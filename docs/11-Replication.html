<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.47">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>先行研究の再現 – 『カテゴリカルデータの連関モデル』</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./12-Review.html" rel="next">
<link href="./10-R.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./11-Replication.html">先行研究の再現</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">『カテゴリカルデータの連関モデル』</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">はじめに</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1-Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">シリーズ編者による内容紹介</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2-Chapter_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">第1章</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3-Chapter_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">第2章</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4-Chapter_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">第3章</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5-Chapter_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">第4章</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6-Chapter_5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">第5章</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7-Chapter_6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">第6章</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8-degrees_of_freedom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">自由度</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./9-Note.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">補足のノート</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RとRStudioのインストールと基本的な操作方法</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-Replication.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">先行研究の再現</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-Review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">研究の動向</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-Crosstabs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">クロス表</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目次</h2>
   
  <ul>
  <li><a href="#なぜ再現が重要か" id="toc-なぜ再現が重要か" class="nav-link active" data-scroll-target="#なぜ再現が重要か">なぜ再現が重要か</a></li>
  <li><a href="#goodman-1979" id="toc-goodman-1979" class="nav-link" data-scroll-target="#goodman-1979">Goodman (1979)</a>
  <ul class="collapse">
  <li><a href="#データの準備" id="toc-データの準備" class="nav-link" data-scroll-target="#データの準備">データの準備</a></li>
  <li><a href="#独立モデルと一様連関モデル" id="toc-独立モデルと一様連関モデル" class="nav-link" data-scroll-target="#独立モデルと一様連関モデル">独立モデルと一様連関モデル</a></li>
  <li><a href="#rc1モデル" id="toc-rc1モデル" class="nav-link" data-scroll-target="#rc1モデル">RC(1)モデル</a></li>
  <li><a href="#モデル比較" id="toc-モデル比較" class="nav-link" data-scroll-target="#モデル比較">モデル比較</a></li>
  </ul></li>
  <li><a href="#duncan-1979" id="toc-duncan-1979" class="nav-link" data-scroll-target="#duncan-1979">Duncan (1979)</a></li>
  <li><a href="#yamaguchi-1987" id="toc-yamaguchi-1987" class="nav-link" data-scroll-target="#yamaguchi-1987">Yamaguchi (1987)</a></li>
  <li><a href="#xie-1992" id="toc-xie-1992" class="nav-link" data-scroll-target="#xie-1992">Xie (1992)</a></li>
  <li><a href="#参考文献" id="toc-参考文献" class="nav-link" data-scroll-target="#参考文献">参考文献</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">先行研究の再現</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="なぜ再現が重要か" class="level2">
<h2 class="anchored" data-anchor-id="なぜ再現が重要か">なぜ再現が重要か</h2>
<p>先行研究の再現（replication）は、統計手法を学ぶ上で非常に有効なアプローチである。その理由は以下の通りである。</p>
<ol type="1">
<li><p><strong>手法の理解が深まる</strong>: 論文を読むだけでなく、実際にデータを入力し、モデルを推定し、結果を確認することで、手法の理解が格段に深まる。</p></li>
<li><p><strong>実装の詳細を学べる</strong>: 論文には書かれていない実装上の工夫やデータの前処理方法を、コードを書く過程で学ぶことができる。</p></li>
<li><p><strong>結果の検証ができる</strong>: 自分の実装が正しいかどうかを、論文の結果と照合することで確認できる。これはソフトウェアや推定アルゴリズムの理解にもつながる。</p></li>
<li><p><strong>応用への準備になる</strong>: 先行研究を再現できれば、同じ手法を自分のデータに適用する準備が整う。</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
再現における注意点
</div>
</div>
<div class="callout-body-container callout-body">
<p>論文の結果と完全に一致しないことは珍しくない。これは以下の理由による：</p>
<ul>
<li>丸め誤差や収束基準の違い</li>
<li>使用したソフトウェアやアルゴリズムの違い</li>
<li>論文の誤植</li>
<li>モデルの定式化の微妙な違い（制約条件など）</li>
</ul>
<p>重要なのは、<strong>主要な結論が一致するかどうか</strong>である。L²やパラメータ推定値が数ポイント異なっても、解釈が同じであれば問題ない。</p>
</div>
</div>
<p><a href="https://github.com/ShoFujihara/Association_Models_Japanese/tree/main/scripts">訳者のGitHubのスクリプトのフォルダ</a> にRのスクリプトファイルを保存しているので、それも活用してください。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gnm)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcdExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="goodman-1979" class="level2">
<h2 class="anchored" data-anchor-id="goodman-1979">Goodman (1979)</h2>
<p><span class="citation" data-cites="goodman1979a">Goodman (<a href="#ref-goodman1979a" role="doc-biblioref">1979</a>)</span> はRC連関モデルを提唱した記念碑的論文である。ここではTable 4のデータ（精神的健康と親の社会経済的地位の関連）を用いて、一様連関モデルとRC(1)モデルを再現する。</p>
<section id="データの準備" class="level3">
<h3 class="anchored" data-anchor-id="データの準備">データの準備</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Goodman (1979) Table 4: Mental Health by Parents' SES</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Rows: Mental Health (Well, Mild, Moderate, Impaired)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Columns: Parents' SES (A=High, B, C, D, E, F=Low)</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>Freq_gm79 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">64</span>, <span class="dv">94</span>, <span class="dv">58</span>, <span class="dv">46</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>               <span class="dv">57</span>, <span class="dv">94</span>, <span class="dv">54</span>, <span class="dv">40</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>               <span class="dv">57</span>, <span class="dv">105</span>, <span class="dv">65</span>, <span class="dv">60</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>               <span class="dv">72</span>, <span class="dv">141</span>, <span class="dv">77</span>, <span class="dv">94</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>               <span class="dv">36</span>, <span class="dv">97</span>, <span class="dv">54</span>, <span class="dv">78</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>               <span class="dv">21</span>, <span class="dv">71</span>, <span class="dv">54</span>, <span class="dv">71</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>d_gm79 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Freq =</span> Freq_gm79,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">MH =</span> <span class="fu">gl</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">24</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Well"</span>, <span class="st">"Mild"</span>, <span class="st">"Moderate"</span>, <span class="st">"Impaired"</span>)),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">SES =</span> <span class="fu">gl</span>(<span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">24</span>, <span class="at">labels =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">U =</span> <span class="fu">as.numeric</span>(MH),  <span class="co"># Row scores</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">V =</span> <span class="fu">as.numeric</span>(SES)  <span class="co"># Column scores</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co"># クロス表として確認</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>d_gm79 <span class="sc">|&gt;</span> <span class="fu">xtabs</span>(Freq <span class="sc">~</span> SES <span class="sc">+</span> MH, <span class="at">data =</span> _)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   MH
SES Well Mild Moderate Impaired
  A   64   94       58       46
  B   57   94       54       40
  C   57  105       65       60
  D   72  141       77       94
  E   36   97       54       78
  F   21   71       54       71</code></pre>
</div>
</div>
</section>
<section id="独立モデルと一様連関モデル" class="level3">
<h3 class="anchored" data-anchor-id="独立モデルと一様連関モデル">独立モデルと一様連関モデル</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1: Independence</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fit_gm79_1 <span class="ot">&lt;-</span> d_gm79 <span class="sc">|&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> MH <span class="sc">+</span> SES, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2: Uniform Association (Row-Column Association I)</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>fit_gm79_2 <span class="ot">&lt;-</span> d_gm79 <span class="sc">|&gt;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> MH <span class="sc">+</span> SES <span class="sc">+</span> U<span class="sc">:</span>V, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 結果の比較</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Independence =</span> fit_gm79_1,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Uniform Association</span><span class="st">`</span> <span class="ot">=</span> fit_gm79_2</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(glance, <span class="at">.id =</span> <span class="st">"Model"</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Model, <span class="at">L2 =</span> deviance, <span class="at">df =</span> df.residual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  Model                  L2    df
  &lt;chr&gt;               &lt;dbl&gt; &lt;int&gt;
1 Independence        47.4     15
2 Uniform Association  9.90    14</code></pre>
</div>
</div>
<p>一様連関パラメータ <span class="math inline">\(\beta\)</span> を確認する。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 一様連関パラメータ</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>beta_ua <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit_gm79_2)[<span class="st">"U:V"</span>]</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"β ="</span>, <span class="fu">round</span>(beta_ua, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>β = 0.0907 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"exp(β) ="</span>, <span class="fu">round</span>(<span class="fu">exp</span>(beta_ua), <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>exp(β) = 1.0949 </code></pre>
</div>
</div>
</section>
<section id="rc1モデル" class="level3">
<h3 class="anchored" data-anchor-id="rc1モデル">RC(1)モデル</h3>
<p>RC(1)モデルは行スコア <span class="math inline">\(\mu_i\)</span> と列スコア <span class="math inline">\(\nu_j\)</span> を推定する。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3: RC(1) Association</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>fit_gm79_3 <span class="ot">&lt;-</span> d_gm79 <span class="sc">|&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> MH <span class="sc">+</span> SES <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, MH, SES),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.......
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 適合度</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_gm79_3) <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">L2 =</span> deviance, <span class="at">df =</span> df.residual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
     L2    df
  &lt;dbl&gt; &lt;int&gt;
1  3.57     8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># スコアの取得と正規化</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(fit_gm79_3, <span class="fu">pickCoef</span>(fit_gm79_3, <span class="st">"[.]MH"</span>),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ref =</span> <span class="st">"mean"</span>, <span class="at">scaleRef =</span> <span class="st">"mean"</span>, <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(fit_gm79_3, <span class="fu">pickCoef</span>(fit_gm79_3, <span class="st">"[.]SES"</span>),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ref =</span> <span class="st">"mean"</span>, <span class="at">scaleRef =</span> <span class="st">"mean"</span>, <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">行スコア（Mental Health）:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
行スコア（Mental Health）:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(mu<span class="sc">$</span>qvframe, <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           Estimate Std. Error
Mult(1, ., SES).MHWell      -0.7327     0.0647
Mult(1, ., SES).MHMild      -0.0335     0.1083
Mult(1, ., SES).MHModerate   0.0927     0.1225
Mult(1, ., SES).MHImpaired   0.6734     0.0786</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">列スコア（Parents' SES）:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
列スコア（Parents' SES）:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(nu<span class="sc">$</span>qvframe, <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate Std. Error
Mult(1, MH, .).SESA  -0.4378     0.1127
Mult(1, MH, .).SESB  -0.4413     0.1142
Mult(1, MH, .).SESC  -0.1566     0.1224
Mult(1, MH, .).SESD  -0.0056     0.1127
Mult(1, MH, .).SESE   0.3674     0.1241
Mult(1, MH, .).SESF   0.6739     0.0932</code></pre>
</div>
</div>
</section>
<section id="モデル比較" class="level3">
<h3 class="anchored" data-anchor-id="モデル比較">モデル比較</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># モデル適合度の比較（Goodman 1979 Table 4と照合）</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Independence"</span>, <span class="st">"Uniform Association"</span>, <span class="st">"RC(1)"</span>),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">L2 =</span> <span class="fu">c</span>(<span class="fu">deviance</span>(fit_gm79_1), <span class="fu">deviance</span>(fit_gm79_2), <span class="fu">deviance</span>(fit_gm79_3)),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> <span class="fu">c</span>(fit_gm79_1<span class="sc">$</span>df, fit_gm79_2<span class="sc">$</span>df, fit_gm79_3<span class="sc">$</span>df)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> <span class="fu">pchisq</span>(L2, df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>),</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">BIC =</span> L2 <span class="sc">-</span> df <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">sum</span>(d_gm79<span class="sc">$</span>Freq))</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Model                  L2    df         p   BIC
  &lt;chr&gt;               &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 Independence        47.4     15 0.0000316 -63.8
2 Uniform Association  9.90    14 0.770     -93.9
3 RC(1)                3.57     8 0.894     -55.7</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
補足
</div>
</div>
<div class="callout-body-container callout-body">
<p>Goodman (1979) のTable 4では、RC(1)モデルの <span class="math inline">\(L^2 = 3.57\)</span>, <span class="math inline">\(df = 8\)</span> と報告されている。上記の結果と一致すれば、実装が正しいことが確認できる。</p>
</div>
</div>
</section>
</section>
<section id="duncan-1979" class="level2">
<h2 class="anchored" data-anchor-id="duncan-1979">Duncan (1979)</h2>
<p><span class="citation" data-cites="duncan1979">Duncan (<a href="#ref-duncan1979" role="doc-biblioref">1979</a>)</span> の結果を再現する．まずはデータを作成する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data (p. 795)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>Freq_duncan_1979 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">19</span>, <span class="dv">26</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">11</span>, <span class="dv">6</span>, <span class="dv">2</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">16</span>, <span class="dv">40</span>, <span class="dv">34</span>, <span class="dv">18</span>, <span class="dv">11</span>, <span class="dv">20</span>, <span class="dv">8</span>, <span class="dv">3</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">12</span>, <span class="dv">35</span>, <span class="dv">65</span>, <span class="dv">66</span>, <span class="dv">35</span>, <span class="dv">88</span>, <span class="dv">23</span>, <span class="dv">21</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">11</span>, <span class="dv">20</span>, <span class="dv">58</span>, <span class="dv">110</span>, <span class="dv">40</span>, <span class="dv">183</span>, <span class="dv">64</span>, <span class="dv">32</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">23</span>, <span class="dv">25</span>, <span class="dv">46</span>, <span class="dv">28</span>, <span class="dv">12</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">12</span>, <span class="dv">28</span>, <span class="dv">102</span>, <span class="dv">162</span>, <span class="dv">90</span>, <span class="dv">554</span>, <span class="dv">230</span>, <span class="dv">177</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">19</span>, <span class="dv">40</span>, <span class="dv">21</span>, <span class="dv">158</span>, <span class="dv">143</span>, <span class="dv">71</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">14</span>, <span class="dv">32</span>, <span class="dv">15</span>, <span class="dv">126</span>, <span class="dv">91</span>, <span class="dv">106</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>d_duncan <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Freq =</span> Freq_duncan_1979,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">O =</span> <span class="fu">gl</span>(<span class="at">n =</span> <span class="dv">8</span>, <span class="at">k =</span> <span class="dv">8</span>, <span class="at">length =</span> <span class="dv">8</span> <span class="sc">*</span> <span class="dv">8</span>),</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">D =</span> <span class="fu">gl</span>(<span class="at">n =</span> <span class="dv">8</span>, <span class="at">k =</span> <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">8</span> <span class="sc">*</span> <span class="dv">8</span>))</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co"># データの完成</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>d_duncan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 64 × 3
    Freq O     D    
   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;
 1    50 1     1    
 2    19 1     2    
 3    26 1     3    
 4     8 1     4    
 5     7 1     5    
 6    11 1     6    
 7     6 1     7    
 8     2 1     8    
 9    16 2     1    
10    40 2     2    
# ℹ 54 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Row and column scores</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>d_duncan <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">U =</span> <span class="fu">as.numeric</span>(O),</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">V =</span> <span class="fu">as.numeric</span>(D))</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 確認</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>d_duncan <span class="sc">|&gt;</span> <span class="fu">count</span>(O, U)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
  O         U     n
  &lt;fct&gt; &lt;dbl&gt; &lt;int&gt;
1 1         1     8
2 2         2     8
3 3         3     8
4 4         4     8
5 5         5     8
6 6         6     8
7 7         7     8
8 8         8     8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>d_duncan <span class="sc">|&gt;</span> <span class="fu">count</span>(D, V)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
  D         V     n
  &lt;fct&gt; &lt;dbl&gt; &lt;int&gt;
1 1         1     8
2 2         2     8
3 3         3     8
4 4         4     8
5 5         5     8
6 6         6     8
7 7         7     8
8 8         8     8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagonal parameters</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>d_duncan <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Diag =</span> <span class="fu">case_when</span>(U <span class="sc">==</span> V <span class="sc">~</span> U, </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">.default =</span> <span class="dv">0</span>))</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 確認</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>d_duncan <span class="sc">|&gt;</span> <span class="fu">xtabs</span>(Diag <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">data =</span> _)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   D
O   1 2 3 4 5 6 7 8
  1 1 0 0 0 0 0 0 0
  2 0 2 0 0 0 0 0 0
  3 0 0 3 0 0 0 0 0
  4 0 0 0 4 0 0 0 0
  5 0 0 0 0 5 0 0 0
  6 0 0 0 0 0 6 0 0
  7 0 0 0 0 0 0 7 0
  8 0 0 0 0 0 0 0 8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># factorにする</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>d_duncan <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">Diag =</span> <span class="fu">factor</span>(Diag))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># weight </span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>d_duncan <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">W =</span> <span class="fu">ifelse</span>(Diag <span class="sc">!=</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># weight変数がどのようになっているのかを確認</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>d_duncan <span class="sc">|&gt;</span> <span class="fu">xtabs</span>(W <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">data =</span> _)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   D
O   1 2 3 4 5 6 7 8
  1 0 1 1 1 1 1 1 1
  2 1 0 1 1 1 1 1 1
  3 1 1 0 1 1 1 1 1
  4 1 1 1 0 1 1 1 1
  5 1 1 1 1 0 1 1 1
  6 1 1 1 1 1 0 1 1
  7 1 1 1 1 1 1 0 1
  8 1 1 1 1 1 1 1 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>d_duncan <span class="sc">|&gt;</span> <span class="fu">uncount</span>(<span class="at">weights =</span> W) <span class="sc">|&gt;</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xtabs</span>(Freq <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">data =</span> _)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   D
O     1   2   3   4   5   6   7   8
  1   0  19  26   8   7  11   6   2
  2  16   0  34  18  11  20   8   3
  3  12  35   0  66  35  88  23  21
  4  11  20  58   0  40 183  64  32
  5   2   8  12  23   0  46  28  12
  6  12  28 102 162  90   0 230 177
  7   0   6  19  40  21 158   0  71
  8   0   3  14  32  15 126  91   0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># データの完成</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>d_duncan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 64 × 7
    Freq O     D         U     V Diag      W
   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt;
 1    50 1     1         1     1 1         0
 2    19 1     2         1     2 0         1
 3    26 1     3         1     3 0         1
 4     8 1     4         1     4 0         1
 5     7 1     5         1     5 0         1
 6    11 1     6         1     6 0         1
 7     6 1     7         1     7 0         1
 8     2 1     8         1     8 0         1
 9    16 2     1         2     1 0         1
10    40 2     2         2     2 2         0
# ℹ 54 more rows</code></pre>
</div>
</div>
<p>このデータについて<code>gnm</code>を用いたモデルの推定を行う．<code>glm</code>でもよい．結果は<code>summary</code>でみることができるが，<code>tidy</code>や<code>glance</code>でも確認でき，これらを使ったほうが表の整理やその後の<code>ggplot</code>による図の作成が簡単である．<code>tidy</code>は<code>gnm</code>をサポートの対象外としているが，<code>glm</code>とほぼ同じ構造なのではじめに警告がでるものの，結果は問題なく出力される．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (1) Independence</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>fit_d_1 <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_d_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ O + D, family = poisson, data = d_duncan)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-5.9252  -3.6322  -0.7127   2.0150  12.8584  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  1.33460    0.13099  10.189  &lt; 2e-16 ***
O2           0.15082    0.12007   1.256 0.209053    
O3           0.98373    0.10319   9.533  &lt; 2e-16 ***
O4           1.39016    0.09839  14.130  &lt; 2e-16 ***
O5           0.19004    0.11899   1.597 0.110244    
O6           2.35174    0.09213  25.527  &lt; 2e-16 ***
O7           1.26706    0.09966  12.713  &lt; 2e-16 ***
O8           1.09861    0.10165  10.808  &lt; 2e-16 ***
D2           0.43417    0.12642   3.434 0.000594 ***
D3           1.16436    0.11280  10.322  &lt; 2e-16 ***
D4           1.49432    0.10896  13.714  &lt; 2e-16 ***
D5           0.86244    0.11744   7.344 2.08e-13 ***
D6           2.44361    0.10265  23.805  &lt; 2e-16 ***
D7           1.75046    0.10668  16.409  &lt; 2e-16 ***
D8           1.41500    0.10978  12.889  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Residual deviance: 954.49 on 49 degrees of freedom
AIC: 1306.8

Number of iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_d_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 5
   term        estimate std.error statistic   p.value
   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 (Intercept)    1.33     0.131      10.2  2.22e- 24
 2 O2             0.151    0.120       1.26 2.09e-  1
 3 O3             0.984    0.103       9.53 1.52e- 21
 4 O4             1.39     0.0984     14.1  2.49e- 45
 5 O5             0.190    0.119       1.60 1.10e-  1
 6 O6             2.35     0.0921     25.5  9.84e-144
 7 O7             1.27     0.0997     12.7  4.98e- 37
 8 O8             1.10     0.102      10.8  3.17e- 27
 9 D2             0.434    0.126       3.43 5.94e-  4
10 D3             1.16     0.113      10.3  5.59e- 25
11 D4             1.49     0.109      13.7  8.33e- 43
12 D5             0.862    0.117       7.34 2.08e- 13
13 D6             2.44     0.103      23.8  2.93e-125
14 D7             1.75     0.107      16.4  1.65e- 60
15 D8             1.42     0.110      12.9  5.18e- 38</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_d_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -638. 1307. 1339.     954.          49    64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (2) Row effects</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>fit_d_2 <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> O <span class="sc">+</span> D <span class="sc">+</span> O<span class="sc">:</span>V, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_d_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ O + D + O:V, family = poisson, data = d_duncan)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.1378  -1.0958  -0.3250   0.8183   3.3582  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  4.78811    0.19161  24.989  &lt; 2e-16 ***
O2          -0.69056    0.25946  -2.662  0.00778 ** 
O3          -1.15391    0.24063  -4.795 1.62e-06 ***
O4          -1.63391    0.24085  -6.784 1.17e-11 ***
O5          -3.24022    0.33365  -9.711  &lt; 2e-16 ***
O6          -1.89930    0.23156  -8.202  &lt; 2e-16 ***
O7          -4.21681    0.30489 -13.831  &lt; 2e-16 ***
O8          -5.13641    0.34152 -15.040  &lt; 2e-16 ***
D2           1.24434    0.13842   8.989  &lt; 2e-16 ***
D3           2.64279    0.15304  17.269  &lt; 2e-16 ***
D4           3.51911    0.18143  19.396  &lt; 2e-16 ***
D5           3.33853    0.21802  15.313  &lt; 2e-16 ***
D6           5.29848    0.24258  21.842  &lt; 2e-16 ***
D7           4.92699    0.27452  17.947  &lt; 2e-16 ***
D8           4.86597    0.30300  16.059  &lt; 2e-16 ***
O1:V        -1.32268    0.07546 -17.529  &lt; 2e-16 ***
O2:V        -1.05277    0.06472 -16.267  &lt; 2e-16 ***
O3:V        -0.73047    0.05137 -14.221  &lt; 2e-16 ***
O4:V        -0.54801    0.04808 -11.397  &lt; 2e-16 ***
O5:V        -0.47086    0.06225  -7.564 3.92e-14 ***
O6:V        -0.32377    0.04351  -7.441 1.00e-13 ***
O7:V        -0.11858    0.05167  -2.295  0.02175 *  
O8:V         0.00000         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 130.08 on 42 degrees of freedom
AIC: 496.42

Number of iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_d_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 23 × 5
   term        estimate std.error statistic   p.value
   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 (Intercept)    4.79      0.192     25.0  8.03e-138
 2 O2            -0.691     0.259     -2.66 7.78e-  3
 3 O3            -1.15      0.241     -4.80 1.62e-  6
 4 O4            -1.63      0.241     -6.78 1.17e- 11
 5 O5            -3.24      0.334     -9.71 2.69e- 22
 6 O6            -1.90      0.232     -8.20 2.36e- 16
 7 O7            -4.22      0.305    -13.8  1.67e- 43
 8 O8            -5.14      0.342    -15.0  4.03e- 51
 9 D2             1.24      0.138      8.99 2.49e- 19
10 D3             2.64      0.153     17.3  8.10e- 67
# ℹ 13 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_d_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -226.  496.  544.     130.          42    64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (3) Quasi independence, diagonal omitted</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>fit_d_3 <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">data =</span> _, <span class="at">weights =</span> W, <span class="at">family =</span> poisson)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_d_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ O + D, family = poisson, data = d_duncan, 
    weights = W)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-4.567  -2.318   0.000   1.018   6.152  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   0.3635     0.1789   2.031   0.0422 *  
O2            0.3545     0.1475   2.402   0.0163 *  
O3            1.3492     0.1276  10.575  &lt; 2e-16 ***
O4            1.7696     0.1232  14.362  &lt; 2e-16 ***
O5            0.5661     0.1426   3.971 7.16e-05 ***
O6            2.7261     0.1193  22.845  &lt; 2e-16 ***
O7            1.5500     0.1262  12.283  &lt; 2e-16 ***
O8            1.3749     0.1276  10.777  &lt; 2e-16 ***
D2            0.8204     0.1652   4.966 6.83e-07 ***
D3            1.6901     0.1506  11.219  &lt; 2e-16 ***
D4            2.0265     0.1477  13.719  &lt; 2e-16 ***
D5            1.4397     0.1532   9.399  &lt; 2e-16 ***
D6            2.9686     0.1444  20.559  &lt; 2e-16 ***
D7            2.2451     0.1455  15.434  &lt; 2e-16 ***
D8            1.8753     0.1486  12.624  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Residual deviance: 446.84 on 41 degrees of freedom
AIC: 748.82

Number of iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_d_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 5
   term        estimate std.error statistic   p.value
   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 (Intercept)    0.363     0.179      2.03 4.22e-  2
 2 O2             0.354     0.148      2.40 1.63e-  2
 3 O3             1.35      0.128     10.6  3.88e- 26
 4 O4             1.77      0.123     14.4  9.01e- 47
 5 O5             0.566     0.143      3.97 7.16e-  5
 6 O6             2.73      0.119     22.8  1.65e-115
 7 O7             1.55      0.126     12.3  1.12e- 34
 8 O8             1.37      0.128     10.8  4.42e- 27
 9 D2             0.820     0.165      4.97 6.83e-  7
10 D3             1.69      0.151     11.2  3.30e- 29
11 D4             2.03      0.148     13.7  7.82e- 43
12 D5             1.44      0.153      9.40 5.50e- 21
13 D6             2.97      0.144     20.6  6.33e- 94
14 D7             2.25      0.145     15.4  9.66e- 54
15 D8             1.88      0.149     12.6  1.56e- 36</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_d_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -359.  749.  781.     447.          41    56</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (3) Quasi independence, diagonal fitted</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>fit_d_3b <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O <span class="sc">+</span> D <span class="sc">+</span> Diag, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_d_3b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ O + D + Diag, family = poisson, data = d_duncan)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-4.567  -2.318   0.000   1.018   6.152  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.36346    0.17892   2.031 0.042211 *  
O2           0.35445    0.14755   2.402 0.016292 *  
O3           1.34923    0.12758  10.575  &lt; 2e-16 ***
O4           1.76957    0.12322  14.362  &lt; 2e-16 ***
O5           0.56615    0.14257   3.971 7.16e-05 ***
O6           2.72612    0.11933  22.845  &lt; 2e-16 ***
O7           1.54999    0.12619  12.283  &lt; 2e-16 ***
O8           1.37488    0.12757  10.777  &lt; 2e-16 ***
D2           0.82044    0.16521   4.966 6.83e-07 ***
D3           1.69007    0.15065  11.219  &lt; 2e-16 ***
D4           2.02648    0.14771  13.719  &lt; 2e-16 ***
D5           1.43966    0.15317   9.399  &lt; 2e-16 ***
D6           2.96856    0.14439  20.559  &lt; 2e-16 ***
D7           2.24512    0.14547  15.434  &lt; 2e-16 ***
D8           1.87534    0.14855  12.624  &lt; 2e-16 ***
Diag1        3.54857    0.22806  15.560  &lt; 2e-16 ***
Diag2        2.15053    0.20737  10.370  &lt; 2e-16 ***
Diag3        0.77163    0.15275   5.052 4.38e-07 ***
Diag4        0.54098    0.12287   4.403 1.07e-05 ***
Diag5        0.84961    0.22965   3.700 0.000216 ***
Diag6        0.25903    0.07531   3.439 0.000583 ***
Diag7        0.80428    0.11438   7.031 2.04e-12 ***
Diag8        1.04976    0.12946   8.109  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Residual deviance: 446.84 on 41 degrees of freedom
AIC: 815.18

Number of iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_d_3b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 23 × 5
   term        estimate std.error statistic   p.value
   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 (Intercept)    0.363     0.179      2.03 4.22e-  2
 2 O2             0.354     0.148      2.40 1.63e-  2
 3 O3             1.35      0.128     10.6  3.88e- 26
 4 O4             1.77      0.123     14.4  9.01e- 47
 5 O5             0.566     0.143      3.97 7.16e-  5
 6 O6             2.73      0.119     22.8  1.65e-115
 7 O7             1.55      0.126     12.3  1.12e- 34
 8 O8             1.37      0.128     10.8  4.42e- 27
 9 D2             0.820     0.165      4.97 6.83e-  7
10 D3             1.69      0.151     11.2  3.30e- 29
# ℹ 13 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_d_3b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -385.  815.  865.     447.          41    64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (4) Uniform association, diagonal omitted</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>fit_d_4 <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span>  O <span class="sc">+</span> D <span class="sc">+</span> U<span class="sc">:</span>V, <span class="at">data =</span> _, <span class="at">weights =</span> W, <span class="at">family =</span> poisson)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_d_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ O + D + U:V, family = poisson, data = d_duncan, 
    weights = W)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.6522  -0.6267   0.0000   0.5913   2.0964  

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  2.109554   0.188406  11.197  &lt; 2e-16 ***
O2          -0.185071   0.150342  -1.231 0.218324    
O3           0.229092   0.136939   1.673 0.094337 .  
O4          -0.060423   0.147813  -0.409 0.682699    
O5          -2.024528   0.187084 -10.822  &lt; 2e-16 ***
O6          -0.590189   0.198922  -2.967 0.003008 ** 
O7          -2.570773   0.244589 -10.511  &lt; 2e-16 ***
O8          -3.518248   0.285046 -12.343  &lt; 2e-16 ***
D2           0.256818   0.168036   1.528 0.126426    
D3           0.581222   0.158565   3.666 0.000247 ***
D4           0.233361   0.167699   1.392 0.164059    
D5          -1.099156   0.193262  -5.687 1.29e-08 ***
D6          -0.265555   0.210615  -1.261 0.207362    
D7          -1.794390   0.250606  -7.160 8.06e-13 ***
D8          -2.916108   0.289546 -10.071  &lt; 2e-16 ***
U:V          0.136974   0.007489  18.289  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Residual deviance: 58.436 on 40 degrees of freedom
AIC: 362.41

Number of iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_d_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 5
   term        estimate std.error statistic  p.value
   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1 (Intercept)   2.11     0.188      11.2   4.22e-29
 2 O2           -0.185    0.150      -1.23  2.18e- 1
 3 O3            0.229    0.137       1.67  9.43e- 2
 4 O4           -0.0604   0.148      -0.409 6.83e- 1
 5 O5           -2.02     0.187     -10.8   2.72e-27
 6 O6           -0.590    0.199      -2.97  3.01e- 3
 7 O7           -2.57     0.245     -10.5   7.72e-26
 8 O8           -3.52     0.285     -12.3   5.33e-35
 9 D2            0.257    0.168       1.53  1.26e- 1
10 D3            0.581    0.159       3.67  2.47e- 4
11 D4            0.233    0.168       1.39  1.64e- 1
12 D5           -1.10     0.193      -5.69  1.29e- 8
13 D6           -0.266    0.211      -1.26  2.07e- 1
14 D7           -1.79     0.251      -7.16  8.06e-13
15 D8           -2.92     0.290     -10.1   7.40e-24
16 U:V           0.137    0.00749    18.3   1.01e-74</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_d_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -165.  362.  397.     58.4          40    56</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># log-odds b_hat</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>fit_d_4<span class="sc">$</span>coefficients[<span class="st">"U:V"</span>] <span class="sc">|&gt;</span> <span class="fu">exp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     U:V 
1.146799 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>fit_d_4b <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span>  O <span class="sc">+</span> D <span class="sc">+</span> U<span class="sc">:</span>V <span class="sc">+</span> Diag, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_d_4b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:

gnm(formula = Freq ~ O + D + U:V + Diag, family = poisson, data = d_duncan)

Deviance Residuals: 
       Min          1Q      Median          3Q         Max  
-2.652e+00  -6.267e-01  -3.932e-08   5.913e-01   2.096e+00  

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  2.109554   0.188406  11.197  &lt; 2e-16 ***
O2          -0.185071   0.150342  -1.231 0.218324    
O3           0.229092   0.136939   1.673 0.094337 .  
O4          -0.060423   0.147813  -0.409 0.682699    
O5          -2.024528   0.187084 -10.822  &lt; 2e-16 ***
O6          -0.590189   0.198922  -2.967 0.003008 ** 
O7          -2.570773   0.244589 -10.511  &lt; 2e-16 ***
O8          -3.518248   0.285046 -12.343  &lt; 2e-16 ***
D2           0.256818   0.168036   1.528 0.126426    
D3           0.581222   0.158565   3.666 0.000247 ***
D4           0.233361   0.167699   1.392 0.164059    
D5          -1.099156   0.193262  -5.687 1.29e-08 ***
D6          -0.265555   0.210615  -1.261 0.207362    
D7          -1.794390   0.250606  -7.160 8.06e-13 ***
D8          -2.916108   0.289546 -10.071  &lt; 2e-16 ***
U:V          0.136974   0.007489  18.289  &lt; 2e-16 ***
Diag1        1.665495   0.237383   7.016 2.28e-12 ***
Diag2        0.959681   0.212122   4.524 6.06e-06 ***
Diag3        0.021750   0.156530   0.139 0.889490    
Diag4        0.226399   0.124364   1.820 0.068689 .  
Diag5        0.808646   0.229754   3.520 0.000432 ***
Diag6        0.132277   0.077191   1.714 0.086597 .  
Diag7        0.506709   0.115936   4.371 1.24e-05 ***
Diag8        0.221880   0.134803   1.646 0.099771 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Residual deviance: 58.436 on 40 degrees of freedom
AIC: 428.78

Number of iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_d_4b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24 × 5
   term        estimate std.error statistic  p.value
   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1 (Intercept)   2.11       0.188    11.2   4.22e-29
 2 O2           -0.185      0.150    -1.23  2.18e- 1
 3 O3            0.229      0.137     1.67  9.43e- 2
 4 O4           -0.0604     0.148    -0.409 6.83e- 1
 5 O5           -2.02       0.187   -10.8   2.72e-27
 6 O6           -0.590      0.199    -2.97  3.01e- 3
 7 O7           -2.57       0.245   -10.5   7.72e-26
 8 O8           -3.52       0.285   -12.3   5.33e-35
 9 D2            0.257      0.168     1.53  1.26e- 1
10 D3            0.581      0.159     3.67  2.47e- 4
# ℹ 14 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_d_4b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -190.  429.  481.     58.4          40    64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># log-odds b_hat</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>fit_d_4b<span class="sc">$</span>coefficients[<span class="st">"U:V"</span>] <span class="sc">|&gt;</span> <span class="fu">exp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     U:V 
1.146799 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (5) Row effects, diagonal omitted*</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>fit_d_5 <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O <span class="sc">+</span> D <span class="sc">+</span> O<span class="sc">:</span>V, <span class="at">data =</span> _, <span class="at">weights =</span> W, <span class="at">family =</span> poisson)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_d_5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ O + D + O:V, family = poisson, data = d_duncan, 
    weights = W)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.5731  -0.5561   0.0000   0.6020   1.4669  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  3.30716    0.35290   9.371  &lt; 2e-16 ***
O2           0.18160    0.40668   0.447   0.6552    
O3           0.07048    0.35788   0.197   0.8439    
O4          -0.59546    0.34779  -1.712   0.0869 .  
O5          -2.17219    0.42137  -5.155 2.54e-07 ***
O6          -0.68517    0.33031  -2.074   0.0380 *  
O7          -2.75820    0.38757  -7.117 1.11e-12 ***
O8          -3.51465    0.43967  -7.994  &lt; 2e-16 ***
D2           1.38525    0.18314   7.564 3.91e-14 ***
D3           2.75348    0.19480  14.135  &lt; 2e-16 ***
D4           3.45305    0.22703  15.210  &lt; 2e-16 ***
D5           3.20664    0.26857  11.940  &lt; 2e-16 ***
D6           5.10309    0.30368  16.804  &lt; 2e-16 ***
D7           4.64707    0.34112  13.623  &lt; 2e-16 ***
D8           4.58416    0.40156  11.416  &lt; 2e-16 ***
O1:V        -0.97261    0.09074 -10.719  &lt; 2e-16 ***
O2:V        -0.91747    0.07796 -11.768  &lt; 2e-16 ***
O3:V        -0.65692    0.06243 -10.522  &lt; 2e-16 ***
O4:V        -0.45024    0.05914  -7.613 2.68e-14 ***
O5:V        -0.38508    0.07183  -5.361 8.29e-08 ***
O6:V        -0.25744    0.05495  -4.685 2.80e-06 ***
O7:V        -0.10400    0.06481  -1.605   0.1085    
O8:V         0.00000         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 45.906 on 34 degrees of freedom
AIC: 361.88

Number of iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_d_5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 23 × 5
   term        estimate std.error statistic  p.value
   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1 (Intercept)   3.31       0.353     9.37  7.16e-21
 2 O2            0.182      0.407     0.447 6.55e- 1
 3 O3            0.0705     0.358     0.197 8.44e- 1
 4 O4           -0.595      0.348    -1.71  8.69e- 2
 5 O5           -2.17       0.421    -5.16  2.54e- 7
 6 O6           -0.685      0.330    -2.07  3.80e- 2
 7 O7           -2.76       0.388    -7.12  1.11e-12
 8 O8           -3.51       0.440    -7.99  1.31e-15
 9 D2            1.39       0.183     7.56  3.91e-14
10 D3            2.75       0.195    14.1   2.32e-45
# ℹ 13 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_d_5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -159.  362.  409.     45.9          34    56</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (5) Row effects, diagonal fitted</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>fit_d_5b <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O <span class="sc">+</span> D <span class="sc">+</span> O<span class="sc">:</span>V <span class="sc">+</span> Diag, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_d_5b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:

gnm(formula = Freq ~ O + D + O:V + Diag, family = poisson, data = d_duncan)

Deviance Residuals: 
       Min          1Q      Median          3Q         Max  
-2.573e+00  -5.561e-01   3.495e-08   6.020e-01   1.467e+00  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  3.30716    0.35290   9.371  &lt; 2e-16 ***
O2           0.18160    0.40668   0.447 0.655198    
O3           0.07048    0.35788   0.197 0.843875    
O4          -0.59546    0.34779  -1.712 0.086876 .  
O5          -2.17219    0.42137  -5.155 2.54e-07 ***
O6          -0.68517    0.33031  -2.074 0.038049 *  
O7          -2.75820    0.38757  -7.117 1.11e-12 ***
O8          -3.51465    0.43967  -7.994  &lt; 2e-16 ***
D2           1.38525    0.18314   7.564 3.91e-14 ***
D3           2.75348    0.19480  14.135  &lt; 2e-16 ***
D4           3.45305    0.22703  15.210  &lt; 2e-16 ***
D5           3.20664    0.26857  11.940  &lt; 2e-16 ***
D6           5.10309    0.30368  16.804  &lt; 2e-16 ***
D7           4.64707    0.34112  13.623  &lt; 2e-16 ***
D8           4.58416    0.40156  11.416  &lt; 2e-16 ***
O1:V        -0.97261    0.09074 -10.719  &lt; 2e-16 ***
O2:V        -0.91747    0.07796 -11.768  &lt; 2e-16 ***
O3:V        -0.65692    0.06243 -10.522  &lt; 2e-16 ***
O4:V        -0.45024    0.05914  -7.613 2.68e-14 ***
O5:V        -0.38508    0.07183  -5.361 8.29e-08 ***
O6:V        -0.25744    0.05495  -4.685 2.80e-06 ***
O7:V        -0.10400    0.06481  -1.605 0.108538    
O8:V         0.00000         NA      NA       NA    
Diag1        1.57747    0.32240   4.893 9.94e-07 ***
Diag2        0.64980    0.24519   2.650 0.008045 ** 
Diag3        0.01404    0.17040   0.082 0.934327    
Diag4        0.33668    0.13137   2.563 0.010381 *  
Diag5        0.80264    0.23091   3.476 0.000509 ***
Diag6        0.13674    0.07784   1.757 0.078973 .  
Diag7        0.49482    0.12541   3.946 7.96e-05 ***
Diag8        0.28677    0.17735   1.617 0.105894    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 45.906 on 34 degrees of freedom
AIC: 428.25

Number of iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_d_5b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 5
   term        estimate std.error statistic  p.value
   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1 (Intercept)   3.31       0.353     9.37  7.16e-21
 2 O2            0.182      0.407     0.447 6.55e- 1
 3 O3            0.0705     0.358     0.197 8.44e- 1
 4 O4           -0.595      0.348    -1.71  8.69e- 2
 5 O5           -2.17       0.421    -5.16  2.54e- 7
 6 O6           -0.685      0.330    -2.07  3.80e- 2
 7 O7           -2.76       0.388    -7.12  1.11e-12
 8 O8           -3.51       0.440    -7.99  1.31e-15
 9 D2            1.39       0.183     7.56  3.91e-14
10 D3            2.75       0.195    14.1   2.32e-45
# ℹ 21 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_d_5b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -184.  428.  493.     45.9          34    64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabel 1</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>d_duncan_fitted <span class="ot">&lt;-</span> </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  d_duncan <span class="sc">|&gt;</span> </span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fitted_1 =</span> <span class="fu">predict</span>(fit_d_1, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">fitted_2 =</span> <span class="fu">predict</span>(fit_d_2, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">fitted_3 =</span> <span class="fu">predict</span>(fit_d_3, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">fitted_4 =</span> <span class="fu">predict</span>(fit_d_4, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">fitted_5 =</span> <span class="fu">predict</span>(fit_d_5, <span class="at">type =</span> <span class="st">"response"</span>))</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>tab_obs <span class="ot">&lt;-</span> d_duncan_fitted <span class="sc">|&gt;</span> <span class="fu">xtabs</span>(Freq <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">data =</span> _)</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>tab_fitted_1 <span class="ot">&lt;-</span> d_duncan_fitted <span class="sc">|&gt;</span> <span class="fu">xtabs</span>(fitted_1 <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">data =</span> _)</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>tab_fitted_2 <span class="ot">&lt;-</span> d_duncan_fitted <span class="sc">|&gt;</span> <span class="fu">xtabs</span>(fitted_2 <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">data =</span> _)</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>tab_fitted_3 <span class="ot">&lt;-</span> d_duncan_fitted <span class="sc">|&gt;</span> <span class="fu">xtabs</span>(fitted_3 <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">data =</span> _)</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>tab_fitted_4 <span class="ot">&lt;-</span> d_duncan_fitted <span class="sc">|&gt;</span> <span class="fu">xtabs</span>(fitted_4 <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">data =</span> _)</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>tab_fitted_5 <span class="ot">&lt;-</span> d_duncan_fitted <span class="sc">|&gt;</span> <span class="fu">xtabs</span>(fitted_5 <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">data =</span> _)</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Observed Counts</span></span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>tab_obs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   D
O     1   2   3   4   5   6   7   8
  1  50  19  26   8   7  11   6   2
  2  16  40  34  18  11  20   8   3
  3  12  35  65  66  35  88  23  21
  4  11  20  58 110  40 183  64  32
  5   2   8  12  23  25  46  28  12
  6  12  28 102 162  90 554 230 177
  7   0   6  19  40  21 158 143  71
  8   0   3  14  32  15 126  91 106</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitted Counts, Model (4)</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>tab_fitted_4 <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   D
O       1     2     3     4     5     6     7     8
  1   9.5  14.0  22.2  18.0   5.4  14.4   3.6   1.3
  2   9.0  15.3  27.9  25.9   9.0  27.2   7.8   3.3
  3  15.6  30.5  63.6  67.7  27.0  93.6  30.6  15.0
  4  13.4  30.0  71.8  87.7  40.0 159.3  59.7  33.7
  5   2.2   5.5  15.2  21.3  11.1  50.8  21.9  14.1
  6  10.4  30.6  96.2 154.5  92.7 485.4 239.3 177.3
  7   1.6   5.5  20.0  36.9  25.4 152.3  86.2  73.2
  8   0.7   2.8  11.7  24.7  19.5 134.4  87.1  84.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitted Counts, Model (5)</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>tab_fitted_5 <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   D
O       1     2     3     4     5     6     7     8
  1  10.3  15.6  23.2  17.6   5.2  13.1   3.1   1.1
  2  13.1  20.9  32.8  26.4   8.2  21.9   5.5   2.1
  3  15.2  31.5  64.1  66.9  27.1  93.6  30.8  15.0
  4   9.6  24.4  61.2  78.6  39.1 166.2  67.2  40.2
  5   2.1   5.8  15.4  21.1  11.2  50.8  21.9  14.0
  6  10.6  32.9  99.8 155.3  93.8 483.2 236.7 171.8
  7   1.6   5.6  19.9  36.1  25.4 152.6  87.2  73.8
  8   0.8   3.2  12.8  25.7  20.1 133.7  84.7  79.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>d_1 <span class="ot">&lt;-</span> (tab_obs<span class="sc">/</span>tab_fitted_1) <span class="sc">|&gt;</span> <span class="fu">diag</span>()</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>d_2 <span class="ot">&lt;-</span> (tab_obs<span class="sc">/</span>tab_fitted_2) <span class="sc">|&gt;</span> <span class="fu">diag</span>()</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>d_3 <span class="ot">&lt;-</span> (tab_obs<span class="sc">/</span>tab_fitted_3) <span class="sc">|&gt;</span> <span class="fu">diag</span>()</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>d_4 <span class="ot">&lt;-</span> (tab_obs<span class="sc">/</span>tab_fitted_4) <span class="sc">|&gt;</span> <span class="fu">diag</span>()</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>d_5 <span class="ot">&lt;-</span> (tab_obs<span class="sc">/</span>tab_fitted_5) <span class="sc">|&gt;</span> <span class="fu">diag</span>()</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagonal Ratios</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>occ <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"I"</span>,<span class="st">"II"</span>,<span class="st">"III"</span>,<span class="st">"IV"</span>,<span class="st">"Va"</span>,<span class="st">"Vb"</span>,<span class="st">"VI"</span>,<span class="st">"VII"</span>)</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(occ, d_1, d_2, d_3, d_4, d_5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 6
  occ     d_1   d_2   d_3   d_4   d_5
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 I     13.2   1.56 34.8   5.29  4.84
2 II     5.87  1.57  8.59  2.61  1.92
3 III    2.00  1.09  2.16  1.02  1.01
4 IV     1.62  1.25  1.72  1.25  1.40
5 Va     2.30  1.99  2.34  2.24  2.23
6 Vb     1.21  1.08  1.30  1.14  1.15
7 VI     1.84  1.34  2.24  1.66  1.64
8 VII    2.26  1.16  2.86  1.25  1.33</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 2</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>Model <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"(1) Independence"</span>,</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"(2) Row effects"</span>,</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">"(3) Quasi independence, diagonal omitted"</span>,</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"(4) Uniform association, diagonal omitted"</span>,</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>           <span class="st">"(5) Row effects, diagonal omitted"</span>)</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 複数のモデルの適合度をglanceで示してまとめる</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(fit_d_1, fit_d_2, fit_d_3, fit_d_4, fit_d_5) <span class="sc">|&gt;</span> </span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(glance) <span class="sc">|&gt;</span> </span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(Model, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Model, <span class="at">L2 =</span> deviance, <span class="at">df =</span> df.residual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  Model                                        L2    df
  &lt;chr&gt;                                     &lt;dbl&gt; &lt;int&gt;
1 (1) Independence                          954.     49
2 (2) Row effects                           130.     42
3 (3) Quasi independence, diagonal omitted  447.     41
4 (4) Uniform association, diagonal omitted  58.4    40
5 (5) Row effects, diagonal omitted          45.9    34</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure 2</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>b_4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(fit_d_4<span class="sc">$</span>coefficients[<span class="st">"U:V"</span>] <span class="sc">*</span> (<span class="dv">7</span><span class="sc">:</span><span class="dv">0</span>))</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>b_5 <span class="ot">&lt;-</span> fit_d_5<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">":V"</span>, <span class="fu">names</span>(fit_d_5<span class="sc">$</span>coefficients))]</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>b_5[<span class="st">"O8:V"</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>b_5 <span class="ot">&lt;-</span> <span class="fu">exp</span>(b_5 <span class="sc">*</span> (<span class="sc">-</span><span class="dv">1</span>)) </span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>d_duncan_b_4 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">y =</span> b_4, <span class="at">Model =</span> <span class="st">"Model 4"</span>, <span class="at">x =</span> <span class="fu">gl</span>(<span class="dv">8</span>, <span class="dv">1</span>))</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>d_duncan_b_5 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">y =</span> b_5, <span class="at">Model =</span> <span class="st">"Model 5"</span>, <span class="at">x =</span> <span class="fu">gl</span>(<span class="dv">8</span>, <span class="dv">1</span>))</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(d_duncan_b_4, d_duncan_b_5)</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">factor</span>(x, <span class="at">levels =</span> <span class="dv">8</span><span class="sc">:</span><span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, </span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> Model, </span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> Model,</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Model)) <span class="sc">+</span> </span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">1</span>,<span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"longdash"</span>,<span class="st">"solid"</span>)) <span class="sc">+</span></span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"FATHER'S OCCUPATION (i)"</span>, <span class="at">y =</span> <span class="st">"b_i/b_8"</span>) <span class="sc">+</span></span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_color_colorblind</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="11-Replication_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mosaic plot</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaic</span>(fit_d_1, <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">residuals_type =</span> <span class="st">"rstandard"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="11-Replication_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaic</span>(fit_d_2, <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">residuals_type =</span> <span class="st">"rstandard"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="11-Replication_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaic</span>(fit_d_3b, <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">residuals_type =</span> <span class="st">"rstandard"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="11-Replication_files/figure-html/unnamed-chunk-9-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaic</span>(fit_d_4b, <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">residuals_type =</span> <span class="st">"rstandard"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="11-Replication_files/figure-html/unnamed-chunk-9-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaic</span>(fit_d_5b, <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">residuals_type =</span> <span class="st">"rstandard"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="11-Replication_files/figure-html/unnamed-chunk-9-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="yamaguchi-1987" class="level2">
<h2 class="anchored" data-anchor-id="yamaguchi-1987">Yamaguchi (1987)</h2>
<p><span class="citation" data-cites="yamaguchi1987">Yamaguchi (<a href="#ref-yamaguchi1987" role="doc-biblioref">1987</a>)</span> の結果を再現する．なおデータは<code>vcdExtra</code>パッケージの<code>Yamaguchi87</code>からも入手できる．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>Freq_yamaguchi_1987 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1275</span>, <span class="dv">364</span>, <span class="dv">274</span>, <span class="dv">272</span>, <span class="dv">17</span>,</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">1055</span>, <span class="dv">597</span>, <span class="dv">394</span>, <span class="dv">443</span>, <span class="dv">31</span>,</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">1043</span>, <span class="dv">587</span>, <span class="dv">1045</span>, <span class="dv">951</span>, <span class="dv">47</span>,</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">1159</span>, <span class="dv">791</span>, <span class="dv">1323</span>, <span class="dv">2046</span>, <span class="dv">52</span>,</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">666</span>, <span class="dv">496</span>, <span class="dv">1031</span>, <span class="dv">1632</span>, <span class="dv">646</span>,</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>                         </span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">474</span>, <span class="dv">129</span>, <span class="dv">87</span>, <span class="dv">124</span>, <span class="dv">11</span>,</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">300</span>, <span class="dv">218</span>, <span class="dv">171</span>, <span class="dv">220</span>, <span class="dv">8</span>,</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">438</span>, <span class="dv">254</span>, <span class="dv">669</span>, <span class="dv">703</span>, <span class="dv">16</span>,</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">601</span>, <span class="dv">388</span>, <span class="dv">932</span>, <span class="dv">1789</span>, <span class="dv">37</span>,</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">76</span>, <span class="dv">56</span>, <span class="dv">125</span>, <span class="dv">295</span>, <span class="dv">191</span>,</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>                         </span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">127</span>, <span class="dv">101</span>, <span class="dv">24</span>, <span class="dv">30</span>, <span class="dv">12</span>,</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">86</span>, <span class="dv">207</span>, <span class="dv">64</span>, <span class="dv">61</span>, <span class="dv">13</span>,</span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">43</span>, <span class="dv">73</span>, <span class="dv">122</span>, <span class="dv">60</span>, <span class="dv">13</span>,</span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">35</span>, <span class="dv">51</span>, <span class="dv">62</span>, <span class="dv">66</span>, <span class="dv">11</span>,</span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">109</span>, <span class="dv">206</span>, <span class="dv">184</span>, <span class="dv">253</span>, <span class="dv">325</span>)</span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>d_yamaguchi <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">O =</span> <span class="fu">gl</span>(<span class="dv">5</span>, <span class="at">k =</span> <span class="dv">5</span>, <span class="at">length =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="dv">5</span> <span class="sc">*</span> <span class="dv">5</span>),</span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>                      <span class="at">D =</span> <span class="fu">gl</span>(<span class="dv">5</span>, <span class="at">k =</span> <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="dv">5</span> <span class="sc">*</span> <span class="dv">5</span>),</span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a>                      <span class="at">C =</span> <span class="fu">gl</span>(<span class="dv">3</span>, <span class="at">k =</span> <span class="dv">5</span> <span class="sc">*</span> <span class="dv">5</span>, <span class="at">length =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="dv">5</span> <span class="sc">*</span> <span class="dv">5</span>),</span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Freq =</span> Freq_yamaguchi_1987)</span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a>d_yamaguchi</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 75 × 4
   O     D     C      Freq
   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt;
 1 1     1     1      1275
 2 1     2     1       364
 3 1     3     1       274
 4 1     4     1       272
 5 1     5     1        17
 6 2     1     1      1055
 7 2     2     1       597
 8 2     3     1       394
 9 2     4     1       443
10 2     5     1        31
# ℹ 65 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagonal parameters</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>d_yamaguchi <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Diag =</span> <span class="fu">case_when</span>(O <span class="sc">==</span> D <span class="sc">~</span> O, <span class="at">.default =</span> <span class="st">"0"</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>())</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Row and column scores</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>d_yamaguchi <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">U =</span> <span class="fu">as.numeric</span>(O),</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">V =</span> <span class="fu">as.numeric</span>(D))</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Country dummy</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>d_yamaguchi <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">C1 =</span> <span class="fu">case_match</span>(C,</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="st">"2"</span>,<span class="st">"3"</span>) <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"1"</span> <span class="sc">~</span> <span class="dv">1</span>),</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">C2 =</span> <span class="fu">case_match</span>(C,</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"3"</span>) <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"2"</span> <span class="sc">~</span> <span class="dv">1</span>),</span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">C3 =</span> <span class="fu">case_match</span>(C,</span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>) <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"3"</span> <span class="sc">~</span> <span class="dv">1</span>))</span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Off diagonal cells (Diag*C)</span></span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a><span class="co"># No association between R and C, given L</span></span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>fit_y_1 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -929. 1943. 2040.    1336.          33    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># U0-Cross-nationally homogeneous uniform association</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>fit_y_2 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>V, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -349.  784.  884.     175.          32    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>b_2 <span class="ot">&lt;-</span> fit_y_2<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_2<span class="sc">$</span>coefficients))]</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>b_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      U:V 
0.1850182 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># U1-Cross-nationally uniform uniform association</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>fit_y_3 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">*</span>C, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -344.  779.  883.     166.          30    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>b_3 <span class="ot">&lt;-</span> fit_y_3<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_3<span class="sc">$</span>coefficients))]</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>b_3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        U:V      C2:U:V      C3:U:V 
 0.18852859  0.01069127 -0.04990850 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># U2-Cross-nationally uniform uniform association</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>fit_y_4 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>V <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -345.  777.  879.     167.          31    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>b_4 <span class="ot">&lt;-</span> fit_y_4<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_4<span class="sc">$</span>coefficients))]</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>b_4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        U:V      U:V:C3 
 0.19052983 -0.05190974 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R0-Cross-nationally homogeneous row effect association</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>fit_y_5 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> O<span class="sc">:</span>V, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -339.  771.  877.     156.          29    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R1-Cross-nationally uniform row effect association</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>fit_y_6 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> O<span class="sc">:</span>V <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">*</span>C, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -335.  766.  878.     148.          27    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>b_6 <span class="ot">&lt;-</span> fit_y_6<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"V:U"</span>, <span class="fu">names</span>(fit_y_6<span class="sc">$</span>coefficients))]</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>b_6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        V:U      C2:V:U      C3:V:U 
         NA  0.00369588 -0.05053513 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R2-Cross-nationally uniform row effect association</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>fit_y_7 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> O<span class="sc">:</span>V <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -335.  764.  873.     148.          28    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>b_7 <span class="ot">&lt;-</span> fit_y_7<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"V:U"</span>, <span class="fu">names</span>(fit_y_7<span class="sc">$</span>coefficients))]</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>b_7</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     V:U:C3 
-0.05122437 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># C0-Cross-nationally homogeneous column effect association</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>fit_y_8 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>D, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -295.  682.  789.     67.7          29    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># C1-Cross-nationally uniform column effect association</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>fit_y_9 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>D <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">*</span>C, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -291.  679.  790.     60.3          27    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>b_9 <span class="ot">&lt;-</span> fit_y_9<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_9<span class="sc">$</span>coefficients))]</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>b_9</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        U:V      C2:U:V      C3:U:V 
         NA  0.01491735 -0.04242365 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># C2-Cross-nationally uniform column effect association</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>fit_y_10 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>D <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -292.  678.  787.     61.3          28    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>b_10 <span class="ot">&lt;-</span> fit_y_10<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_10<span class="sc">$</span>coefficients))]</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>b_10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     U:V:C3 
-0.04530956 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># H0-Cross-nationally homogeneous homogeneous row &amp; column effect association</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>fit_y_11 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> <span class="fu">MultHomog</span>(O, D), </span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.....
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_11)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -315.  721.  828.     107.          29    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># H1-Cross-nationally uniform homogeneous row &amp; column effect association</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>fit_y_12 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> <span class="fu">MultHomog</span>(O, D) <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C2 <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, </span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.....
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_12)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -310.  717.  828.     98.2          27    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>b_12 <span class="ot">&lt;-</span> fit_y_12<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_12<span class="sc">$</span>coefficients))]</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>b_12</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      U:V:C2       U:V:C3 
-0.002548059 -0.052199354 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># H2-Cross-nationally uniform homogeneous row &amp; column effect association</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>fit_y_13 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> <span class="fu">MultHomog</span>(O, D) <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, </span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.....
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_13)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -310.  715.  824.     98.2          28    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>b_13 <span class="ot">&lt;-</span> fit_y_13<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_13<span class="sc">$</span>coefficients))]</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>b_13</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     U:V:C3 
-0.05173675 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R+C0 -Cross-nationally uniform row &amp; column effect association</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>fit_y_14 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>D <span class="sc">+</span> O<span class="sc">:</span>V, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_14)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -281.  659.  773.     38.8          26    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R+C1 -Cross-nationally uniform row &amp; column effect association</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>fit_y_15 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>D <span class="sc">+</span> O<span class="sc">:</span>V <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C2 <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_15)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -278.  658.  776.     33.3          24    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>b_15 <span class="ot">&lt;-</span> fit_y_15<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_15<span class="sc">$</span>coefficients))]</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>b_15</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      U:V:C2       U:V:C3 
 0.003287747 -0.041213885 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R+C2-Cross-nationally uniform row &amp; column effect association</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>fit_y_16 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>D <span class="sc">+</span> O<span class="sc">:</span>V <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_16)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -278.  656.  772.     33.3          25    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>b_16 <span class="ot">&lt;-</span> fit_y_16<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_16<span class="sc">$</span>coefficients))]</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>b_16</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    U:V:C3 
-0.0418251 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>d_yamaguchi <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SYM =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>,</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, </span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">9</span>,</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">0</span>, <span class="dv">10</span>,</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">0</span>), <span class="dv">3</span>)) <span class="sc">|&gt;</span>  <span class="fu">factor</span>())</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>d_yamaguchi <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(O, D, C, SYM) <span class="sc">|&gt;</span> <span class="fu">unique</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 75 × 4
   O     D     C     SYM  
   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;
 1 1     1     1     0    
 2 1     2     1     1    
 3 1     3     1     2    
 4 1     4     1     3    
 5 1     5     1     4    
 6 2     1     1     1    
 7 2     2     1     0    
 8 2     3     1     5    
 9 2     4     1     6    
10 2     5     1     7    
# ℹ 65 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># QS0-Cross-nationally homogeneous quasi-symmetry</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>fit_y_17 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> SYM, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_17)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -315.  723.  832.     107.          28    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_y_17) <span class="sc">|&gt;</span> <span class="fu">print</span>(<span class="at">n =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 52 × 5
   term         estimate std.error statistic    p.value
   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
 1 (Intercept)  4.47        0.0870   51.4     0        
 2 O2           0.688       0.0658   10.4     1.59e- 25
 3 O3           1.64        0.0602   27.2     1.06e-162
 4 O4           2.34        0.0575   40.7     0        
 5 O5           2.09        0.0650   32.1     1.13e-226
 6 C2          -1.23        0.0742  -16.6     6.96e- 62
 7 C3          -2.41        0.115   -21.0     3.48e- 98
 8 D2          -0.304       0.0519   -5.86    4.74e-  9
 9 D3           0.359       0.0447    8.04    9.13e- 16
10 D4           0.811       0.0414   19.6     2.04e- 85
11 D5          -2.40        0.0947  -25.3     1.06e-141
12 Diag1        2.68        0.0914   29.3     3.33e-189
13 Diag2        1.54        0.0992   15.5     3.40e- 54
14 Diag3        0.487       0.0535    9.10    9.21e- 20
15 Diag4       -0.000521    0.0479   -0.0109  9.91e-  1
16 Diag5        2.31        0.0964   24.0     6.95e-127
17 SYM1         1.78        0.0722   24.7     1.90e-134
18 SYM2         0.811       0.0517   15.7     1.73e- 55
19 SYM3         0.256       0.0532    4.80    1.56e-  6
20 SYM4        NA          NA        NA      NA        
21 SYM5         0.541       0.0553    9.78    1.35e- 22
22 SYM6         0.132       0.0563    2.34    1.92e-  2
23 SYM7        NA          NA        NA      NA        
24 SYM8        NA          NA        NA      NA        
25 SYM9        NA          NA        NA      NA        
26 SYM10       NA          NA        NA      NA        
27 O2:C2        0.0124      0.0798    0.155   8.77e-  1
28 O3:C2        0.373       0.0734    5.09    3.57e-  7
29 O4:C2        0.574       0.0714    8.03    9.65e- 16
30 O5:C2       -1.02        0.0788  -12.9     2.39e- 38
31 O2:C3        0.0805      0.120     0.673   5.01e-  1
32 O3:C3       -0.688       0.116    -5.92    3.20e-  9
33 O4:C3       -1.19        0.120    -9.92    3.45e- 23
34 O5:C3        0.409       0.0967    4.23    2.29e-  5
35 C2:D2        0.0286      0.0541    0.529   5.97e-  1
36 C3:D2        1.05        0.0901   11.6     2.65e- 31
37 C2:D3        0.285       0.0489    5.83    5.64e-  9
38 C3:D3        0.336       0.0893    3.77    1.65e-  4
39 C2:D4        0.516       0.0498   10.4     3.12e- 25
40 C3:D4        0.215       0.0862    2.50    1.25e-  2
41 C2:D5        0.0726      0.148     0.491   6.23e-  1
42 C3:D5        2.05        0.179    11.4     4.08e- 30
43 C2:Diag1     0.243       0.0917    2.65    8.12e-  3
44 C3:Diag1     0.106       0.148     0.720   4.72e-  1
45 C2:Diag2     0.184       0.102     1.80    7.26e-  2
46 C3:Diag2     0.225       0.128     1.76    7.91e-  2
47 C2:Diag3     0.128       0.0743    1.72    8.60e-  2
48 C3:Diag3     0.617       0.140     4.41    1.05e-  5
49 C2:Diag4     0.00793     0.0624    0.127   8.99e-  1
50 C3:Diag4    -0.0490      0.163    -0.300   7.64e-  1
51 C2:Diag5     0.961       0.174     5.53    3.26e-  8
52 C3:Diag5    -0.730       0.189    -3.86    1.12e-  4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># QS1-Cross-nationally uniform quasi-symmetry</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>fit_y_18 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> SYM <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C2 <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_18)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -310.  719.  832.     98.2          26    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>b_18 <span class="ot">&lt;-</span> fit_y_18<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_18<span class="sc">$</span>coefficients))]</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>b_18</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      U:V:C2       U:V:C3 
-0.002538939 -0.052099153 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># QS2-Cross-nationally uniform quasi-symmetry</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>fit_y_19 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> SYM <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_19)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -310.  717.  828.     98.2          27    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>b_19 <span class="ot">&lt;-</span> fit_y_19<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_19<span class="sc">$</span>coefficients))]</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>b_19</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     U:V:C3 
-0.05163812 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FI0-Cross-nationallyhomogeneous full two-way interaction</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>fit_y_20 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> O<span class="sc">:</span>D, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_20)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -279.  665.  788.     36.2          22    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FI1-Cross-nationally uniform full two-way interaction</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>fit_y_21 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> O<span class="sc">:</span>D <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C2 <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_21)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -277.  663.  791.     30.7          20    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>b_21 <span class="ot">&lt;-</span> fit_y_21<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_21<span class="sc">$</span>coefficients))]</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>b_21</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      U:V:C2       U:V:C3 
 0.003476173 -0.041081646 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FI2-Cross-nationally uniform full two-way interaction</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>fit_y_22 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> O<span class="sc">:</span>D <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_22)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -277.  661.  787.     30.8          21    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>b_22 <span class="ot">&lt;-</span> fit_y_22<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_22<span class="sc">$</span>coefficients))]</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>b_22</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     U:V:C3 
-0.04172632 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>Model <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"No association between R and C, given L"</span>,</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">"U0-Cross-nationally homogeneous uniform association"</span>,</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"U1-Cross-nationally uniform uniform association"</span>,</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">"U2-Cross-nationally uniform uniform association"</span>,</span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"R0-Cross-nationally homogeneous row effect association"</span>,</span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>           <span class="st">"R1-Cross-nationally uniform row effect association"</span>,</span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"R2-Cross-nationally uniform row effect association"</span>,</span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a>           <span class="st">"C0-Cross-nationally homogeneous column effect association"</span>,</span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a>           <span class="st">"C1-Cross-nationally uniform column effect association"</span>,</span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a>           <span class="st">"C2-Cross-nationally uniform column effect association"</span>,</span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a>           <span class="st">"H0-Cross-nationally homogeneous homogeneous row &amp; column effect association"</span>,</span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a>           <span class="st">"H1-Cross-nationally uniform homogeneousrow &amp; column effect association"</span>,</span>
<span id="cb192-13"><a href="#cb192-13" aria-hidden="true" tabindex="-1"></a>           <span class="st">"H2-Cross-nationally uniform homogeneousrow &amp; column effect association"</span>,</span>
<span id="cb192-14"><a href="#cb192-14" aria-hidden="true" tabindex="-1"></a>           <span class="st">"R+C0 -Cross-nationally uniform row &amp; column effect association"</span>,</span>
<span id="cb192-15"><a href="#cb192-15" aria-hidden="true" tabindex="-1"></a>           <span class="st">"R+C1 -Cross-nationally uniform row &amp; column effect association"</span>,</span>
<span id="cb192-16"><a href="#cb192-16" aria-hidden="true" tabindex="-1"></a>           <span class="st">"R+C2-Cross-nationally uniform row &amp; column effect association"</span>,</span>
<span id="cb192-17"><a href="#cb192-17" aria-hidden="true" tabindex="-1"></a>           <span class="st">"QS0-Cross-nationally homogeneous quasi-symmetry"</span>,</span>
<span id="cb192-18"><a href="#cb192-18" aria-hidden="true" tabindex="-1"></a>           <span class="st">"QS1-Cross-nationally uniform quasi-symmetry"</span>,</span>
<span id="cb192-19"><a href="#cb192-19" aria-hidden="true" tabindex="-1"></a>           <span class="st">"QS2-Cross-nationally uniform quasi-symmetry"</span>,</span>
<span id="cb192-20"><a href="#cb192-20" aria-hidden="true" tabindex="-1"></a>           <span class="st">"FI0-Cross-nationallyhomogeneous full two-way interaction"</span>,</span>
<span id="cb192-21"><a href="#cb192-21" aria-hidden="true" tabindex="-1"></a>           <span class="st">"FI1-Cross-nationally uniform full two-way interaction"</span>,</span>
<span id="cb192-22"><a href="#cb192-22" aria-hidden="true" tabindex="-1"></a>           <span class="st">"FI2-Cross-nationally uniform full two-way interaction"</span>)</span>
<span id="cb192-23"><a href="#cb192-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-24"><a href="#cb192-24" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(fit_y_1, fit_y_2, fit_y_3, fit_y_4, fit_y_5, fit_y_6, fit_y_7, fit_y_8, fit_y_9, fit_y_10,</span>
<span id="cb192-25"><a href="#cb192-25" aria-hidden="true" tabindex="-1"></a>     fit_y_11, fit_y_12, fit_y_13, fit_y_14, fit_y_15, fit_y_16, fit_y_17, fit_y_18, fit_y_19,</span>
<span id="cb192-26"><a href="#cb192-26" aria-hidden="true" tabindex="-1"></a>     fit_y_20, fit_y_21, fit_y_22) <span class="sc">|&gt;</span> </span>
<span id="cb192-27"><a href="#cb192-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(glance) <span class="sc">|&gt;</span> </span>
<span id="cb192-28"><a href="#cb192-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Model =</span> Model, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb192-29"><a href="#cb192-29" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb192-30"><a href="#cb192-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 22 × 7
   Model                           logLik   AIC   BIC deviance df.residual  nobs
   &lt;chr&gt;                            &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
 1 No association between R and C…  -929. 1943. 2040.   1336.           33    75
 2 U0-Cross-nationally homogeneou…  -349.  784.  884.    175.           32    75
 3 U1-Cross-nationally uniform un…  -344.  779.  883.    166.           30    75
 4 U2-Cross-nationally uniform un…  -345.  777.  879.    167.           31    75
 5 R0-Cross-nationally homogeneou…  -339.  771.  877.    156.           29    75
 6 R1-Cross-nationally uniform ro…  -335.  766.  878.    148.           27    75
 7 R2-Cross-nationally uniform ro…  -335.  764.  873.    148.           28    75
 8 C0-Cross-nationally homogeneou…  -295.  682.  789.     67.7          29    75
 9 C1-Cross-nationally uniform co…  -291.  679.  790.     60.3          27    75
10 C2-Cross-nationally uniform co…  -292.  678.  787.     61.3          28    75
11 H0-Cross-nationally homogeneou…  -315.  721.  828.    107.           29    75
12 H1-Cross-nationally uniform ho…  -310.  717.  828.     98.2          27    75
13 H2-Cross-nationally uniform ho…  -310.  715.  824.     98.2          28    75
14 R+C0 -Cross-nationally uniform…  -281.  659.  773.     38.8          26    75
15 R+C1 -Cross-nationally uniform…  -278.  658.  776.     33.3          24    75
16 R+C2-Cross-nationally uniform …  -278.  656.  772.     33.3          25    75
17 QS0-Cross-nationally homogeneo…  -315.  723.  832.    107.           28    75
18 QS1-Cross-nationally uniform q…  -310.  719.  832.     98.2          26    75
19 QS2-Cross-nationally uniform q…  -310.  717.  828.     98.2          27    75
20 FI0-Cross-nationallyhomogeneou…  -279.  665.  788.     36.2          22    75
21 FI1-Cross-nationally uniform f…  -277.  663.  791.     30.7          20    75
22 FI2-Cross-nationally uniform f…  -277.  661.  787.     30.8          21    75</code></pre>
</div>
</div>
<p>H1とH2が微妙に異なるが誤差の範囲か．また，FI1の<span class="math inline">\(\beta_1\)</span>については符号が <span class="citation" data-cites="yamaguchi1987">Yamaguchi (<a href="#ref-yamaguchi1987" role="doc-biblioref">1987</a>)</span> のものとは異なっているがこちらが正しいか．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R+C2: No uniform difference between any two</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>fit_y_23 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>D <span class="sc">+</span> O<span class="sc">:</span>V <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, </span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_23)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -278.  656.  772.     33.3          25    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_y_23) <span class="sc">|&gt;</span> <span class="fu">print</span>(<span class="at">n =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 53 × 5
   term        estimate std.error statistic   p.value
   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 (Intercept)  7.07       0.177    39.9     0       
 2 O2          -0.197      0.253    -0.778   4.37e- 1
 3 O3          -0.536      0.376    -1.43    1.54e- 1
 4 O4          -0.722      0.549    -1.32    1.88e- 1
 5 O5          -1.43       0.656    -2.18    2.96e- 2
 6 C2          -1.24       0.0742  -16.6     3.30e-62
 7 C3          -2.60       0.130   -19.9     1.61e-88
 8 O2:C2        0.0105     0.0799    0.131   8.96e- 1
 9 O3:C2        0.375      0.0734    5.12    3.13e- 7
10 O4:C2        0.576      0.0716    8.04    8.77e-16
11 O5:C2       -1.03       0.0790  -13.1     4.41e-39
12 O2:C3        0.244      0.131     1.87    6.19e- 2
13 O3:C3       -0.405      0.154    -2.63    8.56e- 3
14 O4:C3       -0.777      0.189    -4.11    4.00e- 5
15 O5:C3        0.911      0.219     4.17    3.08e- 5
16 D2          -0.670      0.161    -4.16    3.18e- 5
17 D3          -0.922      0.240    -3.84    1.25e- 4
18 D4          -0.625      0.351    -1.78    7.49e- 2
19 D5          -2.26       0.545    -4.15    3.31e- 5
20 C2:D2        0.0189     0.0536    0.354   7.24e- 1
21 C3:D2        1.21       0.109    11.1     7.17e-29
22 C2:D3        0.285      0.0491    5.80    6.73e- 9
23 C3:D3        0.640      0.156     4.10    4.20e- 5
24 C2:D4        0.539      0.0498   10.8     2.77e-27
25 C3:D4        0.672      0.216     3.11    1.87e- 3
26 C2:D5        0.157      0.148     1.06    2.90e- 1
27 C3:D5        2.31       0.275     8.38    5.22e-17
28 Diag1        0.247      0.135     1.83    6.76e- 2
29 Diag2        0.249      0.0715    3.49    4.90e- 4
30 Diag3        0.361      0.0460    7.85    4.25e-15
31 Diag4       -0.00158    0.0564   -0.0280  9.78e- 1
32 Diag5        3.09       0.177    17.5     1.15e-68
33 C2:Diag1     0.246      0.0917    2.69    7.22e- 3
34 C3:Diag1     0.332      0.168     1.98    4.80e- 2
35 C2:Diag2     0.199      0.102     1.95    5.13e- 2
36 C3:Diag2     0.246      0.128     1.93    5.38e- 2
37 C2:Diag3     0.130      0.0742    1.75    8.06e- 2
38 C3:Diag3     0.590      0.140     4.22    2.49e- 5
39 C2:Diag4    -0.0134     0.0625   -0.214   8.31e- 1
40 C3:Diag4    -0.0629     0.163    -0.387   6.99e- 1
41 C2:Diag5     0.893      0.174     5.13    2.89e- 7
42 C3:Diag5    -0.264      0.219    -1.21    2.28e- 1
43 D1:U         0.177      0.136     1.30    1.93e- 1
44 D2:U         0.245      0.118     2.08    3.73e- 2
45 D3:U         0.442      0.0941    4.70    2.60e- 6
46 D4:U         0.476      0.0784    6.07    1.28e- 9
47 D5:U         0         NA        NA      NA       
48 O1:V        -0.342      0.105    -3.27    1.08e- 3
49 O2:V        -0.275      0.0678   -4.05    5.05e- 5
50 O3:V        -0.116      0.0440   -2.63    8.55e- 3
51 O4:V         0         NA        NA      NA       
52 O5:V         0         NA        NA      NA       
53 U:V:C3      -0.0418     0.0178   -2.35    1.88e- 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R+C3: Uniform difference between G.B. and U.S.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="xie-1992" class="level2">
<h2 class="anchored" data-anchor-id="xie-1992">Xie (1992)</h2>
<p><span class="citation" data-cites="xie1992">Xie (<a href="#ref-xie1992" role="doc-biblioref">1992</a>)</span> の結果を再現する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>d_xie <span class="ot">&lt;-</span> d_yamaguchi</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 確認</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>d_xie</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 75 × 11
   O     D     C      Freq Diag      U     V    C1    C2    C3 SYM  
   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;
 1 1     1     1      1275 1         1     1     1     0     0 0    
 2 1     2     1       364 0         1     2     1     0     0 1    
 3 1     3     1       274 0         1     3     1     0     0 2    
 4 1     4     1       272 0         1     4     1     0     0 3    
 5 1     5     1        17 0         1     5     1     0     0 4    
 6 2     1     1      1055 0         2     1     1     0     0 1    
 7 2     2     1       597 2         2     2     1     0     0 0    
 8 2     3     1       394 0         2     3     1     0     0 5    
 9 2     4     1       443 0         2     4     1     0     0 6    
10 2     5     1        31 0         2     5     1     0     0 7    
# ℹ 65 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Off diagonal cells (Diag*C)</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Null association between R and C, given L</span></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>fit_x_1 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -929. 1943. 2040.    1336.          33    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R0 Cross-nationally homogeneous row effect association</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>fit_x_2 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> O<span class="sc">:</span>V, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -339.  771.  877.     156.          29    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R1 Cross-nationally uniform row effect association</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>fit_x_3 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> O<span class="sc">:</span>V <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">*</span>C, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -335.  766.  878.     148.          27    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rx Cross-nationally log-multiplicative row effect association</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>fit_x_4 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> <span class="fu">Mult</span>(C,O,V), <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.......
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -335.  766.  877.     148.          27    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># C0-Cross-nationally homogeneous column effect association</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>fit_x_5 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>D, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -295.  682.  789.     67.7          29    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># C1-Cross-nationally uniform column effect association</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>fit_x_6 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>D <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">*</span>C, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1        34313.      74  -291.  679.  790.     60.3          27    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cx-Cross-nationally log-multiplicative column effect association</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>fit_x_7 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> <span class="fu">Mult</span>(C,U,D), <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.......
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -291.  677.  789.     58.8          27    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (R+C) 0 - Cross-nationally homogeneous row and column effects association I</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>fit_x_8 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C  <span class="sc">+</span> O<span class="sc">:</span>V <span class="sc">+</span> U<span class="sc">:</span>D, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -281.  659.  773.     38.8          26    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (R+C) u - Cross-nationally uniform row and column effects association I</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>fit_x_9 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C  <span class="sc">+</span> O<span class="sc">:</span>V <span class="sc">+</span> U<span class="sc">:</span>D <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">*</span>C, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -278.  658.  776.     33.3          24    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (R+C) x - Cross-nationally log-multiplicative row and column effects association I</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>fit_x_10 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> <span class="fu">Mult</span>(C,O<span class="sc">:</span>V<span class="sc">+</span>U<span class="sc">:</span>D), <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations........
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -278.  658.  776.     33.0          24    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RC0 Cross-nationally homogeneous row and column effects association</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>fit_x_11 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> <span class="fu">Mult</span>(O,D), <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.......
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_11)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -280.  658.  772.     37.7          26    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RCx Cross-nationally log-multiplicative row and column effects association</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>fit_x_12 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> <span class="fu">Mult</span>(<span class="fu">Exp</span>(C),O,D), <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations........
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_12)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -277.  657.  775.     32.1          24    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FI0 Cross-nationally homogeneous full two-way R and C interaction</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>fit_x_13 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>,O<span class="sc">*</span>D), <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations....
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_13)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -279.  665.  788.     36.2          22    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FIu Cross-nationally uniform full two-way R and C interaction</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>fit_x_14 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>,O<span class="sc">*</span>D) <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">*</span>C, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.....
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_14)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -277.  663.  791.     30.7          20    75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FIx Cross-nationally log-multiplicative full two-way R and C interaction</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>fit_x_15 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> <span class="fu">Mult</span>(<span class="fu">Exp</span>(C),O<span class="sc">*</span>D), <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations........
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_15)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -277.  664.  791.     30.9          20    75</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a>Model <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Null association between R and C, given L"</span>,</span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">"R0 Cross-nationally homogeneous row effect association"</span>,</span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"R1 Cross-nationally uniform row effect association"</span>,</span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Rx Cross-nationally log-multiplicative row effect association"</span>,</span>
<span id="cb247-5"><a href="#cb247-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"C0-Cross-nationally homogeneous column effect association"</span>,</span>
<span id="cb247-6"><a href="#cb247-6" aria-hidden="true" tabindex="-1"></a>           <span class="st">"C1-Cross-nationally uniform column effect association"</span>,</span>
<span id="cb247-7"><a href="#cb247-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Cx-Cross-nationally log-multiplicative column effect association"</span>,</span>
<span id="cb247-8"><a href="#cb247-8" aria-hidden="true" tabindex="-1"></a>           <span class="st">"(R+C) 0 - Cross-nationally homogeneous row and column effects association I"</span>,</span>
<span id="cb247-9"><a href="#cb247-9" aria-hidden="true" tabindex="-1"></a>           <span class="st">"(R+C) u - Cross-nationally uniform row and column effects association I"</span>,</span>
<span id="cb247-10"><a href="#cb247-10" aria-hidden="true" tabindex="-1"></a>           <span class="st">"(R+C) x - Cross-nationally log-multiplicative row and column effects association I"</span>,</span>
<span id="cb247-11"><a href="#cb247-11" aria-hidden="true" tabindex="-1"></a>           <span class="st">"RC0 Cross-nationally homogeneous row and column effects association"</span>,</span>
<span id="cb247-12"><a href="#cb247-12" aria-hidden="true" tabindex="-1"></a>           <span class="st">"RCx Cross-nationally log-multiplicative row and column effects association"</span>,</span>
<span id="cb247-13"><a href="#cb247-13" aria-hidden="true" tabindex="-1"></a>           <span class="st">"FI0 Cross-nationally homogeneous full two-way R and C interaction"</span>,</span>
<span id="cb247-14"><a href="#cb247-14" aria-hidden="true" tabindex="-1"></a>           <span class="st">"FIu Cross-nationally uniform full two-way R and C interaction"</span>,</span>
<span id="cb247-15"><a href="#cb247-15" aria-hidden="true" tabindex="-1"></a>           <span class="st">"FIx Cross-nationally log-multiplicative full two-way R and C interaction"</span>)</span>
<span id="cb247-16"><a href="#cb247-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-17"><a href="#cb247-17" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(fit_x_1, fit_x_2, fit_x_3, fit_x_4, fit_x_5, </span>
<span id="cb247-18"><a href="#cb247-18" aria-hidden="true" tabindex="-1"></a>     fit_x_6, fit_x_7, fit_x_8, fit_x_9, fit_x_10,</span>
<span id="cb247-19"><a href="#cb247-19" aria-hidden="true" tabindex="-1"></a>     fit_x_11, fit_x_12, fit_x_13, fit_x_14, fit_x_15) <span class="sc">|&gt;</span> </span>
<span id="cb247-20"><a href="#cb247-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(glance) <span class="sc">|&gt;</span> </span>
<span id="cb247-21"><a href="#cb247-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Model =</span> Model, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-22"><a href="#cb247-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb247-23"><a href="#cb247-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 7
   Model                           logLik   AIC   BIC deviance df.residual  nobs
   &lt;chr&gt;                            &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
 1 Null association between R and…  -929. 1943. 2040.   1336.           33    75
 2 R0 Cross-nationally homogeneou…  -339.  771.  877.    156.           29    75
 3 R1 Cross-nationally uniform ro…  -335.  766.  878.    148.           27    75
 4 Rx Cross-nationally log-multip…  -335.  766.  877.    148.           27    75
 5 C0-Cross-nationally homogeneou…  -295.  682.  789.     67.7          29    75
 6 C1-Cross-nationally uniform co…  -291.  679.  790.     60.3          27    75
 7 Cx-Cross-nationally log-multip…  -291.  677.  789.     58.8          27    75
 8 (R+C) 0 - Cross-nationally hom…  -281.  659.  773.     38.8          26    75
 9 (R+C) u - Cross-nationally uni…  -278.  658.  776.     33.3          24    75
10 (R+C) x - Cross-nationally log…  -278.  658.  776.     33.0          24    75
11 RC0 Cross-nationally homogeneo…  -280.  658.  772.     37.7          26    75
12 RCx Cross-nationally log-multi…  -277.  657.  775.     32.1          24    75
13 FI0 Cross-nationally homogeneo…  -279.  665.  788.     36.2          22    75
14 FIu Cross-nationally uniform f…  -277.  663.  791.     30.7          20    75
15 FIx Cross-nationally log-multi…  -277.  664.  791.     30.9          20    75</code></pre>
</div>
</div>
</section>
<section id="参考文献" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="参考文献">参考文献</h2>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-duncan1979" class="csl-entry" role="listitem">
Duncan, Otis Dudley. 1979. <span>“How <span>Destination Depends</span> on <span>Origin</span> in the <span>Occupational Mobility Table</span>.”</span> <em>The American Journal of Sociology</em> 84 (4): 793–803. <a href="https://www.jstor.org/stable/2778024">https://www.jstor.org/stable/2778024</a>.
</div>
<div id="ref-goodman1979a" class="csl-entry" role="listitem">
Goodman, Leo A. 1979. <span>“Simple <span>Models</span> for the <span>Analysis</span> of <span>Association</span> in <span>Cross-Classifications</span> Having <span>Ordered Categories</span>.”</span> <em>Journal of the American Statistical Association</em> 74 (367): 537–52.
</div>
<div id="ref-xie1992" class="csl-entry" role="listitem">
Xie, Yu. 1992. <span>“The <span>Log-Multiplicative Layer Effect Model</span> for <span>Comparing Mobility Tables</span>.”</span> <em>American Sociological Review</em> 57 (3): 380–95. <a href="https://doi.org/10.2307/2096242">https://doi.org/10.2307/2096242</a>.
</div>
<div id="ref-yamaguchi1987" class="csl-entry" role="listitem">
Yamaguchi, Kazuo. 1987. <span>“Models for <span>Comparing Mobility Tables</span>: <span>Toward Parsimony</span> and <span>Substance</span>.”</span> <em>American Sociological Review</em> 52 (4): 482–94. <a href="https://doi.org/10.2307/2095293">https://doi.org/10.2307/2095293</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./10-R.html" class="pagination-link" aria-label="RとRStudioのインストールと基本的な操作方法">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">RとRStudioのインストールと基本的な操作方法</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./12-Review.html" class="pagination-link" aria-label="研究の動向">
        <span class="nav-page-text">研究の動向</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb249" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># 先行研究の再現 {-}</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## なぜ再現が重要か</span></span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-5"><a href="#cb249-5" aria-hidden="true" tabindex="-1"></a>先行研究の再現（replication）は、統計手法を学ぶ上で非常に有効なアプローチである。その理由は以下の通りである。</span>
<span id="cb249-6"><a href="#cb249-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-7"><a href="#cb249-7" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**手法の理解が深まる**: 論文を読むだけでなく、実際にデータを入力し、モデルを推定し、結果を確認することで、手法の理解が格段に深まる。</span>
<span id="cb249-8"><a href="#cb249-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-9"><a href="#cb249-9" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**実装の詳細を学べる**: 論文には書かれていない実装上の工夫やデータの前処理方法を、コードを書く過程で学ぶことができる。</span>
<span id="cb249-10"><a href="#cb249-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-11"><a href="#cb249-11" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**結果の検証ができる**: 自分の実装が正しいかどうかを、論文の結果と照合することで確認できる。これはソフトウェアや推定アルゴリズムの理解にもつながる。</span>
<span id="cb249-12"><a href="#cb249-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-13"><a href="#cb249-13" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**応用への準備になる**: 先行研究を再現できれば、同じ手法を自分のデータに適用する準備が整う。</span>
<span id="cb249-14"><a href="#cb249-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-15"><a href="#cb249-15" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb249-16"><a href="#cb249-16" aria-hidden="true" tabindex="-1"></a><span class="fu">## 再現における注意点</span></span>
<span id="cb249-17"><a href="#cb249-17" aria-hidden="true" tabindex="-1"></a>論文の結果と完全に一致しないことは珍しくない。これは以下の理由による：</span>
<span id="cb249-18"><a href="#cb249-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-19"><a href="#cb249-19" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>丸め誤差や収束基準の違い</span>
<span id="cb249-20"><a href="#cb249-20" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>使用したソフトウェアやアルゴリズムの違い</span>
<span id="cb249-21"><a href="#cb249-21" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>論文の誤植</span>
<span id="cb249-22"><a href="#cb249-22" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>モデルの定式化の微妙な違い（制約条件など）</span>
<span id="cb249-23"><a href="#cb249-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-24"><a href="#cb249-24" aria-hidden="true" tabindex="-1"></a>重要なのは、**主要な結論が一致するかどうか**である。L²やパラメータ推定値が数ポイント異なっても、解釈が同じであれば問題ない。</span>
<span id="cb249-25"><a href="#cb249-25" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb249-26"><a href="#cb249-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-27"><a href="#cb249-27" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">訳者のGitHubのスクリプトのフォルダ</span><span class="co">](https://github.com/ShoFujihara/Association_Models_Japanese/tree/main/scripts)</span> にRのスクリプトファイルを保存しているので、それも活用してください。</span>
<span id="cb249-28"><a href="#cb249-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-31"><a href="#cb249-31" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb249-32"><a href="#cb249-32" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb249-33"><a href="#cb249-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb249-34"><a href="#cb249-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gnm)</span>
<span id="cb249-35"><a href="#cb249-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb249-36"><a href="#cb249-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcdExtra)</span>
<span id="cb249-37"><a href="#cb249-37" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb249-38"><a href="#cb249-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-39"><a href="#cb249-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-40"><a href="#cb249-40" aria-hidden="true" tabindex="-1"></a><span class="fu">## Goodman (1979)</span></span>
<span id="cb249-41"><a href="#cb249-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-42"><a href="#cb249-42" aria-hidden="true" tabindex="-1"></a>@goodman1979a はRC連関モデルを提唱した記念碑的論文である。ここではTable 4のデータ（精神的健康と親の社会経済的地位の関連）を用いて、一様連関モデルとRC(1)モデルを再現する。</span>
<span id="cb249-43"><a href="#cb249-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-44"><a href="#cb249-44" aria-hidden="true" tabindex="-1"></a><span class="fu">### データの準備</span></span>
<span id="cb249-45"><a href="#cb249-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-48"><a href="#cb249-48" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb249-49"><a href="#cb249-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Goodman (1979) Table 4: Mental Health by Parents' SES</span></span>
<span id="cb249-50"><a href="#cb249-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Rows: Mental Health (Well, Mild, Moderate, Impaired)</span></span>
<span id="cb249-51"><a href="#cb249-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Columns: Parents' SES (A=High, B, C, D, E, F=Low)</span></span>
<span id="cb249-52"><a href="#cb249-52" aria-hidden="true" tabindex="-1"></a>Freq_gm79 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">64</span>, <span class="dv">94</span>, <span class="dv">58</span>, <span class="dv">46</span>,</span>
<span id="cb249-53"><a href="#cb249-53" aria-hidden="true" tabindex="-1"></a>               <span class="dv">57</span>, <span class="dv">94</span>, <span class="dv">54</span>, <span class="dv">40</span>,</span>
<span id="cb249-54"><a href="#cb249-54" aria-hidden="true" tabindex="-1"></a>               <span class="dv">57</span>, <span class="dv">105</span>, <span class="dv">65</span>, <span class="dv">60</span>,</span>
<span id="cb249-55"><a href="#cb249-55" aria-hidden="true" tabindex="-1"></a>               <span class="dv">72</span>, <span class="dv">141</span>, <span class="dv">77</span>, <span class="dv">94</span>,</span>
<span id="cb249-56"><a href="#cb249-56" aria-hidden="true" tabindex="-1"></a>               <span class="dv">36</span>, <span class="dv">97</span>, <span class="dv">54</span>, <span class="dv">78</span>,</span>
<span id="cb249-57"><a href="#cb249-57" aria-hidden="true" tabindex="-1"></a>               <span class="dv">21</span>, <span class="dv">71</span>, <span class="dv">54</span>, <span class="dv">71</span>)</span>
<span id="cb249-58"><a href="#cb249-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-59"><a href="#cb249-59" aria-hidden="true" tabindex="-1"></a>d_gm79 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb249-60"><a href="#cb249-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">Freq =</span> Freq_gm79,</span>
<span id="cb249-61"><a href="#cb249-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">MH =</span> <span class="fu">gl</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">24</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Well"</span>, <span class="st">"Mild"</span>, <span class="st">"Moderate"</span>, <span class="st">"Impaired"</span>)),</span>
<span id="cb249-62"><a href="#cb249-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">SES =</span> <span class="fu">gl</span>(<span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">24</span>, <span class="at">labels =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb249-63"><a href="#cb249-63" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb249-64"><a href="#cb249-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb249-65"><a href="#cb249-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">U =</span> <span class="fu">as.numeric</span>(MH),  <span class="co"># Row scores</span></span>
<span id="cb249-66"><a href="#cb249-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">V =</span> <span class="fu">as.numeric</span>(SES)  <span class="co"># Column scores</span></span>
<span id="cb249-67"><a href="#cb249-67" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb249-68"><a href="#cb249-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-69"><a href="#cb249-69" aria-hidden="true" tabindex="-1"></a><span class="co"># クロス表として確認</span></span>
<span id="cb249-70"><a href="#cb249-70" aria-hidden="true" tabindex="-1"></a>d_gm79 <span class="sc">|&gt;</span> <span class="fu">xtabs</span>(Freq <span class="sc">~</span> SES <span class="sc">+</span> MH, <span class="at">data =</span> _)</span>
<span id="cb249-71"><a href="#cb249-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb249-72"><a href="#cb249-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-73"><a href="#cb249-73" aria-hidden="true" tabindex="-1"></a><span class="fu">### 独立モデルと一様連関モデル</span></span>
<span id="cb249-74"><a href="#cb249-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-77"><a href="#cb249-77" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb249-78"><a href="#cb249-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1: Independence</span></span>
<span id="cb249-79"><a href="#cb249-79" aria-hidden="true" tabindex="-1"></a>fit_gm79_1 <span class="ot">&lt;-</span> d_gm79 <span class="sc">|&gt;</span></span>
<span id="cb249-80"><a href="#cb249-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> MH <span class="sc">+</span> SES, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-81"><a href="#cb249-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-82"><a href="#cb249-82" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2: Uniform Association (Row-Column Association I)</span></span>
<span id="cb249-83"><a href="#cb249-83" aria-hidden="true" tabindex="-1"></a>fit_gm79_2 <span class="ot">&lt;-</span> d_gm79 <span class="sc">|&gt;</span></span>
<span id="cb249-84"><a href="#cb249-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> MH <span class="sc">+</span> SES <span class="sc">+</span> U<span class="sc">:</span>V, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-85"><a href="#cb249-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-86"><a href="#cb249-86" aria-hidden="true" tabindex="-1"></a><span class="co"># 結果の比較</span></span>
<span id="cb249-87"><a href="#cb249-87" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb249-88"><a href="#cb249-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">Independence =</span> fit_gm79_1,</span>
<span id="cb249-89"><a href="#cb249-89" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Uniform Association</span><span class="st">`</span> <span class="ot">=</span> fit_gm79_2</span>
<span id="cb249-90"><a href="#cb249-90" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb249-91"><a href="#cb249-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(glance, <span class="at">.id =</span> <span class="st">"Model"</span>) <span class="sc">|&gt;</span></span>
<span id="cb249-92"><a href="#cb249-92" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Model, <span class="at">L2 =</span> deviance, <span class="at">df =</span> df.residual)</span>
<span id="cb249-93"><a href="#cb249-93" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb249-94"><a href="#cb249-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-95"><a href="#cb249-95" aria-hidden="true" tabindex="-1"></a>一様連関パラメータ $\beta$ を確認する。</span>
<span id="cb249-96"><a href="#cb249-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-99"><a href="#cb249-99" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb249-100"><a href="#cb249-100" aria-hidden="true" tabindex="-1"></a><span class="co"># 一様連関パラメータ</span></span>
<span id="cb249-101"><a href="#cb249-101" aria-hidden="true" tabindex="-1"></a>beta_ua <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit_gm79_2)[<span class="st">"U:V"</span>]</span>
<span id="cb249-102"><a href="#cb249-102" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"β ="</span>, <span class="fu">round</span>(beta_ua, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb249-103"><a href="#cb249-103" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"exp(β) ="</span>, <span class="fu">round</span>(<span class="fu">exp</span>(beta_ua), <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb249-104"><a href="#cb249-104" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb249-105"><a href="#cb249-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-106"><a href="#cb249-106" aria-hidden="true" tabindex="-1"></a><span class="fu">### RC(1)モデル</span></span>
<span id="cb249-107"><a href="#cb249-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-108"><a href="#cb249-108" aria-hidden="true" tabindex="-1"></a>RC(1)モデルは行スコア $\mu_i$ と列スコア $\nu_j$ を推定する。</span>
<span id="cb249-109"><a href="#cb249-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-112"><a href="#cb249-112" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb249-113"><a href="#cb249-113" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb249-114"><a href="#cb249-114" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3: RC(1) Association</span></span>
<span id="cb249-115"><a href="#cb249-115" aria-hidden="true" tabindex="-1"></a>fit_gm79_3 <span class="ot">&lt;-</span> d_gm79 <span class="sc">|&gt;</span></span>
<span id="cb249-116"><a href="#cb249-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> MH <span class="sc">+</span> SES <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, MH, SES),</span>
<span id="cb249-117"><a href="#cb249-117" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-118"><a href="#cb249-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-119"><a href="#cb249-119" aria-hidden="true" tabindex="-1"></a><span class="co"># 適合度</span></span>
<span id="cb249-120"><a href="#cb249-120" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_gm79_3) <span class="sc">|&gt;</span></span>
<span id="cb249-121"><a href="#cb249-121" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">L2 =</span> deviance, <span class="at">df =</span> df.residual)</span>
<span id="cb249-122"><a href="#cb249-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-123"><a href="#cb249-123" aria-hidden="true" tabindex="-1"></a><span class="co"># スコアの取得と正規化</span></span>
<span id="cb249-124"><a href="#cb249-124" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(fit_gm79_3, <span class="fu">pickCoef</span>(fit_gm79_3, <span class="st">"[.]MH"</span>),</span>
<span id="cb249-125"><a href="#cb249-125" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ref =</span> <span class="st">"mean"</span>, <span class="at">scaleRef =</span> <span class="st">"mean"</span>, <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb249-126"><a href="#cb249-126" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(fit_gm79_3, <span class="fu">pickCoef</span>(fit_gm79_3, <span class="st">"[.]SES"</span>),</span>
<span id="cb249-127"><a href="#cb249-127" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ref =</span> <span class="st">"mean"</span>, <span class="at">scaleRef =</span> <span class="st">"mean"</span>, <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb249-128"><a href="#cb249-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-129"><a href="#cb249-129" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">行スコア（Mental Health）:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb249-130"><a href="#cb249-130" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(mu<span class="sc">$</span>qvframe, <span class="dv">4</span>))</span>
<span id="cb249-131"><a href="#cb249-131" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">列スコア（Parents' SES）:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb249-132"><a href="#cb249-132" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(nu<span class="sc">$</span>qvframe, <span class="dv">4</span>))</span>
<span id="cb249-133"><a href="#cb249-133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb249-134"><a href="#cb249-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-135"><a href="#cb249-135" aria-hidden="true" tabindex="-1"></a><span class="fu">### モデル比較</span></span>
<span id="cb249-136"><a href="#cb249-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-139"><a href="#cb249-139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb249-140"><a href="#cb249-140" aria-hidden="true" tabindex="-1"></a><span class="co"># モデル適合度の比較（Goodman 1979 Table 4と照合）</span></span>
<span id="cb249-141"><a href="#cb249-141" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb249-142"><a href="#cb249-142" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Independence"</span>, <span class="st">"Uniform Association"</span>, <span class="st">"RC(1)"</span>),</span>
<span id="cb249-143"><a href="#cb249-143" aria-hidden="true" tabindex="-1"></a>  <span class="at">L2 =</span> <span class="fu">c</span>(<span class="fu">deviance</span>(fit_gm79_1), <span class="fu">deviance</span>(fit_gm79_2), <span class="fu">deviance</span>(fit_gm79_3)),</span>
<span id="cb249-144"><a href="#cb249-144" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> <span class="fu">c</span>(fit_gm79_1<span class="sc">$</span>df, fit_gm79_2<span class="sc">$</span>df, fit_gm79_3<span class="sc">$</span>df)</span>
<span id="cb249-145"><a href="#cb249-145" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb249-146"><a href="#cb249-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb249-147"><a href="#cb249-147" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> <span class="fu">pchisq</span>(L2, df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>),</span>
<span id="cb249-148"><a href="#cb249-148" aria-hidden="true" tabindex="-1"></a>    <span class="at">BIC =</span> L2 <span class="sc">-</span> df <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">sum</span>(d_gm79<span class="sc">$</span>Freq))</span>
<span id="cb249-149"><a href="#cb249-149" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb249-150"><a href="#cb249-150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb249-151"><a href="#cb249-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-152"><a href="#cb249-152" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb249-153"><a href="#cb249-153" aria-hidden="true" tabindex="-1"></a><span class="fu">## 補足</span></span>
<span id="cb249-154"><a href="#cb249-154" aria-hidden="true" tabindex="-1"></a>Goodman (1979) のTable 4では、RC(1)モデルの $L^2 = 3.57$, $df = 8$ と報告されている。上記の結果と一致すれば、実装が正しいことが確認できる。</span>
<span id="cb249-155"><a href="#cb249-155" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb249-156"><a href="#cb249-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-157"><a href="#cb249-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-158"><a href="#cb249-158" aria-hidden="true" tabindex="-1"></a><span class="fu">## Duncan (1979)</span></span>
<span id="cb249-159"><a href="#cb249-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-160"><a href="#cb249-160" aria-hidden="true" tabindex="-1"></a>@duncan1979 の結果を再現する．まずはデータを作成する．</span>
<span id="cb249-161"><a href="#cb249-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-164"><a href="#cb249-164" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb249-165"><a href="#cb249-165" aria-hidden="true" tabindex="-1"></a><span class="co"># Data (p. 795)</span></span>
<span id="cb249-166"><a href="#cb249-166" aria-hidden="true" tabindex="-1"></a>Freq_duncan_1979 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">19</span>, <span class="dv">26</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">11</span>, <span class="dv">6</span>, <span class="dv">2</span>,</span>
<span id="cb249-167"><a href="#cb249-167" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">16</span>, <span class="dv">40</span>, <span class="dv">34</span>, <span class="dv">18</span>, <span class="dv">11</span>, <span class="dv">20</span>, <span class="dv">8</span>, <span class="dv">3</span>,</span>
<span id="cb249-168"><a href="#cb249-168" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">12</span>, <span class="dv">35</span>, <span class="dv">65</span>, <span class="dv">66</span>, <span class="dv">35</span>, <span class="dv">88</span>, <span class="dv">23</span>, <span class="dv">21</span>,</span>
<span id="cb249-169"><a href="#cb249-169" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">11</span>, <span class="dv">20</span>, <span class="dv">58</span>, <span class="dv">110</span>, <span class="dv">40</span>, <span class="dv">183</span>, <span class="dv">64</span>, <span class="dv">32</span>,</span>
<span id="cb249-170"><a href="#cb249-170" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">23</span>, <span class="dv">25</span>, <span class="dv">46</span>, <span class="dv">28</span>, <span class="dv">12</span>,</span>
<span id="cb249-171"><a href="#cb249-171" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">12</span>, <span class="dv">28</span>, <span class="dv">102</span>, <span class="dv">162</span>, <span class="dv">90</span>, <span class="dv">554</span>, <span class="dv">230</span>, <span class="dv">177</span>,</span>
<span id="cb249-172"><a href="#cb249-172" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">19</span>, <span class="dv">40</span>, <span class="dv">21</span>, <span class="dv">158</span>, <span class="dv">143</span>, <span class="dv">71</span>,</span>
<span id="cb249-173"><a href="#cb249-173" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">14</span>, <span class="dv">32</span>, <span class="dv">15</span>, <span class="dv">126</span>, <span class="dv">91</span>, <span class="dv">106</span></span>
<span id="cb249-174"><a href="#cb249-174" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb249-175"><a href="#cb249-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-176"><a href="#cb249-176" aria-hidden="true" tabindex="-1"></a>d_duncan <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Freq =</span> Freq_duncan_1979,</span>
<span id="cb249-177"><a href="#cb249-177" aria-hidden="true" tabindex="-1"></a>                   <span class="at">O =</span> <span class="fu">gl</span>(<span class="at">n =</span> <span class="dv">8</span>, <span class="at">k =</span> <span class="dv">8</span>, <span class="at">length =</span> <span class="dv">8</span> <span class="sc">*</span> <span class="dv">8</span>),</span>
<span id="cb249-178"><a href="#cb249-178" aria-hidden="true" tabindex="-1"></a>                   <span class="at">D =</span> <span class="fu">gl</span>(<span class="at">n =</span> <span class="dv">8</span>, <span class="at">k =</span> <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">8</span> <span class="sc">*</span> <span class="dv">8</span>))</span>
<span id="cb249-179"><a href="#cb249-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-180"><a href="#cb249-180" aria-hidden="true" tabindex="-1"></a><span class="co"># データの完成</span></span>
<span id="cb249-181"><a href="#cb249-181" aria-hidden="true" tabindex="-1"></a>d_duncan</span>
<span id="cb249-182"><a href="#cb249-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-183"><a href="#cb249-183" aria-hidden="true" tabindex="-1"></a><span class="co"># Row and column scores</span></span>
<span id="cb249-184"><a href="#cb249-184" aria-hidden="true" tabindex="-1"></a>d_duncan <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> </span>
<span id="cb249-185"><a href="#cb249-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">U =</span> <span class="fu">as.numeric</span>(O),</span>
<span id="cb249-186"><a href="#cb249-186" aria-hidden="true" tabindex="-1"></a>         <span class="at">V =</span> <span class="fu">as.numeric</span>(D))</span>
<span id="cb249-187"><a href="#cb249-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-188"><a href="#cb249-188" aria-hidden="true" tabindex="-1"></a><span class="co"># 確認</span></span>
<span id="cb249-189"><a href="#cb249-189" aria-hidden="true" tabindex="-1"></a>d_duncan <span class="sc">|&gt;</span> <span class="fu">count</span>(O, U)</span>
<span id="cb249-190"><a href="#cb249-190" aria-hidden="true" tabindex="-1"></a>d_duncan <span class="sc">|&gt;</span> <span class="fu">count</span>(D, V)</span>
<span id="cb249-191"><a href="#cb249-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-192"><a href="#cb249-192" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagonal parameters</span></span>
<span id="cb249-193"><a href="#cb249-193" aria-hidden="true" tabindex="-1"></a>d_duncan <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> </span>
<span id="cb249-194"><a href="#cb249-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Diag =</span> <span class="fu">case_when</span>(U <span class="sc">==</span> V <span class="sc">~</span> U, </span>
<span id="cb249-195"><a href="#cb249-195" aria-hidden="true" tabindex="-1"></a>                          <span class="at">.default =</span> <span class="dv">0</span>))</span>
<span id="cb249-196"><a href="#cb249-196" aria-hidden="true" tabindex="-1"></a><span class="co"># 確認</span></span>
<span id="cb249-197"><a href="#cb249-197" aria-hidden="true" tabindex="-1"></a>d_duncan <span class="sc">|&gt;</span> <span class="fu">xtabs</span>(Diag <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">data =</span> _)</span>
<span id="cb249-198"><a href="#cb249-198" aria-hidden="true" tabindex="-1"></a><span class="co"># factorにする</span></span>
<span id="cb249-199"><a href="#cb249-199" aria-hidden="true" tabindex="-1"></a>d_duncan <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">Diag =</span> <span class="fu">factor</span>(Diag))</span>
<span id="cb249-200"><a href="#cb249-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-201"><a href="#cb249-201" aria-hidden="true" tabindex="-1"></a><span class="co"># weight </span></span>
<span id="cb249-202"><a href="#cb249-202" aria-hidden="true" tabindex="-1"></a>d_duncan <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">W =</span> <span class="fu">ifelse</span>(Diag <span class="sc">!=</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb249-203"><a href="#cb249-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-204"><a href="#cb249-204" aria-hidden="true" tabindex="-1"></a><span class="co"># weight変数がどのようになっているのかを確認</span></span>
<span id="cb249-205"><a href="#cb249-205" aria-hidden="true" tabindex="-1"></a>d_duncan <span class="sc">|&gt;</span> <span class="fu">xtabs</span>(W <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">data =</span> _)</span>
<span id="cb249-206"><a href="#cb249-206" aria-hidden="true" tabindex="-1"></a>d_duncan <span class="sc">|&gt;</span> <span class="fu">uncount</span>(<span class="at">weights =</span> W) <span class="sc">|&gt;</span> </span>
<span id="cb249-207"><a href="#cb249-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xtabs</span>(Freq <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">data =</span> _)</span>
<span id="cb249-208"><a href="#cb249-208" aria-hidden="true" tabindex="-1"></a><span class="co"># データの完成</span></span>
<span id="cb249-209"><a href="#cb249-209" aria-hidden="true" tabindex="-1"></a>d_duncan</span>
<span id="cb249-210"><a href="#cb249-210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb249-211"><a href="#cb249-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-212"><a href="#cb249-212" aria-hidden="true" tabindex="-1"></a>このデータについて<span class="in">`gnm`</span>を用いたモデルの推定を行う．<span class="in">`glm`</span>でもよい．結果は<span class="in">`summary`</span>でみることができるが，<span class="in">`tidy`</span>や<span class="in">`glance`</span>でも確認でき，これらを使ったほうが表の整理やその後の<span class="in">`ggplot`</span>による図の作成が簡単である．<span class="in">`tidy`</span>は<span class="in">`gnm`</span>をサポートの対象外としているが，<span class="in">`glm`</span>とほぼ同じ構造なのではじめに警告がでるものの，結果は問題なく出力される．</span>
<span id="cb249-213"><a href="#cb249-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-216"><a href="#cb249-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb249-217"><a href="#cb249-217" aria-hidden="true" tabindex="-1"></a><span class="co"># (1) Independence</span></span>
<span id="cb249-218"><a href="#cb249-218" aria-hidden="true" tabindex="-1"></a>fit_d_1 <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> </span>
<span id="cb249-219"><a href="#cb249-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-220"><a href="#cb249-220" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_d_1)</span>
<span id="cb249-221"><a href="#cb249-221" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_d_1)</span>
<span id="cb249-222"><a href="#cb249-222" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_d_1)</span>
<span id="cb249-223"><a href="#cb249-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-224"><a href="#cb249-224" aria-hidden="true" tabindex="-1"></a><span class="co"># (2) Row effects</span></span>
<span id="cb249-225"><a href="#cb249-225" aria-hidden="true" tabindex="-1"></a>fit_d_2 <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> </span>
<span id="cb249-226"><a href="#cb249-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> O <span class="sc">+</span> D <span class="sc">+</span> O<span class="sc">:</span>V, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-227"><a href="#cb249-227" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_d_2)</span>
<span id="cb249-228"><a href="#cb249-228" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_d_2)</span>
<span id="cb249-229"><a href="#cb249-229" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_d_2)</span>
<span id="cb249-230"><a href="#cb249-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-231"><a href="#cb249-231" aria-hidden="true" tabindex="-1"></a><span class="co"># (3) Quasi independence, diagonal omitted</span></span>
<span id="cb249-232"><a href="#cb249-232" aria-hidden="true" tabindex="-1"></a>fit_d_3 <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">data =</span> _, <span class="at">weights =</span> W, <span class="at">family =</span> poisson)</span>
<span id="cb249-233"><a href="#cb249-233" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_d_3)</span>
<span id="cb249-234"><a href="#cb249-234" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_d_3)</span>
<span id="cb249-235"><a href="#cb249-235" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_d_3)</span>
<span id="cb249-236"><a href="#cb249-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-237"><a href="#cb249-237" aria-hidden="true" tabindex="-1"></a><span class="co"># (3) Quasi independence, diagonal fitted</span></span>
<span id="cb249-238"><a href="#cb249-238" aria-hidden="true" tabindex="-1"></a>fit_d_3b <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O <span class="sc">+</span> D <span class="sc">+</span> Diag, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-239"><a href="#cb249-239" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_d_3b)</span>
<span id="cb249-240"><a href="#cb249-240" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_d_3b)</span>
<span id="cb249-241"><a href="#cb249-241" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_d_3b)</span>
<span id="cb249-242"><a href="#cb249-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-243"><a href="#cb249-243" aria-hidden="true" tabindex="-1"></a><span class="co"># (4) Uniform association, diagonal omitted</span></span>
<span id="cb249-244"><a href="#cb249-244" aria-hidden="true" tabindex="-1"></a>fit_d_4 <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span>  O <span class="sc">+</span> D <span class="sc">+</span> U<span class="sc">:</span>V, <span class="at">data =</span> _, <span class="at">weights =</span> W, <span class="at">family =</span> poisson)</span>
<span id="cb249-245"><a href="#cb249-245" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_d_4)</span>
<span id="cb249-246"><a href="#cb249-246" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_d_4)</span>
<span id="cb249-247"><a href="#cb249-247" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_d_4)</span>
<span id="cb249-248"><a href="#cb249-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-249"><a href="#cb249-249" aria-hidden="true" tabindex="-1"></a><span class="co"># log-odds b_hat</span></span>
<span id="cb249-250"><a href="#cb249-250" aria-hidden="true" tabindex="-1"></a>fit_d_4<span class="sc">$</span>coefficients[<span class="st">"U:V"</span>] <span class="sc">|&gt;</span> <span class="fu">exp</span>()</span>
<span id="cb249-251"><a href="#cb249-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-252"><a href="#cb249-252" aria-hidden="true" tabindex="-1"></a>fit_d_4b <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span>  O <span class="sc">+</span> D <span class="sc">+</span> U<span class="sc">:</span>V <span class="sc">+</span> Diag, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-253"><a href="#cb249-253" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_d_4b)</span>
<span id="cb249-254"><a href="#cb249-254" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_d_4b)</span>
<span id="cb249-255"><a href="#cb249-255" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_d_4b)</span>
<span id="cb249-256"><a href="#cb249-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-257"><a href="#cb249-257" aria-hidden="true" tabindex="-1"></a><span class="co"># log-odds b_hat</span></span>
<span id="cb249-258"><a href="#cb249-258" aria-hidden="true" tabindex="-1"></a>fit_d_4b<span class="sc">$</span>coefficients[<span class="st">"U:V"</span>] <span class="sc">|&gt;</span> <span class="fu">exp</span>()</span>
<span id="cb249-259"><a href="#cb249-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-260"><a href="#cb249-260" aria-hidden="true" tabindex="-1"></a><span class="co"># (5) Row effects, diagonal omitted*</span></span>
<span id="cb249-261"><a href="#cb249-261" aria-hidden="true" tabindex="-1"></a>fit_d_5 <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O <span class="sc">+</span> D <span class="sc">+</span> O<span class="sc">:</span>V, <span class="at">data =</span> _, <span class="at">weights =</span> W, <span class="at">family =</span> poisson)</span>
<span id="cb249-262"><a href="#cb249-262" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_d_5)</span>
<span id="cb249-263"><a href="#cb249-263" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_d_5)</span>
<span id="cb249-264"><a href="#cb249-264" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_d_5)</span>
<span id="cb249-265"><a href="#cb249-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-266"><a href="#cb249-266" aria-hidden="true" tabindex="-1"></a><span class="co"># (5) Row effects, diagonal fitted</span></span>
<span id="cb249-267"><a href="#cb249-267" aria-hidden="true" tabindex="-1"></a>fit_d_5b <span class="ot">&lt;-</span> d_duncan <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O <span class="sc">+</span> D <span class="sc">+</span> O<span class="sc">:</span>V <span class="sc">+</span> Diag, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-268"><a href="#cb249-268" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_d_5b)</span>
<span id="cb249-269"><a href="#cb249-269" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_d_5b)</span>
<span id="cb249-270"><a href="#cb249-270" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_d_5b)</span>
<span id="cb249-271"><a href="#cb249-271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb249-272"><a href="#cb249-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-273"><a href="#cb249-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-276"><a href="#cb249-276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb249-277"><a href="#cb249-277" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabel 1</span></span>
<span id="cb249-278"><a href="#cb249-278" aria-hidden="true" tabindex="-1"></a>d_duncan_fitted <span class="ot">&lt;-</span> </span>
<span id="cb249-279"><a href="#cb249-279" aria-hidden="true" tabindex="-1"></a>  d_duncan <span class="sc">|&gt;</span> </span>
<span id="cb249-280"><a href="#cb249-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fitted_1 =</span> <span class="fu">predict</span>(fit_d_1, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb249-281"><a href="#cb249-281" aria-hidden="true" tabindex="-1"></a>         <span class="at">fitted_2 =</span> <span class="fu">predict</span>(fit_d_2, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb249-282"><a href="#cb249-282" aria-hidden="true" tabindex="-1"></a>         <span class="at">fitted_3 =</span> <span class="fu">predict</span>(fit_d_3, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb249-283"><a href="#cb249-283" aria-hidden="true" tabindex="-1"></a>         <span class="at">fitted_4 =</span> <span class="fu">predict</span>(fit_d_4, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb249-284"><a href="#cb249-284" aria-hidden="true" tabindex="-1"></a>         <span class="at">fitted_5 =</span> <span class="fu">predict</span>(fit_d_5, <span class="at">type =</span> <span class="st">"response"</span>))</span>
<span id="cb249-285"><a href="#cb249-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-286"><a href="#cb249-286" aria-hidden="true" tabindex="-1"></a>tab_obs <span class="ot">&lt;-</span> d_duncan_fitted <span class="sc">|&gt;</span> <span class="fu">xtabs</span>(Freq <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">data =</span> _)</span>
<span id="cb249-287"><a href="#cb249-287" aria-hidden="true" tabindex="-1"></a>tab_fitted_1 <span class="ot">&lt;-</span> d_duncan_fitted <span class="sc">|&gt;</span> <span class="fu">xtabs</span>(fitted_1 <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">data =</span> _)</span>
<span id="cb249-288"><a href="#cb249-288" aria-hidden="true" tabindex="-1"></a>tab_fitted_2 <span class="ot">&lt;-</span> d_duncan_fitted <span class="sc">|&gt;</span> <span class="fu">xtabs</span>(fitted_2 <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">data =</span> _)</span>
<span id="cb249-289"><a href="#cb249-289" aria-hidden="true" tabindex="-1"></a>tab_fitted_3 <span class="ot">&lt;-</span> d_duncan_fitted <span class="sc">|&gt;</span> <span class="fu">xtabs</span>(fitted_3 <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">data =</span> _)</span>
<span id="cb249-290"><a href="#cb249-290" aria-hidden="true" tabindex="-1"></a>tab_fitted_4 <span class="ot">&lt;-</span> d_duncan_fitted <span class="sc">|&gt;</span> <span class="fu">xtabs</span>(fitted_4 <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">data =</span> _)</span>
<span id="cb249-291"><a href="#cb249-291" aria-hidden="true" tabindex="-1"></a>tab_fitted_5 <span class="ot">&lt;-</span> d_duncan_fitted <span class="sc">|&gt;</span> <span class="fu">xtabs</span>(fitted_5 <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">data =</span> _)</span>
<span id="cb249-292"><a href="#cb249-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-293"><a href="#cb249-293" aria-hidden="true" tabindex="-1"></a><span class="co"># Observed Counts</span></span>
<span id="cb249-294"><a href="#cb249-294" aria-hidden="true" tabindex="-1"></a>tab_obs</span>
<span id="cb249-295"><a href="#cb249-295" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitted Counts, Model (4)</span></span>
<span id="cb249-296"><a href="#cb249-296" aria-hidden="true" tabindex="-1"></a>tab_fitted_4 <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>)</span>
<span id="cb249-297"><a href="#cb249-297" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitted Counts, Model (5)</span></span>
<span id="cb249-298"><a href="#cb249-298" aria-hidden="true" tabindex="-1"></a>tab_fitted_5 <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>)</span>
<span id="cb249-299"><a href="#cb249-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-300"><a href="#cb249-300" aria-hidden="true" tabindex="-1"></a>d_1 <span class="ot">&lt;-</span> (tab_obs<span class="sc">/</span>tab_fitted_1) <span class="sc">|&gt;</span> <span class="fu">diag</span>()</span>
<span id="cb249-301"><a href="#cb249-301" aria-hidden="true" tabindex="-1"></a>d_2 <span class="ot">&lt;-</span> (tab_obs<span class="sc">/</span>tab_fitted_2) <span class="sc">|&gt;</span> <span class="fu">diag</span>()</span>
<span id="cb249-302"><a href="#cb249-302" aria-hidden="true" tabindex="-1"></a>d_3 <span class="ot">&lt;-</span> (tab_obs<span class="sc">/</span>tab_fitted_3) <span class="sc">|&gt;</span> <span class="fu">diag</span>()</span>
<span id="cb249-303"><a href="#cb249-303" aria-hidden="true" tabindex="-1"></a>d_4 <span class="ot">&lt;-</span> (tab_obs<span class="sc">/</span>tab_fitted_4) <span class="sc">|&gt;</span> <span class="fu">diag</span>()</span>
<span id="cb249-304"><a href="#cb249-304" aria-hidden="true" tabindex="-1"></a>d_5 <span class="ot">&lt;-</span> (tab_obs<span class="sc">/</span>tab_fitted_5) <span class="sc">|&gt;</span> <span class="fu">diag</span>()</span>
<span id="cb249-305"><a href="#cb249-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-306"><a href="#cb249-306" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagonal Ratios</span></span>
<span id="cb249-307"><a href="#cb249-307" aria-hidden="true" tabindex="-1"></a>occ <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"I"</span>,<span class="st">"II"</span>,<span class="st">"III"</span>,<span class="st">"IV"</span>,<span class="st">"Va"</span>,<span class="st">"Vb"</span>,<span class="st">"VI"</span>,<span class="st">"VII"</span>)</span>
<span id="cb249-308"><a href="#cb249-308" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(occ, d_1, d_2, d_3, d_4, d_5)</span>
<span id="cb249-309"><a href="#cb249-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-310"><a href="#cb249-310" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 2</span></span>
<span id="cb249-311"><a href="#cb249-311" aria-hidden="true" tabindex="-1"></a>Model <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"(1) Independence"</span>,</span>
<span id="cb249-312"><a href="#cb249-312" aria-hidden="true" tabindex="-1"></a>           <span class="st">"(2) Row effects"</span>,</span>
<span id="cb249-313"><a href="#cb249-313" aria-hidden="true" tabindex="-1"></a>           <span class="st">"(3) Quasi independence, diagonal omitted"</span>,</span>
<span id="cb249-314"><a href="#cb249-314" aria-hidden="true" tabindex="-1"></a>           <span class="st">"(4) Uniform association, diagonal omitted"</span>,</span>
<span id="cb249-315"><a href="#cb249-315" aria-hidden="true" tabindex="-1"></a>           <span class="st">"(5) Row effects, diagonal omitted"</span>)</span>
<span id="cb249-316"><a href="#cb249-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-317"><a href="#cb249-317" aria-hidden="true" tabindex="-1"></a><span class="co"># 複数のモデルの適合度をglanceで示してまとめる</span></span>
<span id="cb249-318"><a href="#cb249-318" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(fit_d_1, fit_d_2, fit_d_3, fit_d_4, fit_d_5) <span class="sc">|&gt;</span> </span>
<span id="cb249-319"><a href="#cb249-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(glance) <span class="sc">|&gt;</span> </span>
<span id="cb249-320"><a href="#cb249-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(Model, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb249-321"><a href="#cb249-321" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Model, <span class="at">L2 =</span> deviance, <span class="at">df =</span> df.residual)</span>
<span id="cb249-322"><a href="#cb249-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-323"><a href="#cb249-323" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure 2</span></span>
<span id="cb249-324"><a href="#cb249-324" aria-hidden="true" tabindex="-1"></a>b_4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(fit_d_4<span class="sc">$</span>coefficients[<span class="st">"U:V"</span>] <span class="sc">*</span> (<span class="dv">7</span><span class="sc">:</span><span class="dv">0</span>))</span>
<span id="cb249-325"><a href="#cb249-325" aria-hidden="true" tabindex="-1"></a>b_5 <span class="ot">&lt;-</span> fit_d_5<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">":V"</span>, <span class="fu">names</span>(fit_d_5<span class="sc">$</span>coefficients))]</span>
<span id="cb249-326"><a href="#cb249-326" aria-hidden="true" tabindex="-1"></a>b_5[<span class="st">"O8:V"</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb249-327"><a href="#cb249-327" aria-hidden="true" tabindex="-1"></a>b_5 <span class="ot">&lt;-</span> <span class="fu">exp</span>(b_5 <span class="sc">*</span> (<span class="sc">-</span><span class="dv">1</span>)) </span>
<span id="cb249-328"><a href="#cb249-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-329"><a href="#cb249-329" aria-hidden="true" tabindex="-1"></a>d_duncan_b_4 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">y =</span> b_4, <span class="at">Model =</span> <span class="st">"Model 4"</span>, <span class="at">x =</span> <span class="fu">gl</span>(<span class="dv">8</span>, <span class="dv">1</span>))</span>
<span id="cb249-330"><a href="#cb249-330" aria-hidden="true" tabindex="-1"></a>d_duncan_b_5 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">y =</span> b_5, <span class="at">Model =</span> <span class="st">"Model 5"</span>, <span class="at">x =</span> <span class="fu">gl</span>(<span class="dv">8</span>, <span class="dv">1</span>))</span>
<span id="cb249-331"><a href="#cb249-331" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(d_duncan_b_4, d_duncan_b_5)</span>
<span id="cb249-332"><a href="#cb249-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-333"><a href="#cb249-333" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb249-334"><a href="#cb249-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">factor</span>(x, <span class="at">levels =</span> <span class="dv">8</span><span class="sc">:</span><span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb249-335"><a href="#cb249-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, </span>
<span id="cb249-336"><a href="#cb249-336" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> Model, </span>
<span id="cb249-337"><a href="#cb249-337" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> Model,</span>
<span id="cb249-338"><a href="#cb249-338" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Model)) <span class="sc">+</span> </span>
<span id="cb249-339"><a href="#cb249-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb249-340"><a href="#cb249-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">1</span>,<span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb249-341"><a href="#cb249-341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"longdash"</span>,<span class="st">"solid"</span>)) <span class="sc">+</span></span>
<span id="cb249-342"><a href="#cb249-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"FATHER'S OCCUPATION (i)"</span>, <span class="at">y =</span> <span class="st">"b_i/b_8"</span>) <span class="sc">+</span></span>
<span id="cb249-343"><a href="#cb249-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb249-344"><a href="#cb249-344" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_color_colorblind</span>()</span>
<span id="cb249-345"><a href="#cb249-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-346"><a href="#cb249-346" aria-hidden="true" tabindex="-1"></a><span class="co"># mosaic plot</span></span>
<span id="cb249-347"><a href="#cb249-347" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaic</span>(fit_d_1, <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">residuals_type =</span> <span class="st">"rstandard"</span>)</span>
<span id="cb249-348"><a href="#cb249-348" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaic</span>(fit_d_2, <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">residuals_type =</span> <span class="st">"rstandard"</span>)</span>
<span id="cb249-349"><a href="#cb249-349" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaic</span>(fit_d_3b, <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">residuals_type =</span> <span class="st">"rstandard"</span>)</span>
<span id="cb249-350"><a href="#cb249-350" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaic</span>(fit_d_4b, <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">residuals_type =</span> <span class="st">"rstandard"</span>)</span>
<span id="cb249-351"><a href="#cb249-351" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaic</span>(fit_d_5b, <span class="sc">~</span> O <span class="sc">+</span> D, <span class="at">residuals_type =</span> <span class="st">"rstandard"</span>)</span>
<span id="cb249-352"><a href="#cb249-352" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb249-353"><a href="#cb249-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-354"><a href="#cb249-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-355"><a href="#cb249-355" aria-hidden="true" tabindex="-1"></a><span class="fu">## Yamaguchi (1987)</span></span>
<span id="cb249-356"><a href="#cb249-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-357"><a href="#cb249-357" aria-hidden="true" tabindex="-1"></a>@yamaguchi1987 の結果を再現する．なおデータは<span class="in">`vcdExtra`</span>パッケージの<span class="in">`Yamaguchi87`</span>からも入手できる．</span>
<span id="cb249-358"><a href="#cb249-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-361"><a href="#cb249-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb249-362"><a href="#cb249-362" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb249-363"><a href="#cb249-363" aria-hidden="true" tabindex="-1"></a>Freq_yamaguchi_1987 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1275</span>, <span class="dv">364</span>, <span class="dv">274</span>, <span class="dv">272</span>, <span class="dv">17</span>,</span>
<span id="cb249-364"><a href="#cb249-364" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">1055</span>, <span class="dv">597</span>, <span class="dv">394</span>, <span class="dv">443</span>, <span class="dv">31</span>,</span>
<span id="cb249-365"><a href="#cb249-365" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">1043</span>, <span class="dv">587</span>, <span class="dv">1045</span>, <span class="dv">951</span>, <span class="dv">47</span>,</span>
<span id="cb249-366"><a href="#cb249-366" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">1159</span>, <span class="dv">791</span>, <span class="dv">1323</span>, <span class="dv">2046</span>, <span class="dv">52</span>,</span>
<span id="cb249-367"><a href="#cb249-367" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">666</span>, <span class="dv">496</span>, <span class="dv">1031</span>, <span class="dv">1632</span>, <span class="dv">646</span>,</span>
<span id="cb249-368"><a href="#cb249-368" aria-hidden="true" tabindex="-1"></a>                         </span>
<span id="cb249-369"><a href="#cb249-369" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">474</span>, <span class="dv">129</span>, <span class="dv">87</span>, <span class="dv">124</span>, <span class="dv">11</span>,</span>
<span id="cb249-370"><a href="#cb249-370" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">300</span>, <span class="dv">218</span>, <span class="dv">171</span>, <span class="dv">220</span>, <span class="dv">8</span>,</span>
<span id="cb249-371"><a href="#cb249-371" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">438</span>, <span class="dv">254</span>, <span class="dv">669</span>, <span class="dv">703</span>, <span class="dv">16</span>,</span>
<span id="cb249-372"><a href="#cb249-372" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">601</span>, <span class="dv">388</span>, <span class="dv">932</span>, <span class="dv">1789</span>, <span class="dv">37</span>,</span>
<span id="cb249-373"><a href="#cb249-373" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">76</span>, <span class="dv">56</span>, <span class="dv">125</span>, <span class="dv">295</span>, <span class="dv">191</span>,</span>
<span id="cb249-374"><a href="#cb249-374" aria-hidden="true" tabindex="-1"></a>                         </span>
<span id="cb249-375"><a href="#cb249-375" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">127</span>, <span class="dv">101</span>, <span class="dv">24</span>, <span class="dv">30</span>, <span class="dv">12</span>,</span>
<span id="cb249-376"><a href="#cb249-376" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">86</span>, <span class="dv">207</span>, <span class="dv">64</span>, <span class="dv">61</span>, <span class="dv">13</span>,</span>
<span id="cb249-377"><a href="#cb249-377" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">43</span>, <span class="dv">73</span>, <span class="dv">122</span>, <span class="dv">60</span>, <span class="dv">13</span>,</span>
<span id="cb249-378"><a href="#cb249-378" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">35</span>, <span class="dv">51</span>, <span class="dv">62</span>, <span class="dv">66</span>, <span class="dv">11</span>,</span>
<span id="cb249-379"><a href="#cb249-379" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">109</span>, <span class="dv">206</span>, <span class="dv">184</span>, <span class="dv">253</span>, <span class="dv">325</span>)</span>
<span id="cb249-380"><a href="#cb249-380" aria-hidden="true" tabindex="-1"></a>d_yamaguchi <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">O =</span> <span class="fu">gl</span>(<span class="dv">5</span>, <span class="at">k =</span> <span class="dv">5</span>, <span class="at">length =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="dv">5</span> <span class="sc">*</span> <span class="dv">5</span>),</span>
<span id="cb249-381"><a href="#cb249-381" aria-hidden="true" tabindex="-1"></a>                      <span class="at">D =</span> <span class="fu">gl</span>(<span class="dv">5</span>, <span class="at">k =</span> <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="dv">5</span> <span class="sc">*</span> <span class="dv">5</span>),</span>
<span id="cb249-382"><a href="#cb249-382" aria-hidden="true" tabindex="-1"></a>                      <span class="at">C =</span> <span class="fu">gl</span>(<span class="dv">3</span>, <span class="at">k =</span> <span class="dv">5</span> <span class="sc">*</span> <span class="dv">5</span>, <span class="at">length =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="dv">5</span> <span class="sc">*</span> <span class="dv">5</span>),</span>
<span id="cb249-383"><a href="#cb249-383" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Freq =</span> Freq_yamaguchi_1987)</span>
<span id="cb249-384"><a href="#cb249-384" aria-hidden="true" tabindex="-1"></a>d_yamaguchi</span>
<span id="cb249-385"><a href="#cb249-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-386"><a href="#cb249-386" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagonal parameters</span></span>
<span id="cb249-387"><a href="#cb249-387" aria-hidden="true" tabindex="-1"></a>d_yamaguchi <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb249-388"><a href="#cb249-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Diag =</span> <span class="fu">case_when</span>(O <span class="sc">==</span> D <span class="sc">~</span> O, <span class="at">.default =</span> <span class="st">"0"</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>())</span>
<span id="cb249-389"><a href="#cb249-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-390"><a href="#cb249-390" aria-hidden="true" tabindex="-1"></a><span class="co"># Row and column scores</span></span>
<span id="cb249-391"><a href="#cb249-391" aria-hidden="true" tabindex="-1"></a>d_yamaguchi <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb249-392"><a href="#cb249-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">U =</span> <span class="fu">as.numeric</span>(O),</span>
<span id="cb249-393"><a href="#cb249-393" aria-hidden="true" tabindex="-1"></a>         <span class="at">V =</span> <span class="fu">as.numeric</span>(D))</span>
<span id="cb249-394"><a href="#cb249-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-395"><a href="#cb249-395" aria-hidden="true" tabindex="-1"></a><span class="co"># Country dummy</span></span>
<span id="cb249-396"><a href="#cb249-396" aria-hidden="true" tabindex="-1"></a>d_yamaguchi <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb249-397"><a href="#cb249-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">C1 =</span> <span class="fu">case_match</span>(C,</span>
<span id="cb249-398"><a href="#cb249-398" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="st">"2"</span>,<span class="st">"3"</span>) <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb249-399"><a href="#cb249-399" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"1"</span> <span class="sc">~</span> <span class="dv">1</span>),</span>
<span id="cb249-400"><a href="#cb249-400" aria-hidden="true" tabindex="-1"></a>         <span class="at">C2 =</span> <span class="fu">case_match</span>(C,</span>
<span id="cb249-401"><a href="#cb249-401" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"3"</span>) <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb249-402"><a href="#cb249-402" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"2"</span> <span class="sc">~</span> <span class="dv">1</span>),</span>
<span id="cb249-403"><a href="#cb249-403" aria-hidden="true" tabindex="-1"></a>         <span class="at">C3 =</span> <span class="fu">case_match</span>(C,</span>
<span id="cb249-404"><a href="#cb249-404" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>) <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb249-405"><a href="#cb249-405" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"3"</span> <span class="sc">~</span> <span class="dv">1</span>))</span>
<span id="cb249-406"><a href="#cb249-406" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb249-407"><a href="#cb249-407" aria-hidden="true" tabindex="-1"></a><span class="co"># Off diagonal cells (Diag*C)</span></span>
<span id="cb249-408"><a href="#cb249-408" aria-hidden="true" tabindex="-1"></a><span class="co"># No association between R and C, given L</span></span>
<span id="cb249-409"><a href="#cb249-409" aria-hidden="true" tabindex="-1"></a>fit_y_1 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-410"><a href="#cb249-410" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_1)</span>
<span id="cb249-411"><a href="#cb249-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-412"><a href="#cb249-412" aria-hidden="true" tabindex="-1"></a><span class="co"># U0-Cross-nationally homogeneous uniform association</span></span>
<span id="cb249-413"><a href="#cb249-413" aria-hidden="true" tabindex="-1"></a>fit_y_2 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>V, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-414"><a href="#cb249-414" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_2)</span>
<span id="cb249-415"><a href="#cb249-415" aria-hidden="true" tabindex="-1"></a>b_2 <span class="ot">&lt;-</span> fit_y_2<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_2<span class="sc">$</span>coefficients))]</span>
<span id="cb249-416"><a href="#cb249-416" aria-hidden="true" tabindex="-1"></a>b_2</span>
<span id="cb249-417"><a href="#cb249-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-418"><a href="#cb249-418" aria-hidden="true" tabindex="-1"></a><span class="co"># U1-Cross-nationally uniform uniform association</span></span>
<span id="cb249-419"><a href="#cb249-419" aria-hidden="true" tabindex="-1"></a>fit_y_3 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">*</span>C, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-420"><a href="#cb249-420" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_3)</span>
<span id="cb249-421"><a href="#cb249-421" aria-hidden="true" tabindex="-1"></a>b_3 <span class="ot">&lt;-</span> fit_y_3<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_3<span class="sc">$</span>coefficients))]</span>
<span id="cb249-422"><a href="#cb249-422" aria-hidden="true" tabindex="-1"></a>b_3</span>
<span id="cb249-423"><a href="#cb249-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-424"><a href="#cb249-424" aria-hidden="true" tabindex="-1"></a><span class="co"># U2-Cross-nationally uniform uniform association</span></span>
<span id="cb249-425"><a href="#cb249-425" aria-hidden="true" tabindex="-1"></a>fit_y_4 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb249-426"><a href="#cb249-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>V <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-427"><a href="#cb249-427" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_4)</span>
<span id="cb249-428"><a href="#cb249-428" aria-hidden="true" tabindex="-1"></a>b_4 <span class="ot">&lt;-</span> fit_y_4<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_4<span class="sc">$</span>coefficients))]</span>
<span id="cb249-429"><a href="#cb249-429" aria-hidden="true" tabindex="-1"></a>b_4</span>
<span id="cb249-430"><a href="#cb249-430" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb249-431"><a href="#cb249-431" aria-hidden="true" tabindex="-1"></a><span class="co"># R0-Cross-nationally homogeneous row effect association</span></span>
<span id="cb249-432"><a href="#cb249-432" aria-hidden="true" tabindex="-1"></a>fit_y_5 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb249-433"><a href="#cb249-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> O<span class="sc">:</span>V, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-434"><a href="#cb249-434" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_5)</span>
<span id="cb249-435"><a href="#cb249-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-436"><a href="#cb249-436" aria-hidden="true" tabindex="-1"></a><span class="co"># R1-Cross-nationally uniform row effect association</span></span>
<span id="cb249-437"><a href="#cb249-437" aria-hidden="true" tabindex="-1"></a>fit_y_6 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb249-438"><a href="#cb249-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> O<span class="sc">:</span>V <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">*</span>C, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-439"><a href="#cb249-439" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_6)</span>
<span id="cb249-440"><a href="#cb249-440" aria-hidden="true" tabindex="-1"></a>b_6 <span class="ot">&lt;-</span> fit_y_6<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"V:U"</span>, <span class="fu">names</span>(fit_y_6<span class="sc">$</span>coefficients))]</span>
<span id="cb249-441"><a href="#cb249-441" aria-hidden="true" tabindex="-1"></a>b_6</span>
<span id="cb249-442"><a href="#cb249-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-443"><a href="#cb249-443" aria-hidden="true" tabindex="-1"></a><span class="co"># R2-Cross-nationally uniform row effect association</span></span>
<span id="cb249-444"><a href="#cb249-444" aria-hidden="true" tabindex="-1"></a>fit_y_7 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb249-445"><a href="#cb249-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> O<span class="sc">:</span>V <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-446"><a href="#cb249-446" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_7)</span>
<span id="cb249-447"><a href="#cb249-447" aria-hidden="true" tabindex="-1"></a>b_7 <span class="ot">&lt;-</span> fit_y_7<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"V:U"</span>, <span class="fu">names</span>(fit_y_7<span class="sc">$</span>coefficients))]</span>
<span id="cb249-448"><a href="#cb249-448" aria-hidden="true" tabindex="-1"></a>b_7</span>
<span id="cb249-449"><a href="#cb249-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-450"><a href="#cb249-450" aria-hidden="true" tabindex="-1"></a><span class="co"># C0-Cross-nationally homogeneous column effect association</span></span>
<span id="cb249-451"><a href="#cb249-451" aria-hidden="true" tabindex="-1"></a>fit_y_8 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span></span>
<span id="cb249-452"><a href="#cb249-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>D, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-453"><a href="#cb249-453" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_8)</span>
<span id="cb249-454"><a href="#cb249-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-455"><a href="#cb249-455" aria-hidden="true" tabindex="-1"></a><span class="co"># C1-Cross-nationally uniform column effect association</span></span>
<span id="cb249-456"><a href="#cb249-456" aria-hidden="true" tabindex="-1"></a>fit_y_9 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb249-457"><a href="#cb249-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>D <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">*</span>C, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-458"><a href="#cb249-458" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_9)</span>
<span id="cb249-459"><a href="#cb249-459" aria-hidden="true" tabindex="-1"></a>b_9 <span class="ot">&lt;-</span> fit_y_9<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_9<span class="sc">$</span>coefficients))]</span>
<span id="cb249-460"><a href="#cb249-460" aria-hidden="true" tabindex="-1"></a>b_9</span>
<span id="cb249-461"><a href="#cb249-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-462"><a href="#cb249-462" aria-hidden="true" tabindex="-1"></a><span class="co"># C2-Cross-nationally uniform column effect association</span></span>
<span id="cb249-463"><a href="#cb249-463" aria-hidden="true" tabindex="-1"></a>fit_y_10 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb249-464"><a href="#cb249-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>D <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-465"><a href="#cb249-465" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_10)</span>
<span id="cb249-466"><a href="#cb249-466" aria-hidden="true" tabindex="-1"></a>b_10 <span class="ot">&lt;-</span> fit_y_10<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_10<span class="sc">$</span>coefficients))]</span>
<span id="cb249-467"><a href="#cb249-467" aria-hidden="true" tabindex="-1"></a>b_10</span>
<span id="cb249-468"><a href="#cb249-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-469"><a href="#cb249-469" aria-hidden="true" tabindex="-1"></a><span class="co"># H0-Cross-nationally homogeneous homogeneous row &amp; column effect association</span></span>
<span id="cb249-470"><a href="#cb249-470" aria-hidden="true" tabindex="-1"></a>fit_y_11 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb249-471"><a href="#cb249-471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> <span class="fu">MultHomog</span>(O, D), </span>
<span id="cb249-472"><a href="#cb249-472" aria-hidden="true" tabindex="-1"></a>                               <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-473"><a href="#cb249-473" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_11)</span>
<span id="cb249-474"><a href="#cb249-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-475"><a href="#cb249-475" aria-hidden="true" tabindex="-1"></a><span class="co"># H1-Cross-nationally uniform homogeneous row &amp; column effect association</span></span>
<span id="cb249-476"><a href="#cb249-476" aria-hidden="true" tabindex="-1"></a>fit_y_12 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb249-477"><a href="#cb249-477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> <span class="fu">MultHomog</span>(O, D) <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C2 <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, </span>
<span id="cb249-478"><a href="#cb249-478" aria-hidden="true" tabindex="-1"></a>                               <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-479"><a href="#cb249-479" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_12)</span>
<span id="cb249-480"><a href="#cb249-480" aria-hidden="true" tabindex="-1"></a>b_12 <span class="ot">&lt;-</span> fit_y_12<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_12<span class="sc">$</span>coefficients))]</span>
<span id="cb249-481"><a href="#cb249-481" aria-hidden="true" tabindex="-1"></a>b_12</span>
<span id="cb249-482"><a href="#cb249-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-483"><a href="#cb249-483" aria-hidden="true" tabindex="-1"></a><span class="co"># H2-Cross-nationally uniform homogeneous row &amp; column effect association</span></span>
<span id="cb249-484"><a href="#cb249-484" aria-hidden="true" tabindex="-1"></a>fit_y_13 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> <span class="fu">MultHomog</span>(O, D) <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, </span>
<span id="cb249-485"><a href="#cb249-485" aria-hidden="true" tabindex="-1"></a>                               <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-486"><a href="#cb249-486" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_13)</span>
<span id="cb249-487"><a href="#cb249-487" aria-hidden="true" tabindex="-1"></a>b_13 <span class="ot">&lt;-</span> fit_y_13<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_13<span class="sc">$</span>coefficients))]</span>
<span id="cb249-488"><a href="#cb249-488" aria-hidden="true" tabindex="-1"></a>b_13</span>
<span id="cb249-489"><a href="#cb249-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-490"><a href="#cb249-490" aria-hidden="true" tabindex="-1"></a><span class="co"># R+C0 -Cross-nationally uniform row &amp; column effect association</span></span>
<span id="cb249-491"><a href="#cb249-491" aria-hidden="true" tabindex="-1"></a>fit_y_14 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb249-492"><a href="#cb249-492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>D <span class="sc">+</span> O<span class="sc">:</span>V, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-493"><a href="#cb249-493" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_14)</span>
<span id="cb249-494"><a href="#cb249-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-495"><a href="#cb249-495" aria-hidden="true" tabindex="-1"></a><span class="co"># R+C1 -Cross-nationally uniform row &amp; column effect association</span></span>
<span id="cb249-496"><a href="#cb249-496" aria-hidden="true" tabindex="-1"></a>fit_y_15 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb249-497"><a href="#cb249-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>D <span class="sc">+</span> O<span class="sc">:</span>V <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C2 <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-498"><a href="#cb249-498" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_15)</span>
<span id="cb249-499"><a href="#cb249-499" aria-hidden="true" tabindex="-1"></a>b_15 <span class="ot">&lt;-</span> fit_y_15<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_15<span class="sc">$</span>coefficients))]</span>
<span id="cb249-500"><a href="#cb249-500" aria-hidden="true" tabindex="-1"></a>b_15</span>
<span id="cb249-501"><a href="#cb249-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-502"><a href="#cb249-502" aria-hidden="true" tabindex="-1"></a><span class="co"># R+C2-Cross-nationally uniform row &amp; column effect association</span></span>
<span id="cb249-503"><a href="#cb249-503" aria-hidden="true" tabindex="-1"></a>fit_y_16 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb249-504"><a href="#cb249-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>D <span class="sc">+</span> O<span class="sc">:</span>V <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-505"><a href="#cb249-505" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_16)</span>
<span id="cb249-506"><a href="#cb249-506" aria-hidden="true" tabindex="-1"></a>b_16 <span class="ot">&lt;-</span> fit_y_16<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_16<span class="sc">$</span>coefficients))]</span>
<span id="cb249-507"><a href="#cb249-507" aria-hidden="true" tabindex="-1"></a>b_16</span>
<span id="cb249-508"><a href="#cb249-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-509"><a href="#cb249-509" aria-hidden="true" tabindex="-1"></a>d_yamaguchi <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb249-510"><a href="#cb249-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SYM =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>,</span>
<span id="cb249-511"><a href="#cb249-511" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, </span>
<span id="cb249-512"><a href="#cb249-512" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">9</span>,</span>
<span id="cb249-513"><a href="#cb249-513" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">0</span>, <span class="dv">10</span>,</span>
<span id="cb249-514"><a href="#cb249-514" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">0</span>), <span class="dv">3</span>)) <span class="sc">|&gt;</span>  <span class="fu">factor</span>())</span>
<span id="cb249-515"><a href="#cb249-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-516"><a href="#cb249-516" aria-hidden="true" tabindex="-1"></a>d_yamaguchi <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(O, D, C, SYM) <span class="sc">|&gt;</span> <span class="fu">unique</span>()</span>
<span id="cb249-517"><a href="#cb249-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-518"><a href="#cb249-518" aria-hidden="true" tabindex="-1"></a><span class="co"># QS0-Cross-nationally homogeneous quasi-symmetry</span></span>
<span id="cb249-519"><a href="#cb249-519" aria-hidden="true" tabindex="-1"></a>fit_y_17 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb249-520"><a href="#cb249-520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> SYM, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-521"><a href="#cb249-521" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_17)</span>
<span id="cb249-522"><a href="#cb249-522" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_y_17) <span class="sc">|&gt;</span> <span class="fu">print</span>(<span class="at">n =</span> <span class="cn">Inf</span>)</span>
<span id="cb249-523"><a href="#cb249-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-524"><a href="#cb249-524" aria-hidden="true" tabindex="-1"></a><span class="co"># QS1-Cross-nationally uniform quasi-symmetry</span></span>
<span id="cb249-525"><a href="#cb249-525" aria-hidden="true" tabindex="-1"></a>fit_y_18 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb249-526"><a href="#cb249-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> SYM <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C2 <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-527"><a href="#cb249-527" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_18)</span>
<span id="cb249-528"><a href="#cb249-528" aria-hidden="true" tabindex="-1"></a>b_18 <span class="ot">&lt;-</span> fit_y_18<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_18<span class="sc">$</span>coefficients))]</span>
<span id="cb249-529"><a href="#cb249-529" aria-hidden="true" tabindex="-1"></a>b_18</span>
<span id="cb249-530"><a href="#cb249-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-531"><a href="#cb249-531" aria-hidden="true" tabindex="-1"></a><span class="co"># QS2-Cross-nationally uniform quasi-symmetry</span></span>
<span id="cb249-532"><a href="#cb249-532" aria-hidden="true" tabindex="-1"></a>fit_y_19 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb249-533"><a href="#cb249-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> SYM <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-534"><a href="#cb249-534" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_19)</span>
<span id="cb249-535"><a href="#cb249-535" aria-hidden="true" tabindex="-1"></a>b_19 <span class="ot">&lt;-</span> fit_y_19<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_19<span class="sc">$</span>coefficients))]</span>
<span id="cb249-536"><a href="#cb249-536" aria-hidden="true" tabindex="-1"></a>b_19</span>
<span id="cb249-537"><a href="#cb249-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-538"><a href="#cb249-538" aria-hidden="true" tabindex="-1"></a><span class="co"># FI0-Cross-nationallyhomogeneous full two-way interaction</span></span>
<span id="cb249-539"><a href="#cb249-539" aria-hidden="true" tabindex="-1"></a>fit_y_20 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb249-540"><a href="#cb249-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> O<span class="sc">:</span>D, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-541"><a href="#cb249-541" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_20)</span>
<span id="cb249-542"><a href="#cb249-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-543"><a href="#cb249-543" aria-hidden="true" tabindex="-1"></a><span class="co"># FI1-Cross-nationally uniform full two-way interaction</span></span>
<span id="cb249-544"><a href="#cb249-544" aria-hidden="true" tabindex="-1"></a>fit_y_21 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb249-545"><a href="#cb249-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> O<span class="sc">:</span>D <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C2 <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-546"><a href="#cb249-546" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_21)</span>
<span id="cb249-547"><a href="#cb249-547" aria-hidden="true" tabindex="-1"></a>b_21 <span class="ot">&lt;-</span> fit_y_21<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_21<span class="sc">$</span>coefficients))]</span>
<span id="cb249-548"><a href="#cb249-548" aria-hidden="true" tabindex="-1"></a>b_21</span>
<span id="cb249-549"><a href="#cb249-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-550"><a href="#cb249-550" aria-hidden="true" tabindex="-1"></a><span class="co"># FI2-Cross-nationally uniform full two-way interaction</span></span>
<span id="cb249-551"><a href="#cb249-551" aria-hidden="true" tabindex="-1"></a>fit_y_22 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb249-552"><a href="#cb249-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> O<span class="sc">:</span>D <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-553"><a href="#cb249-553" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_22)</span>
<span id="cb249-554"><a href="#cb249-554" aria-hidden="true" tabindex="-1"></a>b_22 <span class="ot">&lt;-</span> fit_y_22<span class="sc">$</span>coefficients[<span class="fu">grep</span>(<span class="st">"U:V"</span>, <span class="fu">names</span>(fit_y_22<span class="sc">$</span>coefficients))]</span>
<span id="cb249-555"><a href="#cb249-555" aria-hidden="true" tabindex="-1"></a>b_22</span>
<span id="cb249-556"><a href="#cb249-556" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb249-557"><a href="#cb249-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-560"><a href="#cb249-560" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb249-561"><a href="#cb249-561" aria-hidden="true" tabindex="-1"></a>Model <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"No association between R and C, given L"</span>,</span>
<span id="cb249-562"><a href="#cb249-562" aria-hidden="true" tabindex="-1"></a>           <span class="st">"U0-Cross-nationally homogeneous uniform association"</span>,</span>
<span id="cb249-563"><a href="#cb249-563" aria-hidden="true" tabindex="-1"></a>           <span class="st">"U1-Cross-nationally uniform uniform association"</span>,</span>
<span id="cb249-564"><a href="#cb249-564" aria-hidden="true" tabindex="-1"></a>           <span class="st">"U2-Cross-nationally uniform uniform association"</span>,</span>
<span id="cb249-565"><a href="#cb249-565" aria-hidden="true" tabindex="-1"></a>           <span class="st">"R0-Cross-nationally homogeneous row effect association"</span>,</span>
<span id="cb249-566"><a href="#cb249-566" aria-hidden="true" tabindex="-1"></a>           <span class="st">"R1-Cross-nationally uniform row effect association"</span>,</span>
<span id="cb249-567"><a href="#cb249-567" aria-hidden="true" tabindex="-1"></a>           <span class="st">"R2-Cross-nationally uniform row effect association"</span>,</span>
<span id="cb249-568"><a href="#cb249-568" aria-hidden="true" tabindex="-1"></a>           <span class="st">"C0-Cross-nationally homogeneous column effect association"</span>,</span>
<span id="cb249-569"><a href="#cb249-569" aria-hidden="true" tabindex="-1"></a>           <span class="st">"C1-Cross-nationally uniform column effect association"</span>,</span>
<span id="cb249-570"><a href="#cb249-570" aria-hidden="true" tabindex="-1"></a>           <span class="st">"C2-Cross-nationally uniform column effect association"</span>,</span>
<span id="cb249-571"><a href="#cb249-571" aria-hidden="true" tabindex="-1"></a>           <span class="st">"H0-Cross-nationally homogeneous homogeneous row &amp; column effect association"</span>,</span>
<span id="cb249-572"><a href="#cb249-572" aria-hidden="true" tabindex="-1"></a>           <span class="st">"H1-Cross-nationally uniform homogeneousrow &amp; column effect association"</span>,</span>
<span id="cb249-573"><a href="#cb249-573" aria-hidden="true" tabindex="-1"></a>           <span class="st">"H2-Cross-nationally uniform homogeneousrow &amp; column effect association"</span>,</span>
<span id="cb249-574"><a href="#cb249-574" aria-hidden="true" tabindex="-1"></a>           <span class="st">"R+C0 -Cross-nationally uniform row &amp; column effect association"</span>,</span>
<span id="cb249-575"><a href="#cb249-575" aria-hidden="true" tabindex="-1"></a>           <span class="st">"R+C1 -Cross-nationally uniform row &amp; column effect association"</span>,</span>
<span id="cb249-576"><a href="#cb249-576" aria-hidden="true" tabindex="-1"></a>           <span class="st">"R+C2-Cross-nationally uniform row &amp; column effect association"</span>,</span>
<span id="cb249-577"><a href="#cb249-577" aria-hidden="true" tabindex="-1"></a>           <span class="st">"QS0-Cross-nationally homogeneous quasi-symmetry"</span>,</span>
<span id="cb249-578"><a href="#cb249-578" aria-hidden="true" tabindex="-1"></a>           <span class="st">"QS1-Cross-nationally uniform quasi-symmetry"</span>,</span>
<span id="cb249-579"><a href="#cb249-579" aria-hidden="true" tabindex="-1"></a>           <span class="st">"QS2-Cross-nationally uniform quasi-symmetry"</span>,</span>
<span id="cb249-580"><a href="#cb249-580" aria-hidden="true" tabindex="-1"></a>           <span class="st">"FI0-Cross-nationallyhomogeneous full two-way interaction"</span>,</span>
<span id="cb249-581"><a href="#cb249-581" aria-hidden="true" tabindex="-1"></a>           <span class="st">"FI1-Cross-nationally uniform full two-way interaction"</span>,</span>
<span id="cb249-582"><a href="#cb249-582" aria-hidden="true" tabindex="-1"></a>           <span class="st">"FI2-Cross-nationally uniform full two-way interaction"</span>)</span>
<span id="cb249-583"><a href="#cb249-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-584"><a href="#cb249-584" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(fit_y_1, fit_y_2, fit_y_3, fit_y_4, fit_y_5, fit_y_6, fit_y_7, fit_y_8, fit_y_9, fit_y_10,</span>
<span id="cb249-585"><a href="#cb249-585" aria-hidden="true" tabindex="-1"></a>     fit_y_11, fit_y_12, fit_y_13, fit_y_14, fit_y_15, fit_y_16, fit_y_17, fit_y_18, fit_y_19,</span>
<span id="cb249-586"><a href="#cb249-586" aria-hidden="true" tabindex="-1"></a>     fit_y_20, fit_y_21, fit_y_22) <span class="sc">|&gt;</span> </span>
<span id="cb249-587"><a href="#cb249-587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(glance) <span class="sc">|&gt;</span> </span>
<span id="cb249-588"><a href="#cb249-588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Model =</span> Model, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb249-589"><a href="#cb249-589" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb249-590"><a href="#cb249-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="cn">Inf</span>)</span>
<span id="cb249-591"><a href="#cb249-591" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb249-592"><a href="#cb249-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-593"><a href="#cb249-593" aria-hidden="true" tabindex="-1"></a>H1とH2が微妙に異なるが誤差の範囲か．また，FI1の$\beta_1$については符号が @yamaguchi1987 のものとは異なっているがこちらが正しいか．</span>
<span id="cb249-594"><a href="#cb249-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-597"><a href="#cb249-597" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb249-598"><a href="#cb249-598" aria-hidden="true" tabindex="-1"></a><span class="co"># R+C2: No uniform difference between any two</span></span>
<span id="cb249-599"><a href="#cb249-599" aria-hidden="true" tabindex="-1"></a>fit_y_23 <span class="ot">&lt;-</span> d_yamaguchi <span class="sc">|&gt;</span> </span>
<span id="cb249-600"><a href="#cb249-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>D <span class="sc">+</span> O<span class="sc">:</span>V <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">:</span>C3, </span>
<span id="cb249-601"><a href="#cb249-601" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-602"><a href="#cb249-602" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_y_23)</span>
<span id="cb249-603"><a href="#cb249-603" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_y_23) <span class="sc">|&gt;</span> <span class="fu">print</span>(<span class="at">n =</span> <span class="cn">Inf</span>)</span>
<span id="cb249-604"><a href="#cb249-604" aria-hidden="true" tabindex="-1"></a><span class="co"># R+C3: Uniform difference between G.B. and U.S.</span></span>
<span id="cb249-605"><a href="#cb249-605" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb249-606"><a href="#cb249-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-607"><a href="#cb249-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-608"><a href="#cb249-608" aria-hidden="true" tabindex="-1"></a><span class="fu">## Xie (1992)</span></span>
<span id="cb249-609"><a href="#cb249-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-610"><a href="#cb249-610" aria-hidden="true" tabindex="-1"></a>@xie1992 の結果を再現する．</span>
<span id="cb249-611"><a href="#cb249-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-612"><a href="#cb249-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-615"><a href="#cb249-615" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb249-616"><a href="#cb249-616" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb249-617"><a href="#cb249-617" aria-hidden="true" tabindex="-1"></a>d_xie <span class="ot">&lt;-</span> d_yamaguchi</span>
<span id="cb249-618"><a href="#cb249-618" aria-hidden="true" tabindex="-1"></a><span class="co"># 確認</span></span>
<span id="cb249-619"><a href="#cb249-619" aria-hidden="true" tabindex="-1"></a>d_xie</span>
<span id="cb249-620"><a href="#cb249-620" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb249-621"><a href="#cb249-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-622"><a href="#cb249-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-623"><a href="#cb249-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-626"><a href="#cb249-626" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb249-627"><a href="#cb249-627" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb249-628"><a href="#cb249-628" aria-hidden="true" tabindex="-1"></a><span class="co"># Off diagonal cells (Diag*C)</span></span>
<span id="cb249-629"><a href="#cb249-629" aria-hidden="true" tabindex="-1"></a><span class="co"># Null association between R and C, given L</span></span>
<span id="cb249-630"><a href="#cb249-630" aria-hidden="true" tabindex="-1"></a>fit_x_1 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-631"><a href="#cb249-631" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_1)</span>
<span id="cb249-632"><a href="#cb249-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-633"><a href="#cb249-633" aria-hidden="true" tabindex="-1"></a><span class="co"># R0 Cross-nationally homogeneous row effect association</span></span>
<span id="cb249-634"><a href="#cb249-634" aria-hidden="true" tabindex="-1"></a>fit_x_2 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> O<span class="sc">:</span>V, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-635"><a href="#cb249-635" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_2)</span>
<span id="cb249-636"><a href="#cb249-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-637"><a href="#cb249-637" aria-hidden="true" tabindex="-1"></a><span class="co"># R1 Cross-nationally uniform row effect association</span></span>
<span id="cb249-638"><a href="#cb249-638" aria-hidden="true" tabindex="-1"></a>fit_x_3 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> O<span class="sc">:</span>V <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">*</span>C, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-639"><a href="#cb249-639" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_3)</span>
<span id="cb249-640"><a href="#cb249-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-641"><a href="#cb249-641" aria-hidden="true" tabindex="-1"></a><span class="co"># Rx Cross-nationally log-multiplicative row effect association</span></span>
<span id="cb249-642"><a href="#cb249-642" aria-hidden="true" tabindex="-1"></a>fit_x_4 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> <span class="fu">Mult</span>(C,O,V), <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-643"><a href="#cb249-643" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_4)</span>
<span id="cb249-644"><a href="#cb249-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-645"><a href="#cb249-645" aria-hidden="true" tabindex="-1"></a><span class="co"># C0-Cross-nationally homogeneous column effect association</span></span>
<span id="cb249-646"><a href="#cb249-646" aria-hidden="true" tabindex="-1"></a>fit_x_5 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>D, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-647"><a href="#cb249-647" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_5)</span>
<span id="cb249-648"><a href="#cb249-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-649"><a href="#cb249-649" aria-hidden="true" tabindex="-1"></a><span class="co"># C1-Cross-nationally uniform column effect association</span></span>
<span id="cb249-650"><a href="#cb249-650" aria-hidden="true" tabindex="-1"></a>fit_x_6 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">glm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> U<span class="sc">:</span>D <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">*</span>C, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-651"><a href="#cb249-651" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_6)</span>
<span id="cb249-652"><a href="#cb249-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-653"><a href="#cb249-653" aria-hidden="true" tabindex="-1"></a><span class="co"># Cx-Cross-nationally log-multiplicative column effect association</span></span>
<span id="cb249-654"><a href="#cb249-654" aria-hidden="true" tabindex="-1"></a>fit_x_7 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> <span class="fu">Mult</span>(C,U,D), <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-655"><a href="#cb249-655" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_7)</span>
<span id="cb249-656"><a href="#cb249-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-657"><a href="#cb249-657" aria-hidden="true" tabindex="-1"></a><span class="co"># (R+C) 0 - Cross-nationally homogeneous row and column effects association I</span></span>
<span id="cb249-658"><a href="#cb249-658" aria-hidden="true" tabindex="-1"></a>fit_x_8 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C  <span class="sc">+</span> O<span class="sc">:</span>V <span class="sc">+</span> U<span class="sc">:</span>D, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-659"><a href="#cb249-659" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_8)</span>
<span id="cb249-660"><a href="#cb249-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-661"><a href="#cb249-661" aria-hidden="true" tabindex="-1"></a><span class="co"># (R+C) u - Cross-nationally uniform row and column effects association I</span></span>
<span id="cb249-662"><a href="#cb249-662" aria-hidden="true" tabindex="-1"></a>fit_x_9 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C  <span class="sc">+</span> O<span class="sc">:</span>V <span class="sc">+</span> U<span class="sc">:</span>D <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">*</span>C, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-663"><a href="#cb249-663" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_9)</span>
<span id="cb249-664"><a href="#cb249-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-665"><a href="#cb249-665" aria-hidden="true" tabindex="-1"></a><span class="co"># (R+C) x - Cross-nationally log-multiplicative row and column effects association I</span></span>
<span id="cb249-666"><a href="#cb249-666" aria-hidden="true" tabindex="-1"></a>fit_x_10 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> <span class="fu">Mult</span>(C,O<span class="sc">:</span>V<span class="sc">+</span>U<span class="sc">:</span>D), <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-667"><a href="#cb249-667" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_10)</span>
<span id="cb249-668"><a href="#cb249-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-669"><a href="#cb249-669" aria-hidden="true" tabindex="-1"></a><span class="co"># RC0 Cross-nationally homogeneous row and column effects association</span></span>
<span id="cb249-670"><a href="#cb249-670" aria-hidden="true" tabindex="-1"></a>fit_x_11 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> <span class="fu">Mult</span>(O,D), <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-671"><a href="#cb249-671" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_11)</span>
<span id="cb249-672"><a href="#cb249-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-673"><a href="#cb249-673" aria-hidden="true" tabindex="-1"></a><span class="co"># RCx Cross-nationally log-multiplicative row and column effects association</span></span>
<span id="cb249-674"><a href="#cb249-674" aria-hidden="true" tabindex="-1"></a>fit_x_12 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> <span class="fu">Mult</span>(<span class="fu">Exp</span>(C),O,D), <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-675"><a href="#cb249-675" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_12)</span>
<span id="cb249-676"><a href="#cb249-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-677"><a href="#cb249-677" aria-hidden="true" tabindex="-1"></a><span class="co"># FI0 Cross-nationally homogeneous full two-way R and C interaction</span></span>
<span id="cb249-678"><a href="#cb249-678" aria-hidden="true" tabindex="-1"></a>fit_x_13 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>,O<span class="sc">*</span>D), <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-679"><a href="#cb249-679" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_13)</span>
<span id="cb249-680"><a href="#cb249-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-681"><a href="#cb249-681" aria-hidden="true" tabindex="-1"></a><span class="co"># FIu Cross-nationally uniform full two-way R and C interaction</span></span>
<span id="cb249-682"><a href="#cb249-682" aria-hidden="true" tabindex="-1"></a>fit_x_14 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>,O<span class="sc">*</span>D) <span class="sc">+</span> U<span class="sc">:</span>V<span class="sc">*</span>C, <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-683"><a href="#cb249-683" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_14)</span>
<span id="cb249-684"><a href="#cb249-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-685"><a href="#cb249-685" aria-hidden="true" tabindex="-1"></a><span class="co"># FIx Cross-nationally log-multiplicative full two-way R and C interaction</span></span>
<span id="cb249-686"><a href="#cb249-686" aria-hidden="true" tabindex="-1"></a>fit_x_15 <span class="ot">&lt;-</span> d_xie <span class="sc">|&gt;</span> <span class="fu">gnm</span>(Freq <span class="sc">~</span> O<span class="sc">*</span>C <span class="sc">+</span> D<span class="sc">*</span>C <span class="sc">+</span> Diag<span class="sc">*</span>C <span class="sc">+</span> <span class="fu">Mult</span>(<span class="fu">Exp</span>(C),O<span class="sc">*</span>D), <span class="at">data =</span> _, <span class="at">family =</span> poisson)</span>
<span id="cb249-687"><a href="#cb249-687" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_x_15)</span>
<span id="cb249-688"><a href="#cb249-688" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb249-689"><a href="#cb249-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-692"><a href="#cb249-692" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb249-693"><a href="#cb249-693" aria-hidden="true" tabindex="-1"></a>Model <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Null association between R and C, given L"</span>,</span>
<span id="cb249-694"><a href="#cb249-694" aria-hidden="true" tabindex="-1"></a>           <span class="st">"R0 Cross-nationally homogeneous row effect association"</span>,</span>
<span id="cb249-695"><a href="#cb249-695" aria-hidden="true" tabindex="-1"></a>           <span class="st">"R1 Cross-nationally uniform row effect association"</span>,</span>
<span id="cb249-696"><a href="#cb249-696" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Rx Cross-nationally log-multiplicative row effect association"</span>,</span>
<span id="cb249-697"><a href="#cb249-697" aria-hidden="true" tabindex="-1"></a>           <span class="st">"C0-Cross-nationally homogeneous column effect association"</span>,</span>
<span id="cb249-698"><a href="#cb249-698" aria-hidden="true" tabindex="-1"></a>           <span class="st">"C1-Cross-nationally uniform column effect association"</span>,</span>
<span id="cb249-699"><a href="#cb249-699" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Cx-Cross-nationally log-multiplicative column effect association"</span>,</span>
<span id="cb249-700"><a href="#cb249-700" aria-hidden="true" tabindex="-1"></a>           <span class="st">"(R+C) 0 - Cross-nationally homogeneous row and column effects association I"</span>,</span>
<span id="cb249-701"><a href="#cb249-701" aria-hidden="true" tabindex="-1"></a>           <span class="st">"(R+C) u - Cross-nationally uniform row and column effects association I"</span>,</span>
<span id="cb249-702"><a href="#cb249-702" aria-hidden="true" tabindex="-1"></a>           <span class="st">"(R+C) x - Cross-nationally log-multiplicative row and column effects association I"</span>,</span>
<span id="cb249-703"><a href="#cb249-703" aria-hidden="true" tabindex="-1"></a>           <span class="st">"RC0 Cross-nationally homogeneous row and column effects association"</span>,</span>
<span id="cb249-704"><a href="#cb249-704" aria-hidden="true" tabindex="-1"></a>           <span class="st">"RCx Cross-nationally log-multiplicative row and column effects association"</span>,</span>
<span id="cb249-705"><a href="#cb249-705" aria-hidden="true" tabindex="-1"></a>           <span class="st">"FI0 Cross-nationally homogeneous full two-way R and C interaction"</span>,</span>
<span id="cb249-706"><a href="#cb249-706" aria-hidden="true" tabindex="-1"></a>           <span class="st">"FIu Cross-nationally uniform full two-way R and C interaction"</span>,</span>
<span id="cb249-707"><a href="#cb249-707" aria-hidden="true" tabindex="-1"></a>           <span class="st">"FIx Cross-nationally log-multiplicative full two-way R and C interaction"</span>)</span>
<span id="cb249-708"><a href="#cb249-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-709"><a href="#cb249-709" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(fit_x_1, fit_x_2, fit_x_3, fit_x_4, fit_x_5, </span>
<span id="cb249-710"><a href="#cb249-710" aria-hidden="true" tabindex="-1"></a>     fit_x_6, fit_x_7, fit_x_8, fit_x_9, fit_x_10,</span>
<span id="cb249-711"><a href="#cb249-711" aria-hidden="true" tabindex="-1"></a>     fit_x_11, fit_x_12, fit_x_13, fit_x_14, fit_x_15) <span class="sc">|&gt;</span> </span>
<span id="cb249-712"><a href="#cb249-712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(glance) <span class="sc">|&gt;</span> </span>
<span id="cb249-713"><a href="#cb249-713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Model =</span> Model, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb249-714"><a href="#cb249-714" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb249-715"><a href="#cb249-715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="cn">Inf</span>)</span>
<span id="cb249-716"><a href="#cb249-716" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb249-717"><a href="#cb249-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-718"><a href="#cb249-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-719"><a href="#cb249-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-720"><a href="#cb249-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-721"><a href="#cb249-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-722"><a href="#cb249-722" aria-hidden="true" tabindex="-1"></a><span class="fu">## 参考文献 {-}</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>