<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.47">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; 第3章 – 『カテゴリカルデータの連関モデル』</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./5-Chapter_4.html" rel="next">
<link href="./3-Chapter_2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./4-Chapter_3.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">第3章</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">『カテゴリカルデータの連関モデル』</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">はじめに</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1-Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">シリーズ編者による内容紹介</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2-Chapter_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">第1章</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3-Chapter_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">第2章</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4-Chapter_3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">第3章</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5-Chapter_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">第4章</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6-Chapter_5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">第5章</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7-Chapter_6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">第6章</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8-degrees_of_freedom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">自由度</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./9-Note.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">補足のノート</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RとRStudioのインストールと基本的な操作方法</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-Replication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">先行研究の再現</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-Review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">研究の動向</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-Crosstabs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">クロス表</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目次</h2>
   
  <ul>
  <li><a href="#表3.1a" id="toc-表3.1a" class="nav-link active" data-scroll-target="#表3.1a"><span class="header-section-number">3.1</span> 表3.1A</a></li>
  <li><a href="#表3.2" id="toc-表3.2" class="nav-link" data-scroll-target="#表3.2"><span class="header-section-number">3.2</span> 表3.2</a></li>
  <li><a href="#表3.3" id="toc-表3.3" class="nav-link" data-scroll-target="#表3.3"><span class="header-section-number">3.3</span> 表3.3</a></li>
  <li><a href="#表3.4" id="toc-表3.4" class="nav-link" data-scroll-target="#表3.4"><span class="header-section-number">3.4</span> 表3.4</a></li>
  <li><a href="#練習問題" id="toc-練習問題" class="nav-link" data-scroll-target="#練習問題">練習問題</a></li>
  <li><a href="#参考文献" id="toc-参考文献" class="nav-link" data-scroll-target="#参考文献">参考文献</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">第3章</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>第3章は3元表に対する部分連関モデルを扱う．パッケージは<code>tidyverse</code>（データセットの処理のため），<code>magrittr</code>（パイプ演算子），<code>DescTools</code>（記述統計を求めるため），<code>vcd</code>パッケージ（カテゴリカルデータの分析のため），<code>broom</code>（回帰係数の整理），<code>gnm</code>（連関分析の処理のため），<code>broom</code>（tidyな回帰分析の結果の表示）を使用する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: パッケージ 'ggplot2' はバージョン 4.5.2 の R の下で造られました</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: パッケージ 'tibble' はバージョン 4.5.2 の R の下で造られました</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: パッケージ 'tidyr' はバージョン 4.5.2 の R の下で造られました</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: パッケージ 'readr' はバージョン 4.5.2 の R の下で造られました</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: パッケージ 'purrr' はバージョン 4.5.2 の R の下で造られました</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gnm)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: パッケージ 'broom' はバージョン 4.5.2 の R の下で造られました</code></pre>
</div>
</div>
<p>またモデル適合度を表示するための関数をここでも準備しておく．すべて<code>gnm</code>によって推定を行う．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 引数となるobjはgnmの結果</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>model.summary <span class="ot">&lt;-</span> <span class="cf">function</span>(obj, <span class="at">Model =</span> <span class="cn">NULL</span>){</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">class</span>(obj) <span class="sc">==</span> <span class="st">"gnm"</span>) <span class="sc">!=</span> <span class="dv">1</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"estimate with gnm"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  aic <span class="ot">&lt;-</span> obj<span class="sc">$</span>deviance <span class="sc">-</span> obj<span class="sc">$</span>df <span class="sc">*</span> <span class="dv">2</span> <span class="co"># AIC(L2)</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  bic <span class="ot">&lt;-</span> obj<span class="sc">$</span>deviance <span class="sc">-</span> obj<span class="sc">$</span>df <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">sum</span>(obj<span class="sc">$</span>y)) <span class="co">#BIC(L2)</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  delta <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">abs</span>(obj<span class="sc">$</span>y <span class="sc">-</span> obj<span class="sc">$</span>fitted.values)) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(obj<span class="sc">$</span>y))</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(obj<span class="sc">$</span>deviance, obj<span class="sc">$</span>df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">7</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(Model)){ </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  Model <span class="ot">&lt;-</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(obj))</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Model Description"</span> <span class="ot">=</span> Model,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"df"</span> <span class="ot">=</span> obj<span class="sc">$</span>df,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"L2"</span> <span class="ot">=</span> obj<span class="sc">$</span>deviance,</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">#"AIC(L2)" = aic,</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"BIC"</span> <span class="ot">=</span> bic,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Delta"</span> <span class="ot">=</span> delta,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"p"</span> <span class="ot">=</span> p</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="表3.1a" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="表3.1a"><span class="header-section-number">3.1</span> 表3.1A</h2>
<p>表3.1Aをまずベクトルとして入力する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 表3.1</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>Freq <span class="ot">&lt;-</span> <span class="fu">c</span>(  <span class="dv">9</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1</span>,    <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">1</span>,    <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>           <span class="dv">17</span>,<span class="dv">13</span>, <span class="dv">7</span>, <span class="dv">4</span>,   <span class="dv">13</span>,<span class="dv">22</span>, <span class="dv">9</span>, <span class="dv">1</span>,    <span class="dv">7</span>,<span class="dv">13</span>, <span class="dv">6</span>, <span class="dv">2</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>            <span class="dv">8</span>,<span class="dv">14</span>, <span class="dv">6</span>, <span class="dv">0</span>,   <span class="dv">10</span>,<span class="dv">29</span>,<span class="dv">10</span>, <span class="dv">0</span>,    <span class="dv">5</span>,<span class="dv">14</span>, <span class="dv">6</span>, <span class="dv">2</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>           <span class="dv">20</span>,<span class="dv">38</span>,<span class="dv">24</span>, <span class="dv">8</span>,   <span class="dv">23</span>,<span class="dv">72</span>,<span class="dv">34</span>,<span class="dv">10</span>,   <span class="dv">17</span>,<span class="dv">67</span>,<span class="dv">36</span>,<span class="dv">12</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>            <span class="dv">4</span>,<span class="dv">21</span>,<span class="dv">12</span>, <span class="dv">4</span>,    <span class="dv">7</span>,<span class="dv">30</span>, <span class="dv">9</span>, <span class="dv">1</span>,    <span class="dv">9</span>,<span class="dv">19</span>,<span class="dv">14</span>, <span class="dv">2</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">3</span>,    <span class="dv">1</span>,<span class="dv">16</span>,<span class="dv">19</span>, <span class="dv">2</span>,   <span class="dv">11</span>,<span class="dv">28</span>,<span class="dv">28</span>,<span class="dv">11</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">0</span>,    <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>,    <span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>次に行変数，列変数，層変数を入力する．<code>gl(n = 水準数, k = 繰り返しの数, length = 長さ)</code>を注意しながら設定する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>polviews <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="at">n =</span> <span class="dv">7</span>, <span class="at">k =</span> <span class="dv">4</span><span class="sc">*</span><span class="dv">3</span>, <span class="at">length =</span> <span class="fu">length</span>(Freq))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>fefam <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="at">n =</span> <span class="dv">4</span>, <span class="at">k =</span> <span class="dv">1</span>, <span class="at">length =</span> <span class="fu">length</span>(Freq))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>natfare <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="at">n =</span> <span class="dv">3</span>, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">length =</span> <span class="fu">length</span>(Freq))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>対応しているのかを確認したければ，matrix形式で示すとよい．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(polviews, <span class="at">nrow =</span> <span class="dv">7</span>, <span class="at">ncol =</span> <span class="dv">12</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
[1,] "1"  "1"  "1"  "1"  "1"  "1"  "1"  "1"  "1"  "1"   "1"   "1"  
[2,] "2"  "2"  "2"  "2"  "2"  "2"  "2"  "2"  "2"  "2"   "2"   "2"  
[3,] "3"  "3"  "3"  "3"  "3"  "3"  "3"  "3"  "3"  "3"   "3"   "3"  
[4,] "4"  "4"  "4"  "4"  "4"  "4"  "4"  "4"  "4"  "4"   "4"   "4"  
[5,] "5"  "5"  "5"  "5"  "5"  "5"  "5"  "5"  "5"  "5"   "5"   "5"  
[6,] "6"  "6"  "6"  "6"  "6"  "6"  "6"  "6"  "6"  "6"   "6"   "6"  
[7,] "7"  "7"  "7"  "7"  "7"  "7"  "7"  "7"  "7"  "7"   "7"   "7"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(fefam, <span class="at">nrow =</span> <span class="dv">7</span>, <span class="at">ncol =</span> <span class="dv">12</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
[1,] "1"  "2"  "3"  "4"  "1"  "2"  "3"  "4"  "1"  "2"   "3"   "4"  
[2,] "1"  "2"  "3"  "4"  "1"  "2"  "3"  "4"  "1"  "2"   "3"   "4"  
[3,] "1"  "2"  "3"  "4"  "1"  "2"  "3"  "4"  "1"  "2"   "3"   "4"  
[4,] "1"  "2"  "3"  "4"  "1"  "2"  "3"  "4"  "1"  "2"   "3"   "4"  
[5,] "1"  "2"  "3"  "4"  "1"  "2"  "3"  "4"  "1"  "2"   "3"   "4"  
[6,] "1"  "2"  "3"  "4"  "1"  "2"  "3"  "4"  "1"  "2"   "3"   "4"  
[7,] "1"  "2"  "3"  "4"  "1"  "2"  "3"  "4"  "1"  "2"   "3"   "4"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(natfare, <span class="at">nrow =</span> <span class="dv">7</span>, <span class="at">ncol =</span> <span class="dv">12</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
[1,] "1"  "1"  "1"  "1"  "2"  "2"  "2"  "2"  "3"  "3"   "3"   "3"  
[2,] "1"  "1"  "1"  "1"  "2"  "2"  "2"  "2"  "3"  "3"   "3"   "3"  
[3,] "1"  "1"  "1"  "1"  "2"  "2"  "2"  "2"  "3"  "3"   "3"   "3"  
[4,] "1"  "1"  "1"  "1"  "2"  "2"  "2"  "2"  "3"  "3"   "3"   "3"  
[5,] "1"  "1"  "1"  "1"  "2"  "2"  "2"  "2"  "3"  "3"   "3"   "3"  
[6,] "1"  "1"  "1"  "1"  "2"  "2"  "2"  "2"  "3"  "3"   "3"   "3"  
[7,] "1"  "1"  "1"  "1"  "2"  "2"  "2"  "2"  "3"  "3"   "3"   "3"  </code></pre>
</div>
</div>
<p>tableのデータ（<code>tab_3.1</code>）とセルを単位としたデータ（<code>freq_tab_3.1</code>）を作成する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">tibble</span>(Freq, polviews, fefam, natfare)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>表3.2のモデルで推定を行う．モデル6から8まではスコアパラメータの正則化が必要であるが，適合度については問題なく求めることができる．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1 - 独立モデル</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2 - 完全2元交互作用モデル</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>M2 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> polviews <span class="sc">*</span> fefam <span class="sc">+</span> fefam <span class="sc">*</span> natfare <span class="sc">+</span> polviews <span class="sc">*</span> natfare,</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3 - 条件付き独立 (polviews)</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>M3 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> polviews <span class="sc">*</span> fefam <span class="sc">+</span> polviews <span class="sc">*</span> natfare,</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 4 - 条件付き独立 (fefam)</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>M4 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> polviews <span class="sc">*</span> fefam <span class="sc">+</span> fefam <span class="sc">*</span> natfare,</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 5 - 条件付き独立 (natfare)</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>M5 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> fefam <span class="sc">*</span> natfare <span class="sc">+</span> polviews <span class="sc">*</span> natfare,</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 6 - RC(1)+RL(1) 部分連関</span></span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a><span class="co"># 値の正則化が必要</span></span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>M6 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="sc">+</span> </span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
...........
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 7 - RC(1)+RL(1) 部分連関 (一貫した行スコア - polviews)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 値の正則化が必要</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>M7 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, fefam <span class="sc">+</span> natfare),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
.....
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 8 - RC(1)+RL(1) 部分連関 (一貫した行スコア - polviews)</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 行スコアへの等値制約</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 値の正則化が必要</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 等値制約をかけたいセルの水準を同じにする</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">polviews.c =</span> <span class="fu">case_when</span>(polviews <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>,  <span class="co"># mu1 = mu2</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>                                polviews <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">1</span>,  <span class="co"># mu1 = mu2</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                                polviews <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>                                polviews <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">3</span>,  <span class="co"># mu4 = mu5</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>                                polviews <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="dv">3</span>,  <span class="co"># mu4 = mu5</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>                                polviews <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>                                polviews <span class="sc">==</span> <span class="dv">7</span> <span class="sc">~</span> <span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>           <span class="fu">factor</span>())</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>M8 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, polviews.c, fefam <span class="sc">+</span> natfare),</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations......................................................
Done</code></pre>
</div>
</div>
<p>モデル間の比較は次のように行う．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3 と Model 2の比較</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="at">q =</span> M3<span class="sc">$</span>deviance <span class="sc">-</span> M2<span class="sc">$</span>deviance,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">df =</span> M3<span class="sc">$</span>df.residual <span class="sc">-</span> M2<span class="sc">$</span>df.residual,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.06425806</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 6 と Model 3の比較</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="at">q =</span> M6<span class="sc">$</span>deviance <span class="sc">-</span> M3<span class="sc">$</span>deviance,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">df =</span> M6<span class="sc">$</span>df.residual <span class="sc">-</span> M3<span class="sc">$</span>df.residual,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1266967</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 13 と Model 8の比較</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Model 13が推定できないため表の値を用いる</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="at">q =</span> <span class="fl">9.22</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">df =</span> <span class="dv">6</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1615782</code></pre>
</div>
</div>
</section>
<section id="表3.2" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="表3.2"><span class="header-section-number">3.2</span> 表3.2</h2>
<p>表3.2を再現する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 表3.2</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># リストを作成</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># モデルの適合度をリストに順に格納</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M1, <span class="st">"1. Complete independence"</span>) </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M2, <span class="st">"2. Full two-way interaction"</span>) </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">3</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M3, <span class="st">"3. Conditional independence on POLVIEWS"</span>) </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">4</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M4, <span class="st">"4. Conditional independence on FEFAM"</span>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">5</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M5, <span class="st">"5. Conditional independence on NATFARE"</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">6</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M6, <span class="st">"6. RC(1) + RL(1) partial association"</span>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">7</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M7, <span class="st">"7. Model 6 plus consisitent row (POLVIEWS) score restrictions"</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">8</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M8, <span class="st">"8. Model 6 plus consisitent and equality restrictions on row (POLVIEWS) scores (mu_1 = mu_2, mu_4 = mu_5)"</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co"># リストを行方向に合併する</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>M <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 6
  `Model Description`                               df    L2   BIC Delta       p
  &lt;chr&gt;                                          &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
1 1. Complete independence                          72 168.  -324. 14.1  1.37e-9
2 2. Full two-way interaction                       36  35.4 -211.  5.72 4.99e-1
3 3. Conditional independence on POLVIEWS           42  47.3 -240.  7.30 2.67e-1
4 4. Conditional independence on FEFAM              48  87.3 -241. 10.3  4.50e-4
5 5. Conditional independence on NATFARE            54  91.0 -278. 10.1  1.21e-3
6 6. RC(1) + RL(1) partial association              57  68.6 -321.  8.83 1.40e-1
7 7. Model 6 plus consisitent row (POLVIEWS) sc…    62  72.8 -351.  9.07 1.65e-1
8 8. Model 6 plus consisitent and equality rest…    64  73.6 -364.  9.21 1.93e-1</code></pre>
</div>
</div>
</section>
<section id="表3.3" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="表3.3"><span class="header-section-number">3.3</span> 表3.3</h2>
<p>表3.3を再現するために，モデル6から8までのスコアパラメータの正則化を行う．</p>
<p>まずはモデル6である．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimating standard error</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 6</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 変数と係数と係数の順番を表示</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(M6, <span class="st">"[.]polviews"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Mult(1, ., fefam).polviews1   Mult(1, ., fefam).polviews2 
                           14                            15 
  Mult(1, ., fefam).polviews3   Mult(1, ., fefam).polviews4 
                           16                            17 
  Mult(1, ., fefam).polviews5   Mult(1, ., fefam).polviews6 
                           18                            19 
  Mult(1, ., fefam).polviews7 Mult(1, ., natfare).polviews1 
                           20                            26 
Mult(1, ., natfare).polviews2 Mult(1, ., natfare).polviews3 
                           27                            28 
Mult(1, ., natfare).polviews4 Mult(1, ., natfare).polviews5 
                           29                            30 
Mult(1, ., natfare).polviews6 Mult(1, ., natfare).polviews7 
                           31                            32 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(M6, <span class="st">"[.]fefam"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mult(1, polviews, .).fefam1 Mult(1, polviews, .).fefam2 
                         21                          22 
Mult(1, polviews, .).fefam3 Mult(1, polviews, .).fefam4 
                         23                          24 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(M6, <span class="st">"[.]natfare"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mult(1, polviews, .).natfare1 Mult(1, polviews, .).natfare2 
                           33                            34 
Mult(1, polviews, .).natfare3 
                           35 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">var =</span> <span class="fu">names</span>(M6<span class="sc">$</span>coefficients),</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">estimate =</span> M6<span class="sc">$</span>coefficients) <span class="sc">|&gt;</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> estimate,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">number =</span> <span class="fu">row_number</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                        var    estimate number
(Intercept)                                     (Intercept)  0.46010322      1
polviews2                                         polviews2  1.09013264      2
polviews3                                         polviews3  1.04474962      3
polviews4                                         polviews4  2.35542345      4
polviews5                                         polviews5  1.34518163      5
polviews6                                         polviews6  1.26357620      6
polviews7                                         polviews7 -0.11962048      7
fefam2                                               fefam2  0.98988339      8
fefam3                                               fefam3  0.45222489      9
fefam4                                               fefam4 -0.84762939     10
natfare2                                           natfare2  0.35773800     11
natfare3                                           natfare3  0.31293034     12
Mult(., polviews, fefam).         Mult(., polviews, fefam). -1.47156193     13
Mult(1, ., fefam).polviews1     Mult(1, ., fefam).polviews1  0.28230412     14
Mult(1, ., fefam).polviews2     Mult(1, ., fefam).polviews2  0.73736080     15
Mult(1, ., fefam).polviews3     Mult(1, ., fefam).polviews3  0.58229215     16
Mult(1, ., fefam).polviews4     Mult(1, ., fefam).polviews4 -0.01739780     17
Mult(1, ., fefam).polviews5     Mult(1, ., fefam).polviews5  0.06724344     18
Mult(1, ., fefam).polviews6     Mult(1, ., fefam).polviews6 -0.75656699     19
Mult(1, ., fefam).polviews7     Mult(1, ., fefam).polviews7 -1.17106785     20
Mult(1, polviews, .).fefam1     Mult(1, polviews, .).fefam1 -0.50620619     21
Mult(1, polviews, .).fefam2     Mult(1, polviews, .).fefam2 -0.11491983     22
Mult(1, polviews, .).fefam3     Mult(1, polviews, .).fefam3  0.28749391     23
Mult(1, polviews, .).fefam4     Mult(1, polviews, .).fefam4  0.53281043     24
Mult(., polviews, natfare).     Mult(., polviews, natfare).  2.67818141     25
Mult(1, ., natfare).polviews1 Mult(1, ., natfare).polviews1  0.98412497     26
Mult(1, ., natfare).polviews2 Mult(1, ., natfare).polviews2  0.48186249     27
Mult(1, ., natfare).polviews3 Mult(1, ., natfare).polviews3  0.30417307     28
Mult(1, ., natfare).polviews4 Mult(1, ., natfare).polviews4 -0.03428097     29
Mult(1, ., natfare).polviews5 Mult(1, ., natfare).polviews5  0.14057164     30
Mult(1, ., natfare).polviews6 Mult(1, ., natfare).polviews6 -0.71317107     31
Mult(1, ., natfare).polviews7 Mult(1, ., natfare).polviews7 -0.71632879     32
Mult(1, polviews, .).natfare1 Mult(1, polviews, .).natfare1  0.25040924     33
Mult(1, polviews, .).natfare2 Mult(1, polviews, .).natfare2  0.08154186     34
Mult(1, polviews, .).natfare3 Mult(1, polviews, .).natfare3 -0.28251342     35</code></pre>
</div>
</div>
<p>各スコアの両端のカテゴリ，つまり上記推定値のリストの 14,20,21,24,26,32,33,35番目の8つの値についてスコアを求め，固定する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R POLVIEWS mu1[i], i = 1 to 7</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(<span class="at">model =</span> M6, </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">set =</span> <span class="fu">pickCoef</span>(M6, <span class="st">"fefam)[.]polviews"</span>),</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># C FEFAM nu[j], j = 1 to 4</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(<span class="at">model =</span> M6, </span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">set =</span> <span class="fu">pickCoef</span>(M6, <span class="st">"[.]fefam"</span>), </span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="co"># R POLVIEWS mu2[i], i = 1 to 7</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(<span class="at">model =</span> M6, </span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">set =</span> <span class="fu">pickCoef</span>(M6, <span class="st">"natfare)[.]polviews"</span>), </span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="co"># L NATFARE eta[k], k = 1 to 3</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(<span class="at">model =</span> M6, </span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">set =</span> <span class="fu">pickCoef</span>(M6, <span class="st">"[.]natfare"</span>), </span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 確認 </span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">mu1 =</span> mu1, <span class="at">nu =</span> nu, <span class="at">mu2 =</span> mu2, <span class="at">eta =</span> eta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$mu1
                               Estimate Std. Error
Mult(1, ., fefam).polviews1  0.18890704 0.17539812
Mult(1, ., fefam).polviews2  0.45611586 0.11238050
Mult(1, ., fefam).polviews3  0.36505971 0.11498236
Mult(1, ., fefam).polviews4  0.01292237 0.08199631
Mult(1, ., fefam).polviews5  0.06262362 0.11058185
Mult(1, ., fefam).polviews6 -0.42111705 0.12367540
Mult(1, ., fefam).polviews7 -0.66451154 0.10976226

$nu
                              Estimate Std. Error
Mult(1, polviews, .).fefam1 -0.7026886 0.06444123
Mult(1, polviews, .).fefam2 -0.2081705 0.09371704
Mult(1, polviews, .).fefam3  0.3004108 0.10956493
Mult(1, polviews, .).fefam4  0.6104483 0.09158453

$mu2
                                 Estimate Std. Error
Mult(1, ., natfare).polviews1  0.60584367 0.12394769
Mult(1, ., natfare).polviews2  0.27518966 0.11469790
Mult(1, ., natfare).polviews3  0.15821154 0.11316687
Mult(1, ., natfare).polviews4 -0.06460260 0.07187236
Mult(1, ., natfare).polviews5  0.05050796 0.10030828
Mult(1, ., natfare).polviews6 -0.51153570 0.10405220
Mult(1, ., natfare).polviews7 -0.51361453 0.12512860

$eta
                                Estimate Std. Error
Mult(1, polviews, .).natfare1  0.6073482 0.07616839
Mult(1, polviews, .).natfare2  0.1689209 0.11149916
Mult(1, polviews, .).natfare3 -0.7762692 0.03533078</code></pre>
</div>
</div>
<p>正則化したスコアを求めることができたので， 各スコアの両端のカテゴリを取り出し，<code>con</code>とする．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)], </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>         nu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>         mu2<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)], </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>         eta<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>con</code>を用いて制約を課す．制約を課す対象となるパラメータは<code>constrain</code>で指定する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>M6_SE <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">14</span>,<span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">26</span>,<span class="dv">32</span>,<span class="dv">33</span>,<span class="dv">35</span>), </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrainTo =</span> con,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> _, </span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> poisson, </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
.........................
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>M6_SE_coef <span class="ot">&lt;-</span> <span class="fu">tidy</span>(M6_SE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `tidy()` method for objects of class `gnm` is not maintained by the broom team, and is only supported through the `glm` tidier method. Please be cautious in interpreting and reporting broom output.

This warning is displayed once per session.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>M6_SE_coef <span class="sc">|&gt;</span> <span class="fu">print</span>(<span class="at">n =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 35 × 5
   term                          estimate std.error statistic   p.value
   &lt;chr&gt;                            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 (Intercept)                     0.491      0.271    1.81    7.07e- 2
 2 polviews2                       1.03       0.229    4.52    6.06e- 6
 3 polviews3                       0.993      0.226    4.39    1.12e- 5
 4 polviews4                       2.33       0.212   11.0     3.35e-28
 5 polviews5                       1.32       0.218    6.08    1.24e- 9
 6 polviews6                       1.26       0.282    4.49    7.13e- 6
 7 polviews7                      -0.0882     0.355   -0.248   8.04e- 1
 8 fefam2                          1.01       0.188    5.40    6.70e- 8
 9 fefam3                          0.498      0.340    1.46    1.43e- 1
10 fefam4                         -0.787      0.449   -1.75    7.96e- 2
11 natfare2                        0.329      0.127    2.60    9.35e- 3
12 natfare3                        0.222      0.314    0.706   4.80e- 1
13 Mult(., polviews, fefam).      -1.98       0.744   -2.66    7.73e- 3
14 Mult(1, ., fefam).polviews1     0.189     NA       NA      NA       
15 Mult(1, ., fefam).polviews2     0.456      0.308    1.48    1.39e- 1
16 Mult(1, ., fefam).polviews3     0.365      0.285    1.28    2.00e- 1
17 Mult(1, ., fefam).polviews4     0.0129     0.184    0.0703  9.44e- 1
18 Mult(1, ., fefam).polviews5     0.0626     0.212    0.296   7.67e- 1
19 Mult(1, ., fefam).polviews6    -0.421      0.205   -2.06    3.98e- 2
20 Mult(1, ., fefam).polviews7    -0.665     NA       NA      NA       
21 Mult(1, polviews, .).fefam1    -0.703     NA       NA      NA       
22 Mult(1, polviews, .).fefam2    -0.208      0.152   -1.37    1.71e- 1
23 Mult(1, polviews, .).fefam3     0.300      0.185    1.62    1.05e- 1
24 Mult(1, polviews, .).fefam4     0.610     NA       NA      NA       
25 Mult(., polviews, natfare).     1.57       0.405    3.87    1.10e- 4
26 Mult(1, ., natfare).polviews1   0.606     NA       NA      NA       
27 Mult(1, ., natfare).polviews2   0.275      0.200    1.38    1.68e- 1
28 Mult(1, ., natfare).polviews3   0.158      0.191    0.828   4.08e- 1
29 Mult(1, ., natfare).polviews4  -0.0646     0.156   -0.414   6.79e- 1
30 Mult(1, ., natfare).polviews5   0.0505     0.177    0.286   7.75e- 1
31 Mult(1, ., natfare).polviews6  -0.512      0.211   -2.43    1.53e- 2
32 Mult(1, ., natfare).polviews7  -0.514     NA       NA      NA       
33 Mult(1, polviews, .).natfare1   0.607     NA       NA      NA       
34 Mult(1, polviews, .).natfare2   0.169      0.175    0.967   3.34e- 1
35 Mult(1, polviews, .).natfare3  -0.776     NA       NA      NA       </code></pre>
</div>
</div>
<p>モデル7は少し難しい．モデル7は一貫した制約を課している．このモデルからまず一貫した<code>polviews</code>について正則化した場合の値を求める．これが求まったら，次は一貫した制約を課していないモデルに，先ほどの正則化したスコアをRCとRLのそれぞれの部分に適用する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 7</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 変数と係数と係数の順番を表示</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(M7, <span class="st">"[.]polviews"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mult(1, ., fefam + natfare).polviews1 Mult(1, ., fefam + natfare).polviews2 
                                   14                                    15 
Mult(1, ., fefam + natfare).polviews3 Mult(1, ., fefam + natfare).polviews4 
                                   16                                    17 
Mult(1, ., fefam + natfare).polviews5 Mult(1, ., fefam + natfare).polviews6 
                                   18                                    19 
Mult(1, ., fefam + natfare).polviews7 
                                   20 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(M7, <span class="st">"[.]fefam"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mult(1, polviews, . + natfare).fefam1 Mult(1, polviews, . + natfare).fefam2 
                                   21                                    22 
Mult(1, polviews, . + natfare).fefam3 Mult(1, polviews, . + natfare).fefam4 
                                   23                                    24 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(M7, <span class="st">"[.]natfare"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mult(1, polviews, fefam + .).natfare2 Mult(1, polviews, fefam + .).natfare3 
                                   25                                    26 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">var =</span> <span class="fu">names</span>(M7<span class="sc">$</span>coefficients),</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">estimate =</span> M7<span class="sc">$</span>coefficients) <span class="sc">|&gt;</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> estimate,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">number =</span> <span class="fu">row_number</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                        var
(Intercept)                                                     (Intercept)
polviews2                                                         polviews2
polviews3                                                         polviews3
polviews4                                                         polviews4
polviews5                                                         polviews5
polviews6                                                         polviews6
polviews7                                                         polviews7
fefam2                                                               fefam2
fefam3                                                               fefam3
fefam4                                                               fefam4
natfare2                                                           natfare2
natfare3                                                           natfare3
Mult(., polviews, fefam + natfare).     Mult(., polviews, fefam + natfare).
Mult(1, ., fefam + natfare).polviews1 Mult(1, ., fefam + natfare).polviews1
Mult(1, ., fefam + natfare).polviews2 Mult(1, ., fefam + natfare).polviews2
Mult(1, ., fefam + natfare).polviews3 Mult(1, ., fefam + natfare).polviews3
Mult(1, ., fefam + natfare).polviews4 Mult(1, ., fefam + natfare).polviews4
Mult(1, ., fefam + natfare).polviews5 Mult(1, ., fefam + natfare).polviews5
Mult(1, ., fefam + natfare).polviews6 Mult(1, ., fefam + natfare).polviews6
Mult(1, ., fefam + natfare).polviews7 Mult(1, ., fefam + natfare).polviews7
Mult(1, polviews, . + natfare).fefam1 Mult(1, polviews, . + natfare).fefam1
Mult(1, polviews, . + natfare).fefam2 Mult(1, polviews, . + natfare).fefam2
Mult(1, polviews, . + natfare).fefam3 Mult(1, polviews, . + natfare).fefam3
Mult(1, polviews, . + natfare).fefam4 Mult(1, polviews, . + natfare).fefam4
Mult(1, polviews, fefam + .).natfare2 Mult(1, polviews, fefam + .).natfare2
Mult(1, polviews, fefam + .).natfare3 Mult(1, polviews, fefam + .).natfare3
                                          estimate number
(Intercept)                            0.619391388      1
polviews2                              1.051606480      2
polviews3                              0.968679920      3
polviews4                              2.162480405      4
polviews5                              1.181476377      5
polviews6                              0.899158984      6
polviews7                             -0.523433211      7
fefam2                                 1.010958942      8
fefam3                                 0.486160006      9
fefam4                                -0.798532019     10
natfare2                               0.358262978     11
natfare3                               0.339591275     12
Mult(., polviews, fefam + natfare).    1.632702912     13
Mult(1, ., fefam + natfare).polviews1 -0.936131507     14
Mult(1, ., fefam + natfare).polviews2 -0.878275753     15
Mult(1, ., fefam + natfare).polviews3 -0.628736024     16
Mult(1, ., fefam + natfare).polviews4  0.004512138     17
Mult(1, ., fefam + natfare).polviews5 -0.172857152     18
Mult(1, ., fefam + natfare).polviews6  1.002117052     19
Mult(1, ., fefam + natfare).polviews7  1.229839262     20
Mult(1, polviews, . + natfare).fefam1 -0.527141882     21
Mult(1, polviews, . + natfare).fefam2 -0.216483395     22
Mult(1, polviews, . + natfare).fefam3  0.048295609     23
Mult(1, polviews, . + natfare).fefam4  0.209787154     24
Mult(1, polviews, fefam + .).natfare2  0.153583418     25
Mult(1, polviews, fefam + .).natfare3  0.563494752     26</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mu[i], i = 1 to 7</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(<span class="at">model =</span> M7, </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">set =</span> <span class="fu">pickCoef</span>(M7, <span class="st">"[.]polviews"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)], </span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>         mu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>ここでは一貫した制約を課さないモデルを用い，制約で一貫したスコアを割り当てる．そして，制約のない列スコアと層スコアを正則化する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>M7_SE <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="sc">+</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">26</span><span class="sc">:</span><span class="dv">32</span>), </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrainTo =</span> con,</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> _, </span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> poisson, </span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations...
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nu[j], j = 1 to 4</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(<span class="at">model =</span> M7_SE, </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">set =</span> <span class="fu">pickCoef</span>(M7_SE, <span class="st">"[.]fefam"</span>), </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co"># eta[k], k = 1 to 3</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(<span class="at">model =</span> M7_SE, </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">set =</span> <span class="fu">pickCoef</span>(M7_SE, <span class="st">"[.]natfare"</span>), </span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)], </span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>         nu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>         mu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)], </span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>         eta<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>最後に一貫したスコア（行）と正則化したスコア（列と層）を用いて再度推定を行う．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>M7_SE <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="sc">+</span> </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">26</span><span class="sc">:</span><span class="dv">32</span>,<span class="dv">33</span>,<span class="dv">35</span>), </span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrainTo =</span> con,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> _, </span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> poisson, </span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">trace =</span> T, </span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Initial Deviance = 150.948379
Running start-up iterations
Start-up iteration 1. Deviance = 74.278626
Start-up iteration 2. Deviance = 72.891662
Running main iterations
Iteration 1. Deviance = 72.773882
Iteration 2. Deviance = 72.773834
Iteration 3. Deviance = 72.773834
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>M7_SE_coef <span class="ot">&lt;-</span> <span class="fu">tidy</span>(M7_SE)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>M7_SE_coef <span class="sc">|&gt;</span> <span class="fu">print</span>(<span class="at">n =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 35 × 5
   term                          estimate std.error statistic   p.value
   &lt;chr&gt;                            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 (Intercept)                     0.497     0.200      2.49   1.28e- 2
 2 polviews2                       1.06      0.184      5.78   7.52e- 9
 3 polviews3                       1.03      0.190      5.42   5.91e- 8
 4 polviews4                       2.34      0.200     11.7    1.01e-31
 5 polviews5                       1.33      0.202      6.59   4.46e-11
 6 polviews6                       1.27      0.287      4.42   9.73e- 6
 7 polviews7                      -0.107     0.338     -0.317  7.51e- 1
 8 fefam2                          0.983     0.0947    10.4    3.01e-25
 9 fefam3                          0.435     0.104      4.19   2.73e- 5
10 fefam4                         -0.864     0.150     -5.77   7.72e- 9
11 natfare2                        0.345     0.0853     4.04   5.28e- 5
12 natfare3                        0.290     0.0869     3.33   8.54e- 4
13 Mult(., polviews, fefam).       1.95      0.374      5.21   1.92e- 7
14 Mult(1, ., fefam).polviews1    -0.413    NA         NA     NA       
15 Mult(1, ., fefam).polviews2    -0.386    NA         NA     NA       
16 Mult(1, ., fefam).polviews3    -0.269    NA         NA     NA       
17 Mult(1, ., fefam).polviews4     0.0275   NA         NA     NA       
18 Mult(1, ., fefam).polviews5    -0.0555   NA         NA     NA       
19 Mult(1, ., fefam).polviews6     0.494    NA         NA     NA       
20 Mult(1, ., fefam).polviews7     0.601    NA         NA     NA       
21 Mult(1, polviews, .).fefam1    -0.726    NA         NA     NA       
22 Mult(1, polviews, .).fefam2    -0.170     0.150     -1.14   2.55e- 1
23 Mult(1, polviews, .).fefam3     0.304     0.189      1.61   1.08e- 1
24 Mult(1, polviews, .).fefam4     0.593    NA         NA     NA       
25 Mult(., polviews, natfare).     1.44      0.226      6.36   2.03e-10
26 Mult(1, ., natfare).polviews1  -0.413    NA         NA     NA       
27 Mult(1, ., natfare).polviews2  -0.386    NA         NA     NA       
28 Mult(1, ., natfare).polviews3  -0.269    NA         NA     NA       
29 Mult(1, ., natfare).polviews4   0.0275   NA         NA     NA       
30 Mult(1, ., natfare).polviews5  -0.0555   NA         NA     NA       
31 Mult(1, ., natfare).polviews6   0.494    NA         NA     NA       
32 Mult(1, ., natfare).polviews7   0.601    NA         NA     NA       
33 Mult(1, polviews, .).natfare1  -0.580    NA         NA     NA       
34 Mult(1, polviews, .).natfare2  -0.207     0.186     -1.12   2.64e- 1
35 Mult(1, polviews, .).natfare3   0.788    NA         NA     NA       </code></pre>
</div>
</div>
<p>モデル8は<code>1,1,2,3,3,4,5</code>という制約があり，結局は<code>1,2,3,4,5</code>の5つのパラメータを推定することになる．しかし，あくまで<code>1,1,2,3,3,4,5</code>という7つのパラメータにウェイトをかける必要がある．そこで<code>c(2,1,2,1,1)/7</code>とすることで，等値制約をかけている部分は平均を2倍にし，<code>c(2,1,2,1,1)</code>とすることでウェイトも2倍にしている．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 8</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mu[i], i = 1 to 7</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(<span class="at">model =</span> M8,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">set =</span> <span class="fu">pickCoef</span>(M8, <span class="st">"[.]polviews.c"</span>),</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ref =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">7</span>,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleRef =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">7</span>,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleWeights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(<span class="at">model =</span> M8,</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">set =</span> <span class="fu">pickCoef</span>(M8, <span class="st">"[.]polviews.c"</span>),</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ref =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">7</span>,</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleRef =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">7</span>,</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleWeights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>mu;mu</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                            Estimate Std. Error
Mult(1, ., fefam + natfare).polviews.c1 -0.402725149 0.04298356
Mult(1, ., fefam + natfare).polviews.c2 -0.278981096 0.08172199
Mult(1, ., fefam + natfare).polviews.c3 -0.001961895 0.04688021
Mult(1, ., fefam + natfare).polviews.c4  0.491602614 0.08428340
Mult(1, ., fefam + natfare).polviews.c5  0.596752569 0.08715205</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                            Estimate Std. Error
Mult(1, ., fefam + natfare).polviews.c1 -0.402725149 0.04298356
Mult(1, ., fefam + natfare).polviews.c2 -0.278981096 0.08172199
Mult(1, ., fefam + natfare).polviews.c3 -0.001961895 0.04688021
Mult(1, ., fefam + natfare).polviews.c4  0.491602614 0.08428340
Mult(1, ., fefam + natfare).polviews.c5  0.596752569 0.08715205</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)], </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>         mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>一貫した行スコア（等値制約あり）を指定して再推定．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>M8 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="sc">+</span> </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">26</span><span class="sc">:</span><span class="dv">32</span>),</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrainTo =</span> con,</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> _, </span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> poisson, </span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations...
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(M8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 35 × 5
   term        estimate std.error statistic   p.value
   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 (Intercept)    0.498   NA          NA    NA       
 2 polviews2      1.05     0.184       5.70  1.20e- 8
 3 polviews3      1.01    NA          NA    NA       
 4 polviews4      2.32    NA          NA    NA       
 5 polviews5      1.32    NA          NA    NA       
 6 polviews6      1.25    NA          NA    NA       
 7 polviews7     -0.132   NA          NA    NA       
 8 fefam2         0.993    0.0956     10.4   2.62e-25
 9 fefam3         0.451    0.104       4.33  1.52e- 5
10 fefam4        -0.840    0.149      -5.64  1.72e- 8
# ℹ 25 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(M8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1            NA      NA  -189.  412.  453.     73.6          67    84</code></pre>
</div>
</div>
<p>次は列スコアと層スコアの正則化をおこなう．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nu[j], j = 1 to 4</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(<span class="at">model =</span> M8, </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">set =</span> <span class="fu">pickCoef</span>(M8, <span class="st">"[.]fefam"</span>), </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="co"># eta[k], k = 1 to 3</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(<span class="at">model =</span> M8, </span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">set =</span> <span class="fu">pickCoef</span>(M8, <span class="st">"[.]natfare"</span>), </span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)], </span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>         nu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>         mu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)], </span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>         eta<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>一貫した行スコア（等値制約あり）のすべて，列スコア（最初と最後），層スコア（最初と最後）を指定して再推定．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>M8_SE <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="sc">+</span> </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">26</span><span class="sc">:</span><span class="dv">32</span>,<span class="dv">33</span>,<span class="dv">35</span>), </span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrainTo =</span> con,</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> _, </span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> poisson, </span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations....
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>M8_SE_coef <span class="ot">&lt;-</span> <span class="fu">tidy</span>(M8_SE)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>M8_SE_coef <span class="sc">|&gt;</span> <span class="fu">print</span>(<span class="at">n =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 35 × 5
   term                          estimate std.error statistic   p.value
   &lt;chr&gt;                            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 (Intercept)                    0.494      0.199      2.49   1.29e- 2
 2 polviews2                      1.05       0.184      5.70   1.20e- 8
 3 polviews3                      1.02       0.189      5.38   7.41e- 8
 4 polviews4                      2.33       0.195     12.0    6.32e-33
 5 polviews5                      1.32       0.207      6.39   1.62e-10
 6 polviews6                      1.25       0.286      4.39   1.12e- 5
 7 polviews7                     -0.123      0.337     -0.366  7.14e- 1
 8 fefam2                         0.993      0.0956    10.4    2.62e-25
 9 fefam3                         0.451      0.104      4.33   1.52e- 5
10 fefam4                        -0.840      0.149     -5.64   1.72e- 8
11 natfare2                       0.346      0.0856     4.04   5.36e- 5
12 natfare3                       0.302      0.0868     3.48   5.01e- 4
13 Mult(., polviews, fefam).      1.94       0.374      5.19   2.16e- 7
14 Mult(1, ., fefam).polviews1   -0.403     NA         NA     NA       
15 Mult(1, ., fefam).polviews2   -0.403     NA         NA     NA       
16 Mult(1, ., fefam).polviews3   -0.279     NA         NA     NA       
17 Mult(1, ., fefam).polviews4   -0.00196   NA         NA     NA       
18 Mult(1, ., fefam).polviews5   -0.00196   NA         NA     NA       
19 Mult(1, ., fefam).polviews6    0.492     NA         NA     NA       
20 Mult(1, ., fefam).polviews7    0.597     NA         NA     NA       
21 Mult(1, polviews, .).fefam1   -0.733     NA         NA     NA       
22 Mult(1, polviews, .).fefam2   -0.162      0.150     -1.08   2.78e- 1
23 Mult(1, polviews, .).fefam3    0.313      0.191      1.64   1.01e- 1
24 Mult(1, polviews, .).fefam4    0.582     NA         NA     NA       
25 Mult(., polviews, natfare).    1.41       0.226      6.25   4.03e-10
26 Mult(1, ., natfare).polviews1 -0.403     NA         NA     NA       
27 Mult(1, ., natfare).polviews2 -0.403     NA         NA     NA       
28 Mult(1, ., natfare).polviews3 -0.279     NA         NA     NA       
29 Mult(1, ., natfare).polviews4 -0.00196   NA         NA     NA       
30 Mult(1, ., natfare).polviews5 -0.00196   NA         NA     NA       
31 Mult(1, ., natfare).polviews6  0.492     NA         NA     NA       
32 Mult(1, ., natfare).polviews7  0.597     NA         NA     NA       
33 Mult(1, polviews, .).natfare1 -0.569     NA         NA     NA       
34 Mult(1, polviews, .).natfare2 -0.222      0.190     -1.17   2.42e- 1
35 Mult(1, polviews, .).natfare3  0.791     NA         NA     NA       </code></pre>
</div>
</div>
<p>すべてのスコアを列方向に合併し，表3.3を再現．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_cols</span>(</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  M6_SE_coef <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(term, <span class="at">Model6 =</span> estimate),</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  M7_SE_coef <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">Model7 =</span> estimate),</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  M8_SE_coef <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">Model8 =</span> estimate)) <span class="sc">|&gt;</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"Mult"</span>, term)) <span class="sc">|&gt;</span> </span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 23 × 4
   term                           Model6  Model7   Model8
   &lt;chr&gt;                           &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
 1 Mult(., polviews, fefam).     -1.98    1.95    1.94   
 2 Mult(1, ., fefam).polviews1    0.189  -0.413  -0.403  
 3 Mult(1, ., fefam).polviews2    0.456  -0.386  -0.403  
 4 Mult(1, ., fefam).polviews3    0.365  -0.269  -0.279  
 5 Mult(1, ., fefam).polviews4    0.0129  0.0275 -0.00196
 6 Mult(1, ., fefam).polviews5    0.0626 -0.0555 -0.00196
 7 Mult(1, ., fefam).polviews6   -0.421   0.494   0.492  
 8 Mult(1, ., fefam).polviews7   -0.665   0.601   0.597  
 9 Mult(1, polviews, .).fefam1   -0.703  -0.726  -0.733  
10 Mult(1, polviews, .).fefam2   -0.208  -0.170  -0.162  
11 Mult(1, polviews, .).fefam3    0.300   0.304   0.313  
12 Mult(1, polviews, .).fefam4    0.610   0.593   0.582  
13 Mult(., polviews, natfare).    1.57    1.44    1.41   
14 Mult(1, ., natfare).polviews1  0.606  -0.413  -0.403  
15 Mult(1, ., natfare).polviews2  0.275  -0.386  -0.403  
16 Mult(1, ., natfare).polviews3  0.158  -0.269  -0.279  
17 Mult(1, ., natfare).polviews4 -0.0646  0.0275 -0.00196
18 Mult(1, ., natfare).polviews5  0.0505 -0.0555 -0.00196
19 Mult(1, ., natfare).polviews6 -0.512   0.494   0.492  
20 Mult(1, ., natfare).polviews7 -0.514   0.601   0.597  
21 Mult(1, polviews, .).natfare1  0.607  -0.580  -0.569  
22 Mult(1, polviews, .).natfare2  0.169  -0.207  -0.222  
23 Mult(1, polviews, .).natfare3 -0.776   0.788   0.791  </code></pre>
</div>
</div>
</section>
<section id="表3.4" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="表3.4"><span class="header-section-number">3.4</span> 表3.4</h2>
<p>表3.4のデータを入力する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 表3.1</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>Freq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">76</span>, <span class="dv">14</span>, <span class="dv">15</span>,  <span class="dv">4</span>,</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>        <span class="dv">32</span>, <span class="dv">17</span>,  <span class="dv">7</span>,  <span class="dv">3</span>,</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>        <span class="dv">64</span>, <span class="dv">23</span>, <span class="dv">28</span>, <span class="dv">15</span>,</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>        <span class="dv">41</span>, <span class="dv">11</span>, <span class="dv">27</span>, <span class="dv">16</span>,</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>        <span class="dv">15</span>,  <span class="dv">2</span>,  <span class="dv">7</span>,  <span class="dv">4</span>,</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>        <span class="dv">27</span>, <span class="dv">20</span>,  <span class="dv">9</span>,  <span class="dv">5</span>,</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>        <span class="dv">57</span>, <span class="dv">31</span>, <span class="dv">24</span>, <span class="dv">15</span>,</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>        <span class="dv">27</span>,  <span class="dv">9</span>, <span class="dv">22</span>, <span class="dv">16</span>,</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>        <span class="dv">13</span>,  <span class="dv">6</span>, <span class="dv">13</span>,  <span class="dv">5</span>,</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>        <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">10</span>,  <span class="dv">6</span>,</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>        <span class="dv">46</span>, <span class="dv">32</span>, <span class="dv">75</span>, <span class="dv">20</span>,</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>        <span class="dv">54</span>, <span class="dv">26</span>, <span class="dv">58</span>, <span class="dv">55</span>,</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>        <span class="dv">7</span>,  <span class="dv">6</span>,  <span class="dv">7</span>,  <span class="dv">6</span>,</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>        <span class="dv">7</span>,  <span class="dv">2</span>,  <span class="dv">3</span>,  <span class="dv">6</span>,</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>        <span class="dv">12</span>, <span class="dv">11</span>, <span class="dv">31</span>, <span class="dv">15</span>,</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>        <span class="dv">52</span>, <span class="dv">36</span>, <span class="dv">80</span>,<span class="dv">101</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>行，列，層のカテゴリを入力し，<code>matrix</code>で確認する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="dv">4</span>, <span class="dv">16</span>, <span class="dv">64</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">64</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">64</span>)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 確認する</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>L <span class="sc">|&gt;</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">16</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2] [,3] [,4]
 [1,] "1"  "1"  "1"  "1" 
 [2,] "1"  "1"  "1"  "1" 
 [3,] "1"  "1"  "1"  "1" 
 [4,] "1"  "1"  "1"  "1" 
 [5,] "2"  "2"  "2"  "2" 
 [6,] "2"  "2"  "2"  "2" 
 [7,] "2"  "2"  "2"  "2" 
 [8,] "2"  "2"  "2"  "2" 
 [9,] "3"  "3"  "3"  "3" 
[10,] "3"  "3"  "3"  "3" 
[11,] "3"  "3"  "3"  "3" 
[12,] "3"  "3"  "3"  "3" 
[13,] "4"  "4"  "4"  "4" 
[14,] "4"  "4"  "4"  "4" 
[15,] "4"  "4"  "4"  "4" 
[16,] "4"  "4"  "4"  "4" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>R <span class="sc">|&gt;</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">16</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2] [,3] [,4]
 [1,] "1"  "1"  "1"  "1" 
 [2,] "2"  "2"  "2"  "2" 
 [3,] "3"  "3"  "3"  "3" 
 [4,] "4"  "4"  "4"  "4" 
 [5,] "1"  "1"  "1"  "1" 
 [6,] "2"  "2"  "2"  "2" 
 [7,] "3"  "3"  "3"  "3" 
 [8,] "4"  "4"  "4"  "4" 
 [9,] "1"  "1"  "1"  "1" 
[10,] "2"  "2"  "2"  "2" 
[11,] "3"  "3"  "3"  "3" 
[12,] "4"  "4"  "4"  "4" 
[13,] "1"  "1"  "1"  "1" 
[14,] "2"  "2"  "2"  "2" 
[15,] "3"  "3"  "3"  "3" 
[16,] "4"  "4"  "4"  "4" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>C <span class="sc">|&gt;</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">16</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2] [,3] [,4]
 [1,] "1"  "2"  "3"  "4" 
 [2,] "1"  "2"  "3"  "4" 
 [3,] "1"  "2"  "3"  "4" 
 [4,] "1"  "2"  "3"  "4" 
 [5,] "1"  "2"  "3"  "4" 
 [6,] "1"  "2"  "3"  "4" 
 [7,] "1"  "2"  "3"  "4" 
 [8,] "1"  "2"  "3"  "4" 
 [9,] "1"  "2"  "3"  "4" 
[10,] "1"  "2"  "3"  "4" 
[11,] "1"  "2"  "3"  "4" 
[12,] "1"  "2"  "3"  "4" 
[13,] "1"  "2"  "3"  "4" 
[14,] "1"  "2"  "3"  "4" 
[15,] "1"  "2"  "3"  "4" 
[16,] "1"  "2"  "3"  "4" </code></pre>
</div>
</div>
<p>以上を<code>tibble</code>でまとめ，データを作成する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">tibble</span>(Freq, L, R, C) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(L, R, C)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 64 × 4
    Freq L     R     C    
   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;
 1    76 1     1     1    
 2    14 1     1     2    
 3    15 1     1     3    
 4     4 1     1     4    
 5    32 1     2     1    
 6    17 1     2     2    
 7     7 1     2     3    
 8     3 1     2     4    
 9    64 1     3     1    
10    23 1     3     2    
# ℹ 54 more rows</code></pre>
</div>
</div>
<p>行，列，層について整数スコアを作成する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Rscore =</span> <span class="fu">as.numeric</span>(R),</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">Cscore =</span> <span class="fu">as.numeric</span>(C),</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Lscore =</span> <span class="fu">as.numeric</span>(L))</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 64 × 7
    Freq L     R     C     Rscore Cscore Lscore
   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1    76 1     1     1          1      1      1
 2    14 1     1     2          1      2      1
 3    15 1     1     3          1      3      1
 4     4 1     1     4          1      4      1
 5    32 1     2     1          2      1      1
 6    17 1     2     2          2      2      1
 7     7 1     2     3          2      3      1
 8     3 1     2     4          2      4      1
 9    64 1     3     1          3      1      1
10    23 1     3     2          3      2      1
# ℹ 54 more rows</code></pre>
</div>
</div>
<p>それではモデル1から15までを用いた推定を行う．ただし<code>gnm</code>ではモデル3と5の推定はできない． また</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1 - Complete Independence</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L,</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2 - Unrestricted RC(1)+RL(1)+CL(1)</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
................................
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3 - Restricted RC(1)+RL(1)+CL(1) with consistent score</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co"># It may not be fitted with gnm package!</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 4 - Model 2 with consistent cells fitted exactly</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">consistent.cells =</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>((R <span class="sc">==</span> C) <span class="sc">&amp;</span> (C <span class="sc">==</span> L), R, <span class="dv">0</span>)))</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>model4 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> consistent.cells <span class="sc">+</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations......................................
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 5 - Model 3 with consistent cells fitted exactly</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="co"># It may not be fitted with gnm package!</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 6 - Full Two-way interaction</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>model6 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">*</span> C <span class="sc">+</span> R <span class="sc">*</span> L <span class="sc">+</span> C <span class="sc">*</span> L,</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R * C + R * L + C * L, family = poisson, 
    data = freq_tab_3.1, tolerance = 1e-12, trace = F)

Deviance Residuals: 
      Min         1Q     Median         3Q        Max  
-1.685582  -0.504109  -0.008581   0.460359   1.299438  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  4.26029    0.11066  38.499  &lt; 2e-16 ***
R2          -0.79606    0.18519  -4.299 1.72e-05 ***
R3          -0.09579    0.14996  -0.639  0.52299    
R4          -0.43476    0.16083  -2.703  0.00687 ** 
C2          -1.63953    0.22829  -7.182 6.89e-13 ***
C3          -1.39351    0.20261  -6.878 6.08e-12 ***
C4          -2.33707    0.28019  -8.341  &lt; 2e-16 ***
R2:C2        0.90120    0.28232   3.192  0.00141 ** 
R3:C2        0.63274    0.25192   2.512  0.01202 *  
R4:C2        0.33707    0.26138   1.290  0.19719    
R2:C3       -0.06534    0.29098  -0.225  0.82232    
R3:C3        0.66917    0.22004   3.041  0.00236 ** 
R4:C3        0.60286    0.22215   2.714  0.00665 ** 
R2:C4        0.34284    0.36220   0.947  0.34388    
R3:C4        0.56412    0.29673   1.901  0.05729 .  
R4:C4        1.27643    0.28261   4.517 6.29e-06 ***
L2          -1.48502    0.22186  -6.694 2.18e-11 ***
L3          -1.52970    0.20833  -7.343 2.10e-13 ***
L4          -2.08728    0.24553  -8.501  &lt; 2e-16 ***
R2:L2        1.34634    0.28170   4.779 1.76e-06 ***
R3:L2        1.28703    0.24739   5.203 1.97e-07 ***
R4:L2        1.03853    0.26517   3.916 8.99e-05 ***
R2:L3        0.67005    0.28444   2.356  0.01849 *  
R3:L3        1.21742    0.22757   5.350 8.81e-08 ***
R4:L3        1.59671    0.23321   6.847 7.56e-12 ***
R2:L4        0.17240    0.35528   0.485  0.62750    
R3:L4        0.61348    0.27149   2.260  0.02384 *  
R4:L4        2.16906    0.25643   8.459  &lt; 2e-16 ***
C2:L2        0.35033    0.21463   1.632  0.10263    
C3:L2        0.22827    0.20862   1.094  0.27389    
C4:L2        0.49174    0.25839   1.903  0.05703 .  
C2:L3        0.65539    0.20819   3.148  0.00164 ** 
C3:L3        1.09826    0.18400   5.969 2.39e-09 ***
C4:L3        1.11150    0.23123   4.807 1.53e-06 ***
C2:L4        0.87747    0.23892   3.673  0.00024 ***
C3:L4        1.29956    0.20753   6.262 3.80e-10 ***
C4:L4        1.79692    0.23862   7.530 5.06e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Residual deviance: 28.998 on 27 degrees of freedom
AIC: 397.32

Number of iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 7 - Model 6 with consistent cells fitted exactly</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>model7 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">*</span> C <span class="sc">+</span> R <span class="sc">*</span> L <span class="sc">+</span> C <span class="sc">*</span> L <span class="sc">+</span> consistent.cells,</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R * C + R * L + C * L + consistent.cells, 
    family = poisson, data = freq_tab_3.1, tolerance = 1e-12,     trace = F)

Deviance Residuals: 
       Min          1Q      Median          3Q         Max  
-1.505e+00  -4.123e-01  -1.490e-08   3.008e-01   1.562e+00  

Coefficients:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        3.70806    0.31642  11.719  &lt; 2e-16 ***
R2                -0.26471    0.33752  -0.784 0.432870    
R3                 0.43595    0.31473   1.385 0.166007    
R4                 0.04506    0.31538   0.143 0.886401    
C2                -1.23787    0.31573  -3.921 8.83e-05 ***
C3                -0.95472    0.29544  -3.232 0.001231 ** 
C4                -2.00687    0.35086  -5.720 1.07e-08 ***
R2:C2              0.49806    0.36012   1.383 0.166653    
R3:C2              0.33263    0.30439   1.093 0.274482    
R4:C2              0.02956    0.30915   0.096 0.923826    
R2:C3             -0.37252    0.33538  -1.111 0.266684    
R3:C3              0.21202    0.29412   0.721 0.470997    
R4:C3              0.33724    0.27290   1.236 0.216553    
R2:C4              0.06257    0.39636   0.158 0.874574    
R3:C4              0.29993    0.33550   0.894 0.371334    
R4:C4              1.06332    0.33951   3.132 0.001737 ** 
L2                -1.05809    0.31923  -3.314 0.000918 ***
L3                -1.09080    0.29894  -3.649 0.000263 ***
L4                -1.74115    0.32163  -5.413 6.18e-08 ***
R2:L2              0.91597    0.36361   2.519 0.011766 *  
R3:L2              0.93125    0.31450   2.961 0.003066 ** 
R4:L2              0.67771    0.32813   2.065 0.038888 *  
R2:L3              0.33649    0.33467   1.005 0.314694    
R3:L3              0.75119    0.30376   2.473 0.013399 *  
R4:L3              1.28290    0.29072   4.413 1.02e-05 ***
R2:L4             -0.12414    0.39162  -0.317 0.751243    
R3:L4              0.33826    0.31651   1.069 0.285199    
R4:L4              1.91005    0.31369   6.089 1.14e-09 ***
C2:L2              0.17440    0.24791   0.704 0.481744    
C3:L2              0.12343    0.21731   0.568 0.570049    
C4:L2              0.38519    0.26377   1.460 0.144196    
C2:L3              0.54622    0.21620   2.526 0.011522 *  
C3:L3              0.78217    0.22762   3.436 0.000590 ***
C4:L3              0.98203    0.23833   4.120 3.78e-05 ***
C2:L4              0.75925    0.24670   3.078 0.002087 ** 
C3:L4              1.14125    0.21839   5.226 1.73e-07 ***
C4:L4              1.79914    0.31902   5.640 1.70e-08 ***
consistent.cells1  0.62268    0.33657   1.850 0.064303 .  
consistent.cells2  0.25993    0.39723   0.654 0.512891    
consistent.cells3  0.47364    0.26552   1.784 0.074458 .  
consistent.cells4 -0.16248    0.31471  -0.516 0.605666    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Residual deviance: 21.934 on 23 degrees of freedom
AIC: 398.25

Number of iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 8 - Unrestricted uniform and log-multiplicative association in all partial</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co"># association</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>model8 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>      Cscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
..............................
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + 
    Rscore:Lscore + Mult(1, R, L) + Cscore:Lscore + Mult(1, C, 
    L), family = poisson, data = freq_tab_3.1, tolerance = 1e-12,     trace = F)


Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.64348  -0.68031  -0.02712   0.48954   2.01814  

Coefficients:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.592663         NA      NA       NA    
R2               -0.981935         NA      NA       NA    
R3               -0.765424         NA      NA       NA    
R4               -1.589113         NA      NA       NA    
C2               -1.620726         NA      NA       NA    
C3               -2.070109         NA      NA       NA    
C4               -3.426309         NA      NA       NA    
L2               -1.465310         NA      NA       NA    
L3               -2.234413         NA      NA       NA    
L4               -3.812290         NA      NA       NA    
Rscore:Cscore     0.129644   0.027279   4.752 2.01e-06 ***
Mult(., R, C).    2.562692         NA      NA       NA    
Mult(1, ., C).R1  0.144409         NA      NA       NA    
Mult(1, ., C).R2 -0.355246         NA      NA       NA    
Mult(1, ., C).R3 -0.164196         NA      NA       NA    
Mult(1, ., C).R4  0.185745         NA      NA       NA    
Mult(1, R, .).C1  0.116240         NA      NA       NA    
Mult(1, R, .).C2 -0.423041         NA      NA       NA    
Mult(1, R, .).C3  0.007321         NA      NA       NA    
Mult(1, R, .).C4  0.400198         NA      NA       NA    
Rscore:Lscore     0.254496   0.028029   9.080  &lt; 2e-16 ***
Mult(., R, L).   -1.623359         NA      NA       NA    
Mult(1, ., L).R1  1.047094         NA      NA       NA    
Mult(1, ., L).R2 -1.047744         NA      NA       NA    
Mult(1, ., L).R3 -0.821710         NA      NA       NA    
Mult(1, ., L).R4  0.632637         NA      NA       NA    
Mult(1, R, .).L1 -0.009934         NA      NA       NA    
Mult(1, R, .).L2  0.265284         NA      NA       NA    
Mult(1, R, .).L3  0.061598         NA      NA       NA    
Mult(1, R, .).L4 -0.279109         NA      NA       NA    
Cscore:Lscore     0.201725   0.025855   7.802  &lt; 2e-16 ***
Mult(., C, L).   -0.530978         NA      NA       NA    
Mult(1, ., L).C1  0.419608         NA      NA       NA    
Mult(1, ., L).C2 -0.029390         NA      NA       NA    
Mult(1, ., L).C3 -1.255163         NA      NA       NA    
Mult(1, ., L).C4  0.517234         NA      NA       NA    
Mult(1, C, .).L1 -0.042242         NA      NA       NA    
Mult(1, C, .).L2 -0.219371         NA      NA       NA    
Mult(1, C, .).L3  0.306531         NA      NA       NA    
Mult(1, C, .).L4 -0.013210         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 45.854 on 36 degrees of freedom
AIC: 396.17

Number of iterations: 87</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(model8, <span class="st">"[.]R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mult(1, ., C).R1 Mult(1, ., C).R2 Mult(1, ., C).R3 Mult(1, ., C).R4 
              13               14               15               16 
Mult(1, ., L).R1 Mult(1, ., L).R2 Mult(1, ., L).R3 Mult(1, ., L).R4 
              23               24               25               26 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(model8, <span class="st">"[.]C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mult(1, R, .).C1 Mult(1, R, .).C2 Mult(1, R, .).C3 Mult(1, R, .).C4 
              17               18               19               20 
Mult(1, ., L).C1 Mult(1, ., L).C2 Mult(1, ., L).C3 Mult(1, ., L).C4 
              33               34               35               36 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(model8, <span class="st">"[.]L"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mult(1, R, .).L1 Mult(1, R, .).L2 Mult(1, R, .).L3 Mult(1, R, .).L4 
              27               28               29               30 
Mult(1, C, .).L1 Mult(1, C, .).L2 Mult(1, C, .).L3 Mult(1, C, .).L4 
              37               38               39               40 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">var =</span> <span class="fu">names</span>(model8<span class="sc">$</span>coefficients),</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">estimate =</span> model8<span class="sc">$</span>coefficients) <span class="sc">|&gt;</span> </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> estimate,</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">number =</span> <span class="fu">row_number</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                              var     estimate number
(Intercept)           (Intercept)  3.592662928      1
R2                             R2 -0.981935107      2
R3                             R3 -0.765423812      3
R4                             R4 -1.589113014      4
C2                             C2 -1.620725741      5
C3                             C3 -2.070108936      6
C4                             C4 -3.426308772      7
L2                             L2 -1.465310089      8
L3                             L3 -2.234413381      9
L4                             L4 -3.812290182     10
Rscore:Cscore       Rscore:Cscore  0.129643997     11
Mult(., R, C).     Mult(., R, C).  2.562691814     12
Mult(1, ., C).R1 Mult(1, ., C).R1  0.144408804     13
Mult(1, ., C).R2 Mult(1, ., C).R2 -0.355246345     14
Mult(1, ., C).R3 Mult(1, ., C).R3 -0.164196344     15
Mult(1, ., C).R4 Mult(1, ., C).R4  0.185744597     16
Mult(1, R, .).C1 Mult(1, R, .).C1  0.116240175     17
Mult(1, R, .).C2 Mult(1, R, .).C2 -0.423040869     18
Mult(1, R, .).C3 Mult(1, R, .).C3  0.007321316     19
Mult(1, R, .).C4 Mult(1, R, .).C4  0.400198170     20
Rscore:Lscore       Rscore:Lscore  0.254496389     21
Mult(., R, L).     Mult(., R, L). -1.623359494     22
Mult(1, ., L).R1 Mult(1, ., L).R1  1.047094228     23
Mult(1, ., L).R2 Mult(1, ., L).R2 -1.047743753     24
Mult(1, ., L).R3 Mult(1, ., L).R3 -0.821710114     25
Mult(1, ., L).R4 Mult(1, ., L).R4  0.632636882     26
Mult(1, R, .).L1 Mult(1, R, .).L1 -0.009934045     27
Mult(1, R, .).L2 Mult(1, R, .).L2  0.265284240     28
Mult(1, R, .).L3 Mult(1, R, .).L3  0.061598133     29
Mult(1, R, .).L4 Mult(1, R, .).L4 -0.279109012     30
Cscore:Lscore       Cscore:Lscore  0.201724868     31
Mult(., C, L).     Mult(., C, L). -0.530978098     32
Mult(1, ., L).C1 Mult(1, ., L).C1  0.419608381     33
Mult(1, ., L).C2 Mult(1, ., L).C2 -0.029389887     34
Mult(1, ., L).C3 Mult(1, ., L).C3 -1.255162540     35
Mult(1, ., L).C4 Mult(1, ., L).C4  0.517234002     36
Mult(1, C, .).L1 Mult(1, C, .).L1 -0.042241568     37
Mult(1, C, .).L2 Mult(1, C, .).L2 -0.219370907     38
Mult(1, C, .).L3 Mult(1, C, .).L3  0.306531062     39
Mult(1, C, .).L4 Mult(1, C, .).L4 -0.013210257     40</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mu1: 13-16</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  model8,</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model8, <span class="st">"[.]R"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>mu1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Estimate Std. Error
Mult(1, ., C).R1  0.4291986 0.18120993
Mult(1, ., C).R2 -0.6893016 0.09977232
Mult(1, ., C).R3 -0.2616277 0.15931019
Mult(1, ., C).R4  0.5217306 0.15976113</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nu1: 17-20</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>nu1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  model8,</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model8, <span class="st">"[.]C"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>nu1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate Std. Error
Mult(1, R, .).C1  0.15388700 0.15383900
Mult(1, R, .).C2 -0.75746716 0.08227847
Mult(1, R, .).C3 -0.03017965 0.15480459
Mult(1, R, .).C4  0.63375980 0.11651692</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mu2: 23-26</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  model8,</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model8, <span class="st">"[.]R"</span>)[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>mu2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Estimate Std. Error
Mult(1, ., L).R1  0.6061444 0.08512883
Mult(1, ., L).R2 -0.5539702 0.08877502
Mult(1, ., L).R3 -0.4287935 0.09713147
Mult(1, ., L).R4  0.3766193 0.10554742</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># eta1: 27-30</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>eta1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  model8,</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model8, <span class="st">"[.]L"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>eta1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate Std. Error
Mult(1, R, .).L1 -0.04977493 0.08992116
Mult(1, R, .).L2  0.65658058 0.06234704
Mult(1, R, .).L3  0.13381443 0.08765352
Mult(1, R, .).L4 -0.74062008 0.04970264</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nu2: 33-36</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>nu2 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  model8,</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model8, <span class="st">"[.]C"</span>)[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>nu2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate Std. Error
Mult(1, ., L).C1  0.35910324  0.2995712
Mult(1, ., L).C2  0.04079069  0.3606231
Mult(1, ., L).C3 -0.82820782  0.1075525
Mult(1, ., L).C4  0.42831389  0.3177968</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># eta2: 37-40</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>eta2 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  model8,</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model8, <span class="st">"[.]L"</span>)[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>eta2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate Std. Error
Mult(1, C, .).L1 -0.13230141  0.3592002
Mult(1, C, .).L2 -0.59941504  0.2494518
Mult(1, C, .).L3  0.78745843  0.1409196
Mult(1, C, .).L4 -0.05574198  0.3241035</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>         nu1<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>         mu2<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>         eta1<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>         nu2<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>         eta2<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)])</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>model8_se <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span></span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span></span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>      Cscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a><span class="co">#    constrain = c(13,16,17,20,23,26,27,30,33,36,37,40),</span></span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a><span class="co">#    constrainTo = con,</span></span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-15</span></span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
................................................................................
................................................................................
................................................................................
................................................................................
................................................................................
...........................................
Done</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in gnmFit(modelTools = modelTools, y = y, constrain = constrain, : Fitting algorithm has either not converged or converged
to a non-solution of the likelihood equations.
Use exitInfo() for numerical details of last iteration.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model8_se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + 
    Rscore:Lscore + Mult(1, R, L) + Cscore:Lscore + Mult(1, C, 
    L), family = poisson, data = freq_tab_3.1, tolerance = 1e-15,     trace = F)


Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.64348  -0.68031  -0.02712   0.48954   2.01814  

Coefficients:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.590245         NA      NA       NA    
R2               -0.982234         NA      NA       NA    
R3               -0.762118         NA      NA       NA    
R4               -1.585520         NA      NA       NA    
C2               -1.622676         NA      NA       NA    
C3               -2.039930         NA      NA       NA    
C4               -3.422603         NA      NA       NA    
L2               -1.462712         NA      NA       NA    
L3               -2.262274         NA      NA       NA    
L4               -3.804408         NA      NA       NA    
Rscore:Cscore     0.129644   0.027279   4.752 2.01e-06 ***
Mult(., R, C).    1.210212         NA      NA       NA    
Mult(1, ., C).R1  0.305981         NA      NA       NA    
Mult(1, ., C).R2 -0.812193         NA      NA       NA    
Mult(1, ., C).R3 -0.384644         NA      NA       NA    
Mult(1, ., C).R4  0.398486         NA      NA       NA    
Mult(1, R, .).C1  0.100371         NA      NA       NA    
Mult(1, R, .).C2 -0.409912         NA      NA       NA    
Mult(1, R, .).C3 -0.002691         NA      NA       NA    
Mult(1, R, .).C4  0.369060         NA      NA       NA    
Rscore:Lscore     0.254496   0.028029   9.080  &lt; 2e-16 ***
Mult(., R, L).    0.227464         NA      NA       NA    
Mult(1, ., L).R1 -3.420864         NA      NA       NA    
Mult(1, ., L).R2  3.575606         NA      NA       NA    
Mult(1, ., L).R3  2.820685         NA      NA       NA    
Mult(1, ., L).R4 -2.036633         NA      NA       NA    
Mult(1, R, .).L1 -0.029219         NA      NA       NA    
Mult(1, R, .).L2  0.558880         NA      NA       NA    
Mult(1, R, .).L3  0.123634         NA      NA       NA    
Mult(1, R, .).L4 -0.604404         NA      NA       NA    
Cscore:Lscore     0.201725   0.025855   7.802  &lt; 2e-16 ***
Mult(., C, L).    1.055313         NA      NA       NA    
Mult(1, ., L).C1  0.095615         NA      NA       NA    
Mult(1, ., L).C2 -0.055825         NA      NA       NA    
Mult(1, ., L).C3 -0.469258         NA      NA       NA    
Mult(1, ., L).C4  0.128543         NA      NA       NA    
Mult(1, C, .).L1  0.117237         NA      NA       NA    
Mult(1, C, .).L2  0.381472         NA      NA       NA    
Mult(1, C, .).L3 -0.403050         NA      NA       NA    
Mult(1, C, .).L4  0.073929         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 45.854 on 36 degrees of freedom
AIC: 396.17

Number of iterations: 500</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="at">factor=</span><span class="st">"contr.treatment"</span>,</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ordered=</span><span class="st">"contr.treatment"</span>))</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 9 - Model 8 with consistent row scores</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>model9 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C <span class="sc">+</span> L) <span class="sc">+</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>      Cscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
..........
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C + 
    L) + Rscore:Lscore + Cscore:Lscore + Mult(1, C, L), family = poisson, 
    data = freq_tab_3.1, tolerance = 1e-12, trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.56526  -0.67024  -0.02438   0.54037   1.98333  

Coefficients:
                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)           3.61635         NA      NA       NA    
R2                   -1.05655         NA      NA       NA    
R3                   -0.80889         NA      NA       NA    
R4                   -1.56761         NA      NA       NA    
C2                   -1.61930         NA      NA       NA    
C3                   -2.06222         NA      NA       NA    
C4                   -3.46392         NA      NA       NA    
L2                   -1.43276         NA      NA       NA    
L3                   -2.24839         NA      NA       NA    
L4                   -3.77351         NA      NA       NA    
Rscore:Cscore         0.13353    0.02535   5.266 1.39e-07 ***
Mult(., R, C + L).   -1.23856         NA      NA       NA    
Mult(1, ., C + L).R1 -0.51129         NA      NA       NA    
Mult(1, ., C + L).R2  0.64447         NA      NA       NA    
Mult(1, ., C + L).R3  0.44261         NA      NA       NA    
Mult(1, ., C + L).R4 -0.37342         NA      NA       NA    
Mult(1, R, . + L).C1  0.07525         NA      NA       NA    
Mult(1, R, . + L).C2 -0.40263         NA      NA       NA    
Mult(1, R, . + L).C3 -0.05064         NA      NA       NA    
Mult(1, R, . + L).C4  0.33841         NA      NA       NA    
Mult(1, R, C + .).L2 -0.65288         NA      NA       NA    
Mult(1, R, C + .).L3 -0.16222         NA      NA       NA    
Mult(1, R, C + .).L4  0.62976         NA      NA       NA    
Rscore:Lscore         0.24848    0.02722   9.127  &lt; 2e-16 ***
Cscore:Lscore         0.20270    0.02562   7.913  &lt; 2e-16 ***
Mult(., C, L).       -0.51379         NA      NA       NA    
Mult(1, ., L).C1     -0.12267         NA      NA       NA    
Mult(1, ., L).C2      0.16495         NA      NA       NA    
Mult(1, ., L).C3      1.24733         NA      NA       NA    
Mult(1, ., L).C4     -0.21348         NA      NA       NA    
Mult(1, C, .).L1      0.08112         NA      NA       NA    
Mult(1, C, .).L2      0.33301         NA      NA       NA    
Mult(1, C, .).L3     -0.32941         NA      NA       NA    
Mult(1, C, .).L4      0.06922         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 47.134 on 38 degrees of freedom
AIC: 393.45

Number of iterations: 67</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  model9,</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model9, <span class="st">"[.]R"</span>),</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>nu2 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>  model9,</span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model9, <span class="st">"[.]C"</span>)[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a>eta2 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a>  model9,</span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model9, <span class="st">"[.]L"</span>)[<span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>],</span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb135-23"><a href="#cb135-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb135-24"><a href="#cb135-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-25"><a href="#cb135-25" aria-hidden="true" tabindex="-1"></a>model9.extended <span class="ot">&lt;-</span></span>
<span id="cb135-26"><a href="#cb135-26" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> <span class="fu">gnm</span>(</span>
<span id="cb135-27"><a href="#cb135-27" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span></span>
<span id="cb135-28"><a href="#cb135-28" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span></span>
<span id="cb135-29"><a href="#cb135-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb135-30"><a href="#cb135-30" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb135-31"><a href="#cb135-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span></span>
<span id="cb135-32"><a href="#cb135-32" aria-hidden="true" tabindex="-1"></a>      Cscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb135-33"><a href="#cb135-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb135-34"><a href="#cb135-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">23</span><span class="sc">:</span><span class="dv">26</span>),</span>
<span id="cb135-35"><a href="#cb135-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrainTo =</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>]),</span>
<span id="cb135-36"><a href="#cb135-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb135-37"><a href="#cb135-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb135-38"><a href="#cb135-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb135-39"><a href="#cb135-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb135-40"><a href="#cb135-40" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
................................................................................
................................................................................
................................................................................
................................................................................
................................................................................
...........................................
Done</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in gnmFit(modelTools = modelTools, y = y, constrain = constrain, : Fitting algorithm has either not converged or converged
to a non-solution of the likelihood equations.
Use exitInfo() for numerical details of last iteration.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model9.extended)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + 
    Rscore:Lscore + Mult(1, R, L) + Cscore:Lscore + Mult(1, C, 
    L), constrain = c(13:16, 23:26), constrainTo = c(mu$qvframe[, 
    1], mu$qvframe[, 1]), family = poisson, data = freq_tab_3.1, 
    tolerance = 1e-12, trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.73908  -0.72139   0.04454   0.60501   2.94358  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       2.60466         NA      NA       NA    
R2               -2.09777         NA      NA       NA    
R3               -1.66654         NA      NA       NA    
R4               -1.68773         NA      NA       NA    
C2               -3.09013         NA      NA       NA    
C3               -4.86887         NA      NA       NA    
C4               -7.60561         NA      NA       NA    
L2               -2.44308         NA      NA       NA    
L3               -4.39557         NA      NA       NA    
L4               -7.14740         NA      NA       NA    
Rscore:Cscore     0.13276    0.02519   5.271 1.36e-07 ***
Mult(., R, C).    0.26928         NA      NA       NA    
Mult(1, ., C).R1 -0.56136         NA      NA       NA    
Mult(1, ., C).R2  0.59333         NA      NA       NA    
Mult(1, ., C).R3  0.39165         NA      NA       NA    
Mult(1, ., C).R4 -0.42362         NA      NA       NA    
Mult(1, R, .).C1  1.33919         NA      NA       NA    
Mult(1, R, .).C2  3.65451         NA      NA       NA    
Mult(1, R, .).C3  1.98567         NA      NA       NA    
Mult(1, R, .).C4  0.18349         NA      NA       NA    
Rscore:Lscore     0.24865    0.02528   9.835  &lt; 2e-16 ***
Mult(., R, L).   -2.10813         NA      NA       NA    
Mult(1, ., L).R1 -0.56136         NA      NA       NA    
Mult(1, ., L).R2  0.59333         NA      NA       NA    
Mult(1, ., L).R3  0.39165         NA      NA       NA    
Mult(1, ., L).R4 -0.42362         NA      NA       NA    
Mult(1, R, .).L1 -0.21240         NA      NA       NA    
Mult(1, R, .).L2 -0.58693         NA      NA       NA    
Mult(1, R, .).L3 -0.30537         NA      NA       NA    
Mult(1, R, .).L4  0.17050         NA      NA       NA    
Cscore:Lscore     1.79286   88.85495   0.020    0.984    
Mult(., C, L).   12.25954         NA      NA       NA    
Mult(1, ., L).C1  0.11626         NA      NA       NA    
Mult(1, ., L).C2  0.46007         NA      NA       NA    
Mult(1, ., L).C3  0.83002         NA      NA       NA    
Mult(1, ., L).C4  1.20168         NA      NA       NA    
Mult(1, C, .).L1 -0.04510         NA      NA       NA    
Mult(1, C, .).L2 -0.41775         NA      NA       NA    
Mult(1, C, .).L3 -0.76128         NA      NA       NA    
Mult(1, C, .).L4 -1.12100         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 52.686 on 40 degrees of freedom
AIC: 395

Number of iterations: 500</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>nu1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  model9.extended,</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model9.extended, <span class="st">"[.]C"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>eta1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>    model9.extended,</span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pickCoef</span>(model9.extended, <span class="st">"[.]L"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a>model9.phis <span class="ot">&lt;-</span></span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span>  <span class="fu">gnm</span>(</span>
<span id="cb140-19"><a href="#cb140-19" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> </span>
<span id="cb140-20"><a href="#cb140-20" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> </span>
<span id="cb140-21"><a href="#cb140-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb140-22"><a href="#cb140-22" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Lscore <span class="sc">+</span> </span>
<span id="cb140-23"><a href="#cb140-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span> </span>
<span id="cb140-24"><a href="#cb140-24" aria-hidden="true" tabindex="-1"></a>      Cscore<span class="sc">:</span>Lscore <span class="sc">+</span> </span>
<span id="cb140-25"><a href="#cb140-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb140-26"><a href="#cb140-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">23</span><span class="sc">:</span><span class="dv">30</span>, <span class="dv">33</span><span class="sc">:</span><span class="dv">40</span>),</span>
<span id="cb140-27"><a href="#cb140-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrainTo =</span> <span class="fu">c</span>(</span>
<span id="cb140-28"><a href="#cb140-28" aria-hidden="true" tabindex="-1"></a>      mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>],</span>
<span id="cb140-29"><a href="#cb140-29" aria-hidden="true" tabindex="-1"></a>      nu1<span class="sc">$</span>qvframe[, <span class="dv">1</span>],</span>
<span id="cb140-30"><a href="#cb140-30" aria-hidden="true" tabindex="-1"></a>      mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>],</span>
<span id="cb140-31"><a href="#cb140-31" aria-hidden="true" tabindex="-1"></a>      eta1<span class="sc">$</span>qvframe[, <span class="dv">1</span>],</span>
<span id="cb140-32"><a href="#cb140-32" aria-hidden="true" tabindex="-1"></a>      nu2<span class="sc">$</span>qvframe[, <span class="dv">1</span>],</span>
<span id="cb140-33"><a href="#cb140-33" aria-hidden="true" tabindex="-1"></a>      eta2<span class="sc">$</span>qvframe[, <span class="dv">1</span>]</span>
<span id="cb140-34"><a href="#cb140-34" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb140-35"><a href="#cb140-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb140-36"><a href="#cb140-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb140-37"><a href="#cb140-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb140-38"><a href="#cb140-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb140-39"><a href="#cb140-39" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running main iterations.
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model9.phis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + 
    Rscore:Lscore + Mult(1, R, L) + Cscore:Lscore + Mult(1, C, 
    L), constrain = c(13:20, 23:30, 33:40), constrainTo = c(mu$qvframe[, 
    1], nu1$qvframe[, 1], mu$qvframe[, 1], eta1$qvframe[, 1], 
    nu2$qvframe[, 1], eta2$qvframe[, 1]), family = poisson, data = freq_tab_3.1, 
    tolerance = 1e-12, trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.53980  -0.68809  -0.03479   0.52482   1.98459  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.56901    0.08141  43.841  &lt; 2e-16 ***
R2               -0.97605    0.11885  -8.213  &lt; 2e-16 ***
R3               -0.74339    0.14809  -5.020 5.17e-07 ***
R4               -1.56010    0.22173  -7.036 1.98e-12 ***
C2               -1.59740    0.10582 -15.095  &lt; 2e-16 ***
C3               -2.08605    0.17244 -12.097  &lt; 2e-16 ***
C4               -3.48425    0.26854 -12.975  &lt; 2e-16 ***
L2               -1.42497    0.10731 -13.279  &lt; 2e-16 ***
L3               -2.18103    0.17781 -12.266  &lt; 2e-16 ***
L4               -3.81359    0.27925 -13.656  &lt; 2e-16 ***
Rscore:Cscore     0.13413    0.02487   5.394 6.87e-08 ***
Mult(., R, C).    0.65590    0.13917   4.713 2.44e-06 ***
Mult(1, ., C).R1 -0.56136         NA      NA       NA    
Mult(1, ., C).R2  0.59333         NA      NA       NA    
Mult(1, ., C).R3  0.39165         NA      NA       NA    
Mult(1, ., C).R4 -0.42362         NA      NA       NA    
Mult(1, R, .).C1 -0.17991         NA      NA       NA    
Mult(1, R, .).C2  0.74263         NA      NA       NA    
Mult(1, R, .).C3  0.07768         NA      NA       NA    
Mult(1, R, .).C4 -0.64040         NA      NA       NA    
Rscore:Lscore     0.24822    0.02515   9.870  &lt; 2e-16 ***
Mult(., R, L).   -1.13998    0.13986  -8.151  &lt; 2e-16 ***
Mult(1, ., L).R1 -0.56136         NA      NA       NA    
Mult(1, ., L).R2  0.59333         NA      NA       NA    
Mult(1, ., L).R3  0.39165         NA      NA       NA    
Mult(1, ., L).R4 -0.42362         NA      NA       NA    
Mult(1, R, .).L1  0.03903         NA      NA       NA    
Mult(1, R, .).L2 -0.65202         NA      NA       NA    
Mult(1, R, .).L3 -0.13252         NA      NA       NA    
Mult(1, R, .).L4  0.74551         NA      NA       NA    
Cscore:Lscore     0.20298    0.02315   8.768  &lt; 2e-16 ***
Mult(., C, L).   -0.28325    0.10067  -2.814   0.0049 ** 
Mult(1, ., L).C1 -0.33661         NA      NA       NA    
Mult(1, ., L).C2 -0.08944         NA      NA       NA    
Mult(1, ., L).C3  0.84069         NA      NA       NA    
Mult(1, ., L).C4 -0.41464         NA      NA       NA    
Mult(1, C, .).L1  0.08991         NA      NA       NA    
Mult(1, C, .).L2  0.62111         NA      NA       NA    
Mult(1, C, .).L3 -0.77584         NA      NA       NA    
Mult(1, C, .).L4  0.06482         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 47.177 on 48 degrees of freedom
AIC: 373.49

Number of iterations: 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>mu</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       Estimate Std. Error
Mult(1, ., C + L).R1 -0.5613577 0.07946201
Mult(1, ., C + L).R2  0.5933253 0.06976100
Mult(1, ., C + L).R3  0.3916506 0.08375491
Mult(1, ., C + L).R4 -0.4236182 0.08896023</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>nu1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate Std. Error
Mult(1, R, .).C1 -0.17990851  0.1459958
Mult(1, R, .).C2  0.74262512  0.0847230
Mult(1, R, .).C3  0.07767921  0.1515079
Mult(1, R, .).C4 -0.64039581  0.1106479</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>eta1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Estimate Std. Error
Mult(1, R, .).L1  0.0390252 0.08987468
Mult(1, R, .).L2 -0.6520183 0.06129568
Mult(1, R, .).L3 -0.1325187 0.08589704
Mult(1, R, .).L4  0.7455119 0.04784101</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>nu2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate Std. Error
Mult(1, ., L).C1 -0.33661004 0.30087703
Mult(1, ., L).C2 -0.08944163 0.36058729
Mult(1, ., L).C3  0.84069369 0.08936905
Mult(1, ., L).C4 -0.41464201 0.32252708</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>eta2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate Std. Error
Mult(1, C, .).L1  0.08990831  0.3610226
Mult(1, C, .).L2  0.62111332  0.2399524
Mult(1, C, .).L3 -0.77584334  0.1519881
Mult(1, C, .).L4  0.06482171  0.3227342</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  `Model Description`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 model9                 38  47.1 -231.  6.25 0.147</code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 10 - Model 8 with consistent col scores</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>model10 <span class="ot">&lt;-</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> <span class="fu">gnm</span>(</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> </span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> </span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, C, R <span class="sc">+</span> L) <span class="sc">+</span></span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Lscore <span class="sc">+</span> </span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span> </span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a>      Cscore<span class="sc">:</span>Lscore,</span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb156-11"><a href="#cb156-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb156-12"><a href="#cb156-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb156-13"><a href="#cb156-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb156-14"><a href="#cb156-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
................................................................................
..
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  `Model Description`    df    L2   BIC Delta      p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 model10                38  50.9 -227.  6.31 0.0788</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 11 - Model 8 with consistent layer scores</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>model11 <span class="ot">&lt;-</span></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> <span class="fu">gnm</span>(</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> </span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> </span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, L, R <span class="sc">+</span> C) <span class="sc">+</span></span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a>      Cscore<span class="sc">:</span>Lscore,</span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb160-12"><a href="#cb160-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb160-13"><a href="#cb160-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb160-14"><a href="#cb160-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
................................
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model11)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  `Model Description`    df    L2   BIC Delta      p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 model11                38  53.6 -225.  6.58 0.0477</code></pre>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 12 - Modek 9 + U(RL)=U(CL)</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="co"># To impose equality constraint on U(RL) &amp; U(CL),</span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="co"># a covariate is created in following manner:</span></span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span><span class="sc">|&gt;</span> </span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cov_rcl =</span> Rscore <span class="sc">*</span> Lscore <span class="sc">+</span> Cscore <span class="sc">*</span> Lscore)</span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>model12 <span class="ot">&lt;-</span></span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> <span class="fu">gnm</span>(</span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> </span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> </span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C <span class="sc">+</span> L) <span class="sc">+</span></span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a>      cov_rcl <span class="sc">+</span> </span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
..........................................
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(model12)</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model12)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  `Model Description`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 model12                39  48.6 -237.  6.57 0.140</code></pre>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>  model12,</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model12, <span class="st">"[.]R"</span>),</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>nu2 <span class="ot">&lt;-</span></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getContrasts</span>(</span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>    model12,</span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pickCoef</span>(model12, <span class="st">"[.]C"</span>)[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb168-16"><a href="#cb168-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb168-17"><a href="#cb168-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-18"><a href="#cb168-18" aria-hidden="true" tabindex="-1"></a>eta2 <span class="ot">&lt;-</span></span>
<span id="cb168-19"><a href="#cb168-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getContrasts</span>(</span>
<span id="cb168-20"><a href="#cb168-20" aria-hidden="true" tabindex="-1"></a>    model12,</span>
<span id="cb168-21"><a href="#cb168-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pickCoef</span>(model12, <span class="st">"[.]L"</span>)[<span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>],</span>
<span id="cb168-22"><a href="#cb168-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb168-23"><a href="#cb168-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb168-24"><a href="#cb168-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb168-25"><a href="#cb168-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb168-26"><a href="#cb168-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-27"><a href="#cb168-27" aria-hidden="true" tabindex="-1"></a>model12.extended <span class="ot">&lt;-</span></span>
<span id="cb168-28"><a href="#cb168-28" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb168-29"><a href="#cb168-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> </span>
<span id="cb168-30"><a href="#cb168-30" aria-hidden="true" tabindex="-1"></a>        Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> </span>
<span id="cb168-31"><a href="#cb168-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb168-32"><a href="#cb168-32" aria-hidden="true" tabindex="-1"></a>        cov_rcl <span class="sc">+</span> </span>
<span id="cb168-33"><a href="#cb168-33" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span> </span>
<span id="cb168-34"><a href="#cb168-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb168-35"><a href="#cb168-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">23</span><span class="sc">:</span><span class="dv">26</span>),</span>
<span id="cb168-36"><a href="#cb168-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrainTo =</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>]),</span>
<span id="cb168-37"><a href="#cb168-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> _,</span>
<span id="cb168-38"><a href="#cb168-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> poisson,</span>
<span id="cb168-39"><a href="#cb168-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb168-40"><a href="#cb168-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb168-41"><a href="#cb168-41" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
...............................................................
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model12.extended)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + 
    cov_rcl + Mult(1, R, L) + Mult(1, C, L), constrain = c(13:16, 
    23:26), constrainTo = c(mu$qvframe[, 1], mu$qvframe[, 1]), 
    family = poisson, data = freq_tab_3.1, tolerance = 1e-12,     trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.58844  -0.76809   0.02278   0.56330   1.92999  

Coefficients:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.592078         NA      NA       NA    
R2               -0.971943         NA      NA       NA    
R3               -0.677204         NA      NA       NA    
R4               -1.396578         NA      NA       NA    
C2               -1.632064         NA      NA       NA    
C3               -2.137030         NA      NA       NA    
C4               -3.659363         NA      NA       NA    
L2               -1.249658         NA      NA       NA    
L3               -2.293707         NA      NA       NA    
L4               -3.719229         NA      NA       NA    
Rscore:Cscore     0.133358   0.025419   5.246 1.55e-07 ***
Mult(., R, C).   -1.154323         NA      NA       NA    
Mult(1, ., C).R1 -0.538271         NA      NA       NA    
Mult(1, ., C).R2  0.597665         NA      NA       NA    
Mult(1, ., C).R3  0.389408         NA      NA       NA    
Mult(1, ., C).R4 -0.448801         NA      NA       NA    
Mult(1, R, .).C1  0.108828         NA      NA       NA    
Mult(1, R, .).C2 -0.402716         NA      NA       NA    
Mult(1, R, .).C3 -0.036312         NA      NA       NA    
Mult(1, R, .).C4  0.363875         NA      NA       NA    
cov_rcl           0.224229   0.017087  13.123  &lt; 2e-16 ***
Mult(., R, L).    2.489807         NA      NA       NA    
Mult(1, ., L).R1 -0.538271         NA      NA       NA    
Mult(1, ., L).R2  0.597665         NA      NA       NA    
Mult(1, ., L).R3  0.389408         NA      NA       NA    
Mult(1, ., L).R4 -0.448801         NA      NA       NA    
Mult(1, R, .).L1 -0.001751         NA      NA       NA    
Mult(1, R, .).L2  0.322023         NA      NA       NA    
Mult(1, R, .).L3  0.074960         NA      NA       NA    
Mult(1, R, .).L4 -0.319010         NA      NA       NA    
Mult(., C, L).   -1.009160         NA      NA       NA    
Mult(1, ., L).C1 -0.346838         NA      NA       NA    
Mult(1, ., L).C2 -0.438761         NA      NA       NA    
Mult(1, ., L).C3 -1.095773         NA      NA       NA    
Mult(1, ., L).C4 -0.245309         NA      NA       NA    
Mult(1, C, .).L1 -0.050729         NA      NA       NA    
Mult(1, C, .).L2 -0.326016         NA      NA       NA    
Mult(1, C, .).L3  0.250094         NA      NA       NA    
Mult(1, C, .).L4 -0.104920         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 48.569 on 41 degrees of freedom
AIC: 388.89

Number of iterations: 120</code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>nu1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>  model12.extended,</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model12.extended, <span class="st">"[.]C"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>eta1 <span class="ot">&lt;-</span></span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getContrasts</span>(</span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a>    model12.extended,</span>
<span id="cb172-12"><a href="#cb172-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pickCoef</span>(model12.extended, <span class="st">"[.]L"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb172-13"><a href="#cb172-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb172-14"><a href="#cb172-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb172-15"><a href="#cb172-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb172-16"><a href="#cb172-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb172-17"><a href="#cb172-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-18"><a href="#cb172-18" aria-hidden="true" tabindex="-1"></a>model12.phis <span class="ot">&lt;-</span></span>
<span id="cb172-19"><a href="#cb172-19" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> <span class="fu">gnm</span>(</span>
<span id="cb172-20"><a href="#cb172-20" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb172-21"><a href="#cb172-21" aria-hidden="true" tabindex="-1"></a>      cov_rcl <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb172-22"><a href="#cb172-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">23</span><span class="sc">:</span><span class="dv">30</span>, <span class="dv">32</span><span class="sc">:</span><span class="dv">39</span>),</span>
<span id="cb172-23"><a href="#cb172-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrainTo =</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], nu1<span class="sc">$</span>qvframe[, <span class="dv">1</span>],</span>
<span id="cb172-24"><a href="#cb172-24" aria-hidden="true" tabindex="-1"></a>                    mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], eta1<span class="sc">$</span>qvframe[, <span class="dv">1</span>], </span>
<span id="cb172-25"><a href="#cb172-25" aria-hidden="true" tabindex="-1"></a>                    nu2<span class="sc">$</span>qvframe[, <span class="dv">1</span>], eta2<span class="sc">$</span>qvframe[, <span class="dv">1</span>]),</span>
<span id="cb172-26"><a href="#cb172-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb172-27"><a href="#cb172-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson, </span>
<span id="cb172-28"><a href="#cb172-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F, </span>
<span id="cb172-29"><a href="#cb172-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running main iterations....
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model12.phis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + 
    cov_rcl + Mult(1, R, L) + Mult(1, C, L), constrain = c(13:20, 
    23:30, 32:39), constrainTo = c(mu$qvframe[, 1], nu1$qvframe[, 
    1], mu$qvframe[, 1], eta1$qvframe[, 1], nu2$qvframe[, 1], 
    eta2$qvframe[, 1]), family = poisson, data = freq_tab_3.1, 
    tolerance = 1e-12, trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.58844  -0.76809   0.02278   0.56330   1.92999  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.55535    0.08106  43.859  &lt; 2e-16 ***
R2               -0.92909    0.11339  -8.194  &lt; 2e-16 ***
R3               -0.64221    0.12609  -5.093 3.52e-07 ***
R4               -1.39320    0.17746  -7.851  &lt; 2e-16 ***
C2               -1.63743    0.10043 -16.304  &lt; 2e-16 ***
C3               -2.18079    0.15608 -13.973  &lt; 2e-16 ***
C4               -3.65343    0.23846 -15.321  &lt; 2e-16 ***
L2               -1.39736    0.10537 -13.261  &lt; 2e-16 ***
L3               -2.13230    0.17235 -12.372  &lt; 2e-16 ***
L4               -3.74831    0.27154 -13.804  &lt; 2e-16 ***
Rscore:Cscore     0.13336    0.02490   5.357 8.48e-08 ***
Mult(., R, C).   -0.64007    0.13725  -4.663 3.11e-06 ***
Mult(1, ., C).R1 -0.53827         NA      NA       NA    
Mult(1, ., C).R2  0.59766         NA      NA       NA    
Mult(1, ., C).R3  0.38941         NA      NA       NA    
Mult(1, ., C).R4 -0.44880         NA      NA       NA    
Mult(1, R, .).C1  0.18108         NA      NA       NA    
Mult(1, R, .).C2 -0.74146         NA      NA       NA    
Mult(1, R, .).C3 -0.08067         NA      NA       NA    
Mult(1, R, .).C4  0.64105         NA      NA       NA    
cov_rcl           0.22423    0.01636  13.707  &lt; 2e-16 ***
Mult(., R, L).    1.13998    0.13669   8.340  &lt; 2e-16 ***
Mult(1, ., L).R1 -0.53827         NA      NA       NA    
Mult(1, ., L).R2  0.59766         NA      NA       NA    
Mult(1, ., L).R3  0.38941         NA      NA       NA    
Mult(1, ., L).R4 -0.44880         NA      NA       NA    
Mult(1, R, .).L1 -0.04544         NA      NA       NA    
Mult(1, R, .).L2  0.66170         NA      NA       NA    
Mult(1, R, .).L3  0.12210         NA      NA       NA    
Mult(1, R, .).L4 -0.73836         NA      NA       NA    
Mult(., C, L).    0.27613    0.10158   2.718  0.00656 ** 
Mult(1, ., L).C1 -0.27770         NA      NA       NA    
Mult(1, ., L).C2 -0.13959         NA      NA       NA    
Mult(1, ., L).C3  0.84752         NA      NA       NA    
Mult(1, ., L).C4 -0.43024         NA      NA       NA    
Mult(1, C, .).L1  0.01743         NA      NA       NA    
Mult(1, C, .).L2 -0.65220         NA      NA       NA    
Mult(1, C, .).L3  0.74916         NA      NA       NA    
Mult(1, C, .).L4 -0.11439         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 48.569 on 49 degrees of freedom
AIC: 372.89

Number of iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>mu</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       Estimate Std. Error
Mult(1, ., C + L).R1 -0.5382715 0.07940991
Mult(1, ., C + L).R2  0.5976649 0.06869502
Mult(1, ., C + L).R3  0.3894076 0.08390695
Mult(1, ., C + L).R4 -0.4488010 0.08495489</code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>nu1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate Std. Error
Mult(1, R, .).C1  0.18108336  0.1505749
Mult(1, R, .).C2 -0.74145909  0.0888159
Mult(1, R, .).C3 -0.08066998  0.1598862
Mult(1, R, .).C4  0.64104571  0.1141041</code></pre>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>eta1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Estimate Std. Error
Mult(1, R, .).L1 -0.0454423 0.08895571
Mult(1, R, .).L2  0.6617033 0.05943373
Mult(1, R, .).L3  0.1220991 0.08507409
Mult(1, R, .).L4 -0.7383601 0.04862532</code></pre>
</div>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>nu2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Estimate Std. Error
Mult(1, ., L).C1 -0.2776974 0.30818568
Mult(1, ., L).C2 -0.1395889 0.36977790
Mult(1, ., L).C3  0.8475231 0.08001496
Mult(1, ., L).C4 -0.4302368 0.32326672</code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>eta2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate Std. Error
Mult(1, C, .).L1  0.01742597  0.3681779
Mult(1, C, .).L2 -0.65219849  0.2296758
Mult(1, C, .).L3  0.74916478  0.1797929
Mult(1, C, .).L4 -0.11439226  0.3321123</code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model12)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  `Model Description`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 model12                39  48.6 -237.  6.57 0.140</code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 15</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">cov_rcl =</span> Rscore <span class="sc">*</span> Lscore <span class="sc">+</span> Cscore <span class="sc">*</span> Lscore)</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>model15 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, R, C <span class="sc">+</span> L) <span class="sc">+</span> cov_rcl,</span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations..........................................
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model15)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C + 
    L) + cov_rcl, family = poisson, data = freq_tab_3.1, tolerance = 1e-12, 
    trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.98677  -0.75501   0.01756   0.52206   2.97799  

Coefficients:
                      Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)           3.566386         NA      NA       NA    
R2                   -0.939782         NA      NA       NA    
R3                   -0.661014         NA      NA       NA    
R4                   -1.420656         NA      NA       NA    
C2                   -1.686600         NA      NA       NA    
C3                   -2.181039         NA      NA       NA    
C4                   -3.675474         NA      NA       NA    
L2                   -1.468644         NA      NA       NA    
L3                   -2.172304         NA      NA       NA    
L4                   -3.767280         NA      NA       NA    
Rscore:Cscore         0.133072   0.025518   5.215 1.84e-07 ***
Mult(., R, C + L).   -3.369655         NA      NA       NA    
Mult(1, ., C + L).R1  0.195195         NA      NA       NA    
Mult(1, ., C + L).R2 -0.271648         NA      NA       NA    
Mult(1, ., C + L).R3 -0.185940         NA      NA       NA    
Mult(1, ., C + L).R4  0.153902         NA      NA       NA    
Mult(1, R, . + L).C1 -0.118409         NA      NA       NA    
Mult(1, R, . + L).C2  0.308404         NA      NA       NA    
Mult(1, R, . + L).C3 -0.006771         NA      NA       NA    
Mult(1, R, . + L).C4 -0.337100         NA      NA       NA    
Mult(1, R, C + .).L2  0.583301         NA      NA       NA    
Mult(1, R, C + .).L3  0.147190         NA      NA       NA    
Mult(1, R, C + .).L4 -0.571676         NA      NA       NA    
cov_rcl               0.228615   0.017090  13.377  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 55.984 on 44 degrees of freedom
AIC: 390.3

Number of iterations: 42</code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model15)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  `Model Description`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 model15                44  56.0 -266.  6.83 0.106</code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>  model15,</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model15, <span class="st">"[.]R"</span>),</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a>  model15,</span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model15, <span class="st">"[.]C"</span>),</span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb194-14"><a href="#cb194-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb194-15"><a href="#cb194-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb194-16"><a href="#cb194-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-17"><a href="#cb194-17" aria-hidden="true" tabindex="-1"></a>model15.extended <span class="ot">&lt;-</span></span>
<span id="cb194-18"><a href="#cb194-18" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> <span class="fu">gnm</span>(</span>
<span id="cb194-19"><a href="#cb194-19" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> </span>
<span id="cb194-20"><a href="#cb194-20" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> </span>
<span id="cb194-21"><a href="#cb194-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb194-22"><a href="#cb194-22" aria-hidden="true" tabindex="-1"></a>      cov_rcl <span class="sc">+</span> </span>
<span id="cb194-23"><a href="#cb194-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, L),</span>
<span id="cb194-24"><a href="#cb194-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">23</span><span class="sc">:</span><span class="dv">26</span>),</span>
<span id="cb194-25"><a href="#cb194-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrainTo =</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>]),</span>
<span id="cb194-26"><a href="#cb194-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb194-27"><a href="#cb194-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb194-28"><a href="#cb194-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb194-29"><a href="#cb194-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb194-30"><a href="#cb194-30" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations....
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model15.extended)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + 
    cov_rcl + Mult(1, R, L), constrain = c(13:16, 23:26), constrainTo = c(mu$qvframe[, 
    1], mu$qvframe[, 1]), family = poisson, data = freq_tab_3.1, 
    tolerance = 1e-12, trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.98677  -0.75501   0.01756   0.52206   2.97799  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.58560         NA      NA       NA    
R2               -1.00285         NA      NA       NA    
R3               -0.71250         NA      NA       NA    
R4               -1.42623         NA      NA       NA    
C2               -1.64759    0.10152  -16.23  &lt; 2e-16 ***
C3               -2.17084    0.15843  -13.70  &lt; 2e-16 ***
C4               -3.69546    0.24129  -15.32  &lt; 2e-16 ***
L2               -1.41533    0.10612  -13.34  &lt; 2e-16 ***
L3               -2.15885    0.17266  -12.50  &lt; 2e-16 ***
L4               -3.81953    0.27268  -14.01  &lt; 2e-16 ***
Rscore:Cscore     0.13307    0.02539    5.24  1.6e-07 ***
Mult(., R, C).   -0.78645         NA      NA       NA    
Mult(1, ., C).R1  0.54368         NA      NA       NA    
Mult(1, ., C).R2 -0.59799         NA      NA       NA    
Mult(1, ., C).R3 -0.38839         NA      NA       NA    
Mult(1, ., C).R4  0.44270         NA      NA       NA    
Mult(1, R, .).C1 -0.10989         NA      NA       NA    
Mult(1, R, .).C2  0.63791         NA      NA       NA    
Mult(1, R, .).C3  0.08571         NA      NA       NA    
Mult(1, R, .).C4 -0.49305         NA      NA       NA    
cov_rcl           0.22862    0.01643   13.91  &lt; 2e-16 ***
Mult(., R, L).    2.05590         NA      NA       NA    
Mult(1, ., L).R1  0.54368         NA      NA       NA    
Mult(1, ., L).R2 -0.59799         NA      NA       NA    
Mult(1, ., L).R3 -0.38839         NA      NA       NA    
Mult(1, ., L).R4  0.44270         NA      NA       NA    
Mult(1, R, .).L1  0.01045         NA      NA       NA    
Mult(1, R, .).L2 -0.38048         NA      NA       NA    
Mult(1, R, .).L3 -0.08820         NA      NA       NA    
Mult(1, R, .).L4  0.39360         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 55.984 on 46 degrees of freedom
AIC: 386.3

Number of iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">&lt;-</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getContrasts</span>(</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>    model15.extended,</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pickCoef</span>(model15.extended, <span class="st">"[.]L"</span>),</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a>model15.phis <span class="ot">&lt;-</span></span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> <span class="fu">gnm</span>(</span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> </span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> </span>
<span id="cb198-14"><a href="#cb198-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span> </span>
<span id="cb198-15"><a href="#cb198-15" aria-hidden="true" tabindex="-1"></a>      cov_rcl <span class="sc">+</span> </span>
<span id="cb198-16"><a href="#cb198-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, L),</span>
<span id="cb198-17"><a href="#cb198-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">23</span><span class="sc">:</span><span class="dv">30</span>),</span>
<span id="cb198-18"><a href="#cb198-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrainTo =</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], </span>
<span id="cb198-19"><a href="#cb198-19" aria-hidden="true" tabindex="-1"></a>                    nu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], </span>
<span id="cb198-20"><a href="#cb198-20" aria-hidden="true" tabindex="-1"></a>                    mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], </span>
<span id="cb198-21"><a href="#cb198-21" aria-hidden="true" tabindex="-1"></a>                    eta<span class="sc">$</span>qvframe[, <span class="dv">1</span>]),</span>
<span id="cb198-22"><a href="#cb198-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb198-23"><a href="#cb198-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb198-24"><a href="#cb198-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb198-25"><a href="#cb198-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb198-26"><a href="#cb198-26" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running main iterations.
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model15.phis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + 
    cov_rcl + Mult(1, R, L), constrain = c(13:20, 23:30), constrainTo = c(mu$qvframe[, 
    1], nu$qvframe[, 1], mu$qvframe[, 1], eta$qvframe[, 1]), 
    family = poisson, data = freq_tab_3.1, tolerance = 1e-12,     trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.98677  -0.75501   0.01756   0.52206   2.97799  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.55464    0.08091  43.935  &lt; 2e-16 ***
R2               -0.93784    0.11339  -8.271  &lt; 2e-16 ***
R3               -0.65943    0.12613  -5.228 1.71e-07 ***
R4               -1.42048    0.17754  -8.001  &lt; 2e-16 ***
C2               -1.64759    0.10044 -16.404  &lt; 2e-16 ***
C3               -2.17084    0.15588 -13.927  &lt; 2e-16 ***
C4               -3.69546    0.23861 -15.488  &lt; 2e-16 ***
L2               -1.41533    0.10551 -13.414  &lt; 2e-16 ***
L3               -2.15885    0.17245 -12.519  &lt; 2e-16 ***
L4               -3.81953    0.27221 -14.032  &lt; 2e-16 ***
Rscore:Cscore     0.13307    0.02492   5.341 9.24e-08 ***
Mult(., R, C).   -0.64172    0.13829  -4.641 3.48e-06 ***
Mult(1, ., C).R1  0.54368         NA      NA       NA    
Mult(1, ., C).R2 -0.59799         NA      NA       NA    
Mult(1, ., C).R3 -0.38839         NA      NA       NA    
Mult(1, ., C).R4  0.44270         NA      NA       NA    
Mult(1, R, .).C1 -0.17165         NA      NA       NA    
Mult(1, R, .).C2  0.74481         NA      NA       NA    
Mult(1, R, .).C3  0.06806         NA      NA       NA    
Mult(1, R, .).C4 -0.64122         NA      NA       NA    
cov_rcl           0.22862    0.01640  13.939  &lt; 2e-16 ***
Mult(., R, L).    1.13826    0.13726   8.293  &lt; 2e-16 ***
Mult(1, ., L).R1  0.54368         NA      NA       NA    
Mult(1, ., L).R2 -0.59799         NA      NA       NA    
Mult(1, ., L).R3 -0.38839         NA      NA       NA    
Mult(1, ., L).R4  0.44270         NA      NA       NA    
Mult(1, R, .).L1  0.04806         NA      NA       NA    
Mult(1, R, .).L2 -0.65804         NA      NA       NA    
Mult(1, R, .).L3 -0.13012         NA      NA       NA    
Mult(1, R, .).L4  0.74010         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 55.984 on 50 degrees of freedom
AIC: 378.3

Number of iterations: 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>mu</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       Estimate Std. Error
Mult(1, ., C + L).R1  0.5436794 0.07818382
Mult(1, ., C + L).R2 -0.5979869 0.06871974
Mult(1, ., C + L).R3 -0.3883879 0.08391754
Mult(1, ., C + L).R4  0.4426954 0.08454001</code></pre>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>nu</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Estimate Std. Error
Mult(1, R, . + L).C1 -0.17164747 0.14998137
Mult(1, R, . + L).C2  0.74480785 0.08583798
Mult(1, R, . + L).C3  0.06806188 0.15421719
Mult(1, R, . + L).C4 -0.64122226 0.11322236</code></pre>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>eta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate Std. Error
Mult(1, R, .).L1  0.04806244 0.08932196
Mult(1, R, .).L2 -0.65804171 0.05969167
Mult(1, R, .).L3 -0.13011596 0.08427834
Mult(1, R, .).L4  0.74009523 0.04837401</code></pre>
</div>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model15)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  `Model Description`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 model15                44  56.0 -266.  6.83 0.106</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">model.summary</span>(model1, <span class="st">"Model 1"</span>),</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">model.summary</span>(model2, <span class="st">"Model 2"</span>),</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">model.summary</span>(model4, <span class="st">"Model 4"</span>),</span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">model.summary</span>(model6, <span class="st">"Model 6"</span>),</span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">model.summary</span>(model7, <span class="st">"Model 7"</span>),</span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">model.summary</span>(model8, <span class="st">"Model 8"</span>),</span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">model.summary</span>(model9, <span class="st">"Model 9"</span>),</span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">model.summary</span>(model10, <span class="st">"Model 10"</span>),</span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">model.summary</span>(model11, <span class="st">"Model 11"</span>),</span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">model.summary</span>(model12, <span class="st">"Model 12"</span>),</span>
<span id="cb210-11"><a href="#cb210-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">model.summary</span>(model15, <span class="st">"Model 15"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 6
   `Model Description`    df    L2   BIC Delta        p
   &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
 1 Model 1                54 544.   149. 23.7  3.44e-82
 2 Model 2                39 109.  -176.  9.81 1.42e- 8
 3 Model 4                35  37.7 -218.  4.63 3.47e- 1
 4 Model 6                27  29.0 -169.  4.86 3.61e- 1
 5 Model 7                23  21.9 -146.  3.70 5.24e- 1
 6 Model 8                36  45.9 -218.  6.25 1.26e- 1
 7 Model 9                38  47.1 -231.  6.25 1.47e- 1
 8 Model 10               38  50.9 -227.  6.31 7.88e- 2
 9 Model 11               38  53.6 -225.  6.58 4.77e- 2
10 Model 12               39  48.6 -237.  6.57 1.40e- 1
11 Model 15               44  56.0 -266.  6.83 1.06e- 1</code></pre>
</div>
</div>
</section>
<section id="練習問題" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="練習問題">練習問題</h2>
<p><strong>問題3.1</strong> <span class="citation" data-cites="goodman1979a">Goodman (<a href="#ref-goodman1979a" role="doc-biblioref">1979</a>)</span> の表5A，表5B，表5Cの結果を再現しよう．使用するデータは<code>mentalHealth</code>のデータである．表5Aのモデルは，(1) Null Association，(2) Uniform Association，(3) Row-Effect Association，(4) Column-Effect Association，(5) Row and Column Effects (I)， (6) Row and Column Effects (II) の6つである．</p>
<ul>
<li>問題3.1.1：<span class="citation" data-cites="goodman1979a">Goodman (<a href="#ref-goodman1979a" role="doc-biblioref">1979</a>)</span> の表5Bの分析（全体効果の分解）を再現する．表5Bではまずモデル (1) と (2) の比較から一般的な効果（General Effect）を求めている．次に，モデル (2) と (5) の比較から，行・列効果を求めている． 他の効果はモデル (5) で示され，全体効果はモデル (1) となる．</li>
<li>問題3.1.2：<span class="citation" data-cites="goodman1979a">Goodman (<a href="#ref-goodman1979a" role="doc-biblioref">1979</a>)</span> の表5Cの分析（行と列効果の分割）を再現する．モデル (2) と (3) から行効果が，さらにモデル (3) と (5) から行効果が，そして，モデル (2) と (5) から行・列効果の要素を取り出すことができる．</li>
</ul>
</section>
<section id="参考文献" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="参考文献">参考文献</h2>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-goodman1979a" class="csl-entry" role="listitem">
Goodman, Leo A. 1979. <span>“Simple <span>Models</span> for the <span>Analysis</span> of <span>Association</span> in <span>Cross-Classifications</span> Having <span>Ordered Categories</span>.”</span> <em>Journal of the American Statistical Association</em> 74 (367): 537–52.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./3-Chapter_2.html" class="pagination-link" aria-label="第2章">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">第2章</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./5-Chapter_4.html" class="pagination-link" aria-label="第4章">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">第4章</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb212" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># 第3章</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>第3章は3元表に対する部分連関モデルを扱う．パッケージは<span class="in">`tidyverse`</span>（データセットの処理のため），<span class="in">`magrittr`</span>（パイプ演算子），<span class="in">`DescTools`</span>（記述統計を求めるため），<span class="in">`vcd`</span>パッケージ（カテゴリカルデータの分析のため），<span class="in">`broom`</span>（回帰係数の整理），<span class="in">`gnm`</span>（連関分析の処理のため），<span class="in">`broom`</span>（tidyな回帰分析の結果の表示）を使用する．</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gnm)</span>
<span id="cb212-13"><a href="#cb212-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb212-14"><a href="#cb212-14" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-15"><a href="#cb212-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-16"><a href="#cb212-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-17"><a href="#cb212-17" aria-hidden="true" tabindex="-1"></a>またモデル適合度を表示するための関数をここでも準備しておく．すべて<span class="in">`gnm`</span>によって推定を行う．</span>
<span id="cb212-18"><a href="#cb212-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-21"><a href="#cb212-21" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-22"><a href="#cb212-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 引数となるobjはgnmの結果</span></span>
<span id="cb212-23"><a href="#cb212-23" aria-hidden="true" tabindex="-1"></a>model.summary <span class="ot">&lt;-</span> <span class="cf">function</span>(obj, <span class="at">Model =</span> <span class="cn">NULL</span>){</span>
<span id="cb212-24"><a href="#cb212-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">class</span>(obj) <span class="sc">==</span> <span class="st">"gnm"</span>) <span class="sc">!=</span> <span class="dv">1</span>)</span>
<span id="cb212-25"><a href="#cb212-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"estimate with gnm"</span>)</span>
<span id="cb212-26"><a href="#cb212-26" aria-hidden="true" tabindex="-1"></a>  aic <span class="ot">&lt;-</span> obj<span class="sc">$</span>deviance <span class="sc">-</span> obj<span class="sc">$</span>df <span class="sc">*</span> <span class="dv">2</span> <span class="co"># AIC(L2)</span></span>
<span id="cb212-27"><a href="#cb212-27" aria-hidden="true" tabindex="-1"></a>  bic <span class="ot">&lt;-</span> obj<span class="sc">$</span>deviance <span class="sc">-</span> obj<span class="sc">$</span>df <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">sum</span>(obj<span class="sc">$</span>y)) <span class="co">#BIC(L2)</span></span>
<span id="cb212-28"><a href="#cb212-28" aria-hidden="true" tabindex="-1"></a>  delta <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">abs</span>(obj<span class="sc">$</span>y <span class="sc">-</span> obj<span class="sc">$</span>fitted.values)) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(obj<span class="sc">$</span>y))</span>
<span id="cb212-29"><a href="#cb212-29" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(obj<span class="sc">$</span>deviance, obj<span class="sc">$</span>df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-30"><a href="#cb212-30" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">7</span>)</span>
<span id="cb212-31"><a href="#cb212-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(Model)){ </span>
<span id="cb212-32"><a href="#cb212-32" aria-hidden="true" tabindex="-1"></a>  Model <span class="ot">&lt;-</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(obj))</span>
<span id="cb212-33"><a href="#cb212-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb212-34"><a href="#cb212-34" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb212-35"><a href="#cb212-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Model Description"</span> <span class="ot">=</span> Model,</span>
<span id="cb212-36"><a href="#cb212-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"df"</span> <span class="ot">=</span> obj<span class="sc">$</span>df,</span>
<span id="cb212-37"><a href="#cb212-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">"L2"</span> <span class="ot">=</span> obj<span class="sc">$</span>deviance,</span>
<span id="cb212-38"><a href="#cb212-38" aria-hidden="true" tabindex="-1"></a>    <span class="co">#"AIC(L2)" = aic,</span></span>
<span id="cb212-39"><a href="#cb212-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"BIC"</span> <span class="ot">=</span> bic,</span>
<span id="cb212-40"><a href="#cb212-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Delta"</span> <span class="ot">=</span> delta,</span>
<span id="cb212-41"><a href="#cb212-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">"p"</span> <span class="ot">=</span> p</span>
<span id="cb212-42"><a href="#cb212-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-43"><a href="#cb212-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb212-44"><a href="#cb212-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb212-45"><a href="#cb212-45" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-46"><a href="#cb212-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-47"><a href="#cb212-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-48"><a href="#cb212-48" aria-hidden="true" tabindex="-1"></a><span class="fu">## 表3.1A</span></span>
<span id="cb212-49"><a href="#cb212-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-50"><a href="#cb212-50" aria-hidden="true" tabindex="-1"></a>表3.1Aをまずベクトルとして入力する．</span>
<span id="cb212-51"><a href="#cb212-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-54"><a href="#cb212-54" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-55"><a href="#cb212-55" aria-hidden="true" tabindex="-1"></a><span class="co"># 表3.1</span></span>
<span id="cb212-56"><a href="#cb212-56" aria-hidden="true" tabindex="-1"></a>Freq <span class="ot">&lt;-</span> <span class="fu">c</span>(  <span class="dv">9</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1</span>,    <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">1</span>,    <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>,</span>
<span id="cb212-57"><a href="#cb212-57" aria-hidden="true" tabindex="-1"></a>           <span class="dv">17</span>,<span class="dv">13</span>, <span class="dv">7</span>, <span class="dv">4</span>,   <span class="dv">13</span>,<span class="dv">22</span>, <span class="dv">9</span>, <span class="dv">1</span>,    <span class="dv">7</span>,<span class="dv">13</span>, <span class="dv">6</span>, <span class="dv">2</span>,</span>
<span id="cb212-58"><a href="#cb212-58" aria-hidden="true" tabindex="-1"></a>            <span class="dv">8</span>,<span class="dv">14</span>, <span class="dv">6</span>, <span class="dv">0</span>,   <span class="dv">10</span>,<span class="dv">29</span>,<span class="dv">10</span>, <span class="dv">0</span>,    <span class="dv">5</span>,<span class="dv">14</span>, <span class="dv">6</span>, <span class="dv">2</span>,</span>
<span id="cb212-59"><a href="#cb212-59" aria-hidden="true" tabindex="-1"></a>           <span class="dv">20</span>,<span class="dv">38</span>,<span class="dv">24</span>, <span class="dv">8</span>,   <span class="dv">23</span>,<span class="dv">72</span>,<span class="dv">34</span>,<span class="dv">10</span>,   <span class="dv">17</span>,<span class="dv">67</span>,<span class="dv">36</span>,<span class="dv">12</span>,</span>
<span id="cb212-60"><a href="#cb212-60" aria-hidden="true" tabindex="-1"></a>            <span class="dv">4</span>,<span class="dv">21</span>,<span class="dv">12</span>, <span class="dv">4</span>,    <span class="dv">7</span>,<span class="dv">30</span>, <span class="dv">9</span>, <span class="dv">1</span>,    <span class="dv">9</span>,<span class="dv">19</span>,<span class="dv">14</span>, <span class="dv">2</span>,</span>
<span id="cb212-61"><a href="#cb212-61" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">3</span>,    <span class="dv">1</span>,<span class="dv">16</span>,<span class="dv">19</span>, <span class="dv">2</span>,   <span class="dv">11</span>,<span class="dv">28</span>,<span class="dv">28</span>,<span class="dv">11</span>,</span>
<span id="cb212-62"><a href="#cb212-62" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">0</span>,    <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>,    <span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">6</span>)</span>
<span id="cb212-63"><a href="#cb212-63" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-64"><a href="#cb212-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-65"><a href="#cb212-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-66"><a href="#cb212-66" aria-hidden="true" tabindex="-1"></a>次に行変数，列変数，層変数を入力する．<span class="in">`gl(n = 水準数, k = 繰り返しの数, length = 長さ)`</span>を注意しながら設定する．</span>
<span id="cb212-67"><a href="#cb212-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-70"><a href="#cb212-70" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-71"><a href="#cb212-71" aria-hidden="true" tabindex="-1"></a>polviews <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="at">n =</span> <span class="dv">7</span>, <span class="at">k =</span> <span class="dv">4</span><span class="sc">*</span><span class="dv">3</span>, <span class="at">length =</span> <span class="fu">length</span>(Freq))</span>
<span id="cb212-72"><a href="#cb212-72" aria-hidden="true" tabindex="-1"></a>fefam <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="at">n =</span> <span class="dv">4</span>, <span class="at">k =</span> <span class="dv">1</span>, <span class="at">length =</span> <span class="fu">length</span>(Freq))</span>
<span id="cb212-73"><a href="#cb212-73" aria-hidden="true" tabindex="-1"></a>natfare <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="at">n =</span> <span class="dv">3</span>, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">length =</span> <span class="fu">length</span>(Freq))</span>
<span id="cb212-74"><a href="#cb212-74" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-75"><a href="#cb212-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-76"><a href="#cb212-76" aria-hidden="true" tabindex="-1"></a>対応しているのかを確認したければ，matrix形式で示すとよい．</span>
<span id="cb212-77"><a href="#cb212-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-80"><a href="#cb212-80" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-81"><a href="#cb212-81" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(polviews, <span class="at">nrow =</span> <span class="dv">7</span>, <span class="at">ncol =</span> <span class="dv">12</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-82"><a href="#cb212-82" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(fefam, <span class="at">nrow =</span> <span class="dv">7</span>, <span class="at">ncol =</span> <span class="dv">12</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-83"><a href="#cb212-83" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(natfare, <span class="at">nrow =</span> <span class="dv">7</span>, <span class="at">ncol =</span> <span class="dv">12</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-84"><a href="#cb212-84" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-85"><a href="#cb212-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-86"><a href="#cb212-86" aria-hidden="true" tabindex="-1"></a>tableのデータ（<span class="in">`tab_3.1`</span>）とセルを単位としたデータ（<span class="in">`freq_tab_3.1`</span>）を作成する．</span>
<span id="cb212-87"><a href="#cb212-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-90"><a href="#cb212-90" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-91"><a href="#cb212-91" aria-hidden="true" tabindex="-1"></a>tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare)</span>
<span id="cb212-92"><a href="#cb212-92" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">tibble</span>(Freq, polviews, fefam, natfare)</span>
<span id="cb212-93"><a href="#cb212-93" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-94"><a href="#cb212-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-95"><a href="#cb212-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-96"><a href="#cb212-96" aria-hidden="true" tabindex="-1"></a>表3.2のモデルで推定を行う．モデル6から8まではスコアパラメータの正則化が必要であるが，適合度については問題なく求めることができる．</span>
<span id="cb212-97"><a href="#cb212-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-100"><a href="#cb212-100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-101"><a href="#cb212-101" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1 - 独立モデル</span></span>
<span id="cb212-102"><a href="#cb212-102" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb212-103"><a href="#cb212-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb212-104"><a href="#cb212-104" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare,</span>
<span id="cb212-105"><a href="#cb212-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-106"><a href="#cb212-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-107"><a href="#cb212-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb212-108"><a href="#cb212-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-109"><a href="#cb212-109" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-110"><a href="#cb212-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-111"><a href="#cb212-111" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2 - 完全2元交互作用モデル</span></span>
<span id="cb212-112"><a href="#cb212-112" aria-hidden="true" tabindex="-1"></a>M2 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb212-113"><a href="#cb212-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb212-114"><a href="#cb212-114" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> polviews <span class="sc">*</span> fefam <span class="sc">+</span> fefam <span class="sc">*</span> natfare <span class="sc">+</span> polviews <span class="sc">*</span> natfare,</span>
<span id="cb212-115"><a href="#cb212-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-116"><a href="#cb212-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-117"><a href="#cb212-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb212-118"><a href="#cb212-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-119"><a href="#cb212-119" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-120"><a href="#cb212-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-121"><a href="#cb212-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3 - 条件付き独立 (polviews)</span></span>
<span id="cb212-122"><a href="#cb212-122" aria-hidden="true" tabindex="-1"></a>M3 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb212-123"><a href="#cb212-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb212-124"><a href="#cb212-124" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> polviews <span class="sc">*</span> fefam <span class="sc">+</span> polviews <span class="sc">*</span> natfare,</span>
<span id="cb212-125"><a href="#cb212-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-126"><a href="#cb212-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-127"><a href="#cb212-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb212-128"><a href="#cb212-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-129"><a href="#cb212-129" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-130"><a href="#cb212-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-131"><a href="#cb212-131" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 4 - 条件付き独立 (fefam)</span></span>
<span id="cb212-132"><a href="#cb212-132" aria-hidden="true" tabindex="-1"></a>M4 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb212-133"><a href="#cb212-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb212-134"><a href="#cb212-134" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> polviews <span class="sc">*</span> fefam <span class="sc">+</span> fefam <span class="sc">*</span> natfare,</span>
<span id="cb212-135"><a href="#cb212-135" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-136"><a href="#cb212-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-137"><a href="#cb212-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb212-138"><a href="#cb212-138" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-139"><a href="#cb212-139" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-140"><a href="#cb212-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-141"><a href="#cb212-141" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 5 - 条件付き独立 (natfare)</span></span>
<span id="cb212-142"><a href="#cb212-142" aria-hidden="true" tabindex="-1"></a>M5 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb212-143"><a href="#cb212-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb212-144"><a href="#cb212-144" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> fefam <span class="sc">*</span> natfare <span class="sc">+</span> polviews <span class="sc">*</span> natfare,</span>
<span id="cb212-145"><a href="#cb212-145" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-146"><a href="#cb212-146" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-147"><a href="#cb212-147" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb212-148"><a href="#cb212-148" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-149"><a href="#cb212-149" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-150"><a href="#cb212-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-151"><a href="#cb212-151" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 6 - RC(1)+RL(1) 部分連関</span></span>
<span id="cb212-152"><a href="#cb212-152" aria-hidden="true" tabindex="-1"></a><span class="co"># 値の正則化が必要</span></span>
<span id="cb212-153"><a href="#cb212-153" aria-hidden="true" tabindex="-1"></a>M6 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb212-154"><a href="#cb212-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb212-155"><a href="#cb212-155" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb212-156"><a href="#cb212-156" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="sc">+</span> </span>
<span id="cb212-157"><a href="#cb212-157" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb212-158"><a href="#cb212-158" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-159"><a href="#cb212-159" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-160"><a href="#cb212-160" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-161"><a href="#cb212-161" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-162"><a href="#cb212-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-163"><a href="#cb212-163" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 7 - RC(1)+RL(1) 部分連関 (一貫した行スコア - polviews)</span></span>
<span id="cb212-164"><a href="#cb212-164" aria-hidden="true" tabindex="-1"></a><span class="co"># 値の正則化が必要</span></span>
<span id="cb212-165"><a href="#cb212-165" aria-hidden="true" tabindex="-1"></a>M7 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb212-166"><a href="#cb212-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb212-167"><a href="#cb212-167" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb212-168"><a href="#cb212-168" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, fefam <span class="sc">+</span> natfare),</span>
<span id="cb212-169"><a href="#cb212-169" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-170"><a href="#cb212-170" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-171"><a href="#cb212-171" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-172"><a href="#cb212-172" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-173"><a href="#cb212-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-174"><a href="#cb212-174" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 8 - RC(1)+RL(1) 部分連関 (一貫した行スコア - polviews)</span></span>
<span id="cb212-175"><a href="#cb212-175" aria-hidden="true" tabindex="-1"></a><span class="co"># 行スコアへの等値制約</span></span>
<span id="cb212-176"><a href="#cb212-176" aria-hidden="true" tabindex="-1"></a><span class="co"># 値の正則化が必要</span></span>
<span id="cb212-177"><a href="#cb212-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-178"><a href="#cb212-178" aria-hidden="true" tabindex="-1"></a><span class="co"># 等値制約をかけたいセルの水準を同じにする</span></span>
<span id="cb212-179"><a href="#cb212-179" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> </span>
<span id="cb212-180"><a href="#cb212-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">polviews.c =</span> <span class="fu">case_when</span>(polviews <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>,  <span class="co"># mu1 = mu2</span></span>
<span id="cb212-181"><a href="#cb212-181" aria-hidden="true" tabindex="-1"></a>                                polviews <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">1</span>,  <span class="co"># mu1 = mu2</span></span>
<span id="cb212-182"><a href="#cb212-182" aria-hidden="true" tabindex="-1"></a>                                polviews <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb212-183"><a href="#cb212-183" aria-hidden="true" tabindex="-1"></a>                                polviews <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">3</span>,  <span class="co"># mu4 = mu5</span></span>
<span id="cb212-184"><a href="#cb212-184" aria-hidden="true" tabindex="-1"></a>                                polviews <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="dv">3</span>,  <span class="co"># mu4 = mu5</span></span>
<span id="cb212-185"><a href="#cb212-185" aria-hidden="true" tabindex="-1"></a>                                polviews <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb212-186"><a href="#cb212-186" aria-hidden="true" tabindex="-1"></a>                                polviews <span class="sc">==</span> <span class="dv">7</span> <span class="sc">~</span> <span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb212-187"><a href="#cb212-187" aria-hidden="true" tabindex="-1"></a>           <span class="fu">factor</span>())</span>
<span id="cb212-188"><a href="#cb212-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-189"><a href="#cb212-189" aria-hidden="true" tabindex="-1"></a>M8 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb212-190"><a href="#cb212-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb212-191"><a href="#cb212-191" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb212-192"><a href="#cb212-192" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, polviews.c, fefam <span class="sc">+</span> natfare),</span>
<span id="cb212-193"><a href="#cb212-193" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-194"><a href="#cb212-194" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-195"><a href="#cb212-195" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-196"><a href="#cb212-196" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-197"><a href="#cb212-197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-198"><a href="#cb212-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-199"><a href="#cb212-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-200"><a href="#cb212-200" aria-hidden="true" tabindex="-1"></a>モデル間の比較は次のように行う．</span>
<span id="cb212-201"><a href="#cb212-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-204"><a href="#cb212-204" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-205"><a href="#cb212-205" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3 と Model 2の比較</span></span>
<span id="cb212-206"><a href="#cb212-206" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="at">q =</span> M3<span class="sc">$</span>deviance <span class="sc">-</span> M2<span class="sc">$</span>deviance,</span>
<span id="cb212-207"><a href="#cb212-207" aria-hidden="true" tabindex="-1"></a>       <span class="at">df =</span> M3<span class="sc">$</span>df.residual <span class="sc">-</span> M2<span class="sc">$</span>df.residual,</span>
<span id="cb212-208"><a href="#cb212-208" aria-hidden="true" tabindex="-1"></a>       <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-209"><a href="#cb212-209" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 6 と Model 3の比較</span></span>
<span id="cb212-210"><a href="#cb212-210" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="at">q =</span> M6<span class="sc">$</span>deviance <span class="sc">-</span> M3<span class="sc">$</span>deviance,</span>
<span id="cb212-211"><a href="#cb212-211" aria-hidden="true" tabindex="-1"></a>       <span class="at">df =</span> M6<span class="sc">$</span>df.residual <span class="sc">-</span> M3<span class="sc">$</span>df.residual,</span>
<span id="cb212-212"><a href="#cb212-212" aria-hidden="true" tabindex="-1"></a>       <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-213"><a href="#cb212-213" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 13 と Model 8の比較</span></span>
<span id="cb212-214"><a href="#cb212-214" aria-hidden="true" tabindex="-1"></a><span class="do">## Model 13が推定できないため表の値を用いる</span></span>
<span id="cb212-215"><a href="#cb212-215" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="at">q =</span> <span class="fl">9.22</span>,</span>
<span id="cb212-216"><a href="#cb212-216" aria-hidden="true" tabindex="-1"></a>       <span class="at">df =</span> <span class="dv">6</span>,</span>
<span id="cb212-217"><a href="#cb212-217" aria-hidden="true" tabindex="-1"></a>       <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-218"><a href="#cb212-218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-219"><a href="#cb212-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-220"><a href="#cb212-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-221"><a href="#cb212-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-222"><a href="#cb212-222" aria-hidden="true" tabindex="-1"></a><span class="fu">## 表3.2</span></span>
<span id="cb212-223"><a href="#cb212-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-224"><a href="#cb212-224" aria-hidden="true" tabindex="-1"></a>表3.2を再現する．</span>
<span id="cb212-225"><a href="#cb212-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-228"><a href="#cb212-228" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-229"><a href="#cb212-229" aria-hidden="true" tabindex="-1"></a><span class="do">## 表3.2</span></span>
<span id="cb212-230"><a href="#cb212-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-231"><a href="#cb212-231" aria-hidden="true" tabindex="-1"></a><span class="co"># リストを作成</span></span>
<span id="cb212-232"><a href="#cb212-232" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb212-233"><a href="#cb212-233" aria-hidden="true" tabindex="-1"></a><span class="co"># モデルの適合度をリストに順に格納</span></span>
<span id="cb212-234"><a href="#cb212-234" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M1, <span class="st">"1. Complete independence"</span>) </span>
<span id="cb212-235"><a href="#cb212-235" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M2, <span class="st">"2. Full two-way interaction"</span>) </span>
<span id="cb212-236"><a href="#cb212-236" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">3</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M3, <span class="st">"3. Conditional independence on POLVIEWS"</span>) </span>
<span id="cb212-237"><a href="#cb212-237" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">4</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M4, <span class="st">"4. Conditional independence on FEFAM"</span>)</span>
<span id="cb212-238"><a href="#cb212-238" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">5</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M5, <span class="st">"5. Conditional independence on NATFARE"</span>)</span>
<span id="cb212-239"><a href="#cb212-239" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">6</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M6, <span class="st">"6. RC(1) + RL(1) partial association"</span>)</span>
<span id="cb212-240"><a href="#cb212-240" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">7</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M7, <span class="st">"7. Model 6 plus consisitent row (POLVIEWS) score restrictions"</span>)</span>
<span id="cb212-241"><a href="#cb212-241" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">8</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M8, <span class="st">"8. Model 6 plus consisitent and equality restrictions on row (POLVIEWS) scores (mu_1 = mu_2, mu_4 = mu_5)"</span>)</span>
<span id="cb212-242"><a href="#cb212-242" aria-hidden="true" tabindex="-1"></a><span class="co"># リストを行方向に合併する</span></span>
<span id="cb212-243"><a href="#cb212-243" aria-hidden="true" tabindex="-1"></a>M <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>()</span>
<span id="cb212-244"><a href="#cb212-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-245"><a href="#cb212-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-246"><a href="#cb212-246" aria-hidden="true" tabindex="-1"></a><span class="fu">## 表3.3</span></span>
<span id="cb212-247"><a href="#cb212-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-248"><a href="#cb212-248" aria-hidden="true" tabindex="-1"></a>表3.3を再現するために，モデル6から8までのスコアパラメータの正則化を行う．</span>
<span id="cb212-249"><a href="#cb212-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-250"><a href="#cb212-250" aria-hidden="true" tabindex="-1"></a>まずはモデル6である．</span>
<span id="cb212-251"><a href="#cb212-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-254"><a href="#cb212-254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-255"><a href="#cb212-255" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimating standard error</span></span>
<span id="cb212-256"><a href="#cb212-256" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 6</span></span>
<span id="cb212-257"><a href="#cb212-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-258"><a href="#cb212-258" aria-hidden="true" tabindex="-1"></a><span class="co"># 変数と係数と係数の順番を表示</span></span>
<span id="cb212-259"><a href="#cb212-259" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(M6, <span class="st">"[.]polviews"</span>)</span>
<span id="cb212-260"><a href="#cb212-260" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(M6, <span class="st">"[.]fefam"</span>)</span>
<span id="cb212-261"><a href="#cb212-261" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(M6, <span class="st">"[.]natfare"</span>)</span>
<span id="cb212-262"><a href="#cb212-262" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">var =</span> <span class="fu">names</span>(M6<span class="sc">$</span>coefficients),</span>
<span id="cb212-263"><a href="#cb212-263" aria-hidden="true" tabindex="-1"></a>           <span class="at">estimate =</span> M6<span class="sc">$</span>coefficients) <span class="sc">|&gt;</span> </span>
<span id="cb212-264"><a href="#cb212-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> estimate,</span>
<span id="cb212-265"><a href="#cb212-265" aria-hidden="true" tabindex="-1"></a>         <span class="at">number =</span> <span class="fu">row_number</span>())</span>
<span id="cb212-266"><a href="#cb212-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-267"><a href="#cb212-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-268"><a href="#cb212-268" aria-hidden="true" tabindex="-1"></a>各スコアの両端のカテゴリ，つまり上記推定値のリストの</span>
<span id="cb212-269"><a href="#cb212-269" aria-hidden="true" tabindex="-1"></a>14,20,21,24,26,32,33,35番目の8つの値についてスコアを求め，固定する．</span>
<span id="cb212-270"><a href="#cb212-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-273"><a href="#cb212-273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-274"><a href="#cb212-274" aria-hidden="true" tabindex="-1"></a><span class="co"># R POLVIEWS mu1[i], i = 1 to 7</span></span>
<span id="cb212-275"><a href="#cb212-275" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(<span class="at">model =</span> M6, </span>
<span id="cb212-276"><a href="#cb212-276" aria-hidden="true" tabindex="-1"></a>                    <span class="at">set =</span> <span class="fu">pickCoef</span>(M6, <span class="st">"fefam)[.]polviews"</span>),</span>
<span id="cb212-277"><a href="#cb212-277" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-278"><a href="#cb212-278" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb212-279"><a href="#cb212-279" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb212-280"><a href="#cb212-280" aria-hidden="true" tabindex="-1"></a><span class="co"># C FEFAM nu[j], j = 1 to 4</span></span>
<span id="cb212-281"><a href="#cb212-281" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(<span class="at">model =</span> M6, </span>
<span id="cb212-282"><a href="#cb212-282" aria-hidden="true" tabindex="-1"></a>                   <span class="at">set =</span> <span class="fu">pickCoef</span>(M6, <span class="st">"[.]fefam"</span>), </span>
<span id="cb212-283"><a href="#cb212-283" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-284"><a href="#cb212-284" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb212-285"><a href="#cb212-285" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb212-286"><a href="#cb212-286" aria-hidden="true" tabindex="-1"></a><span class="co"># R POLVIEWS mu2[i], i = 1 to 7</span></span>
<span id="cb212-287"><a href="#cb212-287" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(<span class="at">model =</span> M6, </span>
<span id="cb212-288"><a href="#cb212-288" aria-hidden="true" tabindex="-1"></a>                    <span class="at">set =</span> <span class="fu">pickCoef</span>(M6, <span class="st">"natfare)[.]polviews"</span>), </span>
<span id="cb212-289"><a href="#cb212-289" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-290"><a href="#cb212-290" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb212-291"><a href="#cb212-291" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb212-292"><a href="#cb212-292" aria-hidden="true" tabindex="-1"></a><span class="co"># L NATFARE eta[k], k = 1 to 3</span></span>
<span id="cb212-293"><a href="#cb212-293" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(<span class="at">model =</span> M6, </span>
<span id="cb212-294"><a href="#cb212-294" aria-hidden="true" tabindex="-1"></a>                    <span class="at">set =</span> <span class="fu">pickCoef</span>(M6, <span class="st">"[.]natfare"</span>), </span>
<span id="cb212-295"><a href="#cb212-295" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-296"><a href="#cb212-296" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb212-297"><a href="#cb212-297" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb212-298"><a href="#cb212-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-299"><a href="#cb212-299" aria-hidden="true" tabindex="-1"></a><span class="co"># 確認 </span></span>
<span id="cb212-300"><a href="#cb212-300" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">mu1 =</span> mu1, <span class="at">nu =</span> nu, <span class="at">mu2 =</span> mu2, <span class="at">eta =</span> eta)</span>
<span id="cb212-301"><a href="#cb212-301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-302"><a href="#cb212-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-303"><a href="#cb212-303" aria-hidden="true" tabindex="-1"></a>正則化したスコアを求めることができたので，</span>
<span id="cb212-304"><a href="#cb212-304" aria-hidden="true" tabindex="-1"></a>各スコアの両端のカテゴリを取り出し，<span class="in">`con`</span>とする．</span>
<span id="cb212-305"><a href="#cb212-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-308"><a href="#cb212-308" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-309"><a href="#cb212-309" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)], </span>
<span id="cb212-310"><a href="#cb212-310" aria-hidden="true" tabindex="-1"></a>         nu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb212-311"><a href="#cb212-311" aria-hidden="true" tabindex="-1"></a>         mu2<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)], </span>
<span id="cb212-312"><a href="#cb212-312" aria-hidden="true" tabindex="-1"></a>         eta<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)])</span>
<span id="cb212-313"><a href="#cb212-313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-314"><a href="#cb212-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-315"><a href="#cb212-315" aria-hidden="true" tabindex="-1"></a><span class="in">`con`</span>を用いて制約を課す．制約を課す対象となるパラメータは<span class="in">`constrain`</span>で指定する．</span>
<span id="cb212-316"><a href="#cb212-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-319"><a href="#cb212-319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-320"><a href="#cb212-320" aria-hidden="true" tabindex="-1"></a>M6_SE <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb212-321"><a href="#cb212-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb212-322"><a href="#cb212-322" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb212-323"><a href="#cb212-323" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">14</span>,<span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">26</span>,<span class="dv">32</span>,<span class="dv">33</span>,<span class="dv">35</span>), </span>
<span id="cb212-324"><a href="#cb212-324" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrainTo =</span> con,</span>
<span id="cb212-325"><a href="#cb212-325" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> _, </span>
<span id="cb212-326"><a href="#cb212-326" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> poisson, </span>
<span id="cb212-327"><a href="#cb212-327" aria-hidden="true" tabindex="-1"></a>      <span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb212-328"><a href="#cb212-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-329"><a href="#cb212-329" aria-hidden="true" tabindex="-1"></a>M6_SE_coef <span class="ot">&lt;-</span> <span class="fu">tidy</span>(M6_SE)</span>
<span id="cb212-330"><a href="#cb212-330" aria-hidden="true" tabindex="-1"></a>M6_SE_coef <span class="sc">|&gt;</span> <span class="fu">print</span>(<span class="at">n =</span> <span class="cn">Inf</span>)</span>
<span id="cb212-331"><a href="#cb212-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-332"><a href="#cb212-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-333"><a href="#cb212-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-334"><a href="#cb212-334" aria-hidden="true" tabindex="-1"></a>モデル7は少し難しい．モデル7は一貫した制約を課している．このモデルからまず一貫した<span class="in">`polviews`</span>について正則化した場合の値を求める．これが求まったら，次は一貫した制約を課していないモデルに，先ほどの正則化したスコアをRCとRLのそれぞれの部分に適用する．</span>
<span id="cb212-335"><a href="#cb212-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-338"><a href="#cb212-338" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-339"><a href="#cb212-339" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 7</span></span>
<span id="cb212-340"><a href="#cb212-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-341"><a href="#cb212-341" aria-hidden="true" tabindex="-1"></a><span class="co"># 変数と係数と係数の順番を表示</span></span>
<span id="cb212-342"><a href="#cb212-342" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(M7, <span class="st">"[.]polviews"</span>)</span>
<span id="cb212-343"><a href="#cb212-343" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(M7, <span class="st">"[.]fefam"</span>)</span>
<span id="cb212-344"><a href="#cb212-344" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(M7, <span class="st">"[.]natfare"</span>)</span>
<span id="cb212-345"><a href="#cb212-345" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">var =</span> <span class="fu">names</span>(M7<span class="sc">$</span>coefficients),</span>
<span id="cb212-346"><a href="#cb212-346" aria-hidden="true" tabindex="-1"></a>           <span class="at">estimate =</span> M7<span class="sc">$</span>coefficients) <span class="sc">|&gt;</span> </span>
<span id="cb212-347"><a href="#cb212-347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> estimate,</span>
<span id="cb212-348"><a href="#cb212-348" aria-hidden="true" tabindex="-1"></a>         <span class="at">number =</span> <span class="fu">row_number</span>())</span>
<span id="cb212-349"><a href="#cb212-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-350"><a href="#cb212-350" aria-hidden="true" tabindex="-1"></a><span class="co"># mu[i], i = 1 to 7</span></span>
<span id="cb212-351"><a href="#cb212-351" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(<span class="at">model =</span> M7, </span>
<span id="cb212-352"><a href="#cb212-352" aria-hidden="true" tabindex="-1"></a>                   <span class="at">set =</span> <span class="fu">pickCoef</span>(M7, <span class="st">"[.]polviews"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], </span>
<span id="cb212-353"><a href="#cb212-353" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-354"><a href="#cb212-354" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb212-355"><a href="#cb212-355" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb212-356"><a href="#cb212-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-357"><a href="#cb212-357" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)], </span>
<span id="cb212-358"><a href="#cb212-358" aria-hidden="true" tabindex="-1"></a>         mu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)])</span>
<span id="cb212-359"><a href="#cb212-359" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-360"><a href="#cb212-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-361"><a href="#cb212-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-362"><a href="#cb212-362" aria-hidden="true" tabindex="-1"></a>ここでは一貫した制約を課さないモデルを用い，制約で一貫したスコアを割り当てる．そして，制約のない列スコアと層スコアを正則化する．</span>
<span id="cb212-363"><a href="#cb212-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-366"><a href="#cb212-366" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-367"><a href="#cb212-367" aria-hidden="true" tabindex="-1"></a>M7_SE <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb212-368"><a href="#cb212-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb212-369"><a href="#cb212-369" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="sc">+</span> </span>
<span id="cb212-370"><a href="#cb212-370" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb212-371"><a href="#cb212-371" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">26</span><span class="sc">:</span><span class="dv">32</span>), </span>
<span id="cb212-372"><a href="#cb212-372" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrainTo =</span> con,</span>
<span id="cb212-373"><a href="#cb212-373" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> _, </span>
<span id="cb212-374"><a href="#cb212-374" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> poisson, </span>
<span id="cb212-375"><a href="#cb212-375" aria-hidden="true" tabindex="-1"></a>      <span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb212-376"><a href="#cb212-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-377"><a href="#cb212-377" aria-hidden="true" tabindex="-1"></a><span class="co"># nu[j], j = 1 to 4</span></span>
<span id="cb212-378"><a href="#cb212-378" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(<span class="at">model =</span> M7_SE, </span>
<span id="cb212-379"><a href="#cb212-379" aria-hidden="true" tabindex="-1"></a>                   <span class="at">set =</span> <span class="fu">pickCoef</span>(M7_SE, <span class="st">"[.]fefam"</span>), </span>
<span id="cb212-380"><a href="#cb212-380" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-381"><a href="#cb212-381" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb212-382"><a href="#cb212-382" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb212-383"><a href="#cb212-383" aria-hidden="true" tabindex="-1"></a><span class="co"># eta[k], k = 1 to 3</span></span>
<span id="cb212-384"><a href="#cb212-384" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(<span class="at">model =</span> M7_SE, </span>
<span id="cb212-385"><a href="#cb212-385" aria-hidden="true" tabindex="-1"></a>                    <span class="at">set =</span> <span class="fu">pickCoef</span>(M7_SE, <span class="st">"[.]natfare"</span>), </span>
<span id="cb212-386"><a href="#cb212-386" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-387"><a href="#cb212-387" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb212-388"><a href="#cb212-388" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb212-389"><a href="#cb212-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-390"><a href="#cb212-390" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)], </span>
<span id="cb212-391"><a href="#cb212-391" aria-hidden="true" tabindex="-1"></a>         nu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb212-392"><a href="#cb212-392" aria-hidden="true" tabindex="-1"></a>         mu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)], </span>
<span id="cb212-393"><a href="#cb212-393" aria-hidden="true" tabindex="-1"></a>         eta<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)])</span>
<span id="cb212-394"><a href="#cb212-394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-395"><a href="#cb212-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-396"><a href="#cb212-396" aria-hidden="true" tabindex="-1"></a>最後に一貫したスコア（行）と正則化したスコア（列と層）を用いて再度推定を行う．</span>
<span id="cb212-397"><a href="#cb212-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-400"><a href="#cb212-400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-401"><a href="#cb212-401" aria-hidden="true" tabindex="-1"></a>M7_SE <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb212-402"><a href="#cb212-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb212-403"><a href="#cb212-403" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="sc">+</span> </span>
<span id="cb212-404"><a href="#cb212-404" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb212-405"><a href="#cb212-405" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">26</span><span class="sc">:</span><span class="dv">32</span>,<span class="dv">33</span>,<span class="dv">35</span>), </span>
<span id="cb212-406"><a href="#cb212-406" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrainTo =</span> con,</span>
<span id="cb212-407"><a href="#cb212-407" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> _, </span>
<span id="cb212-408"><a href="#cb212-408" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> poisson, </span>
<span id="cb212-409"><a href="#cb212-409" aria-hidden="true" tabindex="-1"></a>      <span class="at">trace =</span> T, </span>
<span id="cb212-410"><a href="#cb212-410" aria-hidden="true" tabindex="-1"></a>      <span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb212-411"><a href="#cb212-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-412"><a href="#cb212-412" aria-hidden="true" tabindex="-1"></a>M7_SE_coef <span class="ot">&lt;-</span> <span class="fu">tidy</span>(M7_SE)</span>
<span id="cb212-413"><a href="#cb212-413" aria-hidden="true" tabindex="-1"></a>M7_SE_coef <span class="sc">|&gt;</span> <span class="fu">print</span>(<span class="at">n =</span> <span class="cn">Inf</span>)</span>
<span id="cb212-414"><a href="#cb212-414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-415"><a href="#cb212-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-416"><a href="#cb212-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-417"><a href="#cb212-417" aria-hidden="true" tabindex="-1"></a>モデル8は<span class="in">`1,1,2,3,3,4,5`</span>という制約があり，結局は<span class="in">`1,2,3,4,5`</span>の5つのパラメータを推定することになる．しかし，あくまで<span class="in">`1,1,2,3,3,4,5`</span>という7つのパラメータにウェイトをかける必要がある．そこで<span class="in">`c(2,1,2,1,1)/7`</span>とすることで，等値制約をかけている部分は平均を2倍にし，<span class="in">`c(2,1,2,1,1)`</span>とすることでウェイトも2倍にしている．</span>
<span id="cb212-418"><a href="#cb212-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-419"><a href="#cb212-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-422"><a href="#cb212-422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-423"><a href="#cb212-423" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 8</span></span>
<span id="cb212-424"><a href="#cb212-424" aria-hidden="true" tabindex="-1"></a><span class="co"># mu[i], i = 1 to 7</span></span>
<span id="cb212-425"><a href="#cb212-425" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(<span class="at">model =</span> M8,</span>
<span id="cb212-426"><a href="#cb212-426" aria-hidden="true" tabindex="-1"></a>                   <span class="at">set =</span> <span class="fu">pickCoef</span>(M8, <span class="st">"[.]polviews.c"</span>),</span>
<span id="cb212-427"><a href="#cb212-427" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ref =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">7</span>,</span>
<span id="cb212-428"><a href="#cb212-428" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleRef =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">7</span>,</span>
<span id="cb212-429"><a href="#cb212-429" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleWeights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb212-430"><a href="#cb212-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-431"><a href="#cb212-431" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(<span class="at">model =</span> M8,</span>
<span id="cb212-432"><a href="#cb212-432" aria-hidden="true" tabindex="-1"></a>                   <span class="at">set =</span> <span class="fu">pickCoef</span>(M8, <span class="st">"[.]polviews.c"</span>),</span>
<span id="cb212-433"><a href="#cb212-433" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ref =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">7</span>,</span>
<span id="cb212-434"><a href="#cb212-434" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleRef =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">7</span>,</span>
<span id="cb212-435"><a href="#cb212-435" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleWeights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb212-436"><a href="#cb212-436" aria-hidden="true" tabindex="-1"></a>mu;mu</span>
<span id="cb212-437"><a href="#cb212-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-438"><a href="#cb212-438" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)], </span>
<span id="cb212-439"><a href="#cb212-439" aria-hidden="true" tabindex="-1"></a>         mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)])</span>
<span id="cb212-440"><a href="#cb212-440" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-441"><a href="#cb212-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-442"><a href="#cb212-442" aria-hidden="true" tabindex="-1"></a>一貫した行スコア（等値制約あり）を指定して再推定．</span>
<span id="cb212-443"><a href="#cb212-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-446"><a href="#cb212-446" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-447"><a href="#cb212-447" aria-hidden="true" tabindex="-1"></a>M8 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> </span>
<span id="cb212-448"><a href="#cb212-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb212-449"><a href="#cb212-449" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="sc">+</span> </span>
<span id="cb212-450"><a href="#cb212-450" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb212-451"><a href="#cb212-451" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">26</span><span class="sc">:</span><span class="dv">32</span>),</span>
<span id="cb212-452"><a href="#cb212-452" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrainTo =</span> con,</span>
<span id="cb212-453"><a href="#cb212-453" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> _, </span>
<span id="cb212-454"><a href="#cb212-454" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> poisson, </span>
<span id="cb212-455"><a href="#cb212-455" aria-hidden="true" tabindex="-1"></a>      <span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb212-456"><a href="#cb212-456" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(M8)</span>
<span id="cb212-457"><a href="#cb212-457" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(M8)</span>
<span id="cb212-458"><a href="#cb212-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-459"><a href="#cb212-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-460"><a href="#cb212-460" aria-hidden="true" tabindex="-1"></a>次は列スコアと層スコアの正則化をおこなう．</span>
<span id="cb212-461"><a href="#cb212-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-464"><a href="#cb212-464" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-465"><a href="#cb212-465" aria-hidden="true" tabindex="-1"></a><span class="co"># nu[j], j = 1 to 4</span></span>
<span id="cb212-466"><a href="#cb212-466" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(<span class="at">model =</span> M8, </span>
<span id="cb212-467"><a href="#cb212-467" aria-hidden="true" tabindex="-1"></a>                   <span class="at">set =</span> <span class="fu">pickCoef</span>(M8, <span class="st">"[.]fefam"</span>), </span>
<span id="cb212-468"><a href="#cb212-468" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-469"><a href="#cb212-469" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb212-470"><a href="#cb212-470" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb212-471"><a href="#cb212-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-472"><a href="#cb212-472" aria-hidden="true" tabindex="-1"></a><span class="co"># eta[k], k = 1 to 3</span></span>
<span id="cb212-473"><a href="#cb212-473" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(<span class="at">model =</span> M8, </span>
<span id="cb212-474"><a href="#cb212-474" aria-hidden="true" tabindex="-1"></a>                    <span class="at">set =</span> <span class="fu">pickCoef</span>(M8, <span class="st">"[.]natfare"</span>), </span>
<span id="cb212-475"><a href="#cb212-475" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-476"><a href="#cb212-476" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb212-477"><a href="#cb212-477" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb212-478"><a href="#cb212-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-479"><a href="#cb212-479" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)], </span>
<span id="cb212-480"><a href="#cb212-480" aria-hidden="true" tabindex="-1"></a>         nu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb212-481"><a href="#cb212-481" aria-hidden="true" tabindex="-1"></a>         mu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)], </span>
<span id="cb212-482"><a href="#cb212-482" aria-hidden="true" tabindex="-1"></a>         eta<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)])</span>
<span id="cb212-483"><a href="#cb212-483" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-484"><a href="#cb212-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-485"><a href="#cb212-485" aria-hidden="true" tabindex="-1"></a>一貫した行スコア（等値制約あり）のすべて，列スコア（最初と最後），層スコア（最初と最後）を指定して再推定．</span>
<span id="cb212-486"><a href="#cb212-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-487"><a href="#cb212-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-490"><a href="#cb212-490" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-491"><a href="#cb212-491" aria-hidden="true" tabindex="-1"></a>M8_SE <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> </span>
<span id="cb212-492"><a href="#cb212-492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb212-493"><a href="#cb212-493" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="sc">+</span> </span>
<span id="cb212-494"><a href="#cb212-494" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb212-495"><a href="#cb212-495" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">26</span><span class="sc">:</span><span class="dv">32</span>,<span class="dv">33</span>,<span class="dv">35</span>), </span>
<span id="cb212-496"><a href="#cb212-496" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrainTo =</span> con,</span>
<span id="cb212-497"><a href="#cb212-497" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> _, </span>
<span id="cb212-498"><a href="#cb212-498" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> poisson, </span>
<span id="cb212-499"><a href="#cb212-499" aria-hidden="true" tabindex="-1"></a>      <span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb212-500"><a href="#cb212-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-501"><a href="#cb212-501" aria-hidden="true" tabindex="-1"></a>M8_SE_coef <span class="ot">&lt;-</span> <span class="fu">tidy</span>(M8_SE)</span>
<span id="cb212-502"><a href="#cb212-502" aria-hidden="true" tabindex="-1"></a>M8_SE_coef <span class="sc">|&gt;</span> <span class="fu">print</span>(<span class="at">n =</span> <span class="cn">Inf</span>)</span>
<span id="cb212-503"><a href="#cb212-503" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-504"><a href="#cb212-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-505"><a href="#cb212-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-506"><a href="#cb212-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-507"><a href="#cb212-507" aria-hidden="true" tabindex="-1"></a>すべてのスコアを列方向に合併し，表3.3を再現．</span>
<span id="cb212-508"><a href="#cb212-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-511"><a href="#cb212-511" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-512"><a href="#cb212-512" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_cols</span>(</span>
<span id="cb212-513"><a href="#cb212-513" aria-hidden="true" tabindex="-1"></a>  M6_SE_coef <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(term, <span class="at">Model6 =</span> estimate),</span>
<span id="cb212-514"><a href="#cb212-514" aria-hidden="true" tabindex="-1"></a>  M7_SE_coef <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">Model7 =</span> estimate),</span>
<span id="cb212-515"><a href="#cb212-515" aria-hidden="true" tabindex="-1"></a>  M8_SE_coef <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">Model8 =</span> estimate)) <span class="sc">|&gt;</span></span>
<span id="cb212-516"><a href="#cb212-516" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"Mult"</span>, term)) <span class="sc">|&gt;</span> </span>
<span id="cb212-517"><a href="#cb212-517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="cn">Inf</span>)</span>
<span id="cb212-518"><a href="#cb212-518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-519"><a href="#cb212-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-520"><a href="#cb212-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-521"><a href="#cb212-521" aria-hidden="true" tabindex="-1"></a><span class="fu">## 表3.4</span></span>
<span id="cb212-522"><a href="#cb212-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-523"><a href="#cb212-523" aria-hidden="true" tabindex="-1"></a>表3.4のデータを入力する．</span>
<span id="cb212-524"><a href="#cb212-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-527"><a href="#cb212-527" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-528"><a href="#cb212-528" aria-hidden="true" tabindex="-1"></a><span class="co"># 表3.1</span></span>
<span id="cb212-529"><a href="#cb212-529" aria-hidden="true" tabindex="-1"></a>Freq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">76</span>, <span class="dv">14</span>, <span class="dv">15</span>,  <span class="dv">4</span>,</span>
<span id="cb212-530"><a href="#cb212-530" aria-hidden="true" tabindex="-1"></a>        <span class="dv">32</span>, <span class="dv">17</span>,  <span class="dv">7</span>,  <span class="dv">3</span>,</span>
<span id="cb212-531"><a href="#cb212-531" aria-hidden="true" tabindex="-1"></a>        <span class="dv">64</span>, <span class="dv">23</span>, <span class="dv">28</span>, <span class="dv">15</span>,</span>
<span id="cb212-532"><a href="#cb212-532" aria-hidden="true" tabindex="-1"></a>        <span class="dv">41</span>, <span class="dv">11</span>, <span class="dv">27</span>, <span class="dv">16</span>,</span>
<span id="cb212-533"><a href="#cb212-533" aria-hidden="true" tabindex="-1"></a>        <span class="dv">15</span>,  <span class="dv">2</span>,  <span class="dv">7</span>,  <span class="dv">4</span>,</span>
<span id="cb212-534"><a href="#cb212-534" aria-hidden="true" tabindex="-1"></a>        <span class="dv">27</span>, <span class="dv">20</span>,  <span class="dv">9</span>,  <span class="dv">5</span>,</span>
<span id="cb212-535"><a href="#cb212-535" aria-hidden="true" tabindex="-1"></a>        <span class="dv">57</span>, <span class="dv">31</span>, <span class="dv">24</span>, <span class="dv">15</span>,</span>
<span id="cb212-536"><a href="#cb212-536" aria-hidden="true" tabindex="-1"></a>        <span class="dv">27</span>,  <span class="dv">9</span>, <span class="dv">22</span>, <span class="dv">16</span>,</span>
<span id="cb212-537"><a href="#cb212-537" aria-hidden="true" tabindex="-1"></a>        <span class="dv">13</span>,  <span class="dv">6</span>, <span class="dv">13</span>,  <span class="dv">5</span>,</span>
<span id="cb212-538"><a href="#cb212-538" aria-hidden="true" tabindex="-1"></a>        <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">10</span>,  <span class="dv">6</span>,</span>
<span id="cb212-539"><a href="#cb212-539" aria-hidden="true" tabindex="-1"></a>        <span class="dv">46</span>, <span class="dv">32</span>, <span class="dv">75</span>, <span class="dv">20</span>,</span>
<span id="cb212-540"><a href="#cb212-540" aria-hidden="true" tabindex="-1"></a>        <span class="dv">54</span>, <span class="dv">26</span>, <span class="dv">58</span>, <span class="dv">55</span>,</span>
<span id="cb212-541"><a href="#cb212-541" aria-hidden="true" tabindex="-1"></a>        <span class="dv">7</span>,  <span class="dv">6</span>,  <span class="dv">7</span>,  <span class="dv">6</span>,</span>
<span id="cb212-542"><a href="#cb212-542" aria-hidden="true" tabindex="-1"></a>        <span class="dv">7</span>,  <span class="dv">2</span>,  <span class="dv">3</span>,  <span class="dv">6</span>,</span>
<span id="cb212-543"><a href="#cb212-543" aria-hidden="true" tabindex="-1"></a>        <span class="dv">12</span>, <span class="dv">11</span>, <span class="dv">31</span>, <span class="dv">15</span>,</span>
<span id="cb212-544"><a href="#cb212-544" aria-hidden="true" tabindex="-1"></a>        <span class="dv">52</span>, <span class="dv">36</span>, <span class="dv">80</span>,<span class="dv">101</span>)</span>
<span id="cb212-545"><a href="#cb212-545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-546"><a href="#cb212-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-547"><a href="#cb212-547" aria-hidden="true" tabindex="-1"></a>行，列，層のカテゴリを入力し，<span class="in">`matrix`</span>で確認する．</span>
<span id="cb212-548"><a href="#cb212-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-551"><a href="#cb212-551" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-552"><a href="#cb212-552" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="dv">4</span>, <span class="dv">16</span>, <span class="dv">64</span>)</span>
<span id="cb212-553"><a href="#cb212-553" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">64</span>)</span>
<span id="cb212-554"><a href="#cb212-554" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">64</span>)</span>
<span id="cb212-555"><a href="#cb212-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-556"><a href="#cb212-556" aria-hidden="true" tabindex="-1"></a><span class="co"># 確認する</span></span>
<span id="cb212-557"><a href="#cb212-557" aria-hidden="true" tabindex="-1"></a>L <span class="sc">|&gt;</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">16</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-558"><a href="#cb212-558" aria-hidden="true" tabindex="-1"></a>R <span class="sc">|&gt;</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">16</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-559"><a href="#cb212-559" aria-hidden="true" tabindex="-1"></a>C <span class="sc">|&gt;</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">16</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-560"><a href="#cb212-560" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-561"><a href="#cb212-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-562"><a href="#cb212-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-563"><a href="#cb212-563" aria-hidden="true" tabindex="-1"></a>以上を<span class="in">`tibble`</span>でまとめ，データを作成する．</span>
<span id="cb212-564"><a href="#cb212-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-567"><a href="#cb212-567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-568"><a href="#cb212-568" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">tibble</span>(Freq, L, R, C) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(L, R, C)</span>
<span id="cb212-569"><a href="#cb212-569" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span></span>
<span id="cb212-570"><a href="#cb212-570" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-571"><a href="#cb212-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-572"><a href="#cb212-572" aria-hidden="true" tabindex="-1"></a>行，列，層について整数スコアを作成する．</span>
<span id="cb212-573"><a href="#cb212-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-576"><a href="#cb212-576" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-577"><a href="#cb212-577" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> </span>
<span id="cb212-578"><a href="#cb212-578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Rscore =</span> <span class="fu">as.numeric</span>(R),</span>
<span id="cb212-579"><a href="#cb212-579" aria-hidden="true" tabindex="-1"></a>         <span class="at">Cscore =</span> <span class="fu">as.numeric</span>(C),</span>
<span id="cb212-580"><a href="#cb212-580" aria-hidden="true" tabindex="-1"></a>         <span class="at">Lscore =</span> <span class="fu">as.numeric</span>(L))</span>
<span id="cb212-581"><a href="#cb212-581" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span></span>
<span id="cb212-582"><a href="#cb212-582" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-583"><a href="#cb212-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-584"><a href="#cb212-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-585"><a href="#cb212-585" aria-hidden="true" tabindex="-1"></a>それではモデル1から15までを用いた推定を行う．ただし<span class="in">`gnm`</span>ではモデル3と5の推定はできない．</span>
<span id="cb212-586"><a href="#cb212-586" aria-hidden="true" tabindex="-1"></a>また</span>
<span id="cb212-587"><a href="#cb212-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-590"><a href="#cb212-590" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-591"><a href="#cb212-591" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1 - Complete Independence</span></span>
<span id="cb212-592"><a href="#cb212-592" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb212-593"><a href="#cb212-593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb212-594"><a href="#cb212-594" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L,</span>
<span id="cb212-595"><a href="#cb212-595" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-596"><a href="#cb212-596" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-597"><a href="#cb212-597" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb212-598"><a href="#cb212-598" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-599"><a href="#cb212-599" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-600"><a href="#cb212-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-601"><a href="#cb212-601" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2 - Unrestricted RC(1)+RL(1)+CL(1)</span></span>
<span id="cb212-602"><a href="#cb212-602" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb212-603"><a href="#cb212-603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb212-604"><a href="#cb212-604" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb212-605"><a href="#cb212-605" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-606"><a href="#cb212-606" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-607"><a href="#cb212-607" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb212-608"><a href="#cb212-608" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-609"><a href="#cb212-609" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-610"><a href="#cb212-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-611"><a href="#cb212-611" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3 - Restricted RC(1)+RL(1)+CL(1) with consistent score</span></span>
<span id="cb212-612"><a href="#cb212-612" aria-hidden="true" tabindex="-1"></a><span class="co"># It may not be fitted with gnm package!</span></span>
<span id="cb212-613"><a href="#cb212-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-614"><a href="#cb212-614" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 4 - Model 2 with consistent cells fitted exactly</span></span>
<span id="cb212-615"><a href="#cb212-615" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb212-616"><a href="#cb212-616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">consistent.cells =</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>((R <span class="sc">==</span> C) <span class="sc">&amp;</span> (C <span class="sc">==</span> L), R, <span class="dv">0</span>)))</span>
<span id="cb212-617"><a href="#cb212-617" aria-hidden="true" tabindex="-1"></a>model4 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb212-618"><a href="#cb212-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb212-619"><a href="#cb212-619" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> consistent.cells <span class="sc">+</span></span>
<span id="cb212-620"><a href="#cb212-620" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb212-621"><a href="#cb212-621" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-622"><a href="#cb212-622" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-623"><a href="#cb212-623" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb212-624"><a href="#cb212-624" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-625"><a href="#cb212-625" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-626"><a href="#cb212-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-627"><a href="#cb212-627" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 5 - Model 3 with consistent cells fitted exactly</span></span>
<span id="cb212-628"><a href="#cb212-628" aria-hidden="true" tabindex="-1"></a><span class="co"># It may not be fitted with gnm package!</span></span>
<span id="cb212-629"><a href="#cb212-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-630"><a href="#cb212-630" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 6 - Full Two-way interaction</span></span>
<span id="cb212-631"><a href="#cb212-631" aria-hidden="true" tabindex="-1"></a>model6 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb212-632"><a href="#cb212-632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb212-633"><a href="#cb212-633" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">*</span> C <span class="sc">+</span> R <span class="sc">*</span> L <span class="sc">+</span> C <span class="sc">*</span> L,</span>
<span id="cb212-634"><a href="#cb212-634" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-635"><a href="#cb212-635" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-636"><a href="#cb212-636" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb212-637"><a href="#cb212-637" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-638"><a href="#cb212-638" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-639"><a href="#cb212-639" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model6)</span>
<span id="cb212-640"><a href="#cb212-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-641"><a href="#cb212-641" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 7 - Model 6 with consistent cells fitted exactly</span></span>
<span id="cb212-642"><a href="#cb212-642" aria-hidden="true" tabindex="-1"></a>model7 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb212-643"><a href="#cb212-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb212-644"><a href="#cb212-644" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">*</span> C <span class="sc">+</span> R <span class="sc">*</span> L <span class="sc">+</span> C <span class="sc">*</span> L <span class="sc">+</span> consistent.cells,</span>
<span id="cb212-645"><a href="#cb212-645" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-646"><a href="#cb212-646" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-647"><a href="#cb212-647" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb212-648"><a href="#cb212-648" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-649"><a href="#cb212-649" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-650"><a href="#cb212-650" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model7)</span>
<span id="cb212-651"><a href="#cb212-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-652"><a href="#cb212-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-653"><a href="#cb212-653" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 8 - Unrestricted uniform and log-multiplicative association in all partial</span></span>
<span id="cb212-654"><a href="#cb212-654" aria-hidden="true" tabindex="-1"></a><span class="co"># association</span></span>
<span id="cb212-655"><a href="#cb212-655" aria-hidden="true" tabindex="-1"></a>model8 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb212-656"><a href="#cb212-656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb212-657"><a href="#cb212-657" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span></span>
<span id="cb212-658"><a href="#cb212-658" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span></span>
<span id="cb212-659"><a href="#cb212-659" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb212-660"><a href="#cb212-660" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb212-661"><a href="#cb212-661" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span></span>
<span id="cb212-662"><a href="#cb212-662" aria-hidden="true" tabindex="-1"></a>      Cscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb212-663"><a href="#cb212-663" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb212-664"><a href="#cb212-664" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-665"><a href="#cb212-665" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-666"><a href="#cb212-666" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb212-667"><a href="#cb212-667" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-668"><a href="#cb212-668" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-669"><a href="#cb212-669" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model8)</span>
<span id="cb212-670"><a href="#cb212-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-671"><a href="#cb212-671" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(model8, <span class="st">"[.]R"</span>)</span>
<span id="cb212-672"><a href="#cb212-672" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(model8, <span class="st">"[.]C"</span>)</span>
<span id="cb212-673"><a href="#cb212-673" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(model8, <span class="st">"[.]L"</span>)</span>
<span id="cb212-674"><a href="#cb212-674" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">var =</span> <span class="fu">names</span>(model8<span class="sc">$</span>coefficients),</span>
<span id="cb212-675"><a href="#cb212-675" aria-hidden="true" tabindex="-1"></a>           <span class="at">estimate =</span> model8<span class="sc">$</span>coefficients) <span class="sc">|&gt;</span> </span>
<span id="cb212-676"><a href="#cb212-676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> estimate,</span>
<span id="cb212-677"><a href="#cb212-677" aria-hidden="true" tabindex="-1"></a>         <span class="at">number =</span> <span class="fu">row_number</span>())</span>
<span id="cb212-678"><a href="#cb212-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-679"><a href="#cb212-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-680"><a href="#cb212-680" aria-hidden="true" tabindex="-1"></a><span class="co"># mu1: 13-16</span></span>
<span id="cb212-681"><a href="#cb212-681" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb212-682"><a href="#cb212-682" aria-hidden="true" tabindex="-1"></a>  model8,</span>
<span id="cb212-683"><a href="#cb212-683" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model8, <span class="st">"[.]R"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb212-684"><a href="#cb212-684" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-685"><a href="#cb212-685" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-686"><a href="#cb212-686" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb212-687"><a href="#cb212-687" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb212-688"><a href="#cb212-688" aria-hidden="true" tabindex="-1"></a>mu1</span>
<span id="cb212-689"><a href="#cb212-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-690"><a href="#cb212-690" aria-hidden="true" tabindex="-1"></a><span class="co"># nu1: 17-20</span></span>
<span id="cb212-691"><a href="#cb212-691" aria-hidden="true" tabindex="-1"></a>nu1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb212-692"><a href="#cb212-692" aria-hidden="true" tabindex="-1"></a>  model8,</span>
<span id="cb212-693"><a href="#cb212-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model8, <span class="st">"[.]C"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb212-694"><a href="#cb212-694" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-695"><a href="#cb212-695" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-696"><a href="#cb212-696" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb212-697"><a href="#cb212-697" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb212-698"><a href="#cb212-698" aria-hidden="true" tabindex="-1"></a>nu1</span>
<span id="cb212-699"><a href="#cb212-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-700"><a href="#cb212-700" aria-hidden="true" tabindex="-1"></a><span class="co"># mu2: 23-26</span></span>
<span id="cb212-701"><a href="#cb212-701" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb212-702"><a href="#cb212-702" aria-hidden="true" tabindex="-1"></a>  model8,</span>
<span id="cb212-703"><a href="#cb212-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model8, <span class="st">"[.]R"</span>)[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb212-704"><a href="#cb212-704" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-705"><a href="#cb212-705" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-706"><a href="#cb212-706" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb212-707"><a href="#cb212-707" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb212-708"><a href="#cb212-708" aria-hidden="true" tabindex="-1"></a>mu2</span>
<span id="cb212-709"><a href="#cb212-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-710"><a href="#cb212-710" aria-hidden="true" tabindex="-1"></a><span class="co"># eta1: 27-30</span></span>
<span id="cb212-711"><a href="#cb212-711" aria-hidden="true" tabindex="-1"></a>eta1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb212-712"><a href="#cb212-712" aria-hidden="true" tabindex="-1"></a>  model8,</span>
<span id="cb212-713"><a href="#cb212-713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model8, <span class="st">"[.]L"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb212-714"><a href="#cb212-714" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-715"><a href="#cb212-715" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-716"><a href="#cb212-716" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb212-717"><a href="#cb212-717" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb212-718"><a href="#cb212-718" aria-hidden="true" tabindex="-1"></a>eta1</span>
<span id="cb212-719"><a href="#cb212-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-720"><a href="#cb212-720" aria-hidden="true" tabindex="-1"></a><span class="co"># nu2: 33-36</span></span>
<span id="cb212-721"><a href="#cb212-721" aria-hidden="true" tabindex="-1"></a>nu2 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb212-722"><a href="#cb212-722" aria-hidden="true" tabindex="-1"></a>  model8,</span>
<span id="cb212-723"><a href="#cb212-723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model8, <span class="st">"[.]C"</span>)[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb212-724"><a href="#cb212-724" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-725"><a href="#cb212-725" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-726"><a href="#cb212-726" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb212-727"><a href="#cb212-727" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb212-728"><a href="#cb212-728" aria-hidden="true" tabindex="-1"></a>nu2</span>
<span id="cb212-729"><a href="#cb212-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-730"><a href="#cb212-730" aria-hidden="true" tabindex="-1"></a><span class="co"># eta2: 37-40</span></span>
<span id="cb212-731"><a href="#cb212-731" aria-hidden="true" tabindex="-1"></a>eta2 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb212-732"><a href="#cb212-732" aria-hidden="true" tabindex="-1"></a>  model8,</span>
<span id="cb212-733"><a href="#cb212-733" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model8, <span class="st">"[.]L"</span>)[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb212-734"><a href="#cb212-734" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-735"><a href="#cb212-735" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-736"><a href="#cb212-736" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb212-737"><a href="#cb212-737" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb212-738"><a href="#cb212-738" aria-hidden="true" tabindex="-1"></a>eta2</span>
<span id="cb212-739"><a href="#cb212-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-740"><a href="#cb212-740" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb212-741"><a href="#cb212-741" aria-hidden="true" tabindex="-1"></a>         nu1<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb212-742"><a href="#cb212-742" aria-hidden="true" tabindex="-1"></a>         mu2<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb212-743"><a href="#cb212-743" aria-hidden="true" tabindex="-1"></a>         eta1<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb212-744"><a href="#cb212-744" aria-hidden="true" tabindex="-1"></a>         nu2<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb212-745"><a href="#cb212-745" aria-hidden="true" tabindex="-1"></a>         eta2<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)])</span>
<span id="cb212-746"><a href="#cb212-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-747"><a href="#cb212-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-748"><a href="#cb212-748" aria-hidden="true" tabindex="-1"></a>model8_se <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb212-749"><a href="#cb212-749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb212-750"><a href="#cb212-750" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span></span>
<span id="cb212-751"><a href="#cb212-751" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span></span>
<span id="cb212-752"><a href="#cb212-752" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb212-753"><a href="#cb212-753" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb212-754"><a href="#cb212-754" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span></span>
<span id="cb212-755"><a href="#cb212-755" aria-hidden="true" tabindex="-1"></a>      Cscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb212-756"><a href="#cb212-756" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb212-757"><a href="#cb212-757" aria-hidden="true" tabindex="-1"></a><span class="co">#    constrain = c(13,16,17,20,23,26,27,30,33,36,37,40),</span></span>
<span id="cb212-758"><a href="#cb212-758" aria-hidden="true" tabindex="-1"></a><span class="co">#    constrainTo = con,</span></span>
<span id="cb212-759"><a href="#cb212-759" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-760"><a href="#cb212-760" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-761"><a href="#cb212-761" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb212-762"><a href="#cb212-762" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-15</span></span>
<span id="cb212-763"><a href="#cb212-763" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-764"><a href="#cb212-764" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model8_se)</span>
<span id="cb212-765"><a href="#cb212-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-766"><a href="#cb212-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-767"><a href="#cb212-767" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="at">factor=</span><span class="st">"contr.treatment"</span>,</span>
<span id="cb212-768"><a href="#cb212-768" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ordered=</span><span class="st">"contr.treatment"</span>))</span>
<span id="cb212-769"><a href="#cb212-769" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 9 - Model 8 with consistent row scores</span></span>
<span id="cb212-770"><a href="#cb212-770" aria-hidden="true" tabindex="-1"></a>model9 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb212-771"><a href="#cb212-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb212-772"><a href="#cb212-772" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span></span>
<span id="cb212-773"><a href="#cb212-773" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span></span>
<span id="cb212-774"><a href="#cb212-774" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C <span class="sc">+</span> L) <span class="sc">+</span></span>
<span id="cb212-775"><a href="#cb212-775" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb212-776"><a href="#cb212-776" aria-hidden="true" tabindex="-1"></a>      Cscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb212-777"><a href="#cb212-777" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb212-778"><a href="#cb212-778" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-779"><a href="#cb212-779" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-780"><a href="#cb212-780" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb212-781"><a href="#cb212-781" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-782"><a href="#cb212-782" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-783"><a href="#cb212-783" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model9)</span>
<span id="cb212-784"><a href="#cb212-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-785"><a href="#cb212-785" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb212-786"><a href="#cb212-786" aria-hidden="true" tabindex="-1"></a>  model9,</span>
<span id="cb212-787"><a href="#cb212-787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model9, <span class="st">"[.]R"</span>),</span>
<span id="cb212-788"><a href="#cb212-788" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-789"><a href="#cb212-789" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-790"><a href="#cb212-790" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb212-791"><a href="#cb212-791" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb212-792"><a href="#cb212-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-793"><a href="#cb212-793" aria-hidden="true" tabindex="-1"></a>nu2 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb212-794"><a href="#cb212-794" aria-hidden="true" tabindex="-1"></a>  model9,</span>
<span id="cb212-795"><a href="#cb212-795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model9, <span class="st">"[.]C"</span>)[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb212-796"><a href="#cb212-796" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-797"><a href="#cb212-797" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-798"><a href="#cb212-798" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb212-799"><a href="#cb212-799" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb212-800"><a href="#cb212-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-801"><a href="#cb212-801" aria-hidden="true" tabindex="-1"></a>eta2 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb212-802"><a href="#cb212-802" aria-hidden="true" tabindex="-1"></a>  model9,</span>
<span id="cb212-803"><a href="#cb212-803" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model9, <span class="st">"[.]L"</span>)[<span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>],</span>
<span id="cb212-804"><a href="#cb212-804" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-805"><a href="#cb212-805" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-806"><a href="#cb212-806" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb212-807"><a href="#cb212-807" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb212-808"><a href="#cb212-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-809"><a href="#cb212-809" aria-hidden="true" tabindex="-1"></a>model9.extended <span class="ot">&lt;-</span></span>
<span id="cb212-810"><a href="#cb212-810" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> <span class="fu">gnm</span>(</span>
<span id="cb212-811"><a href="#cb212-811" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span></span>
<span id="cb212-812"><a href="#cb212-812" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span></span>
<span id="cb212-813"><a href="#cb212-813" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb212-814"><a href="#cb212-814" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb212-815"><a href="#cb212-815" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span></span>
<span id="cb212-816"><a href="#cb212-816" aria-hidden="true" tabindex="-1"></a>      Cscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb212-817"><a href="#cb212-817" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb212-818"><a href="#cb212-818" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">23</span><span class="sc">:</span><span class="dv">26</span>),</span>
<span id="cb212-819"><a href="#cb212-819" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrainTo =</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>]),</span>
<span id="cb212-820"><a href="#cb212-820" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-821"><a href="#cb212-821" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-822"><a href="#cb212-822" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb212-823"><a href="#cb212-823" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-824"><a href="#cb212-824" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-825"><a href="#cb212-825" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model9.extended)</span>
<span id="cb212-826"><a href="#cb212-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-827"><a href="#cb212-827" aria-hidden="true" tabindex="-1"></a>nu1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb212-828"><a href="#cb212-828" aria-hidden="true" tabindex="-1"></a>  model9.extended,</span>
<span id="cb212-829"><a href="#cb212-829" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model9.extended, <span class="st">"[.]C"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb212-830"><a href="#cb212-830" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-831"><a href="#cb212-831" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-832"><a href="#cb212-832" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb212-833"><a href="#cb212-833" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb212-834"><a href="#cb212-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-835"><a href="#cb212-835" aria-hidden="true" tabindex="-1"></a>eta1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb212-836"><a href="#cb212-836" aria-hidden="true" tabindex="-1"></a>    model9.extended,</span>
<span id="cb212-837"><a href="#cb212-837" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pickCoef</span>(model9.extended, <span class="st">"[.]L"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb212-838"><a href="#cb212-838" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-839"><a href="#cb212-839" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-840"><a href="#cb212-840" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb212-841"><a href="#cb212-841" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-842"><a href="#cb212-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-843"><a href="#cb212-843" aria-hidden="true" tabindex="-1"></a>model9.phis <span class="ot">&lt;-</span></span>
<span id="cb212-844"><a href="#cb212-844" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span>  <span class="fu">gnm</span>(</span>
<span id="cb212-845"><a href="#cb212-845" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> </span>
<span id="cb212-846"><a href="#cb212-846" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> </span>
<span id="cb212-847"><a href="#cb212-847" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb212-848"><a href="#cb212-848" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Lscore <span class="sc">+</span> </span>
<span id="cb212-849"><a href="#cb212-849" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span> </span>
<span id="cb212-850"><a href="#cb212-850" aria-hidden="true" tabindex="-1"></a>      Cscore<span class="sc">:</span>Lscore <span class="sc">+</span> </span>
<span id="cb212-851"><a href="#cb212-851" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb212-852"><a href="#cb212-852" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">23</span><span class="sc">:</span><span class="dv">30</span>, <span class="dv">33</span><span class="sc">:</span><span class="dv">40</span>),</span>
<span id="cb212-853"><a href="#cb212-853" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrainTo =</span> <span class="fu">c</span>(</span>
<span id="cb212-854"><a href="#cb212-854" aria-hidden="true" tabindex="-1"></a>      mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>],</span>
<span id="cb212-855"><a href="#cb212-855" aria-hidden="true" tabindex="-1"></a>      nu1<span class="sc">$</span>qvframe[, <span class="dv">1</span>],</span>
<span id="cb212-856"><a href="#cb212-856" aria-hidden="true" tabindex="-1"></a>      mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>],</span>
<span id="cb212-857"><a href="#cb212-857" aria-hidden="true" tabindex="-1"></a>      eta1<span class="sc">$</span>qvframe[, <span class="dv">1</span>],</span>
<span id="cb212-858"><a href="#cb212-858" aria-hidden="true" tabindex="-1"></a>      nu2<span class="sc">$</span>qvframe[, <span class="dv">1</span>],</span>
<span id="cb212-859"><a href="#cb212-859" aria-hidden="true" tabindex="-1"></a>      eta2<span class="sc">$</span>qvframe[, <span class="dv">1</span>]</span>
<span id="cb212-860"><a href="#cb212-860" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb212-861"><a href="#cb212-861" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-862"><a href="#cb212-862" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-863"><a href="#cb212-863" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb212-864"><a href="#cb212-864" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-865"><a href="#cb212-865" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-866"><a href="#cb212-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-867"><a href="#cb212-867" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model9.phis)</span>
<span id="cb212-868"><a href="#cb212-868" aria-hidden="true" tabindex="-1"></a>mu</span>
<span id="cb212-869"><a href="#cb212-869" aria-hidden="true" tabindex="-1"></a>nu1</span>
<span id="cb212-870"><a href="#cb212-870" aria-hidden="true" tabindex="-1"></a>eta1</span>
<span id="cb212-871"><a href="#cb212-871" aria-hidden="true" tabindex="-1"></a>nu2</span>
<span id="cb212-872"><a href="#cb212-872" aria-hidden="true" tabindex="-1"></a>eta2</span>
<span id="cb212-873"><a href="#cb212-873" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model9)</span>
<span id="cb212-874"><a href="#cb212-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-875"><a href="#cb212-875" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 10 - Model 8 with consistent col scores</span></span>
<span id="cb212-876"><a href="#cb212-876" aria-hidden="true" tabindex="-1"></a>model10 <span class="ot">&lt;-</span></span>
<span id="cb212-877"><a href="#cb212-877" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> <span class="fu">gnm</span>(</span>
<span id="cb212-878"><a href="#cb212-878" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> </span>
<span id="cb212-879"><a href="#cb212-879" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> </span>
<span id="cb212-880"><a href="#cb212-880" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, C, R <span class="sc">+</span> L) <span class="sc">+</span></span>
<span id="cb212-881"><a href="#cb212-881" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Lscore <span class="sc">+</span> </span>
<span id="cb212-882"><a href="#cb212-882" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span> </span>
<span id="cb212-883"><a href="#cb212-883" aria-hidden="true" tabindex="-1"></a>      Cscore<span class="sc">:</span>Lscore,</span>
<span id="cb212-884"><a href="#cb212-884" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-885"><a href="#cb212-885" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-886"><a href="#cb212-886" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb212-887"><a href="#cb212-887" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-888"><a href="#cb212-888" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-889"><a href="#cb212-889" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model10)</span>
<span id="cb212-890"><a href="#cb212-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-891"><a href="#cb212-891" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 11 - Model 8 with consistent layer scores</span></span>
<span id="cb212-892"><a href="#cb212-892" aria-hidden="true" tabindex="-1"></a>model11 <span class="ot">&lt;-</span></span>
<span id="cb212-893"><a href="#cb212-893" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> <span class="fu">gnm</span>(</span>
<span id="cb212-894"><a href="#cb212-894" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> </span>
<span id="cb212-895"><a href="#cb212-895" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> </span>
<span id="cb212-896"><a href="#cb212-896" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, L, R <span class="sc">+</span> C) <span class="sc">+</span></span>
<span id="cb212-897"><a href="#cb212-897" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb212-898"><a href="#cb212-898" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb212-899"><a href="#cb212-899" aria-hidden="true" tabindex="-1"></a>      Cscore<span class="sc">:</span>Lscore,</span>
<span id="cb212-900"><a href="#cb212-900" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-901"><a href="#cb212-901" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-902"><a href="#cb212-902" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb212-903"><a href="#cb212-903" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-904"><a href="#cb212-904" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-905"><a href="#cb212-905" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model11)</span>
<span id="cb212-906"><a href="#cb212-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-907"><a href="#cb212-907" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 12 - Modek 9 + U(RL)=U(CL)</span></span>
<span id="cb212-908"><a href="#cb212-908" aria-hidden="true" tabindex="-1"></a><span class="co"># To impose equality constraint on U(RL) &amp; U(CL),</span></span>
<span id="cb212-909"><a href="#cb212-909" aria-hidden="true" tabindex="-1"></a><span class="co"># a covariate is created in following manner:</span></span>
<span id="cb212-910"><a href="#cb212-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-911"><a href="#cb212-911" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span><span class="sc">|&gt;</span> </span>
<span id="cb212-912"><a href="#cb212-912" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cov_rcl =</span> Rscore <span class="sc">*</span> Lscore <span class="sc">+</span> Cscore <span class="sc">*</span> Lscore)</span>
<span id="cb212-913"><a href="#cb212-913" aria-hidden="true" tabindex="-1"></a>model12 <span class="ot">&lt;-</span></span>
<span id="cb212-914"><a href="#cb212-914" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> <span class="fu">gnm</span>(</span>
<span id="cb212-915"><a href="#cb212-915" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> </span>
<span id="cb212-916"><a href="#cb212-916" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> </span>
<span id="cb212-917"><a href="#cb212-917" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C <span class="sc">+</span> L) <span class="sc">+</span></span>
<span id="cb212-918"><a href="#cb212-918" aria-hidden="true" tabindex="-1"></a>      cov_rcl <span class="sc">+</span> </span>
<span id="cb212-919"><a href="#cb212-919" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb212-920"><a href="#cb212-920" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-921"><a href="#cb212-921" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-922"><a href="#cb212-922" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb212-923"><a href="#cb212-923" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-924"><a href="#cb212-924" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-925"><a href="#cb212-925" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(model12)</span></span>
<span id="cb212-926"><a href="#cb212-926" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model12)</span>
<span id="cb212-927"><a href="#cb212-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-928"><a href="#cb212-928" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb212-929"><a href="#cb212-929" aria-hidden="true" tabindex="-1"></a>  model12,</span>
<span id="cb212-930"><a href="#cb212-930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model12, <span class="st">"[.]R"</span>),</span>
<span id="cb212-931"><a href="#cb212-931" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-932"><a href="#cb212-932" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-933"><a href="#cb212-933" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb212-934"><a href="#cb212-934" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb212-935"><a href="#cb212-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-936"><a href="#cb212-936" aria-hidden="true" tabindex="-1"></a>nu2 <span class="ot">&lt;-</span></span>
<span id="cb212-937"><a href="#cb212-937" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getContrasts</span>(</span>
<span id="cb212-938"><a href="#cb212-938" aria-hidden="true" tabindex="-1"></a>    model12,</span>
<span id="cb212-939"><a href="#cb212-939" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pickCoef</span>(model12, <span class="st">"[.]C"</span>)[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb212-940"><a href="#cb212-940" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-941"><a href="#cb212-941" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-942"><a href="#cb212-942" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb212-943"><a href="#cb212-943" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-944"><a href="#cb212-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-945"><a href="#cb212-945" aria-hidden="true" tabindex="-1"></a>eta2 <span class="ot">&lt;-</span></span>
<span id="cb212-946"><a href="#cb212-946" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getContrasts</span>(</span>
<span id="cb212-947"><a href="#cb212-947" aria-hidden="true" tabindex="-1"></a>    model12,</span>
<span id="cb212-948"><a href="#cb212-948" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pickCoef</span>(model12, <span class="st">"[.]L"</span>)[<span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>],</span>
<span id="cb212-949"><a href="#cb212-949" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-950"><a href="#cb212-950" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-951"><a href="#cb212-951" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb212-952"><a href="#cb212-952" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-953"><a href="#cb212-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-954"><a href="#cb212-954" aria-hidden="true" tabindex="-1"></a>model12.extended <span class="ot">&lt;-</span></span>
<span id="cb212-955"><a href="#cb212-955" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb212-956"><a href="#cb212-956" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> </span>
<span id="cb212-957"><a href="#cb212-957" aria-hidden="true" tabindex="-1"></a>        Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> </span>
<span id="cb212-958"><a href="#cb212-958" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb212-959"><a href="#cb212-959" aria-hidden="true" tabindex="-1"></a>        cov_rcl <span class="sc">+</span> </span>
<span id="cb212-960"><a href="#cb212-960" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span> </span>
<span id="cb212-961"><a href="#cb212-961" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb212-962"><a href="#cb212-962" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">23</span><span class="sc">:</span><span class="dv">26</span>),</span>
<span id="cb212-963"><a href="#cb212-963" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrainTo =</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>]),</span>
<span id="cb212-964"><a href="#cb212-964" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> _,</span>
<span id="cb212-965"><a href="#cb212-965" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> poisson,</span>
<span id="cb212-966"><a href="#cb212-966" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb212-967"><a href="#cb212-967" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-968"><a href="#cb212-968" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-969"><a href="#cb212-969" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model12.extended)</span>
<span id="cb212-970"><a href="#cb212-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-971"><a href="#cb212-971" aria-hidden="true" tabindex="-1"></a>nu1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb212-972"><a href="#cb212-972" aria-hidden="true" tabindex="-1"></a>  model12.extended,</span>
<span id="cb212-973"><a href="#cb212-973" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model12.extended, <span class="st">"[.]C"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb212-974"><a href="#cb212-974" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-975"><a href="#cb212-975" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-976"><a href="#cb212-976" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb212-977"><a href="#cb212-977" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb212-978"><a href="#cb212-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-979"><a href="#cb212-979" aria-hidden="true" tabindex="-1"></a>eta1 <span class="ot">&lt;-</span></span>
<span id="cb212-980"><a href="#cb212-980" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getContrasts</span>(</span>
<span id="cb212-981"><a href="#cb212-981" aria-hidden="true" tabindex="-1"></a>    model12.extended,</span>
<span id="cb212-982"><a href="#cb212-982" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pickCoef</span>(model12.extended, <span class="st">"[.]L"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb212-983"><a href="#cb212-983" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-984"><a href="#cb212-984" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-985"><a href="#cb212-985" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb212-986"><a href="#cb212-986" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-987"><a href="#cb212-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-988"><a href="#cb212-988" aria-hidden="true" tabindex="-1"></a>model12.phis <span class="ot">&lt;-</span></span>
<span id="cb212-989"><a href="#cb212-989" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> <span class="fu">gnm</span>(</span>
<span id="cb212-990"><a href="#cb212-990" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb212-991"><a href="#cb212-991" aria-hidden="true" tabindex="-1"></a>      cov_rcl <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb212-992"><a href="#cb212-992" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">23</span><span class="sc">:</span><span class="dv">30</span>, <span class="dv">32</span><span class="sc">:</span><span class="dv">39</span>),</span>
<span id="cb212-993"><a href="#cb212-993" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrainTo =</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], nu1<span class="sc">$</span>qvframe[, <span class="dv">1</span>],</span>
<span id="cb212-994"><a href="#cb212-994" aria-hidden="true" tabindex="-1"></a>                    mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], eta1<span class="sc">$</span>qvframe[, <span class="dv">1</span>], </span>
<span id="cb212-995"><a href="#cb212-995" aria-hidden="true" tabindex="-1"></a>                    nu2<span class="sc">$</span>qvframe[, <span class="dv">1</span>], eta2<span class="sc">$</span>qvframe[, <span class="dv">1</span>]),</span>
<span id="cb212-996"><a href="#cb212-996" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-997"><a href="#cb212-997" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson, </span>
<span id="cb212-998"><a href="#cb212-998" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F, </span>
<span id="cb212-999"><a href="#cb212-999" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb212-1000"><a href="#cb212-1000" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model12.phis)</span>
<span id="cb212-1001"><a href="#cb212-1001" aria-hidden="true" tabindex="-1"></a>mu</span>
<span id="cb212-1002"><a href="#cb212-1002" aria-hidden="true" tabindex="-1"></a>nu1</span>
<span id="cb212-1003"><a href="#cb212-1003" aria-hidden="true" tabindex="-1"></a>eta1</span>
<span id="cb212-1004"><a href="#cb212-1004" aria-hidden="true" tabindex="-1"></a>nu2</span>
<span id="cb212-1005"><a href="#cb212-1005" aria-hidden="true" tabindex="-1"></a>eta2</span>
<span id="cb212-1006"><a href="#cb212-1006" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model12)</span>
<span id="cb212-1007"><a href="#cb212-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1008"><a href="#cb212-1008" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 15</span></span>
<span id="cb212-1009"><a href="#cb212-1009" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span></span>
<span id="cb212-1010"><a href="#cb212-1010" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">cov_rcl =</span> Rscore <span class="sc">*</span> Lscore <span class="sc">+</span> Cscore <span class="sc">*</span> Lscore)</span>
<span id="cb212-1011"><a href="#cb212-1011" aria-hidden="true" tabindex="-1"></a>model15 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span></span>
<span id="cb212-1012"><a href="#cb212-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb212-1013"><a href="#cb212-1013" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, R, C <span class="sc">+</span> L) <span class="sc">+</span> cov_rcl,</span>
<span id="cb212-1014"><a href="#cb212-1014" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-1015"><a href="#cb212-1015" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-1016"><a href="#cb212-1016" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb212-1017"><a href="#cb212-1017" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-1018"><a href="#cb212-1018" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-1019"><a href="#cb212-1019" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model15)</span>
<span id="cb212-1020"><a href="#cb212-1020" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model15)</span>
<span id="cb212-1021"><a href="#cb212-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1022"><a href="#cb212-1022" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb212-1023"><a href="#cb212-1023" aria-hidden="true" tabindex="-1"></a>  model15,</span>
<span id="cb212-1024"><a href="#cb212-1024" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model15, <span class="st">"[.]R"</span>),</span>
<span id="cb212-1025"><a href="#cb212-1025" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-1026"><a href="#cb212-1026" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-1027"><a href="#cb212-1027" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb212-1028"><a href="#cb212-1028" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb212-1029"><a href="#cb212-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1030"><a href="#cb212-1030" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb212-1031"><a href="#cb212-1031" aria-hidden="true" tabindex="-1"></a>  model15,</span>
<span id="cb212-1032"><a href="#cb212-1032" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model15, <span class="st">"[.]C"</span>),</span>
<span id="cb212-1033"><a href="#cb212-1033" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-1034"><a href="#cb212-1034" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-1035"><a href="#cb212-1035" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb212-1036"><a href="#cb212-1036" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb212-1037"><a href="#cb212-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1038"><a href="#cb212-1038" aria-hidden="true" tabindex="-1"></a>model15.extended <span class="ot">&lt;-</span></span>
<span id="cb212-1039"><a href="#cb212-1039" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> <span class="fu">gnm</span>(</span>
<span id="cb212-1040"><a href="#cb212-1040" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> </span>
<span id="cb212-1041"><a href="#cb212-1041" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> </span>
<span id="cb212-1042"><a href="#cb212-1042" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb212-1043"><a href="#cb212-1043" aria-hidden="true" tabindex="-1"></a>      cov_rcl <span class="sc">+</span> </span>
<span id="cb212-1044"><a href="#cb212-1044" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, L),</span>
<span id="cb212-1045"><a href="#cb212-1045" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">23</span><span class="sc">:</span><span class="dv">26</span>),</span>
<span id="cb212-1046"><a href="#cb212-1046" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrainTo =</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>]),</span>
<span id="cb212-1047"><a href="#cb212-1047" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-1048"><a href="#cb212-1048" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-1049"><a href="#cb212-1049" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb212-1050"><a href="#cb212-1050" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-1051"><a href="#cb212-1051" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-1052"><a href="#cb212-1052" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model15.extended)</span>
<span id="cb212-1053"><a href="#cb212-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1054"><a href="#cb212-1054" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">&lt;-</span></span>
<span id="cb212-1055"><a href="#cb212-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getContrasts</span>(</span>
<span id="cb212-1056"><a href="#cb212-1056" aria-hidden="true" tabindex="-1"></a>    model15.extended,</span>
<span id="cb212-1057"><a href="#cb212-1057" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pickCoef</span>(model15.extended, <span class="st">"[.]L"</span>),</span>
<span id="cb212-1058"><a href="#cb212-1058" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-1059"><a href="#cb212-1059" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb212-1060"><a href="#cb212-1060" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb212-1061"><a href="#cb212-1061" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-1062"><a href="#cb212-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1063"><a href="#cb212-1063" aria-hidden="true" tabindex="-1"></a>model15.phis <span class="ot">&lt;-</span></span>
<span id="cb212-1064"><a href="#cb212-1064" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">|&gt;</span> <span class="fu">gnm</span>(</span>
<span id="cb212-1065"><a href="#cb212-1065" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> </span>
<span id="cb212-1066"><a href="#cb212-1066" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> </span>
<span id="cb212-1067"><a href="#cb212-1067" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span> </span>
<span id="cb212-1068"><a href="#cb212-1068" aria-hidden="true" tabindex="-1"></a>      cov_rcl <span class="sc">+</span> </span>
<span id="cb212-1069"><a href="#cb212-1069" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, L),</span>
<span id="cb212-1070"><a href="#cb212-1070" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">23</span><span class="sc">:</span><span class="dv">30</span>),</span>
<span id="cb212-1071"><a href="#cb212-1071" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrainTo =</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], </span>
<span id="cb212-1072"><a href="#cb212-1072" aria-hidden="true" tabindex="-1"></a>                    nu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], </span>
<span id="cb212-1073"><a href="#cb212-1073" aria-hidden="true" tabindex="-1"></a>                    mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], </span>
<span id="cb212-1074"><a href="#cb212-1074" aria-hidden="true" tabindex="-1"></a>                    eta<span class="sc">$</span>qvframe[, <span class="dv">1</span>]),</span>
<span id="cb212-1075"><a href="#cb212-1075" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _,</span>
<span id="cb212-1076"><a href="#cb212-1076" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb212-1077"><a href="#cb212-1077" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb212-1078"><a href="#cb212-1078" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb212-1079"><a href="#cb212-1079" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-1080"><a href="#cb212-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1081"><a href="#cb212-1081" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model15.phis)</span>
<span id="cb212-1082"><a href="#cb212-1082" aria-hidden="true" tabindex="-1"></a>mu</span>
<span id="cb212-1083"><a href="#cb212-1083" aria-hidden="true" tabindex="-1"></a>nu</span>
<span id="cb212-1084"><a href="#cb212-1084" aria-hidden="true" tabindex="-1"></a>eta</span>
<span id="cb212-1085"><a href="#cb212-1085" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model15)</span>
<span id="cb212-1086"><a href="#cb212-1086" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-1087"><a href="#cb212-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1088"><a href="#cb212-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1091"><a href="#cb212-1091" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb212-1092"><a href="#cb212-1092" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">model.summary</span>(model1, <span class="st">"Model 1"</span>),</span>
<span id="cb212-1093"><a href="#cb212-1093" aria-hidden="true" tabindex="-1"></a>          <span class="fu">model.summary</span>(model2, <span class="st">"Model 2"</span>),</span>
<span id="cb212-1094"><a href="#cb212-1094" aria-hidden="true" tabindex="-1"></a>          <span class="fu">model.summary</span>(model4, <span class="st">"Model 4"</span>),</span>
<span id="cb212-1095"><a href="#cb212-1095" aria-hidden="true" tabindex="-1"></a>          <span class="fu">model.summary</span>(model6, <span class="st">"Model 6"</span>),</span>
<span id="cb212-1096"><a href="#cb212-1096" aria-hidden="true" tabindex="-1"></a>          <span class="fu">model.summary</span>(model7, <span class="st">"Model 7"</span>),</span>
<span id="cb212-1097"><a href="#cb212-1097" aria-hidden="true" tabindex="-1"></a>          <span class="fu">model.summary</span>(model8, <span class="st">"Model 8"</span>),</span>
<span id="cb212-1098"><a href="#cb212-1098" aria-hidden="true" tabindex="-1"></a>          <span class="fu">model.summary</span>(model9, <span class="st">"Model 9"</span>),</span>
<span id="cb212-1099"><a href="#cb212-1099" aria-hidden="true" tabindex="-1"></a>          <span class="fu">model.summary</span>(model10, <span class="st">"Model 10"</span>),</span>
<span id="cb212-1100"><a href="#cb212-1100" aria-hidden="true" tabindex="-1"></a>          <span class="fu">model.summary</span>(model11, <span class="st">"Model 11"</span>),</span>
<span id="cb212-1101"><a href="#cb212-1101" aria-hidden="true" tabindex="-1"></a>          <span class="fu">model.summary</span>(model12, <span class="st">"Model 12"</span>),</span>
<span id="cb212-1102"><a href="#cb212-1102" aria-hidden="true" tabindex="-1"></a>          <span class="fu">model.summary</span>(model15, <span class="st">"Model 15"</span>))</span>
<span id="cb212-1103"><a href="#cb212-1103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb212-1104"><a href="#cb212-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1105"><a href="#cb212-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1106"><a href="#cb212-1106" aria-hidden="true" tabindex="-1"></a><span class="fu">## 練習問題 {-}</span></span>
<span id="cb212-1107"><a href="#cb212-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1108"><a href="#cb212-1108" aria-hidden="true" tabindex="-1"></a>**問題3.1** @goodman1979a の表5A，表5B，表5Cの結果を再現しよう．使用するデータは<span class="in">`mentalHealth`</span>のデータである．表5Aのモデルは，(1) Null Association，(2) Uniform Association，(3) Row-Effect Association，(4) Column-Effect Association，(5) Row and Column Effects (I)， (6) Row and Column Effects (II) の6つである．</span>
<span id="cb212-1109"><a href="#cb212-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1110"><a href="#cb212-1110" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>問題3.1.1：@goodman1979a の表5Bの分析（全体効果の分解）を再現する．表5Bではまずモデル (1) と (2) の比較から一般的な効果（General Effect）を求めている．次に，モデル (2) と (5) の比較から，行・列効果を求めている． 他の効果はモデル (5) で示され，全体効果はモデル (1) となる．</span>
<span id="cb212-1111"><a href="#cb212-1111" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>問題3.1.2：@goodman1979a の表5Cの分析（行と列効果の分割）を再現する．モデル  (2) と (3) から行効果が，さらにモデル (3) と (5) から行効果が，そして，モデル (2) と (5) から行・列効果の要素を取り出すことができる．</span>
<span id="cb212-1112"><a href="#cb212-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1113"><a href="#cb212-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1114"><a href="#cb212-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1115"><a href="#cb212-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1116"><a href="#cb212-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1117"><a href="#cb212-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-1118"><a href="#cb212-1118" aria-hidden="true" tabindex="-1"></a><span class="fu">## 参考文献 {-}</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>