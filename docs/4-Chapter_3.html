<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>『カテゴリカルデータのための連関モデル』 - 3&nbsp; 第3章</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./5-Chapter_4.html" rel="next">
<link href="./3-Chapter_2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">第3章</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">『カテゴリカルデータのための連関モデル』</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">はじめに</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1-Introduction.html" class="sidebar-item-text sidebar-link">シリーズ編者による序文</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2-Chapter_1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">第1章</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3-Chapter_2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">第2章</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4-Chapter_3.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">第3章</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5-Chapter_4.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">第4章</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6-Chapter_5.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">第5章</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7-Chapter_6.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">第6章</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8-Note.html" class="sidebar-item-text sidebar-link">補足のノート</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./9-R.html" class="sidebar-item-text sidebar-link">Rのインストールと基本的な操作方法</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#表3.1a" id="toc-表3.1a" class="nav-link active" data-scroll-target="#表3.1a"><span class="toc-section-number">3.1</span>  表3.1A</a></li>
  <li><a href="#表3.2" id="toc-表3.2" class="nav-link" data-scroll-target="#表3.2"><span class="toc-section-number">3.2</span>  表3.2</a></li>
  <li><a href="#表3.3" id="toc-表3.3" class="nav-link" data-scroll-target="#表3.3"><span class="toc-section-number">3.3</span>  表3.3</a></li>
  <li><a href="#表3.4" id="toc-表3.4" class="nav-link" data-scroll-target="#表3.4"><span class="toc-section-number">3.4</span>  表3.4</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">第3章</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>第3章は3元表に対する部分連関モデルを扱う．パッケージは<code>tidyverse</code>（データセットの処理のため），<code>magrittr</code>（パイプ演算子），<code>DescTools</code>（記述統計を求めるため），<code>vcd</code>パッケージ（カテゴリカルデータの分析のため），<code>broom</code>（回帰係数の整理），<code>gnm</code>（連関分析の処理のため）を使用する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'magrittr'

The following object is masked from 'package:purrr':

    set_names

The following object is masked from 'package:tidyr':

    extract</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gnm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>またモデル適合度を表示するための関数をここでも準備しておく．すべて<code>gnm</code>によって推定を行う．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 引数となるobjはgnmの結果</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>model.summary <span class="ot">&lt;-</span> <span class="cf">function</span>(obj, <span class="at">Model =</span> <span class="cn">NULL</span>){</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">class</span>(obj) <span class="sc">==</span> <span class="st">"gnm"</span>) <span class="sc">!=</span> <span class="dv">1</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"estimate with gnm"</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  aic <span class="ot">&lt;-</span> obj<span class="sc">$</span>deviance <span class="sc">-</span> obj<span class="sc">$</span>df <span class="sc">*</span> <span class="dv">2</span> <span class="co"># AIC(L2)</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  bic <span class="ot">&lt;-</span> obj<span class="sc">$</span>deviance <span class="sc">-</span> obj<span class="sc">$</span>df <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">sum</span>(obj<span class="sc">$</span>y)) <span class="co">#BIC(L2)</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  delta <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">abs</span>(obj<span class="sc">$</span>y <span class="sc">-</span> obj<span class="sc">$</span>fitted.values)) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(obj<span class="sc">$</span>y))</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(obj<span class="sc">$</span>deviance, obj<span class="sc">$</span>df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)     <span class="co">#p&lt;-ifelse(p&lt;0.001,"&lt;0.001",p)</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">7</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(Model)){ </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  Model <span class="ot">&lt;-</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(obj))</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Model Description"</span> <span class="ot">=</span> Model,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"df"</span> <span class="ot">=</span> obj<span class="sc">$</span>df,</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"L2"</span> <span class="ot">=</span> obj<span class="sc">$</span>deviance,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">#"AIC(L2)" = aic,</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"BIC"</span> <span class="ot">=</span> bic,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Delta"</span> <span class="ot">=</span> delta,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"p"</span> <span class="ot">=</span> p</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="表3.1a" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="表3.1a"><span class="header-section-number">3.1</span> 表3.1A</h2>
<p>表3.1Aをまずベクトルとして入力する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gnm)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 表3.1</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>Freq <span class="ot">&lt;-</span> <span class="fu">c</span>(  <span class="dv">9</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1</span>,    <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">1</span>,    <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>           <span class="dv">17</span>,<span class="dv">13</span>, <span class="dv">7</span>, <span class="dv">4</span>,   <span class="dv">13</span>,<span class="dv">22</span>, <span class="dv">9</span>, <span class="dv">1</span>,    <span class="dv">7</span>,<span class="dv">13</span>, <span class="dv">6</span>, <span class="dv">2</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>            <span class="dv">8</span>,<span class="dv">14</span>, <span class="dv">6</span>, <span class="dv">0</span>,   <span class="dv">10</span>,<span class="dv">29</span>,<span class="dv">10</span>, <span class="dv">0</span>,    <span class="dv">5</span>,<span class="dv">14</span>, <span class="dv">6</span>, <span class="dv">2</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>           <span class="dv">20</span>,<span class="dv">38</span>,<span class="dv">24</span>, <span class="dv">8</span>,   <span class="dv">23</span>,<span class="dv">72</span>,<span class="dv">34</span>,<span class="dv">10</span>,   <span class="dv">17</span>,<span class="dv">67</span>,<span class="dv">36</span>,<span class="dv">12</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>            <span class="dv">4</span>,<span class="dv">21</span>,<span class="dv">12</span>, <span class="dv">4</span>,    <span class="dv">7</span>,<span class="dv">30</span>, <span class="dv">9</span>, <span class="dv">1</span>,    <span class="dv">9</span>,<span class="dv">19</span>,<span class="dv">14</span>, <span class="dv">2</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">3</span>,    <span class="dv">1</span>,<span class="dv">16</span>,<span class="dv">19</span>, <span class="dv">2</span>,   <span class="dv">11</span>,<span class="dv">28</span>,<span class="dv">28</span>,<span class="dv">11</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">0</span>,    <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>,    <span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>次に行変数，列変数，層変数を入力する．<code>gl(n = 水準数, k = 繰り返しの数, length = 長さ)</code>を注意しながら設定する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>polviews <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="at">n =</span> <span class="dv">7</span>, <span class="at">k =</span> <span class="dv">4</span><span class="sc">*</span><span class="dv">3</span>, <span class="at">length =</span> <span class="fu">length</span>(Freq))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>fefam <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="at">n =</span> <span class="dv">4</span>, <span class="at">k =</span> <span class="dv">1</span>, <span class="at">length =</span> <span class="fu">length</span>(Freq))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>natfare <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="at">n =</span> <span class="dv">3</span>, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">length =</span> <span class="fu">length</span>(Freq))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>対応しているのかを確認したければ，matrix形式で示すとよい．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(polviews, <span class="at">nrow =</span> <span class="dv">7</span>, <span class="at">ncol =</span> <span class="dv">12</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
[1,] "1"  "1"  "1"  "1"  "1"  "1"  "1"  "1"  "1"  "1"   "1"   "1"  
[2,] "2"  "2"  "2"  "2"  "2"  "2"  "2"  "2"  "2"  "2"   "2"   "2"  
[3,] "3"  "3"  "3"  "3"  "3"  "3"  "3"  "3"  "3"  "3"   "3"   "3"  
[4,] "4"  "4"  "4"  "4"  "4"  "4"  "4"  "4"  "4"  "4"   "4"   "4"  
[5,] "5"  "5"  "5"  "5"  "5"  "5"  "5"  "5"  "5"  "5"   "5"   "5"  
[6,] "6"  "6"  "6"  "6"  "6"  "6"  "6"  "6"  "6"  "6"   "6"   "6"  
[7,] "7"  "7"  "7"  "7"  "7"  "7"  "7"  "7"  "7"  "7"   "7"   "7"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(fefam, <span class="at">nrow =</span> <span class="dv">7</span>, <span class="at">ncol =</span> <span class="dv">12</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
[1,] "1"  "2"  "3"  "4"  "1"  "2"  "3"  "4"  "1"  "2"   "3"   "4"  
[2,] "1"  "2"  "3"  "4"  "1"  "2"  "3"  "4"  "1"  "2"   "3"   "4"  
[3,] "1"  "2"  "3"  "4"  "1"  "2"  "3"  "4"  "1"  "2"   "3"   "4"  
[4,] "1"  "2"  "3"  "4"  "1"  "2"  "3"  "4"  "1"  "2"   "3"   "4"  
[5,] "1"  "2"  "3"  "4"  "1"  "2"  "3"  "4"  "1"  "2"   "3"   "4"  
[6,] "1"  "2"  "3"  "4"  "1"  "2"  "3"  "4"  "1"  "2"   "3"   "4"  
[7,] "1"  "2"  "3"  "4"  "1"  "2"  "3"  "4"  "1"  "2"   "3"   "4"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(natfare, <span class="at">nrow =</span> <span class="dv">7</span>, <span class="at">ncol =</span> <span class="dv">12</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
[1,] "1"  "1"  "1"  "1"  "2"  "2"  "2"  "2"  "3"  "3"   "3"   "3"  
[2,] "1"  "1"  "1"  "1"  "2"  "2"  "2"  "2"  "3"  "3"   "3"   "3"  
[3,] "1"  "1"  "1"  "1"  "2"  "2"  "2"  "2"  "3"  "3"   "3"   "3"  
[4,] "1"  "1"  "1"  "1"  "2"  "2"  "2"  "2"  "3"  "3"   "3"   "3"  
[5,] "1"  "1"  "1"  "1"  "2"  "2"  "2"  "2"  "3"  "3"   "3"   "3"  
[6,] "1"  "1"  "1"  "1"  "2"  "2"  "2"  "2"  "3"  "3"   "3"   "3"  
[7,] "1"  "1"  "1"  "1"  "2"  "2"  "2"  "2"  "3"  "3"   "3"   "3"  </code></pre>
</div>
</div>
<p>tableのデータ（<code>tab_3.1</code>）とセルを単位としたデータ（<code>freq_tab_3.1</code>）を作成する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">tibble</span>(Freq, polviews, fefam, natfare)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>表3.2のモデルで推定を行う．モデル6から8まではスコアパラメータの正則化が必要であるが，適合度については問題なく求めることができる．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1 - 独立モデル</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2 - 完全2元交互作用モデル</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>M2 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> polviews <span class="sc">*</span> fefam <span class="sc">+</span> fefam <span class="sc">*</span> natfare <span class="sc">+</span> polviews <span class="sc">*</span> natfare,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3 - 条件付き独立 (polviews)</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>M3 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> polviews <span class="sc">*</span> fefam <span class="sc">+</span> polviews <span class="sc">*</span> natfare,</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 4 - 条件付き独立 (fefam)</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>M4 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> polviews <span class="sc">*</span> fefam <span class="sc">+</span> fefam <span class="sc">*</span> natfare,</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 5 - 条件付き独立 (natfare)</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>M5 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> fefam <span class="sc">*</span> natfare <span class="sc">+</span> polviews <span class="sc">*</span> natfare,</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 6 - RC(1)+RL(1) 部分連関</span></span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a><span class="co"># 値の正則化が必要</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>M6 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="sc">+</span> </span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.....................................................
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 7 - RC(1)+RL(1) 部分連関 (一貫した行スコア - polviews)</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 値の正則化が必要</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>M7 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, fefam <span class="sc">+</span> natfare),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations...............................................
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 8 - RC(1)+RL(1) 部分連関 (一貫した行スコア - polviews)</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 行スコアへの等値制約</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 値の正則化が必要</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 等値制約をかけたいセルの水準を同じにする</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span> </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">polviews.c =</span> <span class="fu">case_when</span>(polviews <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>,  <span class="co"># mu1 = mu2</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                                polviews <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">1</span>,  <span class="co"># mu1 = mu2</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                                polviews <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                                polviews <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">3</span>,  <span class="co"># mu4 = mu5</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>                                polviews <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="dv">3</span>,  <span class="co"># mu4 = mu5</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>                                polviews <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                                polviews <span class="sc">==</span> <span class="dv">7</span> <span class="sc">~</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>           <span class="fu">factor</span>())</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>M8 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, polviews.c, fefam <span class="sc">+</span> natfare),</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.....................................................
Done</code></pre>
</div>
</div>
</section>
<section id="表3.2" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="表3.2"><span class="header-section-number">3.2</span> 表3.2</h2>
<p>表3.2を再現する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 表3.2</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># リストを作成</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># モデルの適合度をリストに順に格納</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M1, <span class="st">"1. Complete independence"</span>) </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M2, <span class="st">"2. Full two-way interaction"</span>) </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">3</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M3, <span class="st">"3. Conditional independence on POLVIEWS"</span>) </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">4</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M4, <span class="st">"4. Conditional independence on FEFAM"</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">5</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M5, <span class="st">"5. Conditional independence on NATFARE"</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">6</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M6, <span class="st">"6. RC(1) + RL(1) partial association"</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">7</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M7, <span class="st">"7. Model 6 plus consisitent row (POLVIEWS) score restrictions"</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>M[[<span class="dv">8</span>]] <span class="ot">&lt;-</span> <span class="fu">model.summary</span>(M8, <span class="st">"8. Model 6 plus consisitent and equality restrictions on row (POLVIEWS) scores (mu_1 = mu_2, mu_4 = mu_5)"</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co"># リストを行方向に合併する</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>M <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 6
  `Model Description`                               df    L2   BIC Delta       p
  &lt;chr&gt;                                          &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
1 1. Complete independence                          72 168.  -324. 14.1  1.37e-9
2 2. Full two-way interaction                       36  35.4 -211.  5.72 4.99e-1
3 3. Conditional independence on POLVIEWS           42  47.3 -240.  7.30 2.67e-1
4 4. Conditional independence on FEFAM              48  87.3 -241. 10.3  4.50e-4
5 5. Conditional independence on NATFARE            54  91.0 -278. 10.1  1.21e-3
6 6. RC(1) + RL(1) partial association              57  68.6 -321.  8.83 1.40e-1
7 7. Model 6 plus consisitent row (POLVIEWS) sc…    62  72.8 -351.  9.07 1.65e-1
8 8. Model 6 plus consisitent and equality rest…    64  73.6 -364.  9.21 1.93e-1</code></pre>
</div>
</div>
</section>
<section id="表3.3" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="表3.3"><span class="header-section-number">3.3</span> 表3.3</h2>
<p>表3.3を再現するために，モデル6から8までのスコアパラメータの正則化を行う．</p>
<p>まずはモデル6である．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimating standard error</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 6</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 変数と係数と係数の順番を表示</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(M6, <span class="st">"[.]polviews"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Mult(1, ., fefam).polviews1   Mult(1, ., fefam).polviews2 
                           14                            15 
  Mult(1, ., fefam).polviews3   Mult(1, ., fefam).polviews4 
                           16                            17 
  Mult(1, ., fefam).polviews5   Mult(1, ., fefam).polviews6 
                           18                            19 
  Mult(1, ., fefam).polviews7 Mult(1, ., natfare).polviews1 
                           20                            26 
Mult(1, ., natfare).polviews2 Mult(1, ., natfare).polviews3 
                           27                            28 
Mult(1, ., natfare).polviews4 Mult(1, ., natfare).polviews5 
                           29                            30 
Mult(1, ., natfare).polviews6 Mult(1, ., natfare).polviews7 
                           31                            32 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(M6, <span class="st">"[.]fefam"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mult(1, polviews, .).fefam1 Mult(1, polviews, .).fefam2 
                         21                          22 
Mult(1, polviews, .).fefam3 Mult(1, polviews, .).fefam4 
                         23                          24 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(M6, <span class="st">"[.]natfare"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mult(1, polviews, .).natfare1 Mult(1, polviews, .).natfare2 
                           33                            34 
Mult(1, polviews, .).natfare3 
                           35 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">var =</span> <span class="fu">names</span>(M6<span class="sc">$</span>coefficients),</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">estimate =</span> M6<span class="sc">$</span>coefficients) <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> estimate,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">number =</span> <span class="fu">row_number</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                        var    estimate number
(Intercept)                                     (Intercept)  0.48028108      1
polviews2                                         polviews2  1.07528328      2
polviews3                                         polviews3  1.03111488      3
polviews4                                         polviews4  2.35033006      4
polviews5                                         polviews5  1.34028362      5
polviews6                                         polviews6  1.26612566      6
polviews7                                         polviews7 -0.10862326      7
fefam2                                               fefam2  0.97484817      8
fefam3                                               fefam3  0.42172690      9
fefam4                                               fefam4 -0.88755370     10
natfare2                                           natfare2  0.36108325     11
natfare3                                           natfare3  0.32348750     12
Mult(., polviews, fefam).         Mult(., polviews, fefam). -0.52183803     13
Mult(1, ., fefam).polviews1     Mult(1, ., fefam).polviews1 -1.10060947     14
Mult(1, ., fefam).polviews2     Mult(1, ., fefam).polviews2 -3.05554561     15
Mult(1, ., fefam).polviews3     Mult(1, ., fefam).polviews3 -2.38936639     16
Mult(1, ., fefam).polviews4     Mult(1, ., fefam).polviews4  0.18691832     17
Mult(1, ., fefam).polviews5     Mult(1, ., fefam).polviews5 -0.17670280     18
Mult(1, ., fefam).polviews6     Mult(1, ., fefam).polviews6  3.36240974     19
Mult(1, ., fefam).polviews7     Mult(1, ., fefam).polviews7  5.14311695     20
Mult(1, polviews, .).fefam1     Mult(1, polviews, .).fefam1  0.34140773     21
Mult(1, polviews, .).fefam2     Mult(1, polviews, .).fefam2  0.08456312     22
Mult(1, polviews, .).fefam3     Mult(1, polviews, .).fefam3 -0.17958561     23
Mult(1, polviews, .).fefam4     Mult(1, polviews, .).fefam4 -0.34061403     24
Mult(., polviews, natfare).     Mult(., polviews, natfare). -3.05679148     25
Mult(1, ., natfare).polviews1 Mult(1, ., natfare).polviews1 -0.92667766     26
Mult(1, ., natfare).polviews2 Mult(1, ., natfare).polviews2 -0.45726242     27
Mult(1, ., natfare).polviews3 Mult(1, ., natfare).polviews3 -0.29119363     28
Mult(1, ., natfare).polviews4 Mult(1, ., natfare).polviews4  0.02512600     29
Mult(1, ., natfare).polviews5 Mult(1, ., natfare).polviews5 -0.13829150     30
Mult(1, ., natfare).polviews6 Mult(1, ., natfare).polviews6  0.65961766     31
Mult(1, ., natfare).polviews7 Mult(1, ., natfare).polviews7  0.66256887     32
Mult(1, polviews, .).natfare1 Mult(1, polviews, .).natfare1  0.23088727     33
Mult(1, polviews, .).natfare2 Mult(1, polviews, .).natfare2  0.07258268     34
Mult(1, polviews, .).natfare3 Mult(1, polviews, .).natfare3 -0.26870064     35</code></pre>
</div>
</div>
<p>各スコアの両端のカテゴリ，つまり上記推定値のリストの 14,20,21,24,26,32,33,35番目の8つの値についてスコアを求め，固定する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R POLVIEWS mu1[i], i = 1 to 7</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(M6, <span class="fu">pickCoef</span>(M6, <span class="st">"fefam)[.]polviews"</span>),</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># C FEFAM nu[j], j = 1 to 4</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(M6, <span class="fu">pickCoef</span>(M6, <span class="st">"[.]fefam"</span>), </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co"># R POLVIEWS mu2[i], i = 1 to 7</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(M6, <span class="fu">pickCoef</span>(M6, <span class="st">"natfare)[.]polviews"</span>), </span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co"># L NATFARE eta[k], k = 1 to 3</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(M6, <span class="fu">pickCoef</span>(M6, <span class="st">"[.]natfare"</span>), </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 確認 </span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">mu1 =</span> mu1, <span class="at">nu =</span> nu, <span class="at">mu2 =</span> mu2, <span class="at">eta =</span> eta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$mu1
                               Estimate Std. Error
Mult(1, ., fefam).polviews1 -0.18890704 0.17539812
Mult(1, ., fefam).polviews2 -0.45611586 0.11238050
Mult(1, ., fefam).polviews3 -0.36505971 0.11498236
Mult(1, ., fefam).polviews4 -0.01292237 0.08199631
Mult(1, ., fefam).polviews5 -0.06262362 0.11058185
Mult(1, ., fefam).polviews6  0.42111705 0.12367540
Mult(1, ., fefam).polviews7  0.66451154 0.10976226

$nu
                              Estimate Std. Error
Mult(1, polviews, .).fefam1  0.7026886 0.06444123
Mult(1, polviews, .).fefam2  0.2081705 0.09371704
Mult(1, polviews, .).fefam3 -0.3004108 0.10956493
Mult(1, polviews, .).fefam4 -0.6104483 0.09158453

$mu2
                                 Estimate Std. Error
Mult(1, ., natfare).polviews1 -0.60584367 0.12394769
Mult(1, ., natfare).polviews2 -0.27518966 0.11469790
Mult(1, ., natfare).polviews3 -0.15821154 0.11316687
Mult(1, ., natfare).polviews4  0.06460260 0.07187236
Mult(1, ., natfare).polviews5 -0.05050796 0.10030828
Mult(1, ., natfare).polviews6  0.51153570 0.10405220
Mult(1, ., natfare).polviews7  0.51361453 0.12512860

$eta
                                Estimate Std. Error
Mult(1, polviews, .).natfare1  0.6073482 0.07616839
Mult(1, polviews, .).natfare2  0.1689209 0.11149916
Mult(1, polviews, .).natfare3 -0.7762692 0.03533078</code></pre>
</div>
</div>
<p>正則化したスコアを求めることができたので， 各スコアの両端のカテゴリを取り出し，<code>con</code>とする．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)], </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>         nu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>         mu2<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)], </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>         eta<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>con</code>を用いて制約を課す．制約のあるパラメータは<code>constrain</code>で指定する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>M6_SE <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">14</span>,<span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">26</span>,<span class="dv">32</span>,<span class="dv">33</span>,<span class="dv">35</span>), </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrainTo =</span> con,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> ., </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> poisson, </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations..................................................
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>M6_SE_coef <span class="ot">&lt;-</span> <span class="fu">summary</span>(M6_SE) <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coefficients</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Variable"</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>M6_SE_coef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Variable    Estimate Std..Error     z.value
1                    (Intercept)  0.49061305  0.2714613  1.80730399
2                      polviews2  1.03462096  0.2286800  4.52431800
3                      polviews3  0.99275852  0.2260565  4.39163963
4                      polviews4  2.33243766  0.2118135 11.01174909
5                      polviews5  1.32371069  0.2178840  6.07530027
6                      polviews6  1.26479125  0.2817072  4.48973712
7                      polviews7 -0.08817192  0.3550448 -0.24834026
8                         fefam2  1.01257263  0.1875433  5.39913927
9                         fefam3  0.49824862  0.3404100  1.46367194
10                        fefam4 -0.78738067  0.4491457 -1.75306289
11                      natfare2  0.32886127  0.1265360  2.59895340
12                      natfare3  0.22179929  0.3142052  0.70590598
13     Mult(., polviews, fefam). -1.98292236  0.7444158 -2.66372963
14   Mult(1, ., fefam).polviews1 -0.18890704         NA          NA
15   Mult(1, ., fefam).polviews2 -0.45611586  0.3084481 -1.47874449
16   Mult(1, ., fefam).polviews3 -0.36505971  0.2850040 -1.28089339
17   Mult(1, ., fefam).polviews4 -0.01292237  0.1836908 -0.07034845
18   Mult(1, ., fefam).polviews5 -0.06262362  0.2116102 -0.29593861
19   Mult(1, ., fefam).polviews6  0.42111705  0.2048749  2.05548422
20   Mult(1, ., fefam).polviews7  0.66451154         NA          NA
21   Mult(1, polviews, .).fefam1  0.70268861         NA          NA
22   Mult(1, polviews, .).fefam2  0.20817046  0.1521823  1.36790202
23   Mult(1, polviews, .).fefam3 -0.30041075  0.1850933 -1.62302311
24   Mult(1, polviews, .).fefam4 -0.61044832         NA          NA
25   Mult(., polviews, natfare). -1.56691378  0.4052719 -3.86632725
26 Mult(1, ., natfare).polviews1 -0.60584367         NA          NA
27 Mult(1, ., natfare).polviews2 -0.27518966  0.1998376 -1.37706660
28 Mult(1, ., natfare).polviews3 -0.15821154  0.1910651 -0.82805039
29 Mult(1, ., natfare).polviews4  0.06460260  0.1559375  0.41428510
30 Mult(1, ., natfare).polviews5 -0.05050796  0.1767772 -0.28571539
31 Mult(1, ., natfare).polviews6  0.51153570  0.2109300  2.42514436
32 Mult(1, ., natfare).polviews7  0.51361453         NA          NA
33 Mult(1, polviews, .).natfare1  0.60734824         NA          NA
34 Mult(1, polviews, .).natfare2  0.16892093  0.1747273  0.96676884
35 Mult(1, polviews, .).natfare3 -0.77626917         NA          NA
       Pr...z..
1  7.071489e-02
2  6.059057e-06
3  1.124990e-05
4  3.354276e-28
5  1.237559e-09
6  7.131113e-06
7  8.038712e-01
8  6.696138e-08
9  1.432836e-01
10 7.959121e-02
11 9.350847e-03
12 4.802466e-01
13 7.727965e-03
14           NA
15 1.392086e-01
16 2.002311e-01
17 9.439163e-01
18 7.672770e-01
19 3.983226e-02
20           NA
21           NA
22 1.713427e-01
23 1.045845e-01
24           NA
25 1.104867e-04
26           NA
27 1.684917e-01
28 4.076420e-01
29 6.786653e-01
30 7.750961e-01
31 1.530230e-02
32           NA
33           NA
34 3.336596e-01
35           NA</code></pre>
</div>
</div>
<p>モデル7はすこし難しい．モデル7は一貫した制約を課している．このモデルからまず一貫した<code>polviews</code>について正則化した場合の値を求める．これが求まったら，次は一貫した制約を課していないモデルに，先ほどの正則化したスコアをRCとRLのそれぞれの部分に適用する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 7</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 変数と係数と係数の順番を表示</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(M7, <span class="st">"[.]polviews"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mult(1, ., fefam + natfare).polviews1 Mult(1, ., fefam + natfare).polviews2 
                                   14                                    15 
Mult(1, ., fefam + natfare).polviews3 Mult(1, ., fefam + natfare).polviews4 
                                   16                                    17 
Mult(1, ., fefam + natfare).polviews5 Mult(1, ., fefam + natfare).polviews6 
                                   18                                    19 
Mult(1, ., fefam + natfare).polviews7 
                                   20 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(M7, <span class="st">"[.]fefam"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mult(1, polviews, . + natfare).fefam1 Mult(1, polviews, . + natfare).fefam2 
                                   21                                    22 
Mult(1, polviews, . + natfare).fefam3 Mult(1, polviews, . + natfare).fefam4 
                                   23                                    24 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(M7, <span class="st">"[.]natfare"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mult(1, polviews, fefam + .).natfare2 Mult(1, polviews, fefam + .).natfare3 
                                   25                                    26 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">var =</span> <span class="fu">names</span>(M7<span class="sc">$</span>coefficients),</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">estimate =</span> M7<span class="sc">$</span>coefficients) <span class="sc">%&gt;%</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> estimate,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">number =</span> <span class="fu">row_number</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                        var
(Intercept)                                                     (Intercept)
polviews2                                                         polviews2
polviews3                                                         polviews3
polviews4                                                         polviews4
polviews5                                                         polviews5
polviews6                                                         polviews6
polviews7                                                         polviews7
fefam2                                                               fefam2
fefam3                                                               fefam3
fefam4                                                               fefam4
natfare2                                                           natfare2
natfare3                                                           natfare3
Mult(., polviews, fefam + natfare).     Mult(., polviews, fefam + natfare).
Mult(1, ., fefam + natfare).polviews1 Mult(1, ., fefam + natfare).polviews1
Mult(1, ., fefam + natfare).polviews2 Mult(1, ., fefam + natfare).polviews2
Mult(1, ., fefam + natfare).polviews3 Mult(1, ., fefam + natfare).polviews3
Mult(1, ., fefam + natfare).polviews4 Mult(1, ., fefam + natfare).polviews4
Mult(1, ., fefam + natfare).polviews5 Mult(1, ., fefam + natfare).polviews5
Mult(1, ., fefam + natfare).polviews6 Mult(1, ., fefam + natfare).polviews6
Mult(1, ., fefam + natfare).polviews7 Mult(1, ., fefam + natfare).polviews7
Mult(1, polviews, . + natfare).fefam1 Mult(1, polviews, . + natfare).fefam1
Mult(1, polviews, . + natfare).fefam2 Mult(1, polviews, . + natfare).fefam2
Mult(1, polviews, . + natfare).fefam3 Mult(1, polviews, . + natfare).fefam3
Mult(1, polviews, . + natfare).fefam4 Mult(1, polviews, . + natfare).fefam4
Mult(1, polviews, fefam + .).natfare2 Mult(1, polviews, fefam + .).natfare2
Mult(1, polviews, fefam + .).natfare3 Mult(1, polviews, fefam + .).natfare3
                                         estimate number
(Intercept)                            0.58771546      1
polviews2                              1.05435427      2
polviews3                              0.98327932      3
polviews4                              2.20715522      4
polviews5                              1.21772723      5
polviews6                              0.99121392      6
polviews7                             -0.42056287      7
fefam2                                 1.00381867      8
fefam3                                 0.47293397      9
fefam4                                -0.81546982     10
natfare2                               0.35473297     11
natfare3                               0.32663974     12
Mult(., polviews, fefam + natfare).    2.47458837     13
Mult(1, ., fefam + natfare).polviews1  0.69577146     14
Mult(1, ., fefam + natfare).polviews2  0.65211417     15
Mult(1, ., fefam + natfare).polviews3  0.46381434     16
Mult(1, ., fefam + natfare).polviews4 -0.01402750     17
Mult(1, ., fefam + natfare).polviews5  0.11981334     18
Mult(1, ., fefam + natfare).polviews6 -0.76680878     19
Mult(1, ., fefam + natfare).polviews7 -0.93864536     20
Mult(1, polviews, . + natfare).fefam1  0.48635026     21
Mult(1, polviews, . + natfare).fefam2  0.21472060     22
Mult(1, polviews, . + natfare).fefam3 -0.01679354     23
Mult(1, polviews, . + natfare).fefam4 -0.15799648     24
Mult(1, polviews, fefam + .).natfare2 -0.13428834     25
Mult(1, polviews, fefam + .).natfare3 -0.49270145     26</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mu[i], i = 1 to 7</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(M7, <span class="fu">pickCoef</span>(M7, <span class="st">"[.]polviews"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)], </span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>         mu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>ここでは一貫した制約を課さないモデルを用い，制約で一貫したスコアを割り当てる．そして，制約のない列スコアと層スコアを正則化する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>M7_SE <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="sc">+</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">26</span><span class="sc">:</span><span class="dv">32</span>), </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrainTo =</span> con,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> ., </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> poisson, </span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations...
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nu[j], j = 1 to 4</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(M7_SE, </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">pickCoef</span>(M7_SE, <span class="st">"[.]fefam"</span>), </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># eta[k], k = 1 to 3</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(M7_SE, </span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">pickCoef</span>(M7_SE, <span class="st">"[.]natfare"</span>), </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)], </span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>         nu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>         mu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)], </span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>         eta<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>最後に一貫したスコア（行）と正則化したスコア（列と層）を用いて再度推定を行う．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>M7_SE <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="sc">+</span> </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">26</span><span class="sc">:</span><span class="dv">32</span>,<span class="dv">33</span>,<span class="dv">35</span>), </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrainTo =</span> con,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> ., </span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> poisson, </span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">trace =</span> T, </span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Initial Deviance = 181.495042
Running start-up iterations
Start-up iteration 1. Deviance = 74.295705
Start-up iteration 2. Deviance = 72.902097
Running main iterations
Iteration 1. Deviance = 72.773888
Iteration 2. Deviance = 72.773834
Iteration 3. Deviance = 72.773834
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>M7_SE_coef <span class="ot">&lt;-</span> <span class="fu">summary</span>(M7_SE) <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coefficients</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Variable"</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>M7_SE_coef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Variable    Estimate Std..Error    z.value     Pr...z..
1                    (Intercept)  0.49666511 0.19953839  2.4890704 1.280776e-02
2                      polviews2  1.06271894 0.18389893  5.7788206 7.522608e-09
3                      polviews3  1.02772195 0.18956295  5.4215339 5.908980e-08
4                      polviews4  2.34315159 0.19992980 11.7198714 1.008250e-31
5                      polviews5  1.32807991 0.20159537  6.5878491 4.462438e-11
6                      polviews6  1.27144201 0.28745747  4.4230613 9.731214e-06
7                      polviews7 -0.10741116 0.33836457 -0.3174421 7.509082e-01
8                         fefam2  0.98345843 0.09473194 10.3814869 3.010493e-25
9                         fefam3  0.43522039 0.10374979  4.1949037 2.729875e-05
10                        fefam4 -0.86376740 0.14958265 -5.7745158 7.717469e-09
11                      natfare2  0.34466727 0.08525038  4.0429996 5.277172e-05
12                      natfare3  0.28970887 0.08687606  3.3347378 8.537987e-04
13     Mult(., polviews, fefam). -1.94985651 0.37444868 -5.2072730 1.916361e-07
14   Mult(1, ., fefam).polviews1  0.41258265         NA         NA           NA
15   Mult(1, ., fefam).polviews2  0.38551616         NA         NA           NA
16   Mult(1, ., fefam).polviews3  0.26877471         NA         NA           NA
17   Mult(1, ., fefam).polviews4 -0.02747595         NA         NA           NA
18   Mult(1, ., fefam).polviews5  0.05550221         NA         NA           NA
19   Mult(1, ., fefam).polviews6 -0.49418258         NA         NA           NA
20   Mult(1, ., fefam).polviews7 -0.60071720         NA         NA           NA
21   Mult(1, polviews, .).fefam1 -0.72624699         NA         NA           NA
22   Mult(1, polviews, .).fefam2 -0.17021171 0.14950096 -1.1385325 2.548982e-01
23   Mult(1, polviews, .).fefam3  0.30370570 0.18912635  1.6058350 1.083102e-01
24   Mult(1, polviews, .).fefam4  0.59275300         NA         NA           NA
25   Mult(., polviews, natfare).  1.43774015 0.22609189  6.3590965 2.029439e-10
26 Mult(1, ., natfare).polviews1  0.41258265         NA         NA           NA
27 Mult(1, ., natfare).polviews2  0.38551616         NA         NA           NA
28 Mult(1, ., natfare).polviews3  0.26877471         NA         NA           NA
29 Mult(1, ., natfare).polviews4 -0.02747595         NA         NA           NA
30 Mult(1, ., natfare).polviews5  0.05550221         NA         NA           NA
31 Mult(1, ., natfare).polviews6 -0.49418258         NA         NA           NA
32 Mult(1, ., natfare).polviews7 -0.60071720         NA         NA           NA
33 Mult(1, polviews, .).natfare1  0.58021189         NA         NA           NA
34 Mult(1, polviews, .).natfare2  0.20740348 0.18571219  1.1168006 2.640796e-01
35 Mult(1, polviews, .).natfare3 -0.78761536         NA         NA           NA</code></pre>
</div>
</div>
<p>モデル8は<code>1,1,2,3,3,4,5</code>という制約があり，結局は<code>1,2,3,4,5</code>の5つのパラメータを推定することになる．しかし，あくまで<code>1,1,2,3,3,4,5</code>という7つのパラメータにウェイトをかける必要がある．そこで<code>c(2,1,2,1,1)/7</code>とすることで，等値制約をかけている部分は平均を2倍にし，<code>c(2,1,2,1,1)</code>とすることでウェイトも2倍にしている．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 8</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mu[i], i = 1 to 7</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(M8, </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">pickCoef</span>(M8, <span class="st">"[.]polviews.c"</span>),</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ref =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">/</span><span class="dv">7</span>, </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleRef =</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">/</span><span class="dv">7</span>,</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleWeights=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(M8,</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">pickCoef</span>(M8, <span class="st">"[.]polviews.c"</span>),</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ref =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">/</span><span class="dv">7</span>, </span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleRef =</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">/</span><span class="dv">7</span>,</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleWeights=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>mu;mu</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                            Estimate Std. Error
Mult(1, ., fefam + natfare).polviews.c1  0.402725149 0.04298356
Mult(1, ., fefam + natfare).polviews.c2  0.278981096 0.08172199
Mult(1, ., fefam + natfare).polviews.c3  0.001961895 0.04688021
Mult(1, ., fefam + natfare).polviews.c4 -0.491602614 0.08428340
Mult(1, ., fefam + natfare).polviews.c5 -0.596752569 0.08715205</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                            Estimate Std. Error
Mult(1, ., fefam + natfare).polviews.c1  0.402725149 0.04298356
Mult(1, ., fefam + natfare).polviews.c2  0.278981096 0.08172199
Mult(1, ., fefam + natfare).polviews.c3  0.001961895 0.04688021
Mult(1, ., fefam + natfare).polviews.c4 -0.491602614 0.08428340
Mult(1, ., fefam + natfare).polviews.c5 -0.596752569 0.08715205</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)], mu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>一貫した行スコア（等値制約あり）を指定して再推定．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>M8 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="sc">+</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">26</span><span class="sc">:</span><span class="dv">32</span>),</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrainTo =</span> con,</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> ., </span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> poisson, </span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations...
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ polviews + fefam + natfare + Mult(1, polviews, 
    fefam) + Mult(1, polviews, natfare), constrain = c(14:20, 
    26:32), constrainTo = con, family = poisson, data = ., tolerance = 1e-12)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.09613  -0.69364  -0.06107   0.52149   2.13382  

Coefficients:
                               Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                    0.486046         NA      NA       NA    
polviews2                      1.047319   0.183771   5.699 1.20e-08 ***
polviews3                      1.017626         NA      NA       NA    
polviews4                      2.335725         NA      NA       NA    
polviews5                      1.329649         NA      NA       NA    
polviews6                      1.272240         NA      NA       NA    
polviews7                     -0.103640         NA      NA       NA    
fefam2                         0.993418   0.095568  10.395  &lt; 2e-16 ***
fefam3                         0.451237   0.104313   4.326 1.52e-05 ***
fefam4                        -0.839900   0.148980  -5.638 1.72e-08 ***
natfare2                       0.345798   0.085610   4.039 5.36e-05 ***
natfare3                       0.302261   0.086847   3.480 0.000501 ***
Mult(., polviews, fefam).     -0.485028         NA      NA       NA    
Mult(1, ., fefam).polviews1    0.402725         NA      NA       NA    
Mult(1, ., fefam).polviews2    0.402725         NA      NA       NA    
Mult(1, ., fefam).polviews3    0.278981         NA      NA       NA    
Mult(1, ., fefam).polviews4    0.001962         NA      NA       NA    
Mult(1, ., fefam).polviews5    0.001962         NA      NA       NA    
Mult(1, ., fefam).polviews6   -0.491603         NA      NA       NA    
Mult(1, ., fefam).polviews7   -0.596753         NA      NA       NA    
Mult(1, polviews, .).fefam1   -2.689282         NA      NA       NA    
Mult(1, polviews, .).fefam2   -0.406698         NA      NA       NA    
Mult(1, polviews, .).fefam3    1.496520         NA      NA       NA    
Mult(1, polviews, .).fefam4    2.574806         NA      NA       NA    
Mult(., polviews, natfare).    2.029067         NA      NA       NA    
Mult(1, ., natfare).polviews1  0.402725         NA      NA       NA    
Mult(1, ., natfare).polviews2  0.402725         NA      NA       NA    
Mult(1, ., natfare).polviews3  0.278981         NA      NA       NA    
Mult(1, ., natfare).polviews4  0.001962         NA      NA       NA    
Mult(1, ., natfare).polviews5  0.001962         NA      NA       NA    
Mult(1, ., natfare).polviews6 -0.491603         NA      NA       NA    
Mult(1, ., natfare).polviews7 -0.596753         NA      NA       NA    
Mult(1, polviews, .).natfare1  0.464177         NA      NA       NA    
Mult(1, polviews, .).natfare2  0.222365         NA      NA       NA    
Mult(1, polviews, .).natfare3 -0.482864         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 73.594 on 67 degrees of freedom
AIC: 411.62

Number of iterations: 3</code></pre>
</div>
</div>
<p>次は列スコアと層スコアの正則化をおこなう．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nu[j], j = 1 to 4</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(M8, </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">pickCoef</span>(M8, <span class="st">"[.]fefam"</span>), </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co"># eta[k], k = 1 to 3</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(M8, </span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">pickCoef</span>(M8, <span class="st">"[.]natfare"</span>), </span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleRef =</span> <span class="st">"mean"</span>, </span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scaleWeights =</span> <span class="st">"unit"</span>)</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)], </span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>         nu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>         mu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)], </span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>         eta<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>一貫した行スコア（等値制約あり）のすべて，列スコア（最初と最後），層スコア（最初と最後）を指定して再推定．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>M8_SE <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> polviews <span class="sc">+</span> fefam <span class="sc">+</span> natfare <span class="sc">+</span> </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="sc">+</span> </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">26</span><span class="sc">:</span><span class="dv">32</span>,<span class="dv">33</span>,<span class="dv">35</span>), </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrainTo =</span> con,</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> ., </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> poisson, </span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations....
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>M8_SE_coef <span class="ot">&lt;-</span> <span class="fu">summary</span>(M8_SE) <span class="sc">%&gt;%</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coefficients</span>() <span class="sc">%&gt;%</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Variable"</span>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>M8_SE_coef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Variable     Estimate Std..Error    z.value
1                    (Intercept)  0.493895139 0.19859016  2.4870071
2                      polviews2  1.047318994 0.18377141  5.6990313
3                      polviews3  1.015213949 0.18866665  5.3809931
4                      polviews4  2.327913419 0.19476832 11.9522182
5                      polviews5  1.321837383 0.20673745  6.3937976
6                      polviews6  1.254808219 0.28561174  4.3934056
7                      polviews7 -0.123120652 0.33655821 -0.3658228
8                         fefam2  0.993417594 0.09556828 10.3948467
9                         fefam3  0.451236835 0.10431337  4.3257815
10                        fefam4 -0.839899708 0.14897993 -5.6376702
11                      natfare2  0.345798040 0.08561002  4.0392239
12                      natfare3  0.302261247 0.08684722  3.4803790
13     Mult(., polviews, fefam). -1.941869008 0.37449253 -5.1853344
14   Mult(1, ., fefam).polviews1  0.402725149         NA         NA
15   Mult(1, ., fefam).polviews2  0.402725149         NA         NA
16   Mult(1, ., fefam).polviews3  0.278981096         NA         NA
17   Mult(1, ., fefam).polviews4  0.001961895         NA         NA
18   Mult(1, ., fefam).polviews5  0.001961895         NA         NA
19   Mult(1, ., fefam).polviews6 -0.491602614         NA         NA
20   Mult(1, ., fefam).polviews7 -0.596752569         NA         NA
21   Mult(1, polviews, .).fefam1 -0.732615689         NA         NA
22   Mult(1, polviews, .).fefam2 -0.162486357 0.14986223 -1.0842382
23   Mult(1, polviews, .).fefam3  0.312887371 0.19082765  1.6396333
24   Mult(1, polviews, .).fefam4  0.582214676         NA         NA
25   Mult(., polviews, natfare).  1.411968172 0.22580482  6.2530472
26 Mult(1, ., natfare).polviews1  0.402725149         NA         NA
27 Mult(1, ., natfare).polviews2  0.402725149         NA         NA
28 Mult(1, ., natfare).polviews3  0.278981096         NA         NA
29 Mult(1, ., natfare).polviews4  0.001961895         NA         NA
30 Mult(1, ., natfare).polviews5  0.001961895         NA         NA
31 Mult(1, ., natfare).polviews6 -0.491602614         NA         NA
32 Mult(1, ., natfare).polviews7 -0.596752569         NA         NA
33 Mult(1, polviews, .).natfare1  0.569479796         NA         NA
34 Mult(1, polviews, .).natfare2  0.221984457 0.18989352  1.1689943
35 Mult(1, polviews, .).natfare3 -0.791464253         NA         NA
       Pr...z..
1  1.288228e-02
2  1.204901e-08
3  7.407603e-08
4  6.321508e-33
5  1.618156e-10
6  1.115886e-05
7  7.144973e-01
8  2.617075e-25
9  1.519920e-05
10 1.723662e-08
11 5.362835e-05
12 5.007049e-04
13 2.156276e-07
14           NA
15           NA
16           NA
17           NA
18           NA
19           NA
20           NA
21           NA
22 2.782592e-01
23 1.010814e-01
24           NA
25 4.025205e-10
26           NA
27           NA
28           NA
29           NA
30           NA
31           NA
32           NA
33           NA
34 2.424059e-01
35           NA</code></pre>
</div>
</div>
<p>すべてのスコアを列方向に合併し，表3.3を再現．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_cols</span>(</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>M6_SE_coef <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(Variable, <span class="at">Model6 =</span> Estimate),</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>M7_SE_coef <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">Model7 =</span> Estimate),</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>M8_SE_coef <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">Model8 =</span> Estimate)) <span class="sc">%&gt;%</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"Mult"</span>,Variable))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Variable      Model6      Model7       Model8
1      Mult(., polviews, fefam). -1.98292236 -1.94985651 -1.941869008
2    Mult(1, ., fefam).polviews1 -0.18890704  0.41258265  0.402725149
3    Mult(1, ., fefam).polviews2 -0.45611586  0.38551616  0.402725149
4    Mult(1, ., fefam).polviews3 -0.36505971  0.26877471  0.278981096
5    Mult(1, ., fefam).polviews4 -0.01292237 -0.02747595  0.001961895
6    Mult(1, ., fefam).polviews5 -0.06262362  0.05550221  0.001961895
7    Mult(1, ., fefam).polviews6  0.42111705 -0.49418258 -0.491602614
8    Mult(1, ., fefam).polviews7  0.66451154 -0.60071720 -0.596752569
9    Mult(1, polviews, .).fefam1  0.70268861 -0.72624699 -0.732615689
10   Mult(1, polviews, .).fefam2  0.20817046 -0.17021171 -0.162486357
11   Mult(1, polviews, .).fefam3 -0.30041075  0.30370570  0.312887371
12   Mult(1, polviews, .).fefam4 -0.61044832  0.59275300  0.582214676
13   Mult(., polviews, natfare). -1.56691378  1.43774015  1.411968172
14 Mult(1, ., natfare).polviews1 -0.60584367  0.41258265  0.402725149
15 Mult(1, ., natfare).polviews2 -0.27518966  0.38551616  0.402725149
16 Mult(1, ., natfare).polviews3 -0.15821154  0.26877471  0.278981096
17 Mult(1, ., natfare).polviews4  0.06460260 -0.02747595  0.001961895
18 Mult(1, ., natfare).polviews5 -0.05050796  0.05550221  0.001961895
19 Mult(1, ., natfare).polviews6  0.51153570 -0.49418258 -0.491602614
20 Mult(1, ., natfare).polviews7  0.51361453 -0.60071720 -0.596752569
21 Mult(1, polviews, .).natfare1  0.60734824  0.58021189  0.569479796
22 Mult(1, polviews, .).natfare2  0.16892093  0.20740348  0.221984457
23 Mult(1, polviews, .).natfare3 -0.77626917 -0.78761536 -0.791464253</code></pre>
</div>
</div>
</section>
<section id="表3.4" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="表3.4"><span class="header-section-number">3.4</span> 表3.4</h2>
<p>表3.4のデータを入力する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 表3.1</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>Freq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">76</span>, <span class="dv">14</span>, <span class="dv">15</span>,  <span class="dv">4</span>,</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>        <span class="dv">32</span>, <span class="dv">17</span>,  <span class="dv">7</span>,  <span class="dv">3</span>,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>        <span class="dv">64</span>, <span class="dv">23</span>, <span class="dv">28</span>, <span class="dv">15</span>,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>        <span class="dv">41</span>, <span class="dv">11</span>, <span class="dv">27</span>, <span class="dv">16</span>,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>        <span class="dv">15</span>,  <span class="dv">2</span>,  <span class="dv">7</span>,  <span class="dv">4</span>,</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>        <span class="dv">27</span>, <span class="dv">20</span>,  <span class="dv">9</span>,  <span class="dv">5</span>,</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>        <span class="dv">57</span>, <span class="dv">31</span>, <span class="dv">24</span>, <span class="dv">15</span>,</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>        <span class="dv">27</span>,  <span class="dv">9</span>, <span class="dv">22</span>, <span class="dv">16</span>,</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>        <span class="dv">13</span>,  <span class="dv">6</span>, <span class="dv">13</span>,  <span class="dv">5</span>,</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>        <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">10</span>,  <span class="dv">6</span>,</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>        <span class="dv">46</span>, <span class="dv">32</span>, <span class="dv">75</span>, <span class="dv">20</span>,</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>        <span class="dv">54</span>, <span class="dv">26</span>, <span class="dv">58</span>, <span class="dv">55</span>,</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>        <span class="dv">7</span>,  <span class="dv">6</span>,  <span class="dv">7</span>,  <span class="dv">6</span>,</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>        <span class="dv">7</span>,  <span class="dv">2</span>,  <span class="dv">3</span>,  <span class="dv">6</span>,</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>        <span class="dv">12</span>, <span class="dv">11</span>, <span class="dv">31</span>, <span class="dv">15</span>,</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>        <span class="dv">52</span>, <span class="dv">36</span>, <span class="dv">80</span>,<span class="dv">101</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>行，列，層のカテゴリを入力し，<code>matrix</code>で確認する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="dv">4</span>, <span class="dv">16</span>, <span class="dv">64</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">64</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">64</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 確認する</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>L <span class="sc">%&gt;%</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">16</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2] [,3] [,4]
 [1,] "1"  "1"  "1"  "1" 
 [2,] "1"  "1"  "1"  "1" 
 [3,] "1"  "1"  "1"  "1" 
 [4,] "1"  "1"  "1"  "1" 
 [5,] "2"  "2"  "2"  "2" 
 [6,] "2"  "2"  "2"  "2" 
 [7,] "2"  "2"  "2"  "2" 
 [8,] "2"  "2"  "2"  "2" 
 [9,] "3"  "3"  "3"  "3" 
[10,] "3"  "3"  "3"  "3" 
[11,] "3"  "3"  "3"  "3" 
[12,] "3"  "3"  "3"  "3" 
[13,] "4"  "4"  "4"  "4" 
[14,] "4"  "4"  "4"  "4" 
[15,] "4"  "4"  "4"  "4" 
[16,] "4"  "4"  "4"  "4" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>R <span class="sc">%&gt;%</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">16</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2] [,3] [,4]
 [1,] "1"  "1"  "1"  "1" 
 [2,] "2"  "2"  "2"  "2" 
 [3,] "3"  "3"  "3"  "3" 
 [4,] "4"  "4"  "4"  "4" 
 [5,] "1"  "1"  "1"  "1" 
 [6,] "2"  "2"  "2"  "2" 
 [7,] "3"  "3"  "3"  "3" 
 [8,] "4"  "4"  "4"  "4" 
 [9,] "1"  "1"  "1"  "1" 
[10,] "2"  "2"  "2"  "2" 
[11,] "3"  "3"  "3"  "3" 
[12,] "4"  "4"  "4"  "4" 
[13,] "1"  "1"  "1"  "1" 
[14,] "2"  "2"  "2"  "2" 
[15,] "3"  "3"  "3"  "3" 
[16,] "4"  "4"  "4"  "4" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>C <span class="sc">%&gt;%</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">16</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2] [,3] [,4]
 [1,] "1"  "2"  "3"  "4" 
 [2,] "1"  "2"  "3"  "4" 
 [3,] "1"  "2"  "3"  "4" 
 [4,] "1"  "2"  "3"  "4" 
 [5,] "1"  "2"  "3"  "4" 
 [6,] "1"  "2"  "3"  "4" 
 [7,] "1"  "2"  "3"  "4" 
 [8,] "1"  "2"  "3"  "4" 
 [9,] "1"  "2"  "3"  "4" 
[10,] "1"  "2"  "3"  "4" 
[11,] "1"  "2"  "3"  "4" 
[12,] "1"  "2"  "3"  "4" 
[13,] "1"  "2"  "3"  "4" 
[14,] "1"  "2"  "3"  "4" 
[15,] "1"  "2"  "3"  "4" 
[16,] "1"  "2"  "3"  "4" </code></pre>
</div>
</div>
<p>以上を<code>tibble</code>でまとめ，データを作成する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">tibble</span>(Freq, L, R, C) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(L, R, C)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 64 × 4
    Freq L     R     C    
   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;
 1    76 1     1     1    
 2    14 1     1     2    
 3    15 1     1     3    
 4     4 1     1     4    
 5    32 1     2     1    
 6    17 1     2     2    
 7     7 1     2     3    
 8     3 1     2     4    
 9    64 1     3     1    
10    23 1     3     2    
# ℹ 54 more rows</code></pre>
</div>
</div>
<p>行，列，層について整数スコアを作成する．</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span> </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Rscore =</span> <span class="fu">as.numeric</span>(R),</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">Cscore =</span> <span class="fu">as.numeric</span>(C),</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Lscore =</span> <span class="fu">as.numeric</span>(L))</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 64 × 7
    Freq L     R     C     Rscore Cscore Lscore
   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1    76 1     1     1          1      1      1
 2    14 1     1     2          1      2      1
 3    15 1     1     3          1      3      1
 4     4 1     1     4          1      4      1
 5    32 1     2     1          2      1      1
 6    17 1     2     2          2      2      1
 7     7 1     2     3          2      3      1
 8     3 1     2     4          2      4      1
 9    64 1     3     1          3      1      1
10    23 1     3     2          3      2      1
# ℹ 54 more rows</code></pre>
</div>
</div>
<p>それではモデル1から15までを用いた推定を行う．ただし<code>gnm</code>ではモデル3と5の推定はできない． また</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1 - Complete Independence</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L,</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2 - Unrestricted RC(1)+RL(1)+CL(1)</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
....................................................
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3 - Restricted RC(1)+RL(1)+CL(1) with consistent score</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="co"># It may not be fitted with gnm package!</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 4 - Model 2 with consistent cells fitted exactly</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">consistent.cells =</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>((R <span class="sc">==</span> C) <span class="sc">&amp;</span> (C <span class="sc">==</span> L), R, <span class="dv">0</span>)))</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>model4 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> consistent.cells <span class="sc">+</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations........................................
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 5 - Model 3 with consistent cells fitted exactly</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co"># It may not be fitted with gnm package!</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 6 - Full Two-way interaction</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>model6 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">*</span> C <span class="sc">+</span> R <span class="sc">*</span> L <span class="sc">+</span> C <span class="sc">*</span> L,</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R * C + R * L + C * L, family = poisson, 
    data = ., tolerance = 1e-12, trace = F)

Deviance Residuals: 
      Min         1Q     Median         3Q        Max  
-1.685582  -0.504109  -0.008581   0.460359   1.299438  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  4.26029    0.11066  38.499  &lt; 2e-16 ***
R2          -0.79606    0.18519  -4.299 1.72e-05 ***
R3          -0.09579    0.14996  -0.639  0.52299    
R4          -0.43476    0.16083  -2.703  0.00687 ** 
C2          -1.63953    0.22829  -7.182 6.89e-13 ***
C3          -1.39351    0.20261  -6.878 6.08e-12 ***
C4          -2.33707    0.28019  -8.341  &lt; 2e-16 ***
R2:C2        0.90120    0.28232   3.192  0.00141 ** 
R3:C2        0.63274    0.25192   2.512  0.01202 *  
R4:C2        0.33707    0.26138   1.290  0.19719    
R2:C3       -0.06534    0.29098  -0.225  0.82232    
R3:C3        0.66917    0.22004   3.041  0.00236 ** 
R4:C3        0.60286    0.22215   2.714  0.00665 ** 
R2:C4        0.34284    0.36220   0.947  0.34388    
R3:C4        0.56412    0.29673   1.901  0.05729 .  
R4:C4        1.27643    0.28261   4.517 6.29e-06 ***
L2          -1.48502    0.22186  -6.694 2.18e-11 ***
L3          -1.52970    0.20833  -7.343 2.10e-13 ***
L4          -2.08728    0.24553  -8.501  &lt; 2e-16 ***
R2:L2        1.34634    0.28170   4.779 1.76e-06 ***
R3:L2        1.28703    0.24739   5.203 1.97e-07 ***
R4:L2        1.03853    0.26517   3.916 8.99e-05 ***
R2:L3        0.67005    0.28444   2.356  0.01849 *  
R3:L3        1.21742    0.22757   5.350 8.81e-08 ***
R4:L3        1.59671    0.23321   6.847 7.56e-12 ***
R2:L4        0.17240    0.35528   0.485  0.62750    
R3:L4        0.61348    0.27149   2.260  0.02384 *  
R4:L4        2.16906    0.25643   8.459  &lt; 2e-16 ***
C2:L2        0.35033    0.21463   1.632  0.10263    
C3:L2        0.22827    0.20862   1.094  0.27389    
C4:L2        0.49174    0.25839   1.903  0.05703 .  
C2:L3        0.65539    0.20819   3.148  0.00164 ** 
C3:L3        1.09826    0.18400   5.969 2.39e-09 ***
C4:L3        1.11150    0.23123   4.807 1.53e-06 ***
C2:L4        0.87747    0.23892   3.673  0.00024 ***
C3:L4        1.29956    0.20753   6.262 3.80e-10 ***
C4:L4        1.79692    0.23862   7.530 5.06e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Residual deviance: 28.998 on 27 degrees of freedom
AIC: 397.32

Number of iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 7 - Model 6 with consistent cells fitted exactly</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>model7 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">*</span> C <span class="sc">+</span> R <span class="sc">*</span> L <span class="sc">+</span> C <span class="sc">*</span> L <span class="sc">+</span> consistent.cells,</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R * C + R * L + C * L + consistent.cells, 
    family = poisson, data = ., tolerance = 1e-12, trace = F)

Deviance Residuals: 
       Min          1Q      Median          3Q         Max  
-1.505e+00  -4.123e-01  -1.490e-08   3.008e-01   1.562e+00  

Coefficients:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        3.70806    0.31642  11.719  &lt; 2e-16 ***
R2                -0.26471    0.33752  -0.784 0.432870    
R3                 0.43595    0.31473   1.385 0.166007    
R4                 0.04506    0.31538   0.143 0.886401    
C2                -1.23787    0.31573  -3.921 8.83e-05 ***
C3                -0.95472    0.29544  -3.232 0.001231 ** 
C4                -2.00687    0.35086  -5.720 1.07e-08 ***
R2:C2              0.49806    0.36012   1.383 0.166653    
R3:C2              0.33263    0.30439   1.093 0.274482    
R4:C2              0.02956    0.30915   0.096 0.923826    
R2:C3             -0.37252    0.33538  -1.111 0.266684    
R3:C3              0.21202    0.29412   0.721 0.470997    
R4:C3              0.33724    0.27290   1.236 0.216553    
R2:C4              0.06257    0.39636   0.158 0.874574    
R3:C4              0.29993    0.33550   0.894 0.371334    
R4:C4              1.06332    0.33951   3.132 0.001737 ** 
L2                -1.05809    0.31923  -3.314 0.000918 ***
L3                -1.09080    0.29894  -3.649 0.000263 ***
L4                -1.74115    0.32163  -5.413 6.18e-08 ***
R2:L2              0.91597    0.36361   2.519 0.011766 *  
R3:L2              0.93125    0.31450   2.961 0.003066 ** 
R4:L2              0.67771    0.32813   2.065 0.038888 *  
R2:L3              0.33649    0.33467   1.005 0.314694    
R3:L3              0.75119    0.30376   2.473 0.013399 *  
R4:L3              1.28290    0.29072   4.413 1.02e-05 ***
R2:L4             -0.12414    0.39162  -0.317 0.751243    
R3:L4              0.33826    0.31651   1.069 0.285199    
R4:L4              1.91005    0.31369   6.089 1.14e-09 ***
C2:L2              0.17440    0.24791   0.704 0.481744    
C3:L2              0.12343    0.21731   0.568 0.570049    
C4:L2              0.38519    0.26377   1.460 0.144196    
C2:L3              0.54622    0.21620   2.526 0.011522 *  
C3:L3              0.78217    0.22762   3.436 0.000590 ***
C4:L3              0.98203    0.23833   4.120 3.78e-05 ***
C2:L4              0.75925    0.24670   3.078 0.002087 ** 
C3:L4              1.14125    0.21839   5.226 1.73e-07 ***
C4:L4              1.79914    0.31902   5.640 1.70e-08 ***
consistent.cells1  0.62268    0.33657   1.850 0.064303 .  
consistent.cells2  0.25993    0.39723   0.654 0.512891    
consistent.cells3  0.47364    0.26552   1.784 0.074458 .  
consistent.cells4 -0.16248    0.31471  -0.516 0.605666    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Residual deviance: 21.934 on 23 degrees of freedom
AIC: 398.25

Number of iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 8 - Unrestricted uniform and log-multiplicative association in all partial</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co"># association</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>model8 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>      Cscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
............................
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + 
    Rscore:Lscore + Mult(1, R, L) + Cscore:Lscore + Mult(1, C, 
    L), family = poisson, data = ., tolerance = 1e-12, trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.64348  -0.68031  -0.02712   0.48954   2.01814  

Coefficients:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.598658         NA      NA       NA    
R2               -0.999936         NA      NA       NA    
R3               -0.770279         NA      NA       NA    
R4               -1.581221         NA      NA       NA    
C2               -1.604574         NA      NA       NA    
C3               -2.106881         NA      NA       NA    
C4               -3.438321         NA      NA       NA    
L2               -1.465192         NA      NA       NA    
L3               -2.183377         NA      NA       NA    
L4               -3.831036         NA      NA       NA    
Rscore:Cscore     0.129644   0.027279   4.752 2.01e-06 ***
Mult(., R, C).    0.570958         NA      NA       NA    
Mult(1, ., C).R1 -0.936684         NA      NA       NA    
Mult(1, ., C).R2  1.911760         NA      NA       NA    
Mult(1, ., C).R3  0.822618         NA      NA       NA    
Mult(1, ., C).R4 -1.172332         NA      NA       NA    
Mult(1, R, .).C1 -0.066419         NA      NA       NA    
Mult(1, R, .).C2  0.358171         NA      NA       NA    
Mult(1, R, .).C3  0.019335         NA      NA       NA    
Mult(1, R, .).C4 -0.289987         NA      NA       NA    
Rscore:Lscore     0.254496   0.028029   9.080  &lt; 2e-16 ***
Mult(., R, L).    1.939632         NA      NA       NA    
Mult(1, ., L).R1 -0.491060         NA      NA       NA    
Mult(1, ., L).R2  0.445325         NA      NA       NA    
Mult(1, ., L).R3  0.344289         NA      NA       NA    
Mult(1, ., L).R4 -0.305799         NA      NA       NA    
Mult(1, R, .).L1 -0.031164         NA      NA       NA    
Mult(1, R, .).L2  0.484146         NA      NA       NA    
Mult(1, R, .).L3  0.102770         NA      NA       NA    
Mult(1, R, .).L4 -0.535159         NA      NA       NA    
Cscore:Lscore     0.201725   0.025855   7.802  &lt; 2e-16 ***
Mult(., C, L).   -1.057248         NA      NA       NA    
Mult(1, ., L).C1 -0.345857         NA      NA       NA    
Mult(1, ., L).C2 -0.111605         NA      NA       NA    
Mult(1, ., L).C3  0.527907         NA      NA       NA    
Mult(1, ., L).C4 -0.396790         NA      NA       NA    
Mult(1, C, .).L1 -0.005155         NA      NA       NA    
Mult(1, C, .).L2  0.165356         NA      NA       NA    
Mult(1, C, .).L3 -0.340895         NA      NA       NA    
Mult(1, C, .).L4 -0.033101         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 45.854 on 36 degrees of freedom
AIC: 396.17

Number of iterations: 85</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(model8, <span class="st">"[.]R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mult(1, ., C).R1 Mult(1, ., C).R2 Mult(1, ., C).R3 Mult(1, ., C).R4 
              13               14               15               16 
Mult(1, ., L).R1 Mult(1, ., L).R2 Mult(1, ., L).R3 Mult(1, ., L).R4 
              23               24               25               26 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(model8, <span class="st">"[.]C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mult(1, R, .).C1 Mult(1, R, .).C2 Mult(1, R, .).C3 Mult(1, R, .).C4 
              17               18               19               20 
Mult(1, ., L).C1 Mult(1, ., L).C2 Mult(1, ., L).C3 Mult(1, ., L).C4 
              33               34               35               36 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pickCoef</span>(model8, <span class="st">"[.]L"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mult(1, R, .).L1 Mult(1, R, .).L2 Mult(1, R, .).L3 Mult(1, R, .).L4 
              27               28               29               30 
Mult(1, C, .).L1 Mult(1, C, .).L2 Mult(1, C, .).L3 Mult(1, C, .).L4 
              37               38               39               40 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">var =</span> <span class="fu">names</span>(model8<span class="sc">$</span>coefficients),</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">estimate =</span> model8<span class="sc">$</span>coefficients) <span class="sc">%&gt;%</span> </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> estimate,</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">number =</span> <span class="fu">row_number</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                              var     estimate number
(Intercept)           (Intercept)  3.598658092      1
R2                             R2 -0.999936266      2
R3                             R3 -0.770278842      3
R4                             R4 -1.581221187      4
C2                             C2 -1.604573709      5
C3                             C3 -2.106880608      6
C4                             C4 -3.438321291      7
L2                             L2 -1.465192172      8
L3                             L3 -2.183377033      9
L4                             L4 -3.831035866     10
Rscore:Cscore       Rscore:Cscore  0.129643997     11
Mult(., R, C).     Mult(., R, C).  0.570958010     12
Mult(1, ., C).R1 Mult(1, ., C).R1 -0.936683717     13
Mult(1, ., C).R2 Mult(1, ., C).R2  1.911759631     14
Mult(1, ., C).R3 Mult(1, ., C).R3  0.822618238     15
Mult(1, ., C).R4 Mult(1, ., C).R4 -1.172331569     16
Mult(1, R, .).C1 Mult(1, R, .).C1 -0.066419266     17
Mult(1, R, .).C2 Mult(1, R, .).C2  0.358171111     18
Mult(1, R, .).C3 Mult(1, R, .).C3  0.019335463     19
Mult(1, R, .).C4 Mult(1, R, .).C4 -0.289986984     20
Rscore:Lscore       Rscore:Lscore  0.254496389     21
Mult(., R, L).     Mult(., R, L).  1.939632012     22
Mult(1, ., L).R1 Mult(1, ., L).R1 -0.491059721     23
Mult(1, ., L).R2 Mult(1, ., L).R2  0.445324971     24
Mult(1, ., L).R3 Mult(1, ., L).R3  0.344288785     25
Mult(1, ., L).R4 Mult(1, ., L).R4 -0.305798848     26
Mult(1, R, .).L1 Mult(1, R, .).L1 -0.031164373     27
Mult(1, R, .).L2 Mult(1, R, .).L2  0.484145876     28
Mult(1, R, .).L3 Mult(1, R, .).L3  0.102770276     29
Mult(1, R, .).L4 Mult(1, R, .).L4 -0.535159300     30
Cscore:Lscore       Cscore:Lscore  0.201724868     31
Mult(., C, L).     Mult(., C, L). -1.057247700     32
Mult(1, ., L).C1 Mult(1, ., L).C1 -0.345856946     33
Mult(1, ., L).C2 Mult(1, ., L).C2 -0.111604851     34
Mult(1, ., L).C3 Mult(1, ., L).C3  0.527907221     35
Mult(1, ., L).C4 Mult(1, ., L).C4 -0.396790342     36
Mult(1, C, .).L1 Mult(1, C, .).L1 -0.005154568     37
Mult(1, C, .).L2 Mult(1, C, .).L2  0.165356095     38
Mult(1, C, .).L3 Mult(1, C, .).L3 -0.340894838     39
Mult(1, C, .).L4 Mult(1, C, .).L4 -0.033101084     40</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mu1: 13-16</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  model8,</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model8, <span class="st">"[.]R"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>mu1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Estimate Std. Error
Mult(1, ., C).R1 -0.4291986 0.18120993
Mult(1, ., C).R2  0.6893016 0.09977232
Mult(1, ., C).R3  0.2616277 0.15931019
Mult(1, ., C).R4 -0.5217306 0.15976113</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nu1: 17-20</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>nu1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  model8,</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model8, <span class="st">"[.]C"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>nu1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate Std. Error
Mult(1, R, .).C1 -0.15388700 0.15383900
Mult(1, R, .).C2  0.75746716 0.08227847
Mult(1, R, .).C3  0.03017965 0.15480459
Mult(1, R, .).C4 -0.63375980 0.11651692</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mu2: 23-26</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  model8,</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model8, <span class="st">"[.]R"</span>)[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>mu2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Estimate Std. Error
Mult(1, ., L).R1 -0.6061444 0.08512883
Mult(1, ., L).R2  0.5539702 0.08877502
Mult(1, ., L).R3  0.4287935 0.09713147
Mult(1, ., L).R4 -0.3766193 0.10554742</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># eta1: 27-30</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>eta1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  model8,</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model8, <span class="st">"[.]L"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>eta1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate Std. Error
Mult(1, R, .).L1 -0.04977493 0.08992116
Mult(1, R, .).L2  0.65658058 0.06234704
Mult(1, R, .).L3  0.13381443 0.08765352
Mult(1, R, .).L4 -0.74062008 0.04970264</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nu2: 33-36</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>nu2 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  model8,</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model8, <span class="st">"[.]C"</span>)[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>nu2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate Std. Error
Mult(1, ., L).C1 -0.35910324  0.2995712
Mult(1, ., L).C2 -0.04079069  0.3606231
Mult(1, ., L).C3  0.82820782  0.1075525
Mult(1, ., L).C4 -0.42831389  0.3177968</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># eta2: 37-40</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>eta2 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  model8,</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model8, <span class="st">"[.]L"</span>)[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>eta2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate Std. Error
Mult(1, C, .).L1  0.13230141  0.3592002
Mult(1, C, .).L2  0.59941504  0.2494518
Mult(1, C, .).L3 -0.78745843  0.1409196
Mult(1, C, .).L4  0.05574198  0.3241035</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>         nu1<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>         mu2<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>         eta1<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>         nu2<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>         eta2<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)])</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>model8_se <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span></span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a>      Cscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a><span class="co">#    constrain = c(13,16,17,20,23,26,27,30,33,36,37,40),</span></span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a><span class="co">#    constrainTo = con,</span></span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-15</span></span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
................................................................................
................................................................................
................................................................................
................................................................................
................................................................................
...........................................
Done</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in gnmFit(modelTools = modelTools, y = y, constrain = constrain, : Fitting algorithm has either not converged or converged
to a non-solution of the likelihood equations.
Use exitInfo() for numerical details of last iteration.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model8_se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + 
    Rscore:Lscore + Mult(1, R, L) + Cscore:Lscore + Mult(1, C, 
    L), family = poisson, data = ., tolerance = 1e-15, trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.64348  -0.68031  -0.02712   0.48954   2.01814  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.58638         NA      NA       NA    
R2               -0.98265         NA      NA       NA    
R3               -0.75539         NA      NA       NA    
R4               -1.57835         NA      NA       NA    
C2               -1.60110         NA      NA       NA    
C3               -2.09213         NA      NA       NA    
C4               -3.43892         NA      NA       NA    
L2               -1.46517         NA      NA       NA    
L3               -2.21828         NA      NA       NA    
L4               -3.81831         NA      NA       NA    
Rscore:Cscore     0.12964    0.02728   4.752 2.01e-06 ***
Mult(., R, C).   -2.78308         NA      NA       NA    
Mult(1, ., C).R1  0.19103         NA      NA       NA    
Mult(1, ., C).R2 -0.39119         NA      NA       NA    
Mult(1, ., C).R3 -0.16857         NA      NA       NA    
Mult(1, ., C).R4  0.23920         NA      NA       NA    
Mult(1, R, .).C1 -0.06786         NA      NA       NA    
Mult(1, R, .).C2  0.35829         NA      NA       NA    
Mult(1, R, .).C3  0.01821         NA      NA       NA    
Mult(1, R, .).C4 -0.29225         NA      NA       NA    
Rscore:Lscore     0.25450    0.02803   9.080  &lt; 2e-16 ***
Mult(., R, L).    2.08992         NA      NA       NA    
Mult(1, ., L).R1 -0.69244         NA      NA       NA    
Mult(1, ., L).R2  0.67140         NA      NA       NA    
Mult(1, ., L).R3  0.52424         NA      NA       NA    
Mult(1, ., L).R4 -0.42261         NA      NA       NA    
Mult(1, R, .).L1 -0.02524         NA      NA       NA    
Mult(1, R, .).L2  0.30312         NA      NA       NA    
Mult(1, R, .).L3  0.06010         NA      NA       NA    
Mult(1, R, .).L4 -0.34639         NA      NA       NA    
Cscore:Lscore     0.20172    0.02585   7.802  &lt; 2e-16 ***
Mult(., C, L).   -1.62312         NA      NA       NA    
Mult(1, ., L).C1  0.17610         NA      NA       NA    
Mult(1, ., L).C2  0.01680         NA      NA       NA    
Mult(1, ., L).C3 -0.41807         NA      NA       NA    
Mult(1, ., L).C4  0.21073         NA      NA       NA    
Mult(1, C, .).L1 -0.01046         NA      NA       NA    
Mult(1, C, .).L2 -0.17379         NA      NA       NA    
Mult(1, C, .).L3  0.31114         NA      NA       NA    
Mult(1, C, .).L4  0.01630         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 45.854 on 36 degrees of freedom
AIC: 396.17

Number of iterations: 500</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="at">factor=</span><span class="st">"contr.treatment"</span>,</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ordered=</span><span class="st">"contr.treatment"</span>))</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 9 - Model 8 with consistent row scores</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>model9 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C <span class="sc">+</span> L) <span class="sc">+</span></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>      Cscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
............
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C + 
    L) + Rscore:Lscore + Cscore:Lscore + Mult(1, C, L), family = poisson, 
    data = ., tolerance = 1e-12, trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.56526  -0.67024  -0.02438   0.54037   1.98333  

Coefficients:
                      Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)           3.573962         NA      NA       NA    
R2                   -0.930605         NA      NA       NA    
R3                   -0.704942         NA      NA       NA    
R4                   -1.552585         NA      NA       NA    
C2                   -1.624447         NA      NA       NA    
C3                   -2.041365         NA      NA       NA    
C4                   -3.459926         NA      NA       NA    
L2                   -1.420163         NA      NA       NA    
L3                   -2.294787         NA      NA       NA    
L4                   -3.761473         NA      NA       NA    
Rscore:Cscore         0.133527   0.025355   5.266 1.39e-07 ***
Mult(., R, C + L).    2.355391         NA      NA       NA    
Mult(1, ., C + L).R1  0.537784         NA      NA       NA    
Mult(1, ., C + L).R2 -0.719764         NA      NA       NA    
Mult(1, ., C + L).R3 -0.500123         NA      NA       NA    
Mult(1, ., C + L).R4  0.387774         NA      NA       NA    
Mult(1, R, . + L).C1  0.078887         NA      NA       NA    
Mult(1, R, . + L).C2 -0.152061         NA      NA       NA    
Mult(1, R, . + L).C3  0.018049         NA      NA       NA    
Mult(1, R, . + L).C4  0.206068         NA      NA       NA    
Mult(1, R, C + .).L2 -0.315525         NA      NA       NA    
Mult(1, R, C + .).L3 -0.078397         NA      NA       NA    
Mult(1, R, C + .).L4  0.304352         NA      NA       NA    
Rscore:Lscore         0.248478   0.027223   9.127  &lt; 2e-16 ***
Cscore:Lscore         0.202702   0.025617   7.913  &lt; 2e-16 ***
Mult(., C, L).        1.294362         NA      NA       NA    
Mult(1, ., L).C1      0.031064         NA      NA       NA    
Mult(1, ., L).C2      0.141272         NA      NA       NA    
Mult(1, ., L).C3      0.556003         NA      NA       NA    
Mult(1, ., L).C4     -0.003729         NA      NA       NA    
Mult(1, C, .).L1     -0.118640         NA      NA       NA    
Mult(1, C, .).L2     -0.379592         NA      NA       NA    
Mult(1, C, .).L3      0.306656         NA      NA       NA    
Mult(1, C, .).L4     -0.106316         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 47.134 on 38 degrees of freedom
AIC: 393.45

Number of iterations: 69</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  model9,</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model9, <span class="st">"[.]R"</span>),</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>nu2 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>  model9,</span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model9, <span class="st">"[.]C"</span>)[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>eta2 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a>  model9,</span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model9, <span class="st">"[.]L"</span>)[<span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>],</span>
<span id="cb122-20"><a href="#cb122-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb122-21"><a href="#cb122-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb122-22"><a href="#cb122-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb122-23"><a href="#cb122-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb122-24"><a href="#cb122-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-25"><a href="#cb122-25" aria-hidden="true" tabindex="-1"></a>model9.extended <span class="ot">&lt;-</span></span>
<span id="cb122-26"><a href="#cb122-26" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span> <span class="fu">gnm</span>(</span>
<span id="cb122-27"><a href="#cb122-27" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span></span>
<span id="cb122-28"><a href="#cb122-28" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span></span>
<span id="cb122-29"><a href="#cb122-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb122-30"><a href="#cb122-30" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb122-31"><a href="#cb122-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span></span>
<span id="cb122-32"><a href="#cb122-32" aria-hidden="true" tabindex="-1"></a>      Cscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb122-33"><a href="#cb122-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb122-34"><a href="#cb122-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">23</span><span class="sc">:</span><span class="dv">26</span>),</span>
<span id="cb122-35"><a href="#cb122-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrainTo =</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>]),</span>
<span id="cb122-36"><a href="#cb122-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb122-37"><a href="#cb122-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb122-38"><a href="#cb122-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb122-39"><a href="#cb122-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb122-40"><a href="#cb122-40" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
......................
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model9.extended)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + 
    Rscore:Lscore + Mult(1, R, L) + Cscore:Lscore + Mult(1, C, 
    L), constrain = c(13:16, 23:26), constrainTo = c(mu$qvframe[, 
    1], mu$qvframe[, 1]), family = poisson, data = ., tolerance = 1e-12, 
    trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.56526  -0.67024  -0.02438   0.54037   1.98333  

Coefficients:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.582360         NA      NA       NA    
R2               -0.996191         NA      NA       NA    
R3               -0.759073         NA      NA       NA    
R4               -1.560408         NA      NA       NA    
C2               -1.598464         NA      NA       NA    
C3               -2.097716         NA      NA       NA    
C4               -3.477535         NA      NA       NA    
L2               -1.441178         NA      NA       NA    
L3               -2.157824         NA      NA       NA    
L4               -3.810647         NA      NA       NA    
Rscore:Cscore     0.133527   0.025195   5.300 1.16e-07 ***
Mult(., R, C).    0.122492         NA      NA       NA    
Mult(1, ., C).R1  0.561358         NA      NA       NA    
Mult(1, ., C).R2 -0.593325         NA      NA       NA    
Mult(1, ., C).R3 -0.391651         NA      NA       NA    
Mult(1, ., C).R4  0.423618         NA      NA       NA    
Mult(1, R, .).C1  0.843810         NA      NA       NA    
Mult(1, R, .).C2 -3.992700         NA      NA       NA    
Mult(1, R, .).C3 -0.430260         NA      NA       NA    
Mult(1, R, .).C4  3.507240         NA      NA       NA    
Rscore:Lscore     0.248478   0.025211   9.856  &lt; 2e-16 ***
Mult(., R, L).   -1.087007         NA      NA       NA    
Mult(1, ., L).R1  0.561358         NA      NA       NA    
Mult(1, ., L).R2 -0.593325         NA      NA       NA    
Mult(1, ., L).R3 -0.391651         NA      NA       NA    
Mult(1, ., L).R4  0.423618         NA      NA       NA    
Mult(1, R, .).L1 -0.038825         NA      NA       NA    
Mult(1, R, .).L2  0.705782         NA      NA       NA    
Mult(1, R, .).L3  0.146183         NA      NA       NA    
Mult(1, R, .).L4 -0.757064         NA      NA       NA    
Cscore:Lscore     0.202702   0.025596   7.919  &lt; 2e-16 ***
Mult(., C, L).   -1.251416         NA      NA       NA    
Mult(1, ., L).C1 -0.297672         NA      NA       NA    
Mult(1, ., L).C2 -0.127745         NA      NA       NA    
Mult(1, ., L).C3  0.511719         NA      NA       NA    
Mult(1, ., L).C4 -0.351318         NA      NA       NA    
Mult(1, C, .).L1  0.013542         NA      NA       NA    
Mult(1, C, .).L2  0.188593         NA      NA       NA    
Mult(1, C, .).L3 -0.271755         NA      NA       NA    
Mult(1, C, .).L4  0.005275         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 47.134 on 40 degrees of freedom
AIC: 389.45

Number of iterations: 79</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>nu1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  model9.extended,</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model9.extended, <span class="st">"[.]C"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>eta1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>    model9.extended,</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pickCoef</span>(model9.extended, <span class="st">"[.]L"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>model9.phis <span class="ot">&lt;-</span></span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span>  <span class="fu">gnm</span>(</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> </span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> </span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Lscore <span class="sc">+</span> </span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span> </span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a>      Cscore<span class="sc">:</span>Lscore <span class="sc">+</span> </span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb126-26"><a href="#cb126-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">23</span><span class="sc">:</span><span class="dv">30</span>, <span class="dv">33</span><span class="sc">:</span><span class="dv">40</span>),</span>
<span id="cb126-27"><a href="#cb126-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrainTo =</span> <span class="fu">c</span>(</span>
<span id="cb126-28"><a href="#cb126-28" aria-hidden="true" tabindex="-1"></a>      mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>],</span>
<span id="cb126-29"><a href="#cb126-29" aria-hidden="true" tabindex="-1"></a>      nu1<span class="sc">$</span>qvframe[, <span class="dv">1</span>],</span>
<span id="cb126-30"><a href="#cb126-30" aria-hidden="true" tabindex="-1"></a>      mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>],</span>
<span id="cb126-31"><a href="#cb126-31" aria-hidden="true" tabindex="-1"></a>      eta1<span class="sc">$</span>qvframe[, <span class="dv">1</span>],</span>
<span id="cb126-32"><a href="#cb126-32" aria-hidden="true" tabindex="-1"></a>      nu2<span class="sc">$</span>qvframe[, <span class="dv">1</span>],</span>
<span id="cb126-33"><a href="#cb126-33" aria-hidden="true" tabindex="-1"></a>      eta2<span class="sc">$</span>qvframe[, <span class="dv">1</span>]</span>
<span id="cb126-34"><a href="#cb126-34" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb126-35"><a href="#cb126-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb126-36"><a href="#cb126-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb126-37"><a href="#cb126-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb126-38"><a href="#cb126-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb126-39"><a href="#cb126-39" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations...
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model9.phis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + 
    Rscore:Lscore + Mult(1, R, L) + Cscore:Lscore + Mult(1, C, 
    L), constrain = c(13:20, 23:30, 33:40), constrainTo = c(mu$qvframe[, 
    1], nu1$qvframe[, 1], mu$qvframe[, 1], eta1$qvframe[, 1], 
    nu2$qvframe[, 1], eta2$qvframe[, 1]), family = poisson, data = ., 
    tolerance = 1e-12, trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.56526  -0.67024  -0.02438   0.54037   1.98333  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.56903    0.08137  43.862  &lt; 2e-16 ***
R2               -0.97605    0.11881  -8.215  &lt; 2e-16 ***
R3               -0.74245    0.14810  -5.013 5.36e-07 ***
R4               -1.55801    0.22175  -7.026 2.13e-12 ***
C2               -1.59504    0.10577 -15.081  &lt; 2e-16 ***
C3               -2.08142    0.17240 -12.073  &lt; 2e-16 ***
C4               -3.47861    0.26841 -12.960  &lt; 2e-16 ***
L2               -1.42666    0.10739 -13.285  &lt; 2e-16 ***
L3               -2.18148    0.17791 -12.262  &lt; 2e-16 ***
L4               -3.81133    0.27937 -13.643  &lt; 2e-16 ***
Rscore:Cscore     0.13353    0.02486   5.371 7.83e-08 ***
Mult(., R, C).    0.66121    0.14008   4.720 2.36e-06 ***
Mult(1, ., C).R1  0.56136         NA      NA       NA    
Mult(1, ., C).R2 -0.59333         NA      NA       NA    
Mult(1, ., C).R3 -0.39165         NA      NA       NA    
Mult(1, ., C).R4  0.42362         NA      NA       NA    
Mult(1, R, .).C1  0.15965         NA      NA       NA    
Mult(1, R, .).C2 -0.73633         NA      NA       NA    
Mult(1, R, .).C3 -0.07638         NA      NA       NA    
Mult(1, R, .).C4  0.65306         NA      NA       NA    
Rscore:Lscore     0.24848    0.02515   9.879  &lt; 2e-16 ***
Mult(., R, L).   -1.13662    0.13964  -8.140  &lt; 2e-16 ***
Mult(1, ., L).R1  0.56136         NA      NA       NA    
Mult(1, ., L).R2 -0.59333         NA      NA       NA    
Mult(1, ., L).R3 -0.39165         NA      NA       NA    
Mult(1, ., L).R4  0.42362         NA      NA       NA    
Mult(1, R, .).L1 -0.05054         NA      NA       NA    
Mult(1, R, .).L2  0.66157         NA      NA       NA    
Mult(1, R, .).L3  0.12640         NA      NA       NA    
Mult(1, R, .).L4 -0.73743         NA      NA       NA    
Cscore:Lscore     0.20270    0.02315   8.756  &lt; 2e-16 ***
Mult(., C, L).    0.28351    0.10068   2.816  0.00486 ** 
Mult(1, ., L).C1 -0.33661         NA      NA       NA    
Mult(1, ., L).C2 -0.08944         NA      NA       NA    
Mult(1, ., L).C3  0.84069         NA      NA       NA    
Mult(1, ., L).C4 -0.41464         NA      NA       NA    
Mult(1, C, .).L1 -0.08991         NA      NA       NA    
Mult(1, C, .).L2 -0.62111         NA      NA       NA    
Mult(1, C, .).L3  0.77584         NA      NA       NA    
Mult(1, C, .).L4 -0.06482         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 47.134 on 48 degrees of freedom
AIC: 373.45

Number of iterations: 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>mu</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       Estimate Std. Error
Mult(1, ., C + L).R1  0.5613577 0.07946201
Mult(1, ., C + L).R2 -0.5933253 0.06976100
Mult(1, ., C + L).R3 -0.3916506 0.08375491
Mult(1, ., C + L).R4  0.4236182 0.08896023</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>nu1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate Std. Error
Mult(1, R, .).C1  0.15964986 0.14637516
Mult(1, R, .).C2 -0.73633460 0.08871449
Mult(1, R, .).C3 -0.07637713 0.15684115
Mult(1, R, .).C4  0.65306187 0.10868144</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>eta1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate Std. Error
Mult(1, R, .).L1 -0.05053742 0.08981862
Mult(1, R, .).L2  0.66156822 0.06038098
Mult(1, R, .).L3  0.12639555 0.08679365
Mult(1, R, .).L4 -0.73742635 0.04940126</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>nu2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate Std. Error
Mult(1, ., L).C1 -0.33661004 0.30087703
Mult(1, ., L).C2 -0.08944163 0.36058729
Mult(1, ., L).C3  0.84069369 0.08936905
Mult(1, ., L).C4 -0.41464201 0.32252708</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>eta2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate Std. Error
Mult(1, C, .).L1 -0.08990831  0.3610226
Mult(1, C, .).L2 -0.62111332  0.2399524
Mult(1, C, .).L3  0.77584334  0.1519881
Mult(1, C, .).L4 -0.06482171  0.3227342</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  `Model Description`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 model9                 38  47.1 -231.  6.25 0.147</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 10 - Model 8 with consistent col scores</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>model10 <span class="ot">&lt;-</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span> <span class="fu">gnm</span>(</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> </span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> </span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, C, R <span class="sc">+</span> L) <span class="sc">+</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Lscore <span class="sc">+</span> </span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span> </span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>      Cscore<span class="sc">:</span>Lscore,</span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
................................................................................
.......
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  `Model Description`    df    L2   BIC Delta      p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 model10                38  50.9 -227.  6.31 0.0788</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 11 - Model 8 with consistent layer scores</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>model11 <span class="ot">&lt;-</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span> <span class="fu">gnm</span>(</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> </span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> </span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, L, R <span class="sc">+</span> C) <span class="sc">+</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Lscore <span class="sc">+</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>      Cscore<span class="sc">:</span>Lscore,</span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
.........................
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model11)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  `Model Description`    df    L2   BIC Delta      p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 model11                38  53.6 -225.  6.58 0.0477</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 12 - Modek 9 + U(RL)=U(CL)</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="co"># To impose equality constraint on U(RL) &amp; U(CL),</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="co"># a covariate is created in following manner:</span></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span><span class="sc">%&gt;%</span> </span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cov_rcl =</span> Rscore <span class="sc">*</span> Lscore <span class="sc">+</span> Cscore <span class="sc">*</span> Lscore)</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>model12 <span class="ot">&lt;-</span></span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span> <span class="fu">gnm</span>(</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> </span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> </span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C <span class="sc">+</span> L) <span class="sc">+</span></span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>      cov_rcl <span class="sc">+</span> </span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb150-17"><a href="#cb150-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb150-18"><a href="#cb150-18" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
..........................................................
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(model12)</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model12)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  `Model Description`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 model12                39  48.6 -237.  6.57 0.140</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>  model12,</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model12, <span class="st">"[.]R"</span>),</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>nu2 <span class="ot">&lt;-</span></span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getContrasts</span>(</span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>    model12,</span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pickCoef</span>(model12, <span class="st">"[.]C"</span>)[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb154-15"><a href="#cb154-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb154-16"><a href="#cb154-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb154-17"><a href="#cb154-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-18"><a href="#cb154-18" aria-hidden="true" tabindex="-1"></a>eta2 <span class="ot">&lt;-</span></span>
<span id="cb154-19"><a href="#cb154-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getContrasts</span>(</span>
<span id="cb154-20"><a href="#cb154-20" aria-hidden="true" tabindex="-1"></a>    model12,</span>
<span id="cb154-21"><a href="#cb154-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pickCoef</span>(model12, <span class="st">"[.]L"</span>)[<span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>],</span>
<span id="cb154-22"><a href="#cb154-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb154-23"><a href="#cb154-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb154-24"><a href="#cb154-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb154-25"><a href="#cb154-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb154-26"><a href="#cb154-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-27"><a href="#cb154-27" aria-hidden="true" tabindex="-1"></a>model12.extended <span class="ot">&lt;-</span></span>
<span id="cb154-28"><a href="#cb154-28" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb154-29"><a href="#cb154-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> </span>
<span id="cb154-30"><a href="#cb154-30" aria-hidden="true" tabindex="-1"></a>        Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> </span>
<span id="cb154-31"><a href="#cb154-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb154-32"><a href="#cb154-32" aria-hidden="true" tabindex="-1"></a>        cov_rcl <span class="sc">+</span> </span>
<span id="cb154-33"><a href="#cb154-33" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span> </span>
<span id="cb154-34"><a href="#cb154-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb154-35"><a href="#cb154-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">23</span><span class="sc">:</span><span class="dv">26</span>),</span>
<span id="cb154-36"><a href="#cb154-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrainTo =</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>]),</span>
<span id="cb154-37"><a href="#cb154-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> .,</span>
<span id="cb154-38"><a href="#cb154-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> poisson,</span>
<span id="cb154-39"><a href="#cb154-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb154-40"><a href="#cb154-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb154-41"><a href="#cb154-41" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
...............................
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model12.extended)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + 
    cov_rcl + Mult(1, R, L) + Mult(1, C, L), constrain = c(13:16, 
    23:26), constrainTo = c(mu$qvframe[, 1], mu$qvframe[, 1]), 
    family = poisson, data = ., tolerance = 1e-12, trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.58844  -0.76809   0.02278   0.56330   1.92999  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.57925         NA      NA       NA    
R2               -0.99260         NA      NA       NA    
R3               -0.69408         NA      NA       NA    
R4               -1.39820         NA      NA       NA    
C2               -1.63377         NA      NA       NA    
C3               -2.15093         NA      NA       NA    
C4               -3.65748         NA      NA       NA    
L2               -1.38736         NA      NA       NA    
L3               -2.14323         NA      NA       NA    
L4               -3.74634         NA      NA       NA    
Rscore:Cscore     0.13336    0.02542   5.246 1.55e-07 ***
Mult(., R, C).    0.94820         NA      NA       NA    
Mult(1, ., C).R1 -0.53827         NA      NA       NA    
Mult(1, ., C).R2  0.59767         NA      NA       NA    
Mult(1, ., C).R3  0.38941         NA      NA       NA    
Mult(1, ., C).R4 -0.44880         NA      NA       NA    
Mult(1, R, .).C1 -0.11275         NA      NA       NA    
Mult(1, R, .).C2  0.51000         NA      NA       NA    
Mult(1, R, .).C3  0.06394         NA      NA       NA    
Mult(1, R, .).C4 -0.42324         NA      NA       NA    
cov_rcl           0.22423    0.01709  13.123  &lt; 2e-16 ***
Mult(., R, L).   -2.52963         NA      NA       NA    
Mult(1, ., L).R1 -0.53827         NA      NA       NA    
Mult(1, ., L).R2  0.59767         NA      NA       NA    
Mult(1, ., L).R3  0.38941         NA      NA       NA    
Mult(1, ., L).R4 -0.44880         NA      NA       NA    
Mult(1, R, .).L1  0.00193         NA      NA       NA    
Mult(1, R, .).L2 -0.31675         NA      NA       NA    
Mult(1, R, .).L3 -0.07357         NA      NA       NA    
Mult(1, R, .).L4  0.31420         NA      NA       NA    
Mult(., C, L).   -0.95295         NA      NA       NA    
Mult(1, ., L).C1  0.25260         NA      NA       NA    
Mult(1, ., L).C2  0.09660         NA      NA       NA    
Mult(1, ., L).C3 -1.01845         NA      NA       NA    
Mult(1, ., L).C4  0.42491         NA      NA       NA    
Mult(1, C, .).L1 -0.02018         NA      NA       NA    
Mult(1, C, .).L2 -0.19195         NA      NA       NA    
Mult(1, C, .).L3  0.16753         NA      NA       NA    
Mult(1, C, .).L4 -0.05400         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 48.569 on 41 degrees of freedom
AIC: 388.89

Number of iterations: 88</code></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>nu1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>  model12.extended,</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model12.extended, <span class="st">"[.]C"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>eta1 <span class="ot">&lt;-</span></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getContrasts</span>(</span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>    model12.extended,</span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pickCoef</span>(model12.extended, <span class="st">"[.]L"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a>model12.phis <span class="ot">&lt;-</span></span>
<span id="cb158-19"><a href="#cb158-19" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span> <span class="fu">gnm</span>(</span>
<span id="cb158-20"><a href="#cb158-20" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb158-21"><a href="#cb158-21" aria-hidden="true" tabindex="-1"></a>      cov_rcl <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, R, L) <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, C, L),</span>
<span id="cb158-22"><a href="#cb158-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">23</span><span class="sc">:</span><span class="dv">30</span>, <span class="dv">32</span><span class="sc">:</span><span class="dv">39</span>),</span>
<span id="cb158-23"><a href="#cb158-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrainTo =</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], nu1<span class="sc">$</span>qvframe[, <span class="dv">1</span>],</span>
<span id="cb158-24"><a href="#cb158-24" aria-hidden="true" tabindex="-1"></a>                    mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], eta1<span class="sc">$</span>qvframe[, <span class="dv">1</span>], </span>
<span id="cb158-25"><a href="#cb158-25" aria-hidden="true" tabindex="-1"></a>                    nu2<span class="sc">$</span>qvframe[, <span class="dv">1</span>], eta2<span class="sc">$</span>qvframe[, <span class="dv">1</span>]),</span>
<span id="cb158-26"><a href="#cb158-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb158-27"><a href="#cb158-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson, </span>
<span id="cb158-28"><a href="#cb158-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F, </span>
<span id="cb158-29"><a href="#cb158-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations...
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model12.phis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + 
    cov_rcl + Mult(1, R, L) + Mult(1, C, L), constrain = c(13:20, 
    23:30, 32:39), constrainTo = c(mu$qvframe[, 1], nu1$qvframe[, 
    1], mu$qvframe[, 1], eta1$qvframe[, 1], nu2$qvframe[, 1], 
    eta2$qvframe[, 1]), family = poisson, data = ., tolerance = 1e-12, 
    trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.58844  -0.76809   0.02278   0.56330   1.92999  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.55535    0.08106  43.859  &lt; 2e-16 ***
R2               -0.92909    0.11339  -8.194  &lt; 2e-16 ***
R3               -0.64221    0.12609  -5.093 3.52e-07 ***
R4               -1.39320    0.17746  -7.851  &lt; 2e-16 ***
C2               -1.63743    0.10043 -16.304  &lt; 2e-16 ***
C3               -2.18079    0.15608 -13.973  &lt; 2e-16 ***
C4               -3.65343    0.23846 -15.321  &lt; 2e-16 ***
L2               -1.39736    0.10537 -13.261  &lt; 2e-16 ***
L3               -2.13230    0.17235 -12.372  &lt; 2e-16 ***
L4               -3.74831    0.27154 -13.804  &lt; 2e-16 ***
Rscore:Cscore     0.13336    0.02490   5.357 8.48e-08 ***
Mult(., R, C).    0.64007    0.13725   4.663 3.11e-06 ***
Mult(1, ., C).R1 -0.53827         NA      NA       NA    
Mult(1, ., C).R2  0.59766         NA      NA       NA    
Mult(1, ., C).R3  0.38941         NA      NA       NA    
Mult(1, ., C).R4 -0.44880         NA      NA       NA    
Mult(1, R, .).C1 -0.18108         NA      NA       NA    
Mult(1, R, .).C2  0.74146         NA      NA       NA    
Mult(1, R, .).C3  0.08067         NA      NA       NA    
Mult(1, R, .).C4 -0.64105         NA      NA       NA    
cov_rcl           0.22423    0.01636  13.707  &lt; 2e-16 ***
Mult(., R, L).   -1.13998    0.13669  -8.340  &lt; 2e-16 ***
Mult(1, ., L).R1 -0.53827         NA      NA       NA    
Mult(1, ., L).R2  0.59766         NA      NA       NA    
Mult(1, ., L).R3  0.38941         NA      NA       NA    
Mult(1, ., L).R4 -0.44880         NA      NA       NA    
Mult(1, R, .).L1  0.04544         NA      NA       NA    
Mult(1, R, .).L2 -0.66170         NA      NA       NA    
Mult(1, R, .).L3 -0.12210         NA      NA       NA    
Mult(1, R, .).L4  0.73836         NA      NA       NA    
Mult(., C, L).   -0.27613    0.10158  -2.718  0.00656 ** 
Mult(1, ., L).C1  0.27770         NA      NA       NA    
Mult(1, ., L).C2  0.13959         NA      NA       NA    
Mult(1, ., L).C3 -0.84752         NA      NA       NA    
Mult(1, ., L).C4  0.43024         NA      NA       NA    
Mult(1, C, .).L1  0.01743         NA      NA       NA    
Mult(1, C, .).L2 -0.65220         NA      NA       NA    
Mult(1, C, .).L3  0.74916         NA      NA       NA    
Mult(1, C, .).L4 -0.11439         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 48.569 on 49 degrees of freedom
AIC: 372.89

Number of iterations: 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>mu</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       Estimate Std. Error
Mult(1, ., C + L).R1 -0.5382715 0.07940991
Mult(1, ., C + L).R2  0.5976649 0.06869502
Mult(1, ., C + L).R3  0.3894076 0.08390695
Mult(1, ., C + L).R4 -0.4488010 0.08495489</code></pre>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>nu1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate Std. Error
Mult(1, R, .).C1 -0.18108336  0.1505749
Mult(1, R, .).C2  0.74145909  0.0888159
Mult(1, R, .).C3  0.08066998  0.1598862
Mult(1, R, .).C4 -0.64104571  0.1141041</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>eta1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Estimate Std. Error
Mult(1, R, .).L1  0.0454423 0.08895571
Mult(1, R, .).L2 -0.6617033 0.05943373
Mult(1, R, .).L3 -0.1220991 0.08507409
Mult(1, R, .).L4  0.7383601 0.04862532</code></pre>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>nu2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Estimate Std. Error
Mult(1, ., L).C1  0.2776974 0.30818568
Mult(1, ., L).C2  0.1395889 0.36977790
Mult(1, ., L).C3 -0.8475231 0.08001496
Mult(1, ., L).C4  0.4302368 0.32326672</code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>eta2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate Std. Error
Mult(1, C, .).L1  0.01742597  0.3681779
Mult(1, C, .).L2 -0.65219849  0.2296758
Mult(1, C, .).L3  0.74916478  0.1797929
Mult(1, C, .).L4 -0.11439226  0.3321123</code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model12)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  `Model Description`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 model12                39  48.6 -237.  6.57 0.140</code></pre>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 15</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>freq_tab_3<span class="fl">.1</span> <span class="ot">&lt;-</span></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">cov_rcl =</span> Rscore <span class="sc">*</span> Lscore <span class="sc">+</span> Cscore <span class="sc">*</span> Lscore)</span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>model15 <span class="ot">&lt;-</span> freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, R, C <span class="sc">+</span> L) <span class="sc">+</span> cov_rcl,</span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb174-12"><a href="#cb174-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb174-13"><a href="#cb174-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations..............................................
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model15)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C + 
    L) + cov_rcl, family = poisson, data = ., tolerance = 1e-12,     trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.98677  -0.75501   0.01756   0.52206   2.97799  

Coefficients:
                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)           3.53570         NA      NA       NA    
R2                   -0.85693         NA      NA       NA    
R3                   -0.59338         NA      NA       NA    
R4                   -1.41333         NA      NA       NA    
C2                   -1.69646         NA      NA       NA    
C3                   -2.18362         NA      NA       NA    
C4                   -3.67042         NA      NA       NA    
L2                   -1.48212         NA      NA       NA    
L3                   -2.17570         NA      NA       NA    
L4                   -3.75407         NA      NA       NA    
Rscore:Cscore         0.13307    0.02552   5.215 1.84e-07 ***
Mult(., R, C + L).   -3.98718         NA      NA       NA    
Mult(1, ., C + L).R1  0.25707         NA      NA       NA    
Mult(1, ., C + L).R2 -0.38014         NA      NA       NA    
Mult(1, ., C + L).R3 -0.26315         NA      NA       NA    
Mult(1, ., C + L).R4  0.20070         NA      NA       NA    
Mult(1, R, . + L).C1 -0.10593         NA      NA       NA    
Mult(1, R, . + L).C2  0.15835         NA      NA       NA    
Mult(1, R, . + L).C3 -0.03680         NA      NA       NA    
Mult(1, R, . + L).C4 -0.24133         NA      NA       NA    
Mult(1, R, C + .).L2  0.36116         NA      NA       NA    
Mult(1, R, C + .).L3  0.09114         NA      NA       NA    
Mult(1, R, C + .).L4 -0.35397         NA      NA       NA    
cov_rcl               0.22862    0.01709  13.377  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 55.984 on 44 degrees of freedom
AIC: 390.3

Number of iterations: 46</code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model15)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  `Model Description`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 model15                44  56.0 -266.  6.83 0.106</code></pre>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>  model15,</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model15, <span class="st">"[.]R"</span>),</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a>  model15,</span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model15, <span class="st">"[.]C"</span>),</span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb180-13"><a href="#cb180-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb180-14"><a href="#cb180-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb180-15"><a href="#cb180-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb180-16"><a href="#cb180-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-17"><a href="#cb180-17" aria-hidden="true" tabindex="-1"></a>model15.extended <span class="ot">&lt;-</span></span>
<span id="cb180-18"><a href="#cb180-18" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span> <span class="fu">gnm</span>(</span>
<span id="cb180-19"><a href="#cb180-19" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> </span>
<span id="cb180-20"><a href="#cb180-20" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> </span>
<span id="cb180-21"><a href="#cb180-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span></span>
<span id="cb180-22"><a href="#cb180-22" aria-hidden="true" tabindex="-1"></a>      cov_rcl <span class="sc">+</span> </span>
<span id="cb180-23"><a href="#cb180-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, L),</span>
<span id="cb180-24"><a href="#cb180-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">23</span><span class="sc">:</span><span class="dv">26</span>),</span>
<span id="cb180-25"><a href="#cb180-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrainTo =</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>]),</span>
<span id="cb180-26"><a href="#cb180-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb180-27"><a href="#cb180-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb180-28"><a href="#cb180-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb180-29"><a href="#cb180-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb180-30"><a href="#cb180-30" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations....
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model15.extended)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + 
    cov_rcl + Mult(1, R, L), constrain = c(13:16, 23:26), constrainTo = c(mu$qvframe[, 
    1], mu$qvframe[, 1]), family = poisson, data = ., tolerance = 1e-12, 
    trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.98677  -0.75501   0.01756   0.52206   2.97799  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.56950         NA      NA       NA    
R2               -0.96904         NA      NA       NA    
R3               -0.68490         NA      NA       NA    
R4               -1.42324         NA      NA       NA    
C2               -1.64759    0.10152  -16.23  &lt; 2e-16 ***
C3               -2.17084    0.15843  -13.70  &lt; 2e-16 ***
C4               -3.69546    0.24129  -15.32  &lt; 2e-16 ***
L2               -1.41533    0.10612  -13.34  &lt; 2e-16 ***
L3               -2.15885    0.17266  -12.50  &lt; 2e-16 ***
L4               -3.81953    0.27268  -14.01  &lt; 2e-16 ***
Rscore:Cscore     0.13307    0.02539    5.24  1.6e-07 ***
Mult(., R, C).   -0.91108         NA      NA       NA    
Mult(1, ., C).R1  0.54368         NA      NA       NA    
Mult(1, ., C).R2 -0.59799         NA      NA       NA    
Mult(1, ., C).R3 -0.38839         NA      NA       NA    
Mult(1, ., C).R4  0.44270         NA      NA       NA    
Mult(1, R, .).C1 -0.10235         NA      NA       NA    
Mult(1, R, .).C2  0.54316         NA      NA       NA    
Mult(1, R, .).C3  0.06649         NA      NA       NA    
Mult(1, R, .).C4 -0.43309         NA      NA       NA    
cov_rcl           0.22862    0.01643   13.91  &lt; 2e-16 ***
Mult(., R, L).    2.08772         NA      NA       NA    
Mult(1, ., L).R1  0.54368         NA      NA       NA    
Mult(1, ., L).R2 -0.59799         NA      NA       NA    
Mult(1, ., L).R3 -0.38839         NA      NA       NA    
Mult(1, ., L).R4  0.44270         NA      NA       NA    
Mult(1, R, .).L1  0.02121         NA      NA       NA    
Mult(1, R, .).L2 -0.36377         NA      NA       NA    
Mult(1, R, .).L3 -0.07593         NA      NA       NA    
Mult(1, R, .).L4  0.39852         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 55.984 on 46 degrees of freedom
AIC: 386.3

Number of iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">&lt;-</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getContrasts</span>(</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>    model15.extended,</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pickCoef</span>(model15.extended, <span class="st">"[.]L"</span>),</span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref =</span> <span class="st">"mean"</span>,</span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleRef =</span> <span class="st">"mean"</span>,</span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaleWeights =</span> <span class="st">"unit"</span></span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a>model15.phis <span class="ot">&lt;-</span></span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a>  freq_tab_3<span class="fl">.1</span> <span class="sc">%&gt;%</span> <span class="fu">gnm</span>(</span>
<span id="cb184-12"><a href="#cb184-12" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> R <span class="sc">+</span> C <span class="sc">+</span> L <span class="sc">+</span> </span>
<span id="cb184-13"><a href="#cb184-13" aria-hidden="true" tabindex="-1"></a>      Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> </span>
<span id="cb184-14"><a href="#cb184-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, C) <span class="sc">+</span> </span>
<span id="cb184-15"><a href="#cb184-15" aria-hidden="true" tabindex="-1"></a>      cov_rcl <span class="sc">+</span> </span>
<span id="cb184-16"><a href="#cb184-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Mult</span>(<span class="dv">1</span>, R, L),</span>
<span id="cb184-17"><a href="#cb184-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">23</span><span class="sc">:</span><span class="dv">30</span>),</span>
<span id="cb184-18"><a href="#cb184-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrainTo =</span> <span class="fu">c</span>(mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], </span>
<span id="cb184-19"><a href="#cb184-19" aria-hidden="true" tabindex="-1"></a>                    nu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], </span>
<span id="cb184-20"><a href="#cb184-20" aria-hidden="true" tabindex="-1"></a>                    mu<span class="sc">$</span>qvframe[, <span class="dv">1</span>], </span>
<span id="cb184-21"><a href="#cb184-21" aria-hidden="true" tabindex="-1"></a>                    eta<span class="sc">$</span>qvframe[, <span class="dv">1</span>]),</span>
<span id="cb184-22"><a href="#cb184-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .,</span>
<span id="cb184-23"><a href="#cb184-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb184-24"><a href="#cb184-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb184-25"><a href="#cb184-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb184-26"><a href="#cb184-26" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialising
Running start-up iterations..
Running main iterations...
Done</code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model15.phis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + 
    cov_rcl + Mult(1, R, L), constrain = c(13:20, 23:30), constrainTo = c(mu$qvframe[, 
    1], nu$qvframe[, 1], mu$qvframe[, 1], eta$qvframe[, 1]), 
    family = poisson, data = ., tolerance = 1e-12, trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.98677  -0.75501   0.01756   0.52206   2.97799  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.55464    0.08091  43.935  &lt; 2e-16 ***
R2               -0.93784    0.11339  -8.271  &lt; 2e-16 ***
R3               -0.65943    0.12613  -5.228 1.71e-07 ***
R4               -1.42048    0.17754  -8.001  &lt; 2e-16 ***
C2               -1.64759    0.10044 -16.404  &lt; 2e-16 ***
C3               -2.17084    0.15588 -13.927  &lt; 2e-16 ***
C4               -3.69546    0.23861 -15.488  &lt; 2e-16 ***
L2               -1.41533    0.10551 -13.414  &lt; 2e-16 ***
L3               -2.15885    0.17245 -12.519  &lt; 2e-16 ***
L4               -3.81953    0.27221 -14.032  &lt; 2e-16 ***
Rscore:Cscore     0.13307    0.02492   5.341 9.24e-08 ***
Mult(., R, C).   -0.64172    0.13829  -4.641 3.48e-06 ***
Mult(1, ., C).R1  0.54368         NA      NA       NA    
Mult(1, ., C).R2 -0.59799         NA      NA       NA    
Mult(1, ., C).R3 -0.38839         NA      NA       NA    
Mult(1, ., C).R4  0.44270         NA      NA       NA    
Mult(1, R, .).C1 -0.17165         NA      NA       NA    
Mult(1, R, .).C2  0.74481         NA      NA       NA    
Mult(1, R, .).C3  0.06806         NA      NA       NA    
Mult(1, R, .).C4 -0.64122         NA      NA       NA    
cov_rcl           0.22862    0.01640  13.939  &lt; 2e-16 ***
Mult(., R, L).    1.13826    0.13726   8.293  &lt; 2e-16 ***
Mult(1, ., L).R1  0.54368         NA      NA       NA    
Mult(1, ., L).R2 -0.59799         NA      NA       NA    
Mult(1, ., L).R3 -0.38839         NA      NA       NA    
Mult(1, ., L).R4  0.44270         NA      NA       NA    
Mult(1, R, .).L1  0.04806         NA      NA       NA    
Mult(1, R, .).L2 -0.65804         NA      NA       NA    
Mult(1, R, .).L3 -0.13012         NA      NA       NA    
Mult(1, R, .).L4  0.74010         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 55.984 on 50 degrees of freedom
AIC: 378.3

Number of iterations: 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>mu</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       Estimate Std. Error
Mult(1, ., C + L).R1  0.5436794 0.07818382
Mult(1, ., C + L).R2 -0.5979869 0.06871974
Mult(1, ., C + L).R3 -0.3883879 0.08391754
Mult(1, ., C + L).R4  0.4426954 0.08454001</code></pre>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>nu</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Estimate Std. Error
Mult(1, R, . + L).C1 -0.17164747 0.14998137
Mult(1, R, . + L).C2  0.74480785 0.08583798
Mult(1, R, . + L).C3  0.06806188 0.15421719
Mult(1, R, . + L).C4 -0.64122226 0.11322236</code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>eta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate Std. Error
Mult(1, R, .).L1  0.04806244 0.08932196
Mult(1, R, .).L2 -0.65804171 0.05969167
Mult(1, R, .).L3 -0.13011596 0.08427834
Mult(1, R, .).L4  0.74009523 0.04837401</code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model15)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  `Model Description`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 model15                44  56.0 -266.  6.83 0.106</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">model.summary</span>(model1),</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model2),</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model4),</span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model6),</span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model7),</span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model8),</span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model9),</span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model10),</span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model11),</span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model12),</span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model15))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 6
   `Model Description`    df    L2   BIC Delta        p
   &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
 1 model1                 54 544.   149. 23.7  3.44e-82
 2 model2                 39 109.  -176.  9.81 1.42e- 8
 3 model4                 35  37.7 -218.  4.63 3.47e- 1
 4 model6                 27  29.0 -169.  4.86 3.61e- 1
 5 model7                 23  21.9 -146.  3.70 5.24e- 1
 6 model8                 36  45.9 -218.  6.25 1.26e- 1
 7 model9                 38  47.1 -231.  6.25 1.47e- 1
 8 model10                38  50.9 -227.  6.31 7.88e- 2
 9 model11                38  53.6 -225.  6.58 4.77e- 2
10 model12                39  48.6 -237.  6.57 1.40e- 1
11 model15                44  56.0 -266.  6.83 1.06e- 1</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./3-Chapter_2.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">第2章</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./5-Chapter_4.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">第4章</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>