[
  {
    "objectID": "12-Review.html#内的連関係数",
    "href": "12-Review.html#内的連関係数",
    "title": "研究の動向",
    "section": "内的連関係数",
    "text": "内的連関係数\n\nBouchet-Valat (2022)\nZhou (2015)"
  },
  {
    "objectID": "4-Chapter_3.html#表3.1a",
    "href": "4-Chapter_3.html#表3.1a",
    "title": "3  第3章",
    "section": "3.1 表3.1A",
    "text": "3.1 表3.1A\n表3.1Aをまずベクトルとして入力する．\n\n# 表3.1\nFreq &lt;- c(  9, 5, 5, 1,    1, 6, 5, 1,    2, 2, 2, 1,\n           17,13, 7, 4,   13,22, 9, 1,    7,13, 6, 2,\n            8,14, 6, 0,   10,29,10, 0,    5,14, 6, 2,\n           20,38,24, 8,   23,72,34,10,   17,67,36,12,\n            4,21,12, 4,    7,30, 9, 1,    9,19,14, 2,\n            2, 9, 8, 3,    1,16,19, 2,   11,28,28,11,\n            0, 1, 5, 0,    2, 3, 3, 2,    2, 7, 6, 6)\n\n次に行変数，列変数，層変数を入力する．gl(n = 水準数, k = 繰り返しの数, length = 長さ)を注意しながら設定する．\n\npolviews &lt;- gl(n = 7, k = 4*3, length = length(Freq))\nfefam &lt;- gl(n = 4, k = 1, length = length(Freq))\nnatfare &lt;- gl(n = 3, k = 4, length = length(Freq))\n\n対応しているのかを確認したければ，matrix形式で示すとよい．\n\nmatrix(polviews, nrow = 7, ncol = 12, byrow = TRUE)\n\n     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]\n[1,] \"1\"  \"1\"  \"1\"  \"1\"  \"1\"  \"1\"  \"1\"  \"1\"  \"1\"  \"1\"   \"1\"   \"1\"  \n[2,] \"2\"  \"2\"  \"2\"  \"2\"  \"2\"  \"2\"  \"2\"  \"2\"  \"2\"  \"2\"   \"2\"   \"2\"  \n[3,] \"3\"  \"3\"  \"3\"  \"3\"  \"3\"  \"3\"  \"3\"  \"3\"  \"3\"  \"3\"   \"3\"   \"3\"  \n[4,] \"4\"  \"4\"  \"4\"  \"4\"  \"4\"  \"4\"  \"4\"  \"4\"  \"4\"  \"4\"   \"4\"   \"4\"  \n[5,] \"5\"  \"5\"  \"5\"  \"5\"  \"5\"  \"5\"  \"5\"  \"5\"  \"5\"  \"5\"   \"5\"   \"5\"  \n[6,] \"6\"  \"6\"  \"6\"  \"6\"  \"6\"  \"6\"  \"6\"  \"6\"  \"6\"  \"6\"   \"6\"   \"6\"  \n[7,] \"7\"  \"7\"  \"7\"  \"7\"  \"7\"  \"7\"  \"7\"  \"7\"  \"7\"  \"7\"   \"7\"   \"7\"  \n\nmatrix(fefam, nrow = 7, ncol = 12, byrow = TRUE)\n\n     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]\n[1,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"   \"3\"   \"4\"  \n[2,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"   \"3\"   \"4\"  \n[3,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"   \"3\"   \"4\"  \n[4,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"   \"3\"   \"4\"  \n[5,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"   \"3\"   \"4\"  \n[6,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"   \"3\"   \"4\"  \n[7,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"   \"3\"   \"4\"  \n\nmatrix(natfare, nrow = 7, ncol = 12, byrow = TRUE)\n\n     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]\n[1,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\"  \"3\"  \"3\"   \"3\"   \"3\"  \n[2,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\"  \"3\"  \"3\"   \"3\"   \"3\"  \n[3,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\"  \"3\"  \"3\"   \"3\"   \"3\"  \n[4,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\"  \"3\"  \"3\"   \"3\"   \"3\"  \n[5,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\"  \"3\"  \"3\"   \"3\"   \"3\"  \n[6,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\"  \"3\"  \"3\"   \"3\"   \"3\"  \n[7,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\"  \"3\"  \"3\"   \"3\"   \"3\"  \n\n\ntableのデータ（tab_3.1）とセルを単位としたデータ（freq_tab_3.1）を作成する．\n\ntab_3.1 &lt;- xtabs(Freq ~ polviews + fefam + natfare)\nfreq_tab_3.1 &lt;- tibble(Freq, polviews, fefam, natfare)\n\n表3.2のモデルで推定を行う．モデル6から8まではスコアパラメータの正則化が必要であるが，適合度については問題なく求めることができる．\n\n# Model 1 - 独立モデル\nM1 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ polviews + fefam + natfare,\n    family = poisson,\n    data = _,\n    trace = F,\n    tolerance = 1e-12\n  )\n\n# Model 2 - 完全2元交互作用モデル\nM2 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ polviews * fefam + fefam * natfare + polviews * natfare,\n    family = poisson,\n    data = _,\n    trace = F,\n    tolerance = 1e-12\n  )\n\n# Model 3 - 条件付き独立 (polviews)\nM3 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ polviews * fefam + polviews * natfare,\n    family = poisson,\n    data = _,\n    trace = F,\n    tolerance = 1e-12\n  )\n\n# Model 4 - 条件付き独立 (fefam)\nM4 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ polviews * fefam + fefam * natfare,\n    family = poisson,\n    data = _,\n    trace = F,\n    tolerance = 1e-12\n  )\n\n# Model 5 - 条件付き独立 (natfare)\nM5 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ fefam * natfare + polviews * natfare,\n    family = poisson,\n    data = _,\n    trace = F,\n    tolerance = 1e-12\n  )\n\n# Model 6 - RC(1)+RL(1) 部分連関\n# 値の正則化が必要\nM6 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ polviews + fefam + natfare + \n      Mult(1, polviews, fefam) + \n      Mult(1, polviews, natfare),\n    data = _,\n    family = poisson,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n......................\nDone\n\n# Model 7 - RC(1)+RL(1) 部分連関 (一貫した行スコア - polviews)\n# 値の正則化が必要\nM7 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ polviews + fefam + natfare + \n      Mult(1, polviews, fefam + natfare),\n    data = _,\n    family = poisson,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.............................................\nDone\n\n# Model 8 - RC(1)+RL(1) 部分連関 (一貫した行スコア - polviews)\n# 行スコアへの等値制約\n# 値の正則化が必要\n\n# 等値制約をかけたいセルの水準を同じにする\nfreq_tab_3.1 &lt;- freq_tab_3.1 |&gt; \n  mutate(polviews.c = case_when(polviews == 1 ~ 1,  # mu1 = mu2\n                                polviews == 2 ~ 1,  # mu1 = mu2\n                                polviews == 3 ~ 2,\n                                polviews == 4 ~ 3,  # mu4 = mu5\n                                polviews == 5 ~ 3,  # mu4 = mu5\n                                polviews == 6 ~ 4,\n                                polviews == 7 ~ 5) |&gt;\n           factor())\n\nM8 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ polviews + fefam + natfare + \n      Mult(1, polviews.c, fefam + natfare),\n    data = _,\n    family = poisson,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n.\nDone\n\n\nモデル間の比較は次のように行う．\n\n# Model 3 と Model 2の比較\npchisq(q = M3$deviance - M2$deviance,\n       df = M3$df.residual - M2$df.residual,\n       lower.tail = FALSE)\n\n[1] 0.06425806\n\n# Model 6 と Model 3の比較\npchisq(q = M6$deviance - M3$deviance,\n       df = M6$df.residual - M3$df.residual,\n       lower.tail = FALSE)\n\n[1] 0.1266967\n\n# Model 13 と Model 8の比較\n## Model 13が推定できないため表の値を用いる\npchisq(q = 9.22,\n       df = 6,\n       lower.tail = FALSE)\n\n[1] 0.1615782"
  },
  {
    "objectID": "4-Chapter_3.html#表3.2",
    "href": "4-Chapter_3.html#表3.2",
    "title": "3  第3章",
    "section": "3.2 表3.2",
    "text": "3.2 表3.2\n表3.2を再現する．\n\n## 表3.2\n\n# リストを作成\nM &lt;- list()\n# モデルの適合度をリストに順に格納\nM[[1]] &lt;- model.summary(M1, \"1. Complete independence\") \nM[[2]] &lt;- model.summary(M2, \"2. Full two-way interaction\") \nM[[3]] &lt;- model.summary(M3, \"3. Conditional independence on POLVIEWS\") \nM[[4]] &lt;- model.summary(M4, \"4. Conditional independence on FEFAM\")\nM[[5]] &lt;- model.summary(M5, \"5. Conditional independence on NATFARE\")\nM[[6]] &lt;- model.summary(M6, \"6. RC(1) + RL(1) partial association\")\nM[[7]] &lt;- model.summary(M7, \"7. Model 6 plus consisitent row (POLVIEWS) score restrictions\")\nM[[8]] &lt;- model.summary(M8, \"8. Model 6 plus consisitent and equality restrictions on row (POLVIEWS) scores (mu_1 = mu_2, mu_4 = mu_5)\")\n# リストを行方向に合併する\nM |&gt; bind_rows()\n\n# A tibble: 8 × 6\n  `Model Description`                               df    L2   BIC Delta       p\n  &lt;chr&gt;                                          &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;\n1 1. Complete independence                          72 168.  -324. 14.1  1.37e-9\n2 2. Full two-way interaction                       36  35.4 -211.  5.72 4.99e-1\n3 3. Conditional independence on POLVIEWS           42  47.3 -240.  7.30 2.67e-1\n4 4. Conditional independence on FEFAM              48  87.3 -241. 10.3  4.50e-4\n5 5. Conditional independence on NATFARE            54  91.0 -278. 10.1  1.21e-3\n6 6. RC(1) + RL(1) partial association              57  68.6 -321.  8.83 1.40e-1\n7 7. Model 6 plus consisitent row (POLVIEWS) sc…    62  72.8 -351.  9.07 1.65e-1\n8 8. Model 6 plus consisitent and equality rest…    64  73.6 -364.  9.21 1.93e-1"
  },
  {
    "objectID": "4-Chapter_3.html#表3.3",
    "href": "4-Chapter_3.html#表3.3",
    "title": "3  第3章",
    "section": "3.3 表3.3",
    "text": "3.3 表3.3\n表3.3を再現するために，モデル6から8までのスコアパラメータの正則化を行う．\nまずはモデル6である．\n\n# Estimating standard error\n# Model 6\n\n# 変数と係数と係数の順番を表示\npickCoef(M6, \"[.]polviews\")\n\n  Mult(1, ., fefam).polviews1   Mult(1, ., fefam).polviews2 \n                           14                            15 \n  Mult(1, ., fefam).polviews3   Mult(1, ., fefam).polviews4 \n                           16                            17 \n  Mult(1, ., fefam).polviews5   Mult(1, ., fefam).polviews6 \n                           18                            19 \n  Mult(1, ., fefam).polviews7 Mult(1, ., natfare).polviews1 \n                           20                            26 \nMult(1, ., natfare).polviews2 Mult(1, ., natfare).polviews3 \n                           27                            28 \nMult(1, ., natfare).polviews4 Mult(1, ., natfare).polviews5 \n                           29                            30 \nMult(1, ., natfare).polviews6 Mult(1, ., natfare).polviews7 \n                           31                            32 \n\npickCoef(M6, \"[.]fefam\")\n\nMult(1, polviews, .).fefam1 Mult(1, polviews, .).fefam2 \n                         21                          22 \nMult(1, polviews, .).fefam3 Mult(1, polviews, .).fefam4 \n                         23                          24 \n\npickCoef(M6, \"[.]natfare\")\n\nMult(1, polviews, .).natfare1 Mult(1, polviews, .).natfare2 \n                           33                            34 \nMult(1, polviews, .).natfare3 \n                           35 \n\ndata.frame(var = names(M6$coefficients),\n           estimate = M6$coefficients) |&gt; \n  mutate(estimate = estimate,\n         number = row_number())\n\n                                                        var    estimate number\n(Intercept)                                     (Intercept)  0.48474763      1\npolviews2                                         polviews2  1.05832580      2\npolviews3                                         polviews3  1.01245917      3\npolviews4                                         polviews4  2.33258096      4\npolviews5                                         polviews5  1.32513032      5\npolviews6                                         polviews6  1.24388465      6\npolviews7                                         polviews7 -0.12529134      7\nfefam2                                               fefam2  0.98729939      8\nfefam3                                               fefam3  0.44698341      9\nfefam4                                               fefam4 -0.85449092     10\nnatfare2                                           natfare2  0.35857000     11\nnatfare3                                           natfare3  0.31555604     12\nMult(., polviews, fefam).         Mult(., polviews, fefam). -3.20992903     13\nMult(1, ., fefam).polviews1     Mult(1, ., fefam).polviews1  0.19740683     14\nMult(1, ., fefam).polviews2     Mult(1, ., fefam).polviews2  0.52075445     15\nMult(1, ., fefam).polviews3     Mult(1, ., fefam).polviews3  0.41056800     16\nMult(1, ., fefam).polviews4     Mult(1, ., fefam).polviews4 -0.01555105     17\nMult(1, ., fefam).polviews5     Mult(1, ., fefam).polviews5  0.04459210     18\nMult(1, ., fefam).polviews6     Mult(1, ., fefam).polviews6 -0.54077926     19\nMult(1, ., fefam).polviews7     Mult(1, ., fefam).polviews7 -0.83530931     20\nMult(1, polviews, .).fefam1     Mult(1, polviews, .).fefam1 -0.34153115     21\nMult(1, polviews, .).fefam2     Mult(1, polviews, .).fefam2 -0.08908215     22\nMult(1, polviews, .).fefam3     Mult(1, polviews, .).fefam3  0.17054596     23\nMult(1, polviews, .).fefam4     Mult(1, polviews, .).fefam4  0.32881856     24\nMult(., polviews, natfare).     Mult(., polviews, natfare).  2.77822167     25\nMult(1, ., natfare).polviews1 Mult(1, ., natfare).polviews1  0.81713838     26\nMult(1, ., natfare).polviews2 Mult(1, ., natfare).polviews2  0.40087807     27\nMult(1, ., natfare).polviews3 Mult(1, ., natfare).polviews3  0.25361432     28\nMult(1, ., natfare).polviews4 Mult(1, ., natfare).polviews4 -0.02688639     29\nMult(1, ., natfare).polviews5 Mult(1, ., natfare).polviews5  0.11802629     30\nMult(1, ., natfare).polviews6 Mult(1, ., natfare).polviews6 -0.58953046     31\nMult(1, ., natfare).polviews7 Mult(1, ., natfare).polviews7 -0.59214749     32\nMult(1, polviews, .).natfare1 Mult(1, polviews, .).natfare1  0.27716932     33\nMult(1, polviews, .).natfare2 Mult(1, polviews, .).natfare2  0.08074983     34\nMult(1, polviews, .).natfare3 Mult(1, polviews, .).natfare3 -0.34270409     35\n\n\n各スコアの両端のカテゴリ，つまり上記推定値のリストの 14,20,21,24,26,32,33,35番目の8つの値についてスコアを求め，固定する．\n\n# R POLVIEWS mu1[i], i = 1 to 7\nmu1 &lt;- getContrasts(model = M6, \n                    set = pickCoef(M6, \"fefam)[.]polviews\"),\n                    ref = \"mean\",\n                    scaleRef = \"mean\", \n                    scaleWeights = \"unit\")\n# C FEFAM nu[j], j = 1 to 4\nnu &lt;- getContrasts(model = M6, \n                   set = pickCoef(M6, \"[.]fefam\"), \n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\n# R POLVIEWS mu2[i], i = 1 to 7\nmu2 &lt;- getContrasts(model = M6, \n                    set = pickCoef(M6, \"natfare)[.]polviews\"), \n                    ref = \"mean\",\n                    scaleRef = \"mean\", \n                    scaleWeights = \"unit\")\n# L NATFARE eta[k], k = 1 to 3\neta &lt;- getContrasts(model = M6, \n                    set = pickCoef(M6, \"[.]natfare\"), \n                    ref = \"mean\",\n                    scaleRef = \"mean\", \n                    scaleWeights = \"unit\")\n\n# 確認 \nlist(mu1 = mu1, nu = nu, mu2 = mu2, eta = eta)\n\n$mu1\n                               Estimate Std. Error\nMult(1, ., fefam).polviews1  0.18890704 0.17539812\nMult(1, ., fefam).polviews2  0.45611586 0.11238050\nMult(1, ., fefam).polviews3  0.36505971 0.11498236\nMult(1, ., fefam).polviews4  0.01292237 0.08199631\nMult(1, ., fefam).polviews5  0.06262362 0.11058185\nMult(1, ., fefam).polviews6 -0.42111705 0.12367540\nMult(1, ., fefam).polviews7 -0.66451154 0.10976226\n\n$nu\n                              Estimate Std. Error\nMult(1, polviews, .).fefam1 -0.7026886 0.06444123\nMult(1, polviews, .).fefam2 -0.2081705 0.09371704\nMult(1, polviews, .).fefam3  0.3004108 0.10956493\nMult(1, polviews, .).fefam4  0.6104483 0.09158453\n\n$mu2\n                                 Estimate Std. Error\nMult(1, ., natfare).polviews1  0.60584367 0.12394769\nMult(1, ., natfare).polviews2  0.27518966 0.11469790\nMult(1, ., natfare).polviews3  0.15821154 0.11316687\nMult(1, ., natfare).polviews4 -0.06460260 0.07187236\nMult(1, ., natfare).polviews5  0.05050796 0.10030828\nMult(1, ., natfare).polviews6 -0.51153570 0.10405220\nMult(1, ., natfare).polviews7 -0.51361453 0.12512860\n\n$eta\n                                Estimate Std. Error\nMult(1, polviews, .).natfare1  0.6073482 0.07616839\nMult(1, polviews, .).natfare2  0.1689209 0.11149916\nMult(1, polviews, .).natfare3 -0.7762692 0.03533078\n\n\n正則化したスコアを求めることができたので， 各スコアの両端のカテゴリを取り出し，conとする．\n\ncon &lt;- c(mu1$qvframe[,1][c(1,7)], \n         nu$qvframe[,1][c(1,4)],\n         mu2$qvframe[,1][c(1,7)], \n         eta$qvframe[,1][c(1,3)])\n\nconを用いて制約を課す．制約を課す対象となるパラメータはconstrainで指定する．\n\nM6_SE &lt;- freq_tab_3.1 |&gt;\n  gnm(Freq ~ polviews + fefam + natfare + \n        Mult(1, polviews, fefam) + Mult(1, polviews, natfare),\n      constrain = c(14,20,21,24,26,32,33,35), \n      constrainTo = con,\n      data = _, \n      family = poisson, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n..............\nDone\n\nM6_SE_coef &lt;- tidy(M6_SE)\n\nWarning: The `tidy()` method for objects of class `gnm` is not maintained by the broom team, and is only supported through the `glm` tidier method. Please be cautious in interpreting and reporting broom output.\n\nThis warning is displayed once per session.\n\nM6_SE_coef |&gt; print(n = Inf)\n\n# A tibble: 35 × 5\n   term                          estimate std.error statistic   p.value\n   &lt;chr&gt;                            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;\n 1 (Intercept)                     0.491      0.271    1.81    7.07e- 2\n 2 polviews2                       1.03       0.229    4.52    6.06e- 6\n 3 polviews3                       0.993      0.226    4.39    1.12e- 5\n 4 polviews4                       2.33       0.212   11.0     3.35e-28\n 5 polviews5                       1.32       0.218    6.08    1.24e- 9\n 6 polviews6                       1.26       0.282    4.49    7.13e- 6\n 7 polviews7                      -0.0882     0.355   -0.248   8.04e- 1\n 8 fefam2                          1.01       0.188    5.40    6.70e- 8\n 9 fefam3                          0.498      0.340    1.46    1.43e- 1\n10 fefam4                         -0.787      0.449   -1.75    7.96e- 2\n11 natfare2                        0.329      0.127    2.60    9.35e- 3\n12 natfare3                        0.222      0.314    0.706   4.80e- 1\n13 Mult(., polviews, fefam).      -1.98       0.744   -2.66    7.73e- 3\n14 Mult(1, ., fefam).polviews1     0.189     NA       NA      NA       \n15 Mult(1, ., fefam).polviews2     0.456      0.308    1.48    1.39e- 1\n16 Mult(1, ., fefam).polviews3     0.365      0.285    1.28    2.00e- 1\n17 Mult(1, ., fefam).polviews4     0.0129     0.184    0.0703  9.44e- 1\n18 Mult(1, ., fefam).polviews5     0.0626     0.212    0.296   7.67e- 1\n19 Mult(1, ., fefam).polviews6    -0.421      0.205   -2.06    3.98e- 2\n20 Mult(1, ., fefam).polviews7    -0.665     NA       NA      NA       \n21 Mult(1, polviews, .).fefam1    -0.703     NA       NA      NA       \n22 Mult(1, polviews, .).fefam2    -0.208      0.152   -1.37    1.71e- 1\n23 Mult(1, polviews, .).fefam3     0.300      0.185    1.62    1.05e- 1\n24 Mult(1, polviews, .).fefam4     0.610     NA       NA      NA       \n25 Mult(., polviews, natfare).     1.57       0.405    3.87    1.10e- 4\n26 Mult(1, ., natfare).polviews1   0.606     NA       NA      NA       \n27 Mult(1, ., natfare).polviews2   0.275      0.200    1.38    1.68e- 1\n28 Mult(1, ., natfare).polviews3   0.158      0.191    0.828   4.08e- 1\n29 Mult(1, ., natfare).polviews4  -0.0646     0.156   -0.414   6.79e- 1\n30 Mult(1, ., natfare).polviews5   0.0505     0.177    0.286   7.75e- 1\n31 Mult(1, ., natfare).polviews6  -0.512      0.211   -2.43    1.53e- 2\n32 Mult(1, ., natfare).polviews7  -0.514     NA       NA      NA       \n33 Mult(1, polviews, .).natfare1   0.607     NA       NA      NA       \n34 Mult(1, polviews, .).natfare2   0.169      0.175    0.967   3.34e- 1\n35 Mult(1, polviews, .).natfare3  -0.776     NA       NA      NA       \n\n\nモデル7は少し難しい．モデル7は一貫した制約を課している．このモデルからまず一貫したpolviewsについて正則化した場合の値を求める．これが求まったら，次は一貫した制約を課していないモデルに，先ほどの正則化したスコアをRCとRLのそれぞれの部分に適用する．\n\n# Model 7\n\n# 変数と係数と係数の順番を表示\npickCoef(M7, \"[.]polviews\")\n\nMult(1, ., fefam + natfare).polviews1 Mult(1, ., fefam + natfare).polviews2 \n                                   14                                    15 \nMult(1, ., fefam + natfare).polviews3 Mult(1, ., fefam + natfare).polviews4 \n                                   16                                    17 \nMult(1, ., fefam + natfare).polviews5 Mult(1, ., fefam + natfare).polviews6 \n                                   18                                    19 \nMult(1, ., fefam + natfare).polviews7 \n                                   20 \n\npickCoef(M7, \"[.]fefam\")\n\nMult(1, polviews, . + natfare).fefam1 Mult(1, polviews, . + natfare).fefam2 \n                                   21                                    22 \nMult(1, polviews, . + natfare).fefam3 Mult(1, polviews, . + natfare).fefam4 \n                                   23                                    24 \n\npickCoef(M7, \"[.]natfare\")\n\nMult(1, polviews, fefam + .).natfare2 Mult(1, polviews, fefam + .).natfare3 \n                                   25                                    26 \n\ndata.frame(var = names(M7$coefficients),\n           estimate = M7$coefficients) |&gt; \n  mutate(estimate = estimate,\n         number = row_number())\n\n                                                                        var\n(Intercept)                                                     (Intercept)\npolviews2                                                         polviews2\npolviews3                                                         polviews3\npolviews4                                                         polviews4\npolviews5                                                         polviews5\npolviews6                                                         polviews6\npolviews7                                                         polviews7\nfefam2                                                               fefam2\nfefam3                                                               fefam3\nfefam4                                                               fefam4\nnatfare2                                                           natfare2\nnatfare3                                                           natfare3\nMult(., polviews, fefam + natfare).     Mult(., polviews, fefam + natfare).\nMult(1, ., fefam + natfare).polviews1 Mult(1, ., fefam + natfare).polviews1\nMult(1, ., fefam + natfare).polviews2 Mult(1, ., fefam + natfare).polviews2\nMult(1, ., fefam + natfare).polviews3 Mult(1, ., fefam + natfare).polviews3\nMult(1, ., fefam + natfare).polviews4 Mult(1, ., fefam + natfare).polviews4\nMult(1, ., fefam + natfare).polviews5 Mult(1, ., fefam + natfare).polviews5\nMult(1, ., fefam + natfare).polviews6 Mult(1, ., fefam + natfare).polviews6\nMult(1, ., fefam + natfare).polviews7 Mult(1, ., fefam + natfare).polviews7\nMult(1, polviews, . + natfare).fefam1 Mult(1, polviews, . + natfare).fefam1\nMult(1, polviews, . + natfare).fefam2 Mult(1, polviews, . + natfare).fefam2\nMult(1, polviews, . + natfare).fefam3 Mult(1, polviews, . + natfare).fefam3\nMult(1, polviews, . + natfare).fefam4 Mult(1, polviews, . + natfare).fefam4\nMult(1, polviews, fefam + .).natfare2 Mult(1, polviews, fefam + .).natfare2\nMult(1, polviews, fefam + .).natfare3 Mult(1, polviews, fefam + .).natfare3\n                                         estimate number\n(Intercept)                            0.49202515      1\npolviews2                              1.06030091      2\npolviews3                              1.01487463      3\npolviews4                              2.30383824      4\npolviews5                              1.29617955      5\npolviews6                              1.19043467      6\npolviews7                             -0.19793594      7\nfefam2                                 1.00427925      8\nfefam3                                 0.47378711      9\nfefam4                                -0.81437726     10\nnatfare2                               0.35496067     11\nnatfare3                               0.32747517     12\nMult(., polviews, fefam + natfare).   -1.09219057     13\nMult(1, ., fefam + natfare).polviews1 -1.66775892     14\nMult(1, ., fefam + natfare).polviews2 -1.56321568     15\nMult(1, ., fefam + natfare).polviews3 -1.11230647     16\nMult(1, ., fefam + natfare).polviews4  0.03194990     17\nMult(1, ., fefam + natfare).polviews5 -0.28854995     18\nMult(1, ., fefam + natfare).polviews6  1.83458565     19\nMult(1, ., fefam + natfare).polviews7  2.24607139     20\nMult(1, polviews, . + natfare).fefam1  0.51224676     21\nMult(1, polviews, . + natfare).fefam2  0.25524117     22\nMult(1, polviews, . + natfare).fefam3  0.03619135     23\nMult(1, polviews, . + natfare).fefam4 -0.09740947     24\nMult(1, polviews, fefam + .).natfare2 -0.12705848     25\nMult(1, polviews, fefam + .).natfare3 -0.46617526     26\n\n# mu[i], i = 1 to 7\nmu &lt;- getContrasts(model = M7, \n                   set = pickCoef(M7, \"[.]polviews\")[1:7], \n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\n\ncon &lt;- c(mu$qvframe[,1][c(1:7)], \n         mu$qvframe[,1][c(1:7)])\n\nここでは一貫した制約を課さないモデルを用い，制約で一貫したスコアを割り当てる．そして，制約のない列スコアと層スコアを正則化する．\n\nM7_SE &lt;- freq_tab_3.1 |&gt;\n  gnm(Freq ~ polviews + fefam + natfare + \n        Mult(1, polviews, fefam) + \n        Mult(1, polviews, natfare),\n      constrain = c(14:20, 26:32), \n      constrainTo = con,\n      data = _, \n      family = poisson, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...\nDone\n\n# nu[j], j = 1 to 4\nnu &lt;- getContrasts(model = M7_SE, \n                   set = pickCoef(M7_SE, \"[.]fefam\"), \n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\n# eta[k], k = 1 to 3\neta &lt;- getContrasts(model = M7_SE, \n                    set = pickCoef(M7_SE, \"[.]natfare\"), \n                    ref = \"mean\",\n                    scaleRef = \"mean\", \n                    scaleWeights = \"unit\")\n\ncon &lt;- c(mu$qvframe[,1][c(1:7)], \n         nu$qvframe[,1][c(1,4)],\n         mu$qvframe[,1][c(1:7)], \n         eta$qvframe[,1][c(1,3)])\n\n最後に一貫したスコア（行）と正則化したスコア（列と層）を用いて再度推定を行う．\n\nM7_SE &lt;- freq_tab_3.1 |&gt;\n  gnm(Freq ~ polviews + fefam + natfare + \n        Mult(1, polviews, fefam) + \n        Mult(1, polviews, natfare),\n      constrain = c(14:20,21,24,26:32,33,35), \n      constrainTo = con,\n      data = _, \n      family = poisson, \n      trace = T, \n      tolerance = 1e-12)\n\nInitialising\nInitial Deviance = 158.521933\nRunning start-up iterations\nStart-up iteration 1. Deviance = 74.526156\nStart-up iteration 2. Deviance = 72.913283\nRunning main iterations\nIteration 1. Deviance = 72.773923\nIteration 2. Deviance = 72.773834\nIteration 3. Deviance = 72.773834\nDone\n\nM7_SE_coef &lt;- tidy(M7_SE)\nM7_SE_coef |&gt; print(n = Inf)\n\n# A tibble: 35 × 5\n   term                          estimate std.error statistic   p.value\n   &lt;chr&gt;                            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;\n 1 (Intercept)                     0.497     0.200      2.49   1.28e- 2\n 2 polviews2                       1.06      0.184      5.78   7.52e- 9\n 3 polviews3                       1.03      0.190      5.42   5.91e- 8\n 4 polviews4                       2.34      0.200     11.7    1.01e-31\n 5 polviews5                       1.33      0.202      6.59   4.46e-11\n 6 polviews6                       1.27      0.287      4.42   9.73e- 6\n 7 polviews7                      -0.107     0.338     -0.317  7.51e- 1\n 8 fefam2                          0.983     0.0947    10.4    3.01e-25\n 9 fefam3                          0.435     0.104      4.19   2.73e- 5\n10 fefam4                         -0.864     0.150     -5.77   7.72e- 9\n11 natfare2                        0.345     0.0853     4.04   5.28e- 5\n12 natfare3                        0.290     0.0869     3.33   8.54e- 4\n13 Mult(., polviews, fefam).      -1.95      0.374     -5.21   1.92e- 7\n14 Mult(1, ., fefam).polviews1    -0.413    NA         NA     NA       \n15 Mult(1, ., fefam).polviews2    -0.386    NA         NA     NA       \n16 Mult(1, ., fefam).polviews3    -0.269    NA         NA     NA       \n17 Mult(1, ., fefam).polviews4     0.0275   NA         NA     NA       \n18 Mult(1, ., fefam).polviews5    -0.0555   NA         NA     NA       \n19 Mult(1, ., fefam).polviews6     0.494    NA         NA     NA       \n20 Mult(1, ., fefam).polviews7     0.601    NA         NA     NA       \n21 Mult(1, polviews, .).fefam1     0.726    NA         NA     NA       \n22 Mult(1, polviews, .).fefam2     0.170     0.150      1.14   2.55e- 1\n23 Mult(1, polviews, .).fefam3    -0.304     0.189     -1.61   1.08e- 1\n24 Mult(1, polviews, .).fefam4    -0.593    NA         NA     NA       \n25 Mult(., polviews, natfare).     1.44      0.226      6.36   2.03e-10\n26 Mult(1, ., natfare).polviews1  -0.413    NA         NA     NA       \n27 Mult(1, ., natfare).polviews2  -0.386    NA         NA     NA       \n28 Mult(1, ., natfare).polviews3  -0.269    NA         NA     NA       \n29 Mult(1, ., natfare).polviews4   0.0275   NA         NA     NA       \n30 Mult(1, ., natfare).polviews5  -0.0555   NA         NA     NA       \n31 Mult(1, ., natfare).polviews6   0.494    NA         NA     NA       \n32 Mult(1, ., natfare).polviews7   0.601    NA         NA     NA       \n33 Mult(1, polviews, .).natfare1  -0.580    NA         NA     NA       \n34 Mult(1, polviews, .).natfare2  -0.207     0.186     -1.12   2.64e- 1\n35 Mult(1, polviews, .).natfare3   0.788    NA         NA     NA       \n\n\nモデル8は1,1,2,3,3,4,5という制約があり，結局は1,2,3,4,5の5つのパラメータを推定することになる．しかし，あくまで1,1,2,3,3,4,5という7つのパラメータにウェイトをかける必要がある．そこでc(2,1,2,1,1)/7とすることで，等値制約をかけている部分は平均を2倍にし，c(2,1,2,1,1)とすることでウェイトも2倍にしている．\n\n# Model 8\n# mu[i], i = 1 to 7\nmu &lt;- getContrasts(model = M8,\n                   set = pickCoef(M8, \"[.]polviews.c\"),\n                   ref = c(2, 1, 2, 1, 1) / 7,\n                   scaleRef = c(2, 1, 2, 1, 1) / 7,\n                   scaleWeights = c(2, 1, 2, 1, 1))\n\nmu &lt;- getContrasts(model = M8,\n                   set = pickCoef(M8, \"[.]polviews.c\"),\n                   ref = c(2, 1, 2, 1, 1) / 7,\n                   scaleRef = c(2, 1, 2, 1, 1) / 7,\n                   scaleWeights = c(2, 1, 2, 1, 1))\nmu;mu\n\n                                            Estimate Std. Error\nMult(1, ., fefam + natfare).polviews.c1 -0.402725149 0.04298356\nMult(1, ., fefam + natfare).polviews.c2 -0.278981096 0.08172199\nMult(1, ., fefam + natfare).polviews.c3 -0.001961895 0.04688021\nMult(1, ., fefam + natfare).polviews.c4  0.491602614 0.08428340\nMult(1, ., fefam + natfare).polviews.c5  0.596752569 0.08715205\n\n\n                                            Estimate Std. Error\nMult(1, ., fefam + natfare).polviews.c1 -0.402725149 0.04298356\nMult(1, ., fefam + natfare).polviews.c2 -0.278981096 0.08172199\nMult(1, ., fefam + natfare).polviews.c3 -0.001961895 0.04688021\nMult(1, ., fefam + natfare).polviews.c4  0.491602614 0.08428340\nMult(1, ., fefam + natfare).polviews.c5  0.596752569 0.08715205\n\ncon &lt;- c(mu$qvframe[, 1][c(1, 1, 2, 3, 3, 4, 5)], \n         mu$qvframe[, 1][c(1, 1, 2, 3, 3, 4, 5)])\n\n一貫した行スコア（等値制約あり）を指定して再推定．\n\nM8 &lt;- freq_tab_3.1 |&gt; \n  gnm(Freq ~ polviews + fefam + natfare + \n        Mult(1, polviews, fefam) + \n        Mult(1, polviews, natfare),\n      constrain = c(14:20,26:32),\n      constrainTo = con,\n      data = _, \n      family = poisson, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...\nDone\n\ntidy(M8)\n\n# A tibble: 35 × 5\n   term        estimate std.error statistic   p.value\n   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;\n 1 (Intercept)    0.494   NA          NA    NA       \n 2 polviews2      1.05     0.184       5.70  1.20e- 8\n 3 polviews3      1.02    NA          NA    NA       \n 4 polviews4      2.33    NA          NA    NA       \n 5 polviews5      1.32    NA          NA    NA       \n 6 polviews6      1.26    NA          NA    NA       \n 7 polviews7     -0.122   NA          NA    NA       \n 8 fefam2         0.993    0.0956     10.4   2.62e-25\n 9 fefam3         0.451    0.104       4.33  1.52e- 5\n10 fefam4        -0.840    0.149      -5.64  1.72e- 8\n# ℹ 25 more rows\n\nglance(M8)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -189.  412.  453.     73.6          67    84\n\n\n次は列スコアと層スコアの正則化をおこなう．\n\n# nu[j], j = 1 to 4\nnu &lt;- getContrasts(model = M8, \n                   set = pickCoef(M8, \"[.]fefam\"), \n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\n\n# eta[k], k = 1 to 3\neta &lt;- getContrasts(model = M8, \n                    set = pickCoef(M8, \"[.]natfare\"), \n                    ref = \"mean\",\n                    scaleRef = \"mean\", \n                    scaleWeights = \"unit\")\n\ncon &lt;- c(mu$qvframe[,1][c(1,1,2,3,3,4,5)], \n         nu$qvframe[,1][c(1,4)],\n         mu$qvframe[,1][c(1,1,2,3,3,4,5)], \n         eta$qvframe[,1][c(1,3)])\n\n一貫した行スコア（等値制約あり）のすべて，列スコア（最初と最後），層スコア（最初と最後）を指定して再推定．\n\nM8_SE &lt;- freq_tab_3.1 |&gt; \n  gnm(Freq ~ polviews + fefam + natfare + \n        Mult(1, polviews, fefam) + \n        Mult(1, polviews, natfare),\n      constrain = c(14:20,21,24,26:32,33,35), \n      constrainTo = con,\n      data = _, \n      family = poisson, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations......\nDone\n\nM8_SE_coef &lt;- tidy(M8_SE)\nM8_SE_coef |&gt; print(n = Inf)\n\n# A tibble: 35 × 5\n   term                          estimate std.error statistic   p.value\n   &lt;chr&gt;                            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;\n 1 (Intercept)                    0.494      0.199      2.49   1.29e- 2\n 2 polviews2                      1.05       0.184      5.70   1.20e- 8\n 3 polviews3                      1.02       0.189      5.38   7.41e- 8\n 4 polviews4                      2.33       0.195     12.0    6.32e-33\n 5 polviews5                      1.32       0.207      6.39   1.62e-10\n 6 polviews6                      1.25       0.286      4.39   1.12e- 5\n 7 polviews7                     -0.123      0.337     -0.366  7.14e- 1\n 8 fefam2                         0.993      0.0956    10.4    2.62e-25\n 9 fefam3                         0.451      0.104      4.33   1.52e- 5\n10 fefam4                        -0.840      0.149     -5.64   1.72e- 8\n11 natfare2                       0.346      0.0856     4.04   5.36e- 5\n12 natfare3                       0.302      0.0868     3.48   5.01e- 4\n13 Mult(., polviews, fefam).     -1.94       0.374     -5.19   2.16e- 7\n14 Mult(1, ., fefam).polviews1   -0.403     NA         NA     NA       \n15 Mult(1, ., fefam).polviews2   -0.403     NA         NA     NA       \n16 Mult(1, ., fefam).polviews3   -0.279     NA         NA     NA       \n17 Mult(1, ., fefam).polviews4   -0.00196   NA         NA     NA       \n18 Mult(1, ., fefam).polviews5   -0.00196   NA         NA     NA       \n19 Mult(1, ., fefam).polviews6    0.492     NA         NA     NA       \n20 Mult(1, ., fefam).polviews7    0.597     NA         NA     NA       \n21 Mult(1, polviews, .).fefam1    0.733     NA         NA     NA       \n22 Mult(1, polviews, .).fefam2    0.162      0.150      1.08   2.78e- 1\n23 Mult(1, polviews, .).fefam3   -0.313      0.191     -1.64   1.01e- 1\n24 Mult(1, polviews, .).fefam4   -0.582     NA         NA     NA       \n25 Mult(., polviews, natfare).   -1.41       0.226     -6.25   4.03e-10\n26 Mult(1, ., natfare).polviews1 -0.403     NA         NA     NA       \n27 Mult(1, ., natfare).polviews2 -0.403     NA         NA     NA       \n28 Mult(1, ., natfare).polviews3 -0.279     NA         NA     NA       \n29 Mult(1, ., natfare).polviews4 -0.00196   NA         NA     NA       \n30 Mult(1, ., natfare).polviews5 -0.00196   NA         NA     NA       \n31 Mult(1, ., natfare).polviews6  0.492     NA         NA     NA       \n32 Mult(1, ., natfare).polviews7  0.597     NA         NA     NA       \n33 Mult(1, polviews, .).natfare1  0.569     NA         NA     NA       \n34 Mult(1, polviews, .).natfare2  0.222      0.190      1.17   2.42e- 1\n35 Mult(1, polviews, .).natfare3 -0.791     NA         NA     NA       \n\n\nすべてのスコアを列方向に合併し，表3.3を再現．\n\nbind_cols(\n  M6_SE_coef |&gt; dplyr::select(term, Model6 = estimate),\n  M7_SE_coef |&gt; dplyr::select(Model7 = estimate),\n  M8_SE_coef |&gt; dplyr::select(Model8 = estimate)) |&gt;\n  dplyr::filter(grepl(\"Mult\", term)) |&gt; \n  print(n = Inf)\n\n# A tibble: 23 × 4\n   term                           Model6  Model7   Model8\n   &lt;chr&gt;                           &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;\n 1 Mult(., polviews, fefam).     -1.98   -1.95   -1.94   \n 2 Mult(1, ., fefam).polviews1    0.189  -0.413  -0.403  \n 3 Mult(1, ., fefam).polviews2    0.456  -0.386  -0.403  \n 4 Mult(1, ., fefam).polviews3    0.365  -0.269  -0.279  \n 5 Mult(1, ., fefam).polviews4    0.0129  0.0275 -0.00196\n 6 Mult(1, ., fefam).polviews5    0.0626 -0.0555 -0.00196\n 7 Mult(1, ., fefam).polviews6   -0.421   0.494   0.492  \n 8 Mult(1, ., fefam).polviews7   -0.665   0.601   0.597  \n 9 Mult(1, polviews, .).fefam1   -0.703   0.726   0.733  \n10 Mult(1, polviews, .).fefam2   -0.208   0.170   0.162  \n11 Mult(1, polviews, .).fefam3    0.300  -0.304  -0.313  \n12 Mult(1, polviews, .).fefam4    0.610  -0.593  -0.582  \n13 Mult(., polviews, natfare).    1.57    1.44   -1.41   \n14 Mult(1, ., natfare).polviews1  0.606  -0.413  -0.403  \n15 Mult(1, ., natfare).polviews2  0.275  -0.386  -0.403  \n16 Mult(1, ., natfare).polviews3  0.158  -0.269  -0.279  \n17 Mult(1, ., natfare).polviews4 -0.0646  0.0275 -0.00196\n18 Mult(1, ., natfare).polviews5  0.0505 -0.0555 -0.00196\n19 Mult(1, ., natfare).polviews6 -0.512   0.494   0.492  \n20 Mult(1, ., natfare).polviews7 -0.514   0.601   0.597  \n21 Mult(1, polviews, .).natfare1  0.607  -0.580   0.569  \n22 Mult(1, polviews, .).natfare2  0.169  -0.207   0.222  \n23 Mult(1, polviews, .).natfare3 -0.776   0.788  -0.791"
  },
  {
    "objectID": "4-Chapter_3.html#表3.4",
    "href": "4-Chapter_3.html#表3.4",
    "title": "3  第3章",
    "section": "3.4 表3.4",
    "text": "3.4 表3.4\n表3.4のデータを入力する．\n\n# 表3.1\nFreq &lt;- c(76, 14, 15,  4,\n        32, 17,  7,  3,\n        64, 23, 28, 15,\n        41, 11, 27, 16,\n        15,  2,  7,  4,\n        27, 20,  9,  5,\n        57, 31, 24, 15,\n        27,  9, 22, 16,\n        13,  6, 13,  5,\n        12, 13, 10,  6,\n        46, 32, 75, 20,\n        54, 26, 58, 55,\n        7,  6,  7,  6,\n        7,  2,  3,  6,\n        12, 11, 31, 15,\n        52, 36, 80,101)\n\n行，列，層のカテゴリを入力し，matrixで確認する．\n\nL &lt;- gl(4, 16, 64)\nR &lt;- gl(4, 4, 64)\nC &lt;- gl(4, 1, 64)\n\n# 確認する\nL |&gt; matrix(nrow = 16, ncol = 4, byrow = TRUE)\n\n      [,1] [,2] [,3] [,4]\n [1,] \"1\"  \"1\"  \"1\"  \"1\" \n [2,] \"1\"  \"1\"  \"1\"  \"1\" \n [3,] \"1\"  \"1\"  \"1\"  \"1\" \n [4,] \"1\"  \"1\"  \"1\"  \"1\" \n [5,] \"2\"  \"2\"  \"2\"  \"2\" \n [6,] \"2\"  \"2\"  \"2\"  \"2\" \n [7,] \"2\"  \"2\"  \"2\"  \"2\" \n [8,] \"2\"  \"2\"  \"2\"  \"2\" \n [9,] \"3\"  \"3\"  \"3\"  \"3\" \n[10,] \"3\"  \"3\"  \"3\"  \"3\" \n[11,] \"3\"  \"3\"  \"3\"  \"3\" \n[12,] \"3\"  \"3\"  \"3\"  \"3\" \n[13,] \"4\"  \"4\"  \"4\"  \"4\" \n[14,] \"4\"  \"4\"  \"4\"  \"4\" \n[15,] \"4\"  \"4\"  \"4\"  \"4\" \n[16,] \"4\"  \"4\"  \"4\"  \"4\" \n\nR |&gt; matrix(nrow = 16, ncol = 4, byrow = TRUE)\n\n      [,1] [,2] [,3] [,4]\n [1,] \"1\"  \"1\"  \"1\"  \"1\" \n [2,] \"2\"  \"2\"  \"2\"  \"2\" \n [3,] \"3\"  \"3\"  \"3\"  \"3\" \n [4,] \"4\"  \"4\"  \"4\"  \"4\" \n [5,] \"1\"  \"1\"  \"1\"  \"1\" \n [6,] \"2\"  \"2\"  \"2\"  \"2\" \n [7,] \"3\"  \"3\"  \"3\"  \"3\" \n [8,] \"4\"  \"4\"  \"4\"  \"4\" \n [9,] \"1\"  \"1\"  \"1\"  \"1\" \n[10,] \"2\"  \"2\"  \"2\"  \"2\" \n[11,] \"3\"  \"3\"  \"3\"  \"3\" \n[12,] \"4\"  \"4\"  \"4\"  \"4\" \n[13,] \"1\"  \"1\"  \"1\"  \"1\" \n[14,] \"2\"  \"2\"  \"2\"  \"2\" \n[15,] \"3\"  \"3\"  \"3\"  \"3\" \n[16,] \"4\"  \"4\"  \"4\"  \"4\" \n\nC |&gt; matrix(nrow = 16, ncol = 4, byrow = TRUE)\n\n      [,1] [,2] [,3] [,4]\n [1,] \"1\"  \"2\"  \"3\"  \"4\" \n [2,] \"1\"  \"2\"  \"3\"  \"4\" \n [3,] \"1\"  \"2\"  \"3\"  \"4\" \n [4,] \"1\"  \"2\"  \"3\"  \"4\" \n [5,] \"1\"  \"2\"  \"3\"  \"4\" \n [6,] \"1\"  \"2\"  \"3\"  \"4\" \n [7,] \"1\"  \"2\"  \"3\"  \"4\" \n [8,] \"1\"  \"2\"  \"3\"  \"4\" \n [9,] \"1\"  \"2\"  \"3\"  \"4\" \n[10,] \"1\"  \"2\"  \"3\"  \"4\" \n[11,] \"1\"  \"2\"  \"3\"  \"4\" \n[12,] \"1\"  \"2\"  \"3\"  \"4\" \n[13,] \"1\"  \"2\"  \"3\"  \"4\" \n[14,] \"1\"  \"2\"  \"3\"  \"4\" \n[15,] \"1\"  \"2\"  \"3\"  \"4\" \n[16,] \"1\"  \"2\"  \"3\"  \"4\" \n\n\n以上をtibbleでまとめ，データを作成する．\n\nfreq_tab_3.1 &lt;- tibble(Freq, L, R, C) |&gt; arrange(L, R, C)\nfreq_tab_3.1\n\n# A tibble: 64 × 4\n    Freq L     R     C    \n   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;\n 1    76 1     1     1    \n 2    14 1     1     2    \n 3    15 1     1     3    \n 4     4 1     1     4    \n 5    32 1     2     1    \n 6    17 1     2     2    \n 7     7 1     2     3    \n 8     3 1     2     4    \n 9    64 1     3     1    \n10    23 1     3     2    \n# ℹ 54 more rows\n\n\n行，列，層について整数スコアを作成する．\n\nfreq_tab_3.1 &lt;- freq_tab_3.1 |&gt; \n  mutate(Rscore = as.numeric(R),\n         Cscore = as.numeric(C),\n         Lscore = as.numeric(L))\nfreq_tab_3.1\n\n# A tibble: 64 × 7\n    Freq L     R     C     Rscore Cscore Lscore\n   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;\n 1    76 1     1     1          1      1      1\n 2    14 1     1     2          1      2      1\n 3    15 1     1     3          1      3      1\n 4     4 1     1     4          1      4      1\n 5    32 1     2     1          2      1      1\n 6    17 1     2     2          2      2      1\n 7     7 1     2     3          2      3      1\n 8     3 1     2     4          2      4      1\n 9    64 1     3     1          3      1      1\n10    23 1     3     2          3      2      1\n# ℹ 54 more rows\n\n\nそれではモデル1から15までを用いた推定を行う．ただしgnmではモデル3と5の推定はできない． また\n\n# Model 1 - Complete Independence\nmodel1 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ R + C + L,\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\n# Model 2 - Unrestricted RC(1)+RL(1)+CL(1)\nmodel2 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ R + C + L + Mult(1, R, C) + Mult(1, R, L) + Mult(1, C, L),\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n...................................\nDone\n\n# Model 3 - Restricted RC(1)+RL(1)+CL(1) with consistent score\n# It may not be fitted with gnm package!\n\n# Model 4 - Model 2 with consistent cells fitted exactly\nfreq_tab_3.1 &lt;- freq_tab_3.1 |&gt;\n  mutate(consistent.cells = factor(ifelse((R == C) & (C == L), R, 0)))\nmodel4 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ R + C + L + consistent.cells +\n      Mult(1, R, C) + Mult(1, R, L) + Mult(1, C, L),\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n........\nDone\n\n# Model 5 - Model 3 with consistent cells fitted exactly\n# It may not be fitted with gnm package!\n\n# Model 6 - Full Two-way interaction\nmodel6 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ R * C + R * L + C * L,\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\nsummary(model6)\n\n\nCall:\ngnm(formula = Freq ~ R * C + R * L + C * L, family = poisson, \n    data = freq_tab_3.1, tolerance = 1e-12, trace = F)\n\nDeviance Residuals: \n      Min         1Q     Median         3Q        Max  \n-1.685582  -0.504109  -0.008581   0.460359   1.299438  \n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  4.26029    0.11066  38.499  &lt; 2e-16 ***\nR2          -0.79606    0.18519  -4.299 1.72e-05 ***\nR3          -0.09579    0.14996  -0.639  0.52299    \nR4          -0.43476    0.16083  -2.703  0.00687 ** \nC2          -1.63953    0.22829  -7.182 6.89e-13 ***\nC3          -1.39351    0.20261  -6.878 6.08e-12 ***\nC4          -2.33707    0.28019  -8.341  &lt; 2e-16 ***\nR2:C2        0.90120    0.28232   3.192  0.00141 ** \nR3:C2        0.63274    0.25192   2.512  0.01202 *  \nR4:C2        0.33707    0.26138   1.290  0.19719    \nR2:C3       -0.06534    0.29098  -0.225  0.82232    \nR3:C3        0.66917    0.22004   3.041  0.00236 ** \nR4:C3        0.60286    0.22215   2.714  0.00665 ** \nR2:C4        0.34284    0.36220   0.947  0.34388    \nR3:C4        0.56412    0.29673   1.901  0.05729 .  \nR4:C4        1.27643    0.28261   4.517 6.29e-06 ***\nL2          -1.48502    0.22186  -6.694 2.18e-11 ***\nL3          -1.52970    0.20833  -7.343 2.10e-13 ***\nL4          -2.08728    0.24553  -8.501  &lt; 2e-16 ***\nR2:L2        1.34634    0.28170   4.779 1.76e-06 ***\nR3:L2        1.28703    0.24739   5.203 1.97e-07 ***\nR4:L2        1.03853    0.26517   3.916 8.99e-05 ***\nR2:L3        0.67005    0.28444   2.356  0.01849 *  \nR3:L3        1.21742    0.22757   5.350 8.81e-08 ***\nR4:L3        1.59671    0.23321   6.847 7.56e-12 ***\nR2:L4        0.17240    0.35528   0.485  0.62750    \nR3:L4        0.61348    0.27149   2.260  0.02384 *  \nR4:L4        2.16906    0.25643   8.459  &lt; 2e-16 ***\nC2:L2        0.35033    0.21463   1.632  0.10263    \nC3:L2        0.22827    0.20862   1.094  0.27389    \nC4:L2        0.49174    0.25839   1.903  0.05703 .  \nC2:L3        0.65539    0.20819   3.148  0.00164 ** \nC3:L3        1.09826    0.18400   5.969 2.39e-09 ***\nC4:L3        1.11150    0.23123   4.807 1.53e-06 ***\nC2:L4        0.87747    0.23892   3.673  0.00024 ***\nC3:L4        1.29956    0.20753   6.262 3.80e-10 ***\nC4:L4        1.79692    0.23862   7.530 5.06e-14 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nResidual deviance: 28.998 on 27 degrees of freedom\nAIC: 397.32\n\nNumber of iterations: 5\n\n# Model 7 - Model 6 with consistent cells fitted exactly\nmodel7 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ R * C + R * L + C * L + consistent.cells,\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\nsummary(model7)\n\n\nCall:\ngnm(formula = Freq ~ R * C + R * L + C * L + consistent.cells, \n    family = poisson, data = freq_tab_3.1, tolerance = 1e-12,     trace = F)\n\nDeviance Residuals: \n       Min          1Q      Median          3Q         Max  \n-1.505e+00  -4.123e-01  -1.490e-08   3.008e-01   1.562e+00  \n\nCoefficients:\n                  Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)        3.70806    0.31642  11.719  &lt; 2e-16 ***\nR2                -0.26471    0.33752  -0.784 0.432870    \nR3                 0.43595    0.31473   1.385 0.166007    \nR4                 0.04506    0.31538   0.143 0.886401    \nC2                -1.23787    0.31573  -3.921 8.83e-05 ***\nC3                -0.95472    0.29544  -3.232 0.001231 ** \nC4                -2.00687    0.35086  -5.720 1.07e-08 ***\nR2:C2              0.49806    0.36012   1.383 0.166653    \nR3:C2              0.33263    0.30439   1.093 0.274482    \nR4:C2              0.02956    0.30915   0.096 0.923826    \nR2:C3             -0.37252    0.33538  -1.111 0.266684    \nR3:C3              0.21202    0.29412   0.721 0.470997    \nR4:C3              0.33724    0.27290   1.236 0.216553    \nR2:C4              0.06257    0.39636   0.158 0.874574    \nR3:C4              0.29993    0.33550   0.894 0.371334    \nR4:C4              1.06332    0.33951   3.132 0.001737 ** \nL2                -1.05809    0.31923  -3.314 0.000918 ***\nL3                -1.09080    0.29894  -3.649 0.000263 ***\nL4                -1.74115    0.32163  -5.413 6.18e-08 ***\nR2:L2              0.91597    0.36361   2.519 0.011766 *  \nR3:L2              0.93125    0.31450   2.961 0.003066 ** \nR4:L2              0.67771    0.32813   2.065 0.038888 *  \nR2:L3              0.33649    0.33467   1.005 0.314694    \nR3:L3              0.75119    0.30376   2.473 0.013399 *  \nR4:L3              1.28290    0.29072   4.413 1.02e-05 ***\nR2:L4             -0.12414    0.39162  -0.317 0.751243    \nR3:L4              0.33826    0.31651   1.069 0.285199    \nR4:L4              1.91005    0.31369   6.089 1.14e-09 ***\nC2:L2              0.17440    0.24791   0.704 0.481744    \nC3:L2              0.12343    0.21731   0.568 0.570049    \nC4:L2              0.38519    0.26377   1.460 0.144196    \nC2:L3              0.54622    0.21620   2.526 0.011522 *  \nC3:L3              0.78217    0.22762   3.436 0.000590 ***\nC4:L3              0.98203    0.23833   4.120 3.78e-05 ***\nC2:L4              0.75925    0.24670   3.078 0.002087 ** \nC3:L4              1.14125    0.21839   5.226 1.73e-07 ***\nC4:L4              1.79914    0.31902   5.640 1.70e-08 ***\nconsistent.cells1  0.62268    0.33657   1.850 0.064303 .  \nconsistent.cells2  0.25993    0.39723   0.654 0.512891    \nconsistent.cells3  0.47364    0.26552   1.784 0.074458 .  \nconsistent.cells4 -0.16248    0.31471  -0.516 0.605666    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nResidual deviance: 21.934 on 23 degrees of freedom\nAIC: 398.25\n\nNumber of iterations: 5\n\n# Model 8 - Unrestricted uniform and log-multiplicative association in all partial\n# association\nmodel8 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ R + C + L +\n      Rscore:Cscore +\n      Mult(1, R, C) +\n      Rscore:Lscore +\n      Mult(1, R, L) +\n      Cscore:Lscore +\n      Mult(1, C, L),\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n...............................\nDone\n\nsummary(model8)\n\n\nCall:\ngnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + \n    Rscore:Lscore + Mult(1, R, L) + Cscore:Lscore + Mult(1, C, \n    L), family = poisson, data = freq_tab_3.1, tolerance = 1e-12,     trace = F)\n\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.64348  -0.68031  -0.02712   0.48954   2.01814  \n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       3.60693         NA      NA       NA    \nR2               -1.01167         NA      NA       NA    \nR3               -0.77554         NA      NA       NA    \nR4               -1.57822         NA      NA       NA    \nC2               -1.61662         NA      NA       NA    \nC3               -2.12871         NA      NA       NA    \nC4               -3.43368         NA      NA       NA    \nL2               -1.46017         NA      NA       NA    \nL3               -2.24968         NA      NA       NA    \nL4               -3.81125         NA      NA       NA    \nRscore:Cscore     0.12964    0.02728   4.752 2.01e-06 ***\nMult(., R, C).   -0.31244         NA      NA       NA    \nMult(1, ., C).R1 -1.63271         NA      NA       NA    \nMult(1, ., C).R2  3.47985         NA      NA       NA    \nMult(1, ., C).R3  1.52499         NA      NA       NA    \nMult(1, ., C).R4 -2.05566         NA      NA       NA    \nMult(1, R, .).C1  0.05575         NA      NA       NA    \nMult(1, R, .).C2 -0.37654         NA      NA       NA    \nMult(1, R, .).C3 -0.03156         NA      NA       NA    \nMult(1, R, .).C4  0.28337         NA      NA       NA    \nRscore:Lscore     0.25450    0.02803   9.080  &lt; 2e-16 ***\nMult(., R, L).    2.87501         NA      NA       NA    \nMult(1, ., L).R1  0.30861         NA      NA       NA    \nMult(1, ., L).R2 -0.31186         NA      NA       NA    \nMult(1, ., L).R3 -0.24491         NA      NA       NA    \nMult(1, ., L).R4  0.18585         NA      NA       NA    \nMult(1, R, .).L1  0.03578         NA      NA       NA    \nMult(1, R, .).L2 -0.48889         NA      NA       NA    \nMult(1, R, .).L3 -0.10059         NA      NA       NA    \nMult(1, R, .).L4  0.54893         NA      NA       NA    \nCscore:Lscore     0.20172    0.02585   7.802  &lt; 2e-16 ***\nMult(., C, L).   -0.16302         NA      NA       NA    \nMult(1, ., L).C1 -1.08705         NA      NA       NA    \nMult(1, ., L).C2  0.34687         NA      NA       NA    \nMult(1, ., L).C3  4.26150         NA      NA       NA    \nMult(1, ., L).C4 -1.39883         NA      NA       NA    \nMult(1, C, .).L1 -0.02898         NA      NA       NA    \nMult(1, C, .).L2  0.15167         NA      NA       NA    \nMult(1, C, .).L3 -0.38468         NA      NA       NA    \nMult(1, C, .).L4 -0.05859         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 45.854 on 36 degrees of freedom\nAIC: 396.17\n\nNumber of iterations: 88\n\npickCoef(model8, \"[.]R\")\n\nMult(1, ., C).R1 Mult(1, ., C).R2 Mult(1, ., C).R3 Mult(1, ., C).R4 \n              13               14               15               16 \nMult(1, ., L).R1 Mult(1, ., L).R2 Mult(1, ., L).R3 Mult(1, ., L).R4 \n              23               24               25               26 \n\npickCoef(model8, \"[.]C\")\n\nMult(1, R, .).C1 Mult(1, R, .).C2 Mult(1, R, .).C3 Mult(1, R, .).C4 \n              17               18               19               20 \nMult(1, ., L).C1 Mult(1, ., L).C2 Mult(1, ., L).C3 Mult(1, ., L).C4 \n              33               34               35               36 \n\npickCoef(model8, \"[.]L\")\n\nMult(1, R, .).L1 Mult(1, R, .).L2 Mult(1, R, .).L3 Mult(1, R, .).L4 \n              27               28               29               30 \nMult(1, C, .).L1 Mult(1, C, .).L2 Mult(1, C, .).L3 Mult(1, C, .).L4 \n              37               38               39               40 \n\ndata.frame(var = names(model8$coefficients),\n           estimate = model8$coefficients) |&gt; \n  mutate(estimate = estimate,\n         number = row_number())\n\n                              var    estimate number\n(Intercept)           (Intercept)  3.60692620      1\nR2                             R2 -1.01167434      2\nR3                             R3 -0.77554494      3\nR4                             R4 -1.57822217      4\nC2                             C2 -1.61662325      5\nC3                             C3 -2.12871031      6\nC4                             C4 -3.43367605      7\nL2                             L2 -1.46016646      8\nL3                             L3 -2.24968488      9\nL4                             L4 -3.81125448     10\nRscore:Cscore       Rscore:Cscore  0.12964400     11\nMult(., R, C).     Mult(., R, C). -0.31244260     12\nMult(1, ., C).R1 Mult(1, ., C).R1 -1.63270821     13\nMult(1, ., C).R2 Mult(1, ., C).R2  3.47985185     14\nMult(1, ., C).R3 Mult(1, ., C).R3  1.52499437     15\nMult(1, ., C).R4 Mult(1, ., C).R4 -2.05566336     16\nMult(1, R, .).C1 Mult(1, R, .).C1  0.05575034     17\nMult(1, R, .).C2 Mult(1, R, .).C2 -0.37653772     18\nMult(1, R, .).C3 Mult(1, R, .).C3 -0.03155909     19\nMult(1, R, .).C4 Mult(1, R, .).C4  0.28337126     20\nRscore:Lscore       Rscore:Lscore  0.25449639     21\nMult(., R, L).     Mult(., R, L).  2.87500695     22\nMult(1, ., L).R1 Mult(1, ., L).R1  0.30860636     23\nMult(1, ., L).R2 Mult(1, ., L).R2 -0.31185837     24\nMult(1, ., L).R3 Mult(1, ., L).R3 -0.24491005     25\nMult(1, ., L).R4 Mult(1, ., L).R4  0.18584929     26\nMult(1, R, .).L1 Mult(1, R, .).L1  0.03578225     27\nMult(1, R, .).L2 Mult(1, R, .).L2 -0.48888799     28\nMult(1, R, .).L3 Mult(1, R, .).L3 -0.10058517     29\nMult(1, R, .).L4 Mult(1, R, .).L4  0.54893163     30\nCscore:Lscore       Cscore:Lscore  0.20172487     31\nMult(., C, L).     Mult(., C, L). -0.16302338     32\nMult(1, ., L).C1 Mult(1, ., L).C1 -1.08704846     33\nMult(1, ., L).C2 Mult(1, ., L).C2  0.34687251     34\nMult(1, ., L).C3 Mult(1, ., L).C3  4.26150034     35\nMult(1, ., L).C4 Mult(1, ., L).C4 -1.39882567     36\nMult(1, C, .).L1 Mult(1, C, .).L1 -0.02897926     37\nMult(1, C, .).L2 Mult(1, C, .).L2  0.15167020     38\nMult(1, C, .).L3 Mult(1, C, .).L3 -0.38468311     39\nMult(1, C, .).L4 Mult(1, C, .).L4 -0.05858752     40\n\n# mu1: 13-16\nmu1 &lt;- getContrasts(\n  model8,\n  pickCoef(model8, \"[.]R\")[1:4],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\nmu1\n\n                   Estimate Std. Error\nMult(1, ., C).R1 -0.4291986 0.18120993\nMult(1, ., C).R2  0.6893016 0.09977232\nMult(1, ., C).R3  0.2616277 0.15931019\nMult(1, ., C).R4 -0.5217306 0.15976113\n\n# nu1: 17-20\nnu1 &lt;- getContrasts(\n  model8,\n  pickCoef(model8, \"[.]C\")[1:4],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\nnu1\n\n                    Estimate Std. Error\nMult(1, R, .).C1  0.15388700 0.15383900\nMult(1, R, .).C2 -0.75746716 0.08227847\nMult(1, R, .).C3 -0.03017965 0.15480459\nMult(1, R, .).C4  0.63375980 0.11651692\n\n# mu2: 23-26\nmu2 &lt;- getContrasts(\n  model8,\n  pickCoef(model8, \"[.]R\")[5:8],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\nmu2\n\n                   Estimate Std. Error\nMult(1, ., L).R1  0.6061444 0.08512883\nMult(1, ., L).R2 -0.5539702 0.08877502\nMult(1, ., L).R3 -0.4287935 0.09713147\nMult(1, ., L).R4  0.3766193 0.10554742\n\n# eta1: 27-30\neta1 &lt;- getContrasts(\n  model8,\n  pickCoef(model8, \"[.]L\")[1:4],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\neta1\n\n                    Estimate Std. Error\nMult(1, R, .).L1  0.04977493 0.08992116\nMult(1, R, .).L2 -0.65658058 0.06234704\nMult(1, R, .).L3 -0.13381443 0.08765352\nMult(1, R, .).L4  0.74062008 0.04970264\n\n# nu2: 33-36\nnu2 &lt;- getContrasts(\n  model8,\n  pickCoef(model8, \"[.]C\")[5:8],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\nnu2\n\n                    Estimate Std. Error\nMult(1, ., L).C1 -0.35910324  0.2995712\nMult(1, ., L).C2 -0.04079069  0.3606231\nMult(1, ., L).C3  0.82820782  0.1075525\nMult(1, ., L).C4 -0.42831389  0.3177968\n\n# eta2: 37-40\neta2 &lt;- getContrasts(\n  model8,\n  pickCoef(model8, \"[.]L\")[5:8],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\neta2\n\n                    Estimate Std. Error\nMult(1, C, .).L1  0.13230141  0.3592002\nMult(1, C, .).L2  0.59941504  0.2494518\nMult(1, C, .).L3 -0.78745843  0.1409196\nMult(1, C, .).L4  0.05574198  0.3241035\n\ncon &lt;- c(mu1$qvframe[, 1][c(1,4)],\n         nu1$qvframe[, 1][c(1,4)],\n         mu2$qvframe[, 1][c(1,4)],\n         eta1$qvframe[, 1][c(1,4)],\n         nu2$qvframe[, 1][c(1,4)],\n         eta2$qvframe[, 1][c(1,4)])\n\n\nmodel8_se &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ R + C + L +\n      Rscore:Cscore +\n      Mult(1, R, C) +\n      Rscore:Lscore +\n      Mult(1, R, L) +\n      Cscore:Lscore +\n      Mult(1, C, L),\n#    constrain = c(13,16,17,20,23,26,27,30,33,36,37,40),\n#    constrainTo = con,\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-15\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n................................................................................\n................................................................................\n................................................................................\n................................................................................\n................................................................................\n...........................................\nDone\n\n\nWarning in gnmFit(modelTools = modelTools, y = y, constrain = constrain, : Fitting algorithm has either not converged or converged\nto a non-solution of the likelihood equations.\nUse exitInfo() for numerical details of last iteration.\n\nsummary(model8_se)\n\n\nCall:\ngnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + \n    Rscore:Lscore + Mult(1, R, L) + Cscore:Lscore + Mult(1, C, \n    L), family = poisson, data = freq_tab_3.1, tolerance = 1e-15,     trace = F)\n\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.64348  -0.68031  -0.02712   0.48954   2.01814  \n\nCoefficients:\n                  Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       3.577460         NA      NA       NA    \nR2               -0.973276         NA      NA       NA    \nR3               -0.758854         NA      NA       NA    \nR4               -1.588580         NA      NA       NA    \nC2               -1.542942         NA      NA       NA    \nC3               -2.068690         NA      NA       NA    \nC4               -3.468518         NA      NA       NA    \nL2               -1.465187         NA      NA       NA    \nL3               -2.265927         NA      NA       NA    \nL4               -3.800888         NA      NA       NA    \nRscore:Cscore     0.129644   0.027279   4.752 2.01e-06 ***\nMult(., R, C).    0.383050         NA      NA       NA    \nMult(1, ., C).R1 -1.159336         NA      NA       NA    \nMult(1, ., C).R2  1.685472         NA      NA       NA    \nMult(1, ., C).R3  0.597721         NA      NA       NA    \nMult(1, ., C).R4 -1.394684         NA      NA       NA    \nMult(1, R, .).C1 -0.140448         NA      NA       NA    \nMult(1, R, .).C2  0.493237         NA      NA       NA    \nMult(1, R, .).C3 -0.012462         NA      NA       NA    \nMult(1, R, .).C4 -0.474114         NA      NA       NA    \nRscore:Lscore     0.254496   0.028029   9.080  &lt; 2e-16 ***\nMult(., R, L).   -1.386577         NA      NA       NA    \nMult(1, ., L).R1 -0.782148         NA      NA       NA    \nMult(1, ., L).R2  0.831010         NA      NA       NA    \nMult(1, ., L).R3  0.656950         NA      NA       NA    \nMult(1, ., L).R4 -0.462989         NA      NA       NA    \nMult(1, R, .).L1  0.017094         NA      NA       NA    \nMult(1, R, .).L2 -0.401335         NA      NA       NA    \nMult(1, R, .).L3 -0.091660         NA      NA       NA    \nMult(1, R, .).L4  0.426335         NA      NA       NA    \nCscore:Lscore     0.201725   0.025855   7.802  &lt; 2e-16 ***\nMult(., C, L).   -0.579236         NA      NA       NA    \nMult(1, ., L).C1  0.101332         NA      NA       NA    \nMult(1, ., L).C2 -0.067722         NA      NA       NA    \nMult(1, ., L).C3 -0.529243         NA      NA       NA    \nMult(1, ., L).C4  0.138090         NA      NA       NA    \nMult(1, C, .).L1 -0.061478         NA      NA       NA    \nMult(1, C, .).L2 -0.492728         NA      NA       NA    \nMult(1, C, .).L3  0.787668         NA      NA       NA    \nMult(1, C, .).L4  0.009204         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 45.854 on 36 degrees of freedom\nAIC: 396.17\n\nNumber of iterations: 500\n\noptions(contrasts = c(factor=\"contr.treatment\",\n                      ordered=\"contr.treatment\"))\n# Model 9 - Model 8 with consistent row scores\nmodel9 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ R + C + L +\n      Rscore:Cscore +\n      Mult(1, R, C + L) +\n      Rscore:Lscore +\n      Cscore:Lscore +\n      Mult(1, C, L),\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n.......................\nDone\n\nsummary(model9)\n\n\nCall:\ngnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C + \n    L) + Rscore:Lscore + Cscore:Lscore + Mult(1, C, L), family = poisson, \n    data = freq_tab_3.1, tolerance = 1e-12, trace = F)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.56526  -0.67024  -0.02438   0.54037   1.98333  \n\nCoefficients:\n                     Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)           3.58040         NA      NA       NA    \nR2                   -0.94500         NA      NA       NA    \nR3                   -0.71682         NA      NA       NA    \nR4                   -1.55430         NA      NA       NA    \nC2                   -1.62568         NA      NA       NA    \nC3                   -2.14412         NA      NA       NA    \nC4                   -3.46459         NA      NA       NA    \nL2                   -1.47744         NA      NA       NA    \nL3                   -2.14620         NA      NA       NA    \nL4                   -3.78575         NA      NA       NA    \nRscore:Cscore         0.13353    0.02535   5.266 1.39e-07 ***\nMult(., R, C + L).   -2.41043         NA      NA       NA    \nMult(1, ., C + L).R1  0.37007         NA      NA       NA    \nMult(1, ., C + L).R2 -0.43599         NA      NA       NA    \nMult(1, ., C + L).R3 -0.29520         NA      NA       NA    \nMult(1, ., C + L).R4  0.27392         NA      NA       NA    \nMult(1, R, . + L).C1 -0.11286         NA      NA       NA    \nMult(1, R, . + L).C2  0.23922         NA      NA       NA    \nMult(1, R, . + L).C3 -0.02011         NA      NA       NA    \nMult(1, R, . + L).C4 -0.30674         NA      NA       NA    \nMult(1, R, C + .).L2  0.48101         NA      NA       NA    \nMult(1, R, C + .).L3  0.11952         NA      NA       NA    \nMult(1, R, C + .).L4 -0.46398         NA      NA       NA    \nRscore:Lscore         0.24848    0.02722   9.127  &lt; 2e-16 ***\nCscore:Lscore         0.20270    0.02562   7.913  &lt; 2e-16 ***\nMult(., C, L).       -1.89177         NA      NA       NA    \nMult(1, ., L).C1      0.20129         NA      NA       NA    \nMult(1, ., L).C2      0.10295         NA      NA       NA    \nMult(1, ., L).C3     -0.26711         NA      NA       NA    \nMult(1, ., L).C4      0.23233         NA      NA       NA    \nMult(1, C, .).L1      0.03139         NA      NA       NA    \nMult(1, C, .).L2     -0.16871         NA      NA       NA    \nMult(1, C, .).L3      0.35751         NA      NA       NA    \nMult(1, C, .).L4      0.04084         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 47.134 on 38 degrees of freedom\nAIC: 393.45\n\nNumber of iterations: 80\n\nmu &lt;- getContrasts(\n  model9,\n  pickCoef(model9, \"[.]R\"),\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\nnu2 &lt;- getContrasts(\n  model9,\n  pickCoef(model9, \"[.]C\")[5:8],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\neta2 &lt;- getContrasts(\n  model9,\n  pickCoef(model9, \"[.]L\")[4:7],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\nmodel9.extended &lt;-\n  freq_tab_3.1 |&gt; gnm(\n    Freq ~ R + C + L +\n      Rscore:Cscore +\n      Mult(1, R, C) +\n      Rscore:Lscore +\n      Mult(1, R, L) +\n      Cscore:Lscore +\n      Mult(1, C, L),\n    constrain = c(13:16, 23:26),\n    constrainTo = c(mu$qvframe[, 1], mu$qvframe[, 1]),\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n............................\nDone\n\nsummary(model9.extended)\n\n\nCall:\ngnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + \n    Rscore:Lscore + Mult(1, R, L) + Cscore:Lscore + Mult(1, C, \n    L), constrain = c(13:16, 23:26), constrainTo = c(mu$qvframe[, \n    1], mu$qvframe[, 1]), family = poisson, data = freq_tab_3.1, \n    tolerance = 1e-12, trace = F)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.56526  -0.67024  -0.02438   0.54037   1.98333  \n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       3.58190         NA      NA       NA    \nR2               -0.97723         NA      NA       NA    \nR3               -0.74342         NA      NA       NA    \nR4               -1.55815         NA      NA       NA    \nC2               -1.58375         NA      NA       NA    \nC3               -2.02765         NA      NA       NA    \nC4               -3.48218         NA      NA       NA    \nL2               -1.36810         NA      NA       NA    \nL3               -2.27692         NA      NA       NA    \nL4               -3.81410         NA      NA       NA    \nRscore:Cscore     0.13353    0.02520   5.300 1.16e-07 ***\nMult(., R, C).    0.64540         NA      NA       NA    \nMult(1, ., C).R1  0.56136         NA      NA       NA    \nMult(1, ., C).R2 -0.59333         NA      NA       NA    \nMult(1, ., C).R3 -0.39165         NA      NA       NA    \nMult(1, ., C).R4  0.42362         NA      NA       NA    \nMult(1, R, .).C1  0.17611         NA      NA       NA    \nMult(1, R, .).C2 -0.74182         NA      NA       NA    \nMult(1, R, .).C3 -0.06570         NA      NA       NA    \nMult(1, R, .).C4  0.68161         NA      NA       NA    \nRscore:Lscore     0.24848    0.02521   9.856  &lt; 2e-16 ***\nMult(., R, L).    0.60454         NA      NA       NA    \nMult(1, ., L).R1  0.56136         NA      NA       NA    \nMult(1, ., L).R2 -0.59333         NA      NA       NA    \nMult(1, ., L).R3 -0.39165         NA      NA       NA    \nMult(1, ., L).R4  0.42362         NA      NA       NA    \nMult(1, R, .).L1  0.07994         NA      NA       NA    \nMult(1, R, .).L2 -1.25892         NA      NA       NA    \nMult(1, R, .).L3 -0.25272         NA      NA       NA    \nMult(1, R, .).L4  1.37138         NA      NA       NA    \nCscore:Lscore     0.20270    0.02560   7.919  &lt; 2e-16 ***\nMult(., C, L).    0.32306         NA      NA       NA    \nMult(1, ., L).C1  0.06719         NA      NA       NA    \nMult(1, ., L).C2  0.38511         NA      NA       NA    \nMult(1, ., L).C3  1.58146         NA      NA       NA    \nMult(1, ., L).C4 -0.03317         NA      NA       NA    \nMult(1, C, .).L1 -0.17127         NA      NA       NA    \nMult(1, C, .).L2 -0.53371         NA      NA       NA    \nMult(1, C, .).L3  0.41943         NA      NA       NA    \nMult(1, C, .).L4 -0.15415         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 47.134 on 40 degrees of freedom\nAIC: 389.45\n\nNumber of iterations: 85\n\nnu1 &lt;- getContrasts(\n  model9.extended,\n  pickCoef(model9.extended, \"[.]C\")[1:4],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\neta1 &lt;- getContrasts(\n    model9.extended,\n    pickCoef(model9.extended, \"[.]L\")[1:4],\n    ref = \"mean\",\n    scaleRef = \"mean\",\n    scaleWeights = \"unit\"\n  )\n\nmodel9.phis &lt;-\n  freq_tab_3.1 |&gt;  gnm(\n    Freq ~ R + C + L + \n      Rscore:Cscore + \n      Mult(1, R, C) +\n      Rscore:Lscore + \n      Mult(1, R, L) + \n      Cscore:Lscore + \n      Mult(1, C, L),\n    constrain = c(13:20, 23:30, 33:40),\n    constrainTo = c(\n      mu$qvframe[, 1],\n      nu1$qvframe[, 1],\n      mu$qvframe[, 1],\n      eta1$qvframe[, 1],\n      nu2$qvframe[, 1],\n      eta2$qvframe[, 1]\n    ),\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning main iterations.\nDone\n\nsummary(model9.phis)\n\n\nCall:\ngnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + \n    Rscore:Lscore + Mult(1, R, L) + Cscore:Lscore + Mult(1, C, \n    L), constrain = c(13:20, 23:30, 33:40), constrainTo = c(mu$qvframe[, \n    1], nu1$qvframe[, 1], mu$qvframe[, 1], eta1$qvframe[, 1], \n    nu2$qvframe[, 1], eta2$qvframe[, 1]), family = poisson, data = freq_tab_3.1, \n    tolerance = 1e-12, trace = F)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.56526  -0.67024  -0.02438   0.54037   1.98333  \n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       3.56903    0.08137  43.862  &lt; 2e-16 ***\nR2               -0.97605    0.11881  -8.215  &lt; 2e-16 ***\nR3               -0.74245    0.14810  -5.013 5.36e-07 ***\nR4               -1.55801    0.22175  -7.026 2.13e-12 ***\nC2               -1.59504    0.10577 -15.081  &lt; 2e-16 ***\nC3               -2.08142    0.17240 -12.073  &lt; 2e-16 ***\nC4               -3.47861    0.26841 -12.960  &lt; 2e-16 ***\nL2               -1.42666    0.10739 -13.285  &lt; 2e-16 ***\nL3               -2.18148    0.17791 -12.262  &lt; 2e-16 ***\nL4               -3.81133    0.27937 -13.643  &lt; 2e-16 ***\nRscore:Cscore     0.13353    0.02486   5.371 7.83e-08 ***\nMult(., R, C).    0.66121    0.14008   4.720 2.36e-06 ***\nMult(1, ., C).R1  0.56136         NA      NA       NA    \nMult(1, ., C).R2 -0.59333         NA      NA       NA    \nMult(1, ., C).R3 -0.39165         NA      NA       NA    \nMult(1, ., C).R4  0.42362         NA      NA       NA    \nMult(1, R, .).C1  0.15965         NA      NA       NA    \nMult(1, R, .).C2 -0.73633         NA      NA       NA    \nMult(1, R, .).C3 -0.07638         NA      NA       NA    \nMult(1, R, .).C4  0.65306         NA      NA       NA    \nRscore:Lscore     0.24848    0.02515   9.879  &lt; 2e-16 ***\nMult(., R, L).    1.13662    0.13964   8.140  &lt; 2e-16 ***\nMult(1, ., L).R1  0.56136         NA      NA       NA    \nMult(1, ., L).R2 -0.59333         NA      NA       NA    \nMult(1, ., L).R3 -0.39165         NA      NA       NA    \nMult(1, ., L).R4  0.42362         NA      NA       NA    \nMult(1, R, .).L1  0.05054         NA      NA       NA    \nMult(1, R, .).L2 -0.66157         NA      NA       NA    \nMult(1, R, .).L3 -0.12640         NA      NA       NA    \nMult(1, R, .).L4  0.73743         NA      NA       NA    \nCscore:Lscore     0.20270    0.02315   8.756  &lt; 2e-16 ***\nMult(., C, L).   -0.28351    0.10068  -2.816  0.00486 ** \nMult(1, ., L).C1  0.33661         NA      NA       NA    \nMult(1, ., L).C2  0.08944         NA      NA       NA    \nMult(1, ., L).C3 -0.84069         NA      NA       NA    \nMult(1, ., L).C4  0.41464         NA      NA       NA    \nMult(1, C, .).L1 -0.08991         NA      NA       NA    \nMult(1, C, .).L2 -0.62111         NA      NA       NA    \nMult(1, C, .).L3  0.77584         NA      NA       NA    \nMult(1, C, .).L4 -0.06482         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 47.134 on 48 degrees of freedom\nAIC: 373.45\n\nNumber of iterations: 1\n\nmu\n\n                       Estimate Std. Error\nMult(1, ., C + L).R1  0.5613577 0.07946201\nMult(1, ., C + L).R2 -0.5933253 0.06976100\nMult(1, ., C + L).R3 -0.3916506 0.08375491\nMult(1, ., C + L).R4  0.4236182 0.08896023\n\nnu1\n\n                    Estimate Std. Error\nMult(1, R, .).C1  0.15964986 0.14637516\nMult(1, R, .).C2 -0.73633460 0.08871449\nMult(1, R, .).C3 -0.07637713 0.15684115\nMult(1, R, .).C4  0.65306187 0.10868144\n\neta1\n\n                    Estimate Std. Error\nMult(1, R, .).L1  0.05053742 0.08981862\nMult(1, R, .).L2 -0.66156822 0.06038098\nMult(1, R, .).L3 -0.12639555 0.08679365\nMult(1, R, .).L4  0.73742635 0.04940126\n\nnu2\n\n                    Estimate Std. Error\nMult(1, ., L).C1  0.33661004 0.30087703\nMult(1, ., L).C2  0.08944163 0.36058729\nMult(1, ., L).C3 -0.84069369 0.08936905\nMult(1, ., L).C4  0.41464201 0.32252708\n\neta2\n\n                    Estimate Std. Error\nMult(1, C, .).L1 -0.08990831  0.3610226\nMult(1, C, .).L2 -0.62111332  0.2399524\nMult(1, C, .).L3  0.77584334  0.1519881\nMult(1, C, .).L4 -0.06482171  0.3227342\n\nmodel.summary(model9)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 model9                 38  47.1 -231.  6.25 0.147\n\n# Model 10 - Model 8 with consistent col scores\nmodel10 &lt;-\n  freq_tab_3.1 |&gt; gnm(\n    Freq ~ R + C + L + \n      Rscore:Cscore + \n      Mult(1, C, R + L) +\n      Rscore:Lscore + \n      Mult(1, R, L) + \n      Cscore:Lscore,\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n................................................................................\n................................................................................\n........\nDone\n\nmodel.summary(model10)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta      p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;\n1 model10                38  54.8 -223.  7.50 0.0384\n\n# Model 11 - Model 8 with consistent layer scores\nmodel11 &lt;-\n  freq_tab_3.1 |&gt; gnm(\n    Freq ~ R + C + L + \n      Rscore:Cscore + \n      Mult(1, L, R + C) +\n      Rscore:Lscore +\n      Mult(1, R, C) +\n      Cscore:Lscore,\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n........................................\nDone\n\nmodel.summary(model11)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta      p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;\n1 model11                38  53.6 -225.  6.58 0.0477\n\n# Model 12 - Modek 9 + U(RL)=U(CL)\n# To impose equality constraint on U(RL) & U(CL),\n# a covariate is created in following manner:\n\nfreq_tab_3.1 &lt;- freq_tab_3.1|&gt; \n  mutate(cov_rcl = Rscore * Lscore + Cscore * Lscore)\nmodel12 &lt;-\n  freq_tab_3.1 |&gt; gnm(\n    Freq ~ R + C + L + \n      Rscore:Cscore + \n      Mult(1, R, C + L) +\n      cov_rcl + \n      Mult(1, C, L),\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n................................\nDone\n\n#summary(model12)\nmodel.summary(model12)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 model12                39  48.6 -237.  6.57 0.140\n\nmu &lt;- getContrasts(\n  model12,\n  pickCoef(model12, \"[.]R\"),\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\nnu2 &lt;-\n  getContrasts(\n    model12,\n    pickCoef(model12, \"[.]C\")[5:8],\n    ref = \"mean\",\n    scaleRef = \"mean\",\n    scaleWeights = \"unit\"\n  )\n\neta2 &lt;-\n  getContrasts(\n    model12,\n    pickCoef(model12, \"[.]L\")[4:7],\n    ref = \"mean\",\n    scaleRef = \"mean\",\n    scaleWeights = \"unit\"\n  )\n\nmodel12.extended &lt;-\n  freq_tab_3.1 |&gt;\n  gnm(Freq ~ R + C + L + \n        Rscore:Cscore + \n        Mult(1, R, C) +\n        cov_rcl + \n        Mult(1, R, L) + \n        Mult(1, C, L),\n      constrain = c(13:16, 23:26),\n      constrainTo = c(mu$qvframe[, 1], mu$qvframe[, 1]),\n      data = _,\n      family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n...........................................................\nDone\n\nsummary(model12.extended)\n\n\nCall:\ngnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + \n    cov_rcl + Mult(1, R, L) + Mult(1, C, L), constrain = c(13:16, \n    23:26), constrainTo = c(mu$qvframe[, 1], mu$qvframe[, 1]), \n    family = poisson, data = freq_tab_3.1, tolerance = 1e-12,     trace = F)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.58844  -0.76809   0.02278   0.56330   1.92999  \n\nCoefficients:\n                  Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       3.611745         NA      NA       NA    \nR2               -1.024206         NA      NA       NA    \nR3               -0.719885         NA      NA       NA    \nR4               -1.400694         NA      NA       NA    \nC2               -1.639144         NA      NA       NA    \nC3               -2.194712         NA      NA       NA    \nC4               -3.651543         NA      NA       NA    \nL2               -1.482185         NA      NA       NA    \nL3               -2.039611         NA      NA       NA    \nL4               -3.765003         NA      NA       NA    \nRscore:Cscore     0.133358   0.025419   5.246 1.55e-07 ***\nMult(., R, C).   -0.089080         NA      NA       NA    \nMult(1, ., C).R1 -0.538271         NA      NA       NA    \nMult(1, ., C).R2  0.597665         NA      NA       NA    \nMult(1, ., C).R3  0.389408         NA      NA       NA    \nMult(1, ., C).R4 -0.448801         NA      NA       NA    \nMult(1, R, .).C1  1.148327         NA      NA       NA    \nMult(1, R, .).C2 -5.480395         NA      NA       NA    \nMult(1, R, .).C3 -0.732443         NA      NA       NA    \nMult(1, R, .).C4  4.453283         NA      NA       NA    \ncov_rcl           0.224229   0.017087  13.123  &lt; 2e-16 ***\nMult(., R, L).    2.347434         NA      NA       NA    \nMult(1, ., L).R1 -0.538271         NA      NA       NA    \nMult(1, ., L).R2  0.597665         NA      NA       NA    \nMult(1, ., L).R3  0.389408         NA      NA       NA    \nMult(1, ., L).R4 -0.448801         NA      NA       NA    \nMult(1, R, .).L1  0.007804         NA      NA       NA    \nMult(1, R, .).L2  0.351215         NA      NA       NA    \nMult(1, R, .).L3  0.089167         NA      NA       NA    \nMult(1, R, .).L4 -0.328697         NA      NA       NA    \nMult(., C, L).    1.293322         NA      NA       NA    \nMult(1, ., L).C1 -0.414505         NA      NA       NA    \nMult(1, ., L).C2 -0.336771         NA      NA       NA    \nMult(1, ., L).C3  0.218827         NA      NA       NA    \nMult(1, ., L).C4 -0.500362         NA      NA       NA    \nMult(1, C, .).L1  0.023613         NA      NA       NA    \nMult(1, C, .).L2 -0.230398         NA      NA       NA    \nMult(1, C, .).L3  0.301185         NA      NA       NA    \nMult(1, C, .).L4 -0.026390         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 48.569 on 41 degrees of freedom\nAIC: 388.89\n\nNumber of iterations: 116\n\nnu1 &lt;- getContrasts(\n  model12.extended,\n  pickCoef(model12.extended, \"[.]C\")[1:4],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\neta1 &lt;-\n  getContrasts(\n    model12.extended,\n    pickCoef(model12.extended, \"[.]L\")[1:4],\n    ref = \"mean\",\n    scaleRef = \"mean\",\n    scaleWeights = \"unit\"\n  )\n\nmodel12.phis &lt;-\n  freq_tab_3.1 |&gt; gnm(\n    Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) +\n      cov_rcl + Mult(1, R, L) + Mult(1, C, L),\n    constrain = c(13:20, 23:30, 32:39),\n    constrainTo = c(mu$qvframe[, 1], nu1$qvframe[, 1],\n                    mu$qvframe[, 1], eta1$qvframe[, 1], \n                    nu2$qvframe[, 1], eta2$qvframe[, 1]),\n    data = _,\n    family = poisson, \n    trace = F, \n    tolerance = 1e-12)\n\nInitialising\nRunning main iterations.\nDone\n\nsummary(model12.phis)\n\n\nCall:\ngnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + \n    cov_rcl + Mult(1, R, L) + Mult(1, C, L), constrain = c(13:20, \n    23:30, 32:39), constrainTo = c(mu$qvframe[, 1], nu1$qvframe[, \n    1], mu$qvframe[, 1], eta1$qvframe[, 1], nu2$qvframe[, 1], \n    eta2$qvframe[, 1]), family = poisson, data = freq_tab_3.1, \n    tolerance = 1e-12, trace = F)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.58844  -0.76809   0.02278   0.56330   1.92999  \n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       3.55535    0.08106  43.859  &lt; 2e-16 ***\nR2               -0.92909    0.11339  -8.194  &lt; 2e-16 ***\nR3               -0.64221    0.12609  -5.093 3.52e-07 ***\nR4               -1.39320    0.17746  -7.851  &lt; 2e-16 ***\nC2               -1.63743    0.10043 -16.304  &lt; 2e-16 ***\nC3               -2.18079    0.15608 -13.973  &lt; 2e-16 ***\nC4               -3.65343    0.23846 -15.321  &lt; 2e-16 ***\nL2               -1.39736    0.10537 -13.261  &lt; 2e-16 ***\nL3               -2.13230    0.17235 -12.372  &lt; 2e-16 ***\nL4               -3.74831    0.27154 -13.804  &lt; 2e-16 ***\nRscore:Cscore     0.13336    0.02490   5.357 8.48e-08 ***\nMult(., R, C).   -0.64007    0.13725  -4.663 3.11e-06 ***\nMult(1, ., C).R1 -0.53827         NA      NA       NA    \nMult(1, ., C).R2  0.59766         NA      NA       NA    \nMult(1, ., C).R3  0.38941         NA      NA       NA    \nMult(1, ., C).R4 -0.44880         NA      NA       NA    \nMult(1, R, .).C1  0.18108         NA      NA       NA    \nMult(1, R, .).C2 -0.74146         NA      NA       NA    \nMult(1, R, .).C3 -0.08067         NA      NA       NA    \nMult(1, R, .).C4  0.64105         NA      NA       NA    \ncov_rcl           0.22423    0.01636  13.707  &lt; 2e-16 ***\nMult(., R, L).    1.13998    0.13669   8.340  &lt; 2e-16 ***\nMult(1, ., L).R1 -0.53827         NA      NA       NA    \nMult(1, ., L).R2  0.59766         NA      NA       NA    \nMult(1, ., L).R3  0.38941         NA      NA       NA    \nMult(1, ., L).R4 -0.44880         NA      NA       NA    \nMult(1, R, .).L1 -0.04544         NA      NA       NA    \nMult(1, R, .).L2  0.66170         NA      NA       NA    \nMult(1, R, .).L3  0.12210         NA      NA       NA    \nMult(1, R, .).L4 -0.73836         NA      NA       NA    \nMult(., C, L).    0.27613    0.10158   2.718  0.00656 ** \nMult(1, ., L).C1 -0.27770         NA      NA       NA    \nMult(1, ., L).C2 -0.13959         NA      NA       NA    \nMult(1, ., L).C3  0.84752         NA      NA       NA    \nMult(1, ., L).C4 -0.43024         NA      NA       NA    \nMult(1, C, .).L1  0.01743         NA      NA       NA    \nMult(1, C, .).L2 -0.65220         NA      NA       NA    \nMult(1, C, .).L3  0.74916         NA      NA       NA    \nMult(1, C, .).L4 -0.11439         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 48.569 on 49 degrees of freedom\nAIC: 372.89\n\nNumber of iterations: 1\n\nmu\n\n                       Estimate Std. Error\nMult(1, ., C + L).R1 -0.5382715 0.07940991\nMult(1, ., C + L).R2  0.5976649 0.06869502\nMult(1, ., C + L).R3  0.3894076 0.08390695\nMult(1, ., C + L).R4 -0.4488010 0.08495489\n\nnu1\n\n                    Estimate Std. Error\nMult(1, R, .).C1  0.18108336  0.1505749\nMult(1, R, .).C2 -0.74145909  0.0888159\nMult(1, R, .).C3 -0.08066998  0.1598862\nMult(1, R, .).C4  0.64104571  0.1141041\n\neta1\n\n                   Estimate Std. Error\nMult(1, R, .).L1 -0.0454423 0.08895571\nMult(1, R, .).L2  0.6617033 0.05943373\nMult(1, R, .).L3  0.1220991 0.08507409\nMult(1, R, .).L4 -0.7383601 0.04862532\n\nnu2\n\n                   Estimate Std. Error\nMult(1, ., L).C1 -0.2776974 0.30818568\nMult(1, ., L).C2 -0.1395889 0.36977790\nMult(1, ., L).C3  0.8475231 0.08001496\nMult(1, ., L).C4 -0.4302368 0.32326672\n\neta2\n\n                    Estimate Std. Error\nMult(1, C, .).L1  0.01742597  0.3681779\nMult(1, C, .).L2 -0.65219849  0.2296758\nMult(1, C, .).L3  0.74916478  0.1797929\nMult(1, C, .).L4 -0.11439226  0.3321123\n\nmodel.summary(model12)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 model12                39  48.6 -237.  6.57 0.140\n\n# Model 15\nfreq_tab_3.1 &lt;-\n  freq_tab_3.1 |&gt; mutate(cov_rcl = Rscore * Lscore + Cscore * Lscore)\nmodel15 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C + L) + cov_rcl,\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations..........................................\nDone\n\nsummary(model15)\n\n\nCall:\ngnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C + \n    L) + cov_rcl, family = poisson, data = freq_tab_3.1, tolerance = 1e-12, \n    trace = F)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.98677  -0.75501   0.01756   0.52206   2.97799  \n\nCoefficients:\n                     Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)           3.55311         NA      NA       NA    \nR2                   -0.90767         NA      NA       NA    \nR3                   -0.63480         NA      NA       NA    \nR4                   -1.41782         NA      NA       NA    \nC2                   -1.68706         NA      NA       NA    \nC3                   -2.18116         NA      NA       NA    \nC4                   -3.67524         NA      NA       NA    \nL2                   -1.46927         NA      NA       NA    \nL3                   -2.17246         NA      NA       NA    \nL4                   -3.76667         NA      NA       NA    \nRscore:Cscore         0.13307    0.02552   5.215 1.84e-07 ***\nMult(., R, C + L).    0.43428         NA      NA       NA    \nMult(1, ., C + L).R1  1.08539         NA      NA       NA    \nMult(1, ., C + L).R2 -1.51474         NA      NA       NA    \nMult(1, ., C + L).R3 -1.03738         NA      NA       NA    \nMult(1, ., C + L).R4  0.85540         NA      NA       NA    \nMult(1, R, . + L).C1  0.19339         NA      NA       NA    \nMult(1, R, . + L).C2 -0.40121         NA      NA       NA    \nMult(1, R, . + L).C3  0.03787         NA      NA       NA    \nMult(1, R, . + L).C4  0.49806         NA      NA       NA    \nMult(1, R, C + .).L2 -0.81261         NA      NA       NA    \nMult(1, R, C + .).L3 -0.20505         NA      NA       NA    \nMult(1, R, C + .).L4  0.79642         NA      NA       NA    \ncov_rcl               0.22862    0.01709  13.377  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 55.984 on 44 degrees of freedom\nAIC: 390.3\n\nNumber of iterations: 42\n\nmodel.summary(model15)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 model15                44  56.0 -266.  6.83 0.106\n\nmu &lt;- getContrasts(\n  model15,\n  pickCoef(model15, \"[.]R\"),\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\nnu &lt;- getContrasts(\n  model15,\n  pickCoef(model15, \"[.]C\"),\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\nmodel15.extended &lt;-\n  freq_tab_3.1 |&gt; gnm(\n    Freq ~ R + C + L + \n      Rscore:Cscore + \n      Mult(1, R, C) +\n      cov_rcl + \n      Mult(1, R, L),\n    constrain = c(13:16, 23:26),\n    constrainTo = c(mu$qvframe[, 1], mu$qvframe[, 1]),\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations....\nDone\n\nsummary(model15.extended)\n\n\nCall:\ngnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + \n    cov_rcl + Mult(1, R, L), constrain = c(13:16, 23:26), constrainTo = c(mu$qvframe[, \n    1], mu$qvframe[, 1]), family = poisson, data = freq_tab_3.1, \n    tolerance = 1e-12, trace = F)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.98677  -0.75501   0.01756   0.52206   2.97799  \n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       3.57905         NA      NA       NA    \nR2               -0.98911         NA      NA       NA    \nR3               -0.70128         NA      NA       NA    \nR4               -1.42502         NA      NA       NA    \nC2               -1.64759    0.10152  -16.23  &lt; 2e-16 ***\nC3               -2.17084    0.15843  -13.70  &lt; 2e-16 ***\nC4               -3.69546    0.24129  -15.32  &lt; 2e-16 ***\nL2               -1.41533    0.10612  -13.34  &lt; 2e-16 ***\nL3               -2.15885    0.17266  -12.50  &lt; 2e-16 ***\nL4               -3.81953    0.27268  -14.01  &lt; 2e-16 ***\nRscore:Cscore     0.13307    0.02539    5.24  1.6e-07 ***\nMult(., R, C).   -1.12234         NA      NA       NA    \nMult(1, ., C).R1  0.54368         NA      NA       NA    \nMult(1, ., C).R2 -0.59799         NA      NA       NA    \nMult(1, ., C).R3 -0.38839         NA      NA       NA    \nMult(1, ., C).R4  0.44270         NA      NA       NA    \nMult(1, R, .).C1 -0.07340         NA      NA       NA    \nMult(1, R, .).C2  0.45060         NA      NA       NA    \nMult(1, R, .).C3  0.06366         NA      NA       NA    \nMult(1, R, .).C4 -0.34189         NA      NA       NA    \ncov_rcl           0.22862    0.01643   13.91  &lt; 2e-16 ***\nMult(., R, L).    0.74709         NA      NA       NA    \nMult(1, ., L).R1  0.54368         NA      NA       NA    \nMult(1, ., L).R2 -0.59799         NA      NA       NA    \nMult(1, ., L).R3 -0.38839         NA      NA       NA    \nMult(1, ., L).R4  0.44270         NA      NA       NA    \nMult(1, R, .).L1  0.05029         NA      NA       NA    \nMult(1, R, .).L2 -1.02552         NA      NA       NA    \nMult(1, R, .).L3 -0.22118         NA      NA       NA    \nMult(1, R, .).L4  1.10466         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 55.984 on 46 degrees of freedom\nAIC: 386.3\n\nNumber of iterations: 4\n\neta &lt;-\n  getContrasts(\n    model15.extended,\n    pickCoef(model15.extended, \"[.]L\"),\n    ref = \"mean\",\n    scaleRef = \"mean\",\n    scaleWeights = \"unit\"\n  )\n\nmodel15.phis &lt;-\n  freq_tab_3.1 |&gt; gnm(\n    Freq ~ R + C + L + \n      Rscore:Cscore + \n      Mult(1, R, C) + \n      cov_rcl + \n      Mult(1, R, L),\n    constrain = c(13:20, 23:30),\n    constrainTo = c(mu$qvframe[, 1], \n                    nu$qvframe[, 1], \n                    mu$qvframe[, 1], \n                    eta$qvframe[, 1]),\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning main iterations.\nDone\n\nsummary(model15.phis)\n\n\nCall:\ngnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + \n    cov_rcl + Mult(1, R, L), constrain = c(13:20, 23:30), constrainTo = c(mu$qvframe[, \n    1], nu$qvframe[, 1], mu$qvframe[, 1], eta$qvframe[, 1]), \n    family = poisson, data = freq_tab_3.1, tolerance = 1e-12,     trace = F)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.98677  -0.75501   0.01756   0.52206   2.97799  \n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       3.55464    0.08091  43.935  &lt; 2e-16 ***\nR2               -0.93784    0.11339  -8.271  &lt; 2e-16 ***\nR3               -0.65943    0.12613  -5.228 1.71e-07 ***\nR4               -1.42048    0.17754  -8.001  &lt; 2e-16 ***\nC2               -1.64759    0.10044 -16.404  &lt; 2e-16 ***\nC3               -2.17084    0.15588 -13.927  &lt; 2e-16 ***\nC4               -3.69546    0.23861 -15.488  &lt; 2e-16 ***\nL2               -1.41533    0.10551 -13.414  &lt; 2e-16 ***\nL3               -2.15885    0.17245 -12.519  &lt; 2e-16 ***\nL4               -3.81953    0.27221 -14.032  &lt; 2e-16 ***\nRscore:Cscore     0.13307    0.02492   5.341 9.24e-08 ***\nMult(., R, C).    0.64172    0.13829   4.641 3.48e-06 ***\nMult(1, ., C).R1  0.54368         NA      NA       NA    \nMult(1, ., C).R2 -0.59799         NA      NA       NA    \nMult(1, ., C).R3 -0.38839         NA      NA       NA    \nMult(1, ., C).R4  0.44270         NA      NA       NA    \nMult(1, R, .).C1  0.17165         NA      NA       NA    \nMult(1, R, .).C2 -0.74481         NA      NA       NA    \nMult(1, R, .).C3 -0.06806         NA      NA       NA    \nMult(1, R, .).C4  0.64122         NA      NA       NA    \ncov_rcl           0.22862    0.01640  13.939  &lt; 2e-16 ***\nMult(., R, L).    1.13826    0.13726   8.293  &lt; 2e-16 ***\nMult(1, ., L).R1  0.54368         NA      NA       NA    \nMult(1, ., L).R2 -0.59799         NA      NA       NA    \nMult(1, ., L).R3 -0.38839         NA      NA       NA    \nMult(1, ., L).R4  0.44270         NA      NA       NA    \nMult(1, R, .).L1  0.04806         NA      NA       NA    \nMult(1, R, .).L2 -0.65804         NA      NA       NA    \nMult(1, R, .).L3 -0.13012         NA      NA       NA    \nMult(1, R, .).L4  0.74010         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 55.984 on 50 degrees of freedom\nAIC: 378.3\n\nNumber of iterations: 1\n\nmu\n\n                       Estimate Std. Error\nMult(1, ., C + L).R1  0.5436794 0.07818382\nMult(1, ., C + L).R2 -0.5979869 0.06871974\nMult(1, ., C + L).R3 -0.3883879 0.08391754\nMult(1, ., C + L).R4  0.4426954 0.08454001\n\nnu\n\n                        Estimate Std. Error\nMult(1, R, . + L).C1  0.17164747 0.14998137\nMult(1, R, . + L).C2 -0.74480785 0.08583798\nMult(1, R, . + L).C3 -0.06806188 0.15421719\nMult(1, R, . + L).C4  0.64122226 0.11322236\n\neta\n\n                    Estimate Std. Error\nMult(1, R, .).L1  0.04806244 0.08932196\nMult(1, R, .).L2 -0.65804171 0.05969167\nMult(1, R, .).L3 -0.13011596 0.08427834\nMult(1, R, .).L4  0.74009523 0.04837401\n\nmodel.summary(model15)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 model15                44  56.0 -266.  6.83 0.106\n\n\n\nbind_rows(model.summary(model1, \"Model 1\"),\n          model.summary(model2, \"Model 2\"),\n          model.summary(model4, \"Model 4\"),\n          model.summary(model6, \"Model 6\"),\n          model.summary(model7, \"Model 7\"),\n          model.summary(model8, \"Model 8\"),\n          model.summary(model9, \"Model 9\"),\n          model.summary(model10, \"Model 10\"),\n          model.summary(model11, \"Model 11\"),\n          model.summary(model12, \"Model 12\"),\n          model.summary(model15, \"Model 15\"))\n\n# A tibble: 11 × 6\n   `Model Description`    df    L2   BIC Delta        p\n   &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n 1 Model 1                54 544.   149. 23.7  3.44e-82\n 2 Model 2                39 109.  -176.  9.81 1.42e- 8\n 3 Model 4                35  37.7 -218.  4.63 3.47e- 1\n 4 Model 6                27  29.0 -169.  4.86 3.61e- 1\n 5 Model 7                23  21.9 -146.  3.70 5.24e- 1\n 6 Model 8                36  45.9 -218.  6.25 1.26e- 1\n 7 Model 9                38  47.1 -231.  6.25 1.47e- 1\n 8 Model 10               38  54.8 -223.  7.50 3.84e- 2\n 9 Model 11               38  53.6 -225.  6.58 4.77e- 2\n10 Model 12               39  48.6 -237.  6.57 1.40e- 1\n11 Model 15               44  56.0 -266.  6.83 1.06e- 1"
  },
  {
    "objectID": "4-Chapter_3.html#練習問題",
    "href": "4-Chapter_3.html#練習問題",
    "title": "3  第3章",
    "section": "練習問題",
    "text": "練習問題\n問題3.1 Goodman (1979) の表5A，表5B，表5Cの結果を再現しよう．使用するデータはmentalHealthのデータである．表5Aのモデルは，(1) Null Association，(2) Uniform Association，(3) Row-Effect Association，(4) Column-Effect Association，(5) Row and Column Effects (I)， (6) Row and Column Effects (II) の6つである．\n\n問題3.1.1：Goodman (1979) の表5Bの分析（全体効果の分解）を再現する．表5Bではまずモデル (1) と (2) の比較から一般的な効果（General Effect）を求めている．次に，モデル (2) と (5) の比較から，行・列効果を求めている． 他の効果はモデル (5) で示され，全体効果はモデル (1) となる．\n問題3.1.2：Goodman (1979) の表5Cの分析（行と列効果の分割）を再現する．モデル (2) と (3) から行効果が，さらにモデル (3) と (5) から行効果が，そして，モデル (2) と (5) から行・列効果の要素を取り出すことができる．"
  },
  {
    "objectID": "4-Chapter_3.html#参考文献",
    "href": "4-Chapter_3.html#参考文献",
    "title": "3  第3章",
    "section": "参考文献",
    "text": "参考文献\n\n\n\n\n\n\nGoodman, Leo A. 1979. “Simple Models for the Analysis of Association in Cross-Classifications Having Ordered Categories.” Journal of the American Statistical Association 74 (367): 537–52."
  },
  {
    "objectID": "5-Chapter_4.html#表4.3",
    "href": "5-Chapter_4.html#表4.3",
    "title": "4  第4章",
    "section": "4.1 表4.3",
    "text": "4.1 表4.3\n\n# Table 4.3\nFreq &lt;- c(201,  29,   8,  13,   5,     152,  29,   2,   8,   0,\n           18,   6,   3,   6,   0,      17,  12,   0,   3,   0,\n          109,  74, 164,  89,  16,     101, 336,   9, 134,   2,\n            7,   6,  45,  30,   6,       7,  41,   7,  63,   0,\n          247,  58,  20,  23,   2,     288,  51,   1,  17,   3,\n           48,  11,  16,  13,   1,      47,  38,   2,  18,   0,\n          157,  68, 178, 116,  27,     165, 321,  27, 168,   1,\n            7,   7,  50,  42,   5,      12,  25,   5,  29,   6)\n\nEduc &lt;- gl(4, 10, 4 * 5 * 2 * 2)\nOcc &lt;- gl(5, 1, 4 * 5 * 2 * 2)\nSex &lt;- gl(2, 5, 4 * 5 * 2 * 2)\nYear &lt;- gl(2, 40, 4 * 5 * 2 * 2)\nL &lt;- Year:Sex\nlevels(L) &lt;- factor(1:4)\n\nRscore &lt;- as.numeric(Educ)\nCscore &lt;- as.numeric(Occ)\n\nfreq_tab_3.1 &lt;- tibble(Freq, Educ, Occ, Sex, Year, L, Rscore, Cscore) \nfreq_tab_3.1\n\n# A tibble: 80 × 8\n    Freq Educ  Occ   Sex   Year  L     Rscore Cscore\n   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt;\n 1   201 1     1     1     1     1          1      1\n 2    29 1     2     1     1     1          1      2\n 3     8 1     3     1     1     1          1      3\n 4    13 1     4     1     1     1          1      4\n 5     5 1     5     1     1     1          1      5\n 6   152 1     1     2     1     2          1      1\n 7    29 1     2     2     1     2          1      2\n 8     2 1     3     2     1     2          1      3\n 9     8 1     4     2     1     2          1      4\n10     0 1     5     2     1     2          1      5\n# ℹ 70 more rows\n\n# Model 1 - RC(0)-L(homogeneous)\nmodel1 &lt;- freq_tab_3.1 |&gt; \n  gnm(\n    Freq ~ Educ + Occ + L + Educ:L + Occ:L,\n    family = poisson,\n    data = _,\n    trace = F,\n    tolerance = 1e-12\n  )\nsummary(model1)\n\n\nCall:\ngnm(formula = Freq ~ Educ + Occ + L + Educ:L + Occ:L, family = poisson, \n    data = freq_tab_3.1, tolerance = 1e-12, trace = F)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-9.2080  -2.2181  -0.4393   1.7534  10.3493  \n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  4.63188    0.07546  61.385  &lt; 2e-16 ***\nEduc2       -2.04867    0.18496 -11.076  &lt; 2e-16 ***\nEduc3        0.56850    0.07822   7.268 3.65e-13 ***\nEduc4       -1.00188    0.12060  -8.307  &lt; 2e-16 ***\nOcc2        -1.06920    0.10808  -9.893  &lt; 2e-16 ***\nOcc3        -0.42050    0.08678  -4.846 1.26e-06 ***\nOcc4        -0.88688    0.10115  -8.768  &lt; 2e-16 ***\nOcc5        -2.51829    0.20006 -12.588  &lt; 2e-16 ***\nL2          -0.58321    0.11600  -5.028 4.96e-07 ***\nL3           0.35568    0.09908   3.590 0.000331 ***\nL4           0.38267    0.09802   3.904 9.46e-05 ***\nEduc2:L2     0.26213    0.26589   0.986 0.324189    \nEduc3:L2     0.54569    0.11433   4.773 1.82e-06 ***\nEduc4:L2     0.52029    0.16809   3.095 0.001966 ** \nEduc2:L3     0.67937    0.21978   3.091 0.001994 ** \nEduc3:L3    -0.12382    0.10396  -1.191 0.233635    \nEduc4:L3    -0.14652    0.16251  -0.902 0.367276    \nEduc2:L4     0.81653    0.21566   3.786 0.000153 ***\nEduc3:L4     0.07042    0.10180   0.692 0.489078    \nEduc4:L4    -0.54042    0.17410  -3.104 0.001908 ** \nOcc2:L2      1.48066    0.13298  11.135  &lt; 2e-16 ***\nOcc3:L2     -2.31314    0.25826  -8.957  &lt; 2e-16 ***\nOcc4:L2      0.60040    0.13656   4.397 1.10e-05 ***\nOcc5:L2     -2.41258    0.73731  -3.272 0.001067 ** \nOcc2:L3     -0.09004    0.14424  -0.624 0.532465    \nOcc3:L3     -0.13260    0.11618  -1.141 0.253725    \nOcc4:L3      0.02568    0.13253   0.194 0.846332    \nOcc5:L3     -0.05541    0.26603  -0.208 0.835011    \nOcc2:L4      0.90622    0.12622   7.179 7.00e-13 ***\nOcc3:L4     -2.26247    0.19508 -11.598  &lt; 2e-16 ***\nOcc4:L4      0.09529    0.12843   0.742 0.458122    \nOcc5:L4     -1.41745    0.37680  -3.762 0.000169 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nResidual deviance: 1370.9 on 48 degrees of freedom\nAIC: 1796.7\n\nNumber of iterations: 6\n\nmodel.summary(model1)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta         p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;\n1 model1                 48 1371.  972.  23.8 1.37e-255\n\n# Model 2 - RC(1)-L(homogeneous)\nmodel2 &lt;- freq_tab_3.1 |&gt; \n  gnm(\n  Freq ~ Educ + Occ + L + Educ:L + Occ:L + Mult(1, Educ, Occ),\n  family = poisson,\n  data = _,\n  trace = F,\n  tolerance = 1e-12\n)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations....................................\nDone\n\nmodel.summary(model2)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta        p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n1 model2                 42  144. -205.  6.39 4.54e-13\n\n# Model 3 - RC(1)-L(heterogeneous)\nmodel3 &lt;- freq_tab_3.1 |&gt; \n  gnm(\n  Freq ~ Educ + Occ + L + Educ:L + Occ:L + Mult(L, L:Educ, L:Occ),\n  family = poisson,\n  data = _,\n  trace = F,\n  tolerance = 1e-12\n)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n........................................\nDone\n\nmodel.summary(model3)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta          p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;\n1 model3                 24  69.1 -130.  3.04 0.00000303\n\n# Model 4 - RC(2)-L(homogeneous)\nmodel4 &lt;- freq_tab_3.1 |&gt; \n  gnm(\n    Freq ~ Educ + Occ + L + Educ:L + Occ:L + instances(Mult(1, Educ, Occ), 2),\n    family = poisson,\n    data = _, \n    trace = F,\n    tolerance = 1e-8\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...............\nDone\n\nmodel.summary(model4)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta        p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n1 model4                 38  117. -199.  5.24 4.93e-10\n\n# Model 4 - RC(2)-L(heterogeneous)\nmodel5 &lt;- freq_tab_3.1 |&gt; \n  gnm(\n    Freq ~ Educ + Occ + L + Educ:L + Occ:L + \n      instances(Mult(L, L:Educ, L:Occ), 2),\n    family = poisson,\n    data = _,\n    trace = F,\n    tolerance = 1e-10,\n    iterStart = 5,\n    iterMax = 1e6,\n    verbose = F\n  )\nmodel.summary(model5)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 model5                  8  5.83 -60.7 0.437 0.666\n\n# Model 6 - RC(3)-L(homogeneous)\nmodel6 &lt;- freq_tab_3.1 |&gt; \n  gnm(\n    Freq ~ Educ + Occ + L + Educ:L + Occ:L + \n      instances(Mult(1, Educ, Occ), 3),\n    family = poisson,\n    data = _,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.....\nDone\n\nmodel.summary(model6)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta        p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n1 model6                 36  113. -186.  5.19 6.60e-10\n\n# Model 7 - RC(3)-L(heterogeneous)\nmodel7 &lt;- freq_tab_3.1 |&gt; \n  gnm(\n    Freq ~ Educ + Occ + L + Educ:L + Occ:L + \n      instances(Mult(L, L:Educ, L:Occ), 3),\n    family = poisson,\n    data = _,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n................................................................................\n................................................................................\n................................................................................\n................................................................................\n................................................................................\n...........................................\nDone\n\n\nWarning in gnmFit(modelTools = modelTools, y = y, constrain = constrain, : Fitting algorithm has either not converged or converged\nto a non-solution of the likelihood equations.\nUse exitInfo() for numerical details of last iteration.\n\nmodel.summary(model7)\n\n# A tibble: 1 × 6\n  `Model Description`    df       L2      BIC         Delta     p\n  &lt;chr&gt;               &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;\n1 model7                  0 2.83e-11 2.83e-11 0.00000000575     0\n\n# Model 8- U+RC (homogeneous)\nmodel8 &lt;- freq_tab_3.1 |&gt; \n  gnm(\n    Freq ~ Educ + Occ + L + Educ:L + Occ:L + \n      Rscore:Cscore + \n      Mult(1, Educ, Occ),\n    family = poisson,\n    data = _,\n    trace = F,\n    tolerance = 1e-6,\n    iterStart = 20,\n    iterMax = 100000\n  )\n\nInitialising\nRunning start-up iterations....................\nRunning main iterations..............\nDone\n\nsummary(model8)\n\n\nCall:\ngnm(formula = Freq ~ Educ + Occ + L + Educ:L + Occ:L + Rscore:Cscore + \n    Mult(1, Educ, Occ), family = poisson, data = freq_tab_3.1, \n    tolerance = 1e-06, iterStart = 20, iterMax = 1e+05, trace = F)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-3.09104  -0.98816  -0.05028   0.65984   4.48366  \n\nCoefficients:\n                      Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)            4.41117         NA      NA       NA    \nEduc2                 -3.16010         NA      NA       NA    \nEduc3                 -2.07744         NA      NA       NA    \nEduc4                 -5.80916         NA      NA       NA    \nOcc2                  -2.84807         NA      NA       NA    \nOcc3                  -4.44591         NA      NA       NA    \nOcc4                  -6.44803         NA      NA       NA    \nOcc5                  -9.79235         NA      NA       NA    \nL2                    -0.45256    0.10138  -4.464 8.04e-06 ***\nL3                     0.30784    0.08546   3.602 0.000315 ***\nL4                     0.27495    0.08559   3.212 0.001317 ** \nEduc2:L2               0.21438    0.26790   0.800 0.423574    \nEduc3:L2               0.60680    0.13272   4.572 4.83e-06 ***\nEduc4:L2               0.84863    0.19679   4.312 1.62e-05 ***\nEduc2:L3               0.67195    0.22185   3.029 0.002455 ** \nEduc3:L3              -0.13777    0.12302  -1.120 0.262766    \nEduc4:L3              -0.17785    0.18557  -0.958 0.337863    \nEduc2:L4               0.83889    0.21766   3.854 0.000116 ***\nEduc3:L4               0.25621    0.11970   2.140 0.032320 *  \nEduc4:L4              -0.10081    0.19889  -0.507 0.612248    \nOcc2:L2                1.22119    0.14272   8.557  &lt; 2e-16 ***\nOcc3:L2               -2.67793    0.26863  -9.969  &lt; 2e-16 ***\nOcc4:L2                0.25078    0.15354   1.633 0.102387    \nOcc5:L2               -2.76550    0.74142  -3.730 0.000191 ***\nOcc2:L3               -0.02264    0.15282  -0.148 0.882219    \nOcc3:L3               -0.01696    0.13679  -0.124 0.901323    \nOcc4:L3                0.12779    0.14886   0.858 0.390653    \nOcc5:L3                0.04374    0.27494   0.159 0.873605    \nOcc2:L4                0.83473    0.13514   6.177 6.54e-10 ***\nOcc3:L4               -2.31754    0.20662 -11.217  &lt; 2e-16 ***\nOcc4:L4                0.05314    0.14388   0.369 0.711886    \nOcc5:L4               -1.43905    0.38269  -3.760 0.000170 ***\nRscore:Cscore          0.80506    0.23183   3.473 0.000515 ***\nMult(., Educ, Occ).   -6.31390         NA      NA       NA    \nMult(1, ., Occ).Educ1 -0.21454         NA      NA       NA    \nMult(1, ., Occ).Educ2 -0.02881         NA      NA       NA    \nMult(1, ., Occ).Educ3  0.15839         NA      NA       NA    \nMult(1, ., Occ).Educ4  0.24978         NA      NA       NA    \nMult(1, Educ, .).Occ1  0.07941         NA      NA       NA    \nMult(1, Educ, .).Occ2 -0.03736         NA      NA       NA    \nMult(1, Educ, .).Occ3  0.05034         NA      NA       NA    \nMult(1, Educ, .).Occ4  1.03956         NA      NA       NA    \nMult(1, Educ, .).Occ5  1.86178         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 124.75 on 41 degrees of freedom\nAIC: 564.56\n\nNumber of iterations: 14\n\nmodel.summary(model8)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta        p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n1 model8                 41  125. -216.  5.58 2.18e-10\n\n# Model 9 - U+RC (heterogeneous)\nmodel9 &lt;- freq_tab_3.1 |&gt; \n  gnm(\n    Freq ~ Educ + Occ + L + Educ:L + Occ:L + \n      Rscore:Cscore:L + \n      Mult(L, L:Educ, L:Occ),\n    family = poisson,\n    data = _,\n    trace = F,\n    tolerance = 1e-6,\n    iterStart = 20,\n    iterMax = 100000,\n    verbose = F\n  )\nmodel.summary(model9)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 model9                 20  27.5 -139.  1.50 0.122"
  },
  {
    "objectID": "5-Chapter_4.html#表4.4",
    "href": "5-Chapter_4.html#表4.4",
    "title": "4  第4章",
    "section": "4.2 表4.4",
    "text": "4.2 表4.4\n\nmodels &lt;- list()\nmodels[[1]] &lt;- model.summary(model1)\nmodels[[2]] &lt;- model.summary(model2)\nmodels[[3]] &lt;- model.summary(model3)\nmodels[[4]] &lt;- model.summary(model4)\nmodels[[5]] &lt;- model.summary(model5)\nmodels[[6]] &lt;- model.summary(model6)\nmodels[[7]] &lt;- model.summary(model7)\nmodels[[8]] &lt;- model.summary(model8)\nmodels[[9]] &lt;- model.summary(model9)\nmodels |&gt; bind_rows() |&gt; kable(digit = 3)\n\n\n\n\nModel Description\ndf\nL2\nBIC\nDelta\np\n\n\n\n\nmodel1\n48\n1370.934\n971.892\n23.750\n0.000\n\n\nmodel2\n42\n143.827\n-205.334\n6.388\n0.000\n\n\nmodel3\n24\n69.062\n-130.459\n3.039\n0.000\n\n\nmodel4\n38\n117.384\n-198.524\n5.237\n0.000\n\n\nmodel5\n8\n5.834\n-60.673\n0.437\n0.666\n\n\nmodel6\n36\n113.180\n-186.101\n5.187\n0.000\n\n\nmodel7\n0\n0.000\n0.000\n0.000\n0.000\n\n\nmodel8\n41\n124.751\n-216.097\n5.581\n0.000\n\n\nmodel9\n20\n27.472\n-138.795\n1.496\n0.122"
  },
  {
    "objectID": "5-Chapter_4.html#表4.5",
    "href": "5-Chapter_4.html#表4.5",
    "title": "4  第4章",
    "section": "4.3 表4.5",
    "text": "4.3 表4.5\n\nmodel_comparison &lt;- function(x, y = 0) {\n  models |&gt; \n    bind_rows() |&gt;\n    dplyr::summarise(`Model Used` = \n                ifelse(y == 0,\n                       paste0(x),\n                       paste0(x,\"-\",y)),\n              df = ifelse(y == 0, \n                          df[x], \n                          df[x] - df[y]),\n              L2 = ifelse(y == 0, \n                          L2[x], \n                          L2[x] - L2[y]))\n}\n\n表4.5Aは次のように再現できる．\n\n# Table 4.5 Panel A\nbind_rows(model_comparison(1,2),\n          model_comparison(2,4),\n          model_comparison(4,6),\n          model_comparison(6),\n          model_comparison(1)) |&gt; kable(digit = 3)\n\n\n\n\nModel Used\ndf\nL2\n\n\n\n\n1-2\n6\n1227.106\n\n\n2-4\n4\n26.444\n\n\n4-6\n2\n4.204\n\n\n6\n36\n113.180\n\n\n1\n48\n1370.934\n\n\n\n\n\n\n# Table 4.5 Panel B\nbind_rows(model_comparison(1,3),\n          model_comparison(3,5),\n          model_comparison(5,7),\n          model_comparison(1)) |&gt; kable(digit = 3)\n\n\n\n\nModel Used\ndf\nL2\n\n\n\n\n1-3\n24\n1301.872\n\n\n3-5\n16\n63.228\n\n\n5-7\n8\n5.834\n\n\n1\n48\n1370.934"
  },
  {
    "objectID": "5-Chapter_4.html#表4.6",
    "href": "5-Chapter_4.html#表4.6",
    "title": "4  第4章",
    "section": "4.4 表4.6",
    "text": "4.4 表4.6\n\n# Table 4.6\nFreq &lt;- c(201, 29, 8,13, 5, 152,29, 2, 8, 0,\n          18, 6, 3, 6, 0,17,12, 0, 3, 0,\n          109,74, 164,89,16, 101, 336, 9, 134, 2,\n          7, 6,45,30, 6, 7,41, 7,63, 0,\n          247,58,20,23, 2, 288,51, 1,17, 3,\n          48,11,16,13, 1,47,38, 2,18, 0,\n          157,68, 178, 116,27, 165, 321,27, 168, 1,\n          7, 7,50,42, 5,12,25, 5,29, 6)\n\nEduc &lt;- gl(4, 10, 4 * 5 * 2 * 2)\nOcc &lt;- gl(5, 1, 4 * 5 * 2 * 2)\nSex &lt;- gl(2, 5, 4 * 5 * 2 * 2)\nYear &lt;- gl(2, 40, 4 * 5 * 2 * 2)\nL &lt;- Year:Sex\nlevels(L) &lt;- factor(1:4)\nRscore &lt;- as.numeric(Educ)\nCscore &lt;- as.numeric(Occ)\n\n# Model 1\nmodel1.un &lt;- freq_tab_3.1 |&gt; gnm(\n  Freq ~ Educ + Occ + L + Educ:L + Occ:L +\n    Mult(L, Educ, L:Occ, inst = 1) +\n    Mult(L, Educ, L:Occ, inst = 2),\n  family = poisson,\n  data = _,\n  trace = F,\n  tolerance = 1e-8,\n  iterStart = 20,\n  iterMax = 100000,\n  verbose = F)\nmodel.summary(model1.un)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 model1.un              14  7.97 -108. 0.687 0.891\n\n# Model 2\nmodel2.un &lt;- freq_tab_3.1 |&gt; gnm(\n  Freq ~ Educ + Occ + L + Educ:L + Occ:L + \n    Mult(L, L:Educ, Occ, inst = 1) + \n    Mult(L, L:Educ, Occ, inst = 2),\n    family = poisson,\n    data = _,\n    trace = F,\n    tolerance = 1e-8,\n    iterStart = 20,\n    iterMax = 100000,\n    verbose = F\n  )\nmodel.summary(model2.un)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta      p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;\n1 model2.un              20  29.2 -137.  1.82 0.0830\n\n# Model 3\n# it might not be fitted with gnm!\n\nmodel2.un &lt;- freq_tab_3.1 |&gt; gnm(\n  Freq ~ Educ + Occ + L + Educ:L + Occ:L + \n    Mult(L, Educ, Occ, inst = 1) + \n    Mult(L, Educ, Occ, inst = 2),\n    family = poisson,\n    data = _,\n    trace = F,\n    tolerance = 1e-8,\n    iterStart = 20,\n    iterMax = 100000,\n    verbose = F\n  )\nmodel.summary(model2.un)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 model2.un              30  38.5 -211.  2.12 0.138\n\n# Model 4\n# it might not be fitted with gnm!\n\n# Model 5\n# it might not be fitted with gnm!\n\n# Model 6\n# it might not be fitted with gnm!\n\n# Model 7\n# it might not be fitted with gnm!\n\n# Model 8\n# it might not be fitted with gnm!\n\n# Model 9\nmodel9.un &lt;- gnm(\n  Freq ~ Educ + Occ + L + Educ:L + Occ:L + \n    Mult(L, Educ, Occ, inst = 1) + \n    Mult(L, Educ, Occ, inst = 2),\n  family = poisson,\n  trace = F,\n  tolerance = 1e-12,\n  iterStart = 20,\n  iterMax = 100000\n)\n\nInitialising\nRunning start-up iterations....................\nRunning main iterations.........................................................\n..........................................\nDone\n\nmodel.summary(model9.un)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 model9.un              30  38.5 -211.  2.12 0.138\n\nmu1 &lt;- getContrasts(\n  model9.un,\n  pickCoef(model9.un, \"[.]Educ\")[1:4],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\nnu1 &lt;- getContrasts(\n  model9.un,\n  pickCoef(model9.un, \"[.]Occ\")[1:5],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\nmu2 &lt;- getContrasts(\n  model9.un,\n  pickCoef(model9.un, \"[.]Educ\")[5:8],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\nnu2 &lt;- getContrasts(\n  model9.un,\n  pickCoef(model9.un, \"[.]Occ\")[6:10],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\ncon &lt;- c(mu1$qvframe[, 1][c(1, 4)], \n         nu1$qvframe[, 1][c(1, 5)],\n         mu2$qvframe[, 1][c(1, 4)], \n         nu2$qvframe[, 1][c(1, 5)])\n\n\nset.seed(123456)\nmodel9 &lt;- gnm(\n  Freq ~ Educ + Occ + L + Educ:L + Occ:L +\n    Mult(L, Educ, Occ, inst = 1) + \n    Mult(L, Educ, Occ, inst = 2),\n  constrain = c(37, 40, 41, 45, 50, 53, 54, 58),\n  constrainTo = con,\n  family = poisson,\n  tolerance = 1e-12,\n  iterStart = 20,\n  iterMax = 100000\n)\n\nInitialising\nRunning start-up iterations....................\nRunning main iterations.........................................................\n..................................\n\n\n\nDeviance is not finite\n\n\nWarning: Algorithm failed - no model could be estimated\n\nsummary(model9)\n\nLength  Class   Mode \n     0   NULL   NULL \n\nmu1\n\n                                  Estimate Std. Error\nMult(L, ., Occ, inst = 1).Educ1  0.6402222 0.02882211\nMult(L, ., Occ, inst = 1).Educ2  0.2386164 0.03949527\nMult(L, ., Occ, inst = 1).Educ3 -0.1683115 0.03139203\nMult(L, ., Occ, inst = 1).Educ4 -0.7105272 0.02071164\n\nnu1\n\n                                  Estimate Std. Error\nMult(L, Educ, ., inst = 1).Occ1  0.7654028 0.02524700\nMult(L, Educ, ., inst = 1).Occ2  0.2501417 0.04589839\nMult(L, Educ, ., inst = 1).Occ3 -0.3979180 0.05170619\nMult(L, Educ, ., inst = 1).Occ4 -0.2733327 0.04831936\nMult(L, Educ, ., inst = 1).Occ5 -0.3442938 0.08637688\n\nmu2\n\n                                  Estimate Std. Error\nMult(L, ., Occ, inst = 2).Educ1 -0.7309442 0.07862794\nMult(L, ., Occ, inst = 2).Educ2  0.2168538 0.14103742\nMult(L, ., Occ, inst = 2).Educ3  0.6355624 0.08287906\nMult(L, ., Occ, inst = 2).Educ4 -0.1214720 0.17120754\n\nnu2\n\n                                   Estimate Std. Error\nMult(L, Educ, ., inst = 2).Occ1  0.07059438 0.10141736\nMult(L, Educ, ., inst = 2).Occ2 -0.48030206 0.07332532\nMult(L, Educ, ., inst = 2).Occ3 -0.19772154 0.10545108\nMult(L, Educ, ., inst = 2).Occ4 -0.21626011 0.06608227\nMult(L, Educ, ., inst = 2).Occ5  0.82368933 0.03866984\n\nmodel.summary(model9.un)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 model9.un              30  38.5 -211.  2.12 0.138\n\n# Model 10\nLc &lt;- L\nlevels(Lc) &lt;- c(1, 1, 2, 2)\nmodel10.un &lt;- gnm(\n  Freq ~ Educ + Occ + L + Educ:L + Occ:L + \n    Mult(Lc, Educ, Occ) + \n    Mult(L, Educ, Occ),\n  family = poisson,\n  trace = F,\n  tolerance = 1e-8,\n  iterStart = 20,\n  iterMax = 100000,\n  verbose = F\n)\nmodel.summary(model10.un)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 model10.un             32  40.4 -226.  2.17 0.146\n\n# Model 11\nset.seed(1234)\nmodel11.un &lt;- gnm(\n  Freq ~ Educ + Occ + L + Educ:L + Occ:L + \n    Mult(1, Educ, Occ) + \n    Mult(L, Educ, Occ),\n  family = poisson,\n  trace = F,\n  tolerance = 1e-8,\n  iterStart = 20,\n  iterMax = 100000,\n  verbose = F\n)\nmodel.summary(model11.un)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 model11.un             33  43.4 -231.  2.31 0.106\n\n# Model 12\nL.c &lt;- L\nlevels(L.c) &lt;- factor(c(1, 2, 3, 2))\n\nset.seed(1234)\nmodel12.un &lt;-\n  gnm(Freq ~ Educ + Occ + L + Educ:L + Occ:L + \n        Mult(1, Educ, Occ) + \n        Mult(L.c, Educ, Occ),\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12,\n    iterStart = 20,\n    iterMax = 100000\n  )\n\nInitialising\nRunning start-up iterations....................\nRunning main iterations.........................................................\n................................................................\nDone\n\nmodel.summary(model12.un)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 model12.un             34  44.6 -238.  2.70 0.105\n\nmu1 &lt;- getContrasts(\n  model12.un,\n  pickCoef(model12.un, \"[.]Educ\")[1:4],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\nnu1 &lt;- getContrasts(\n  model12.un,\n  pickCoef(model12.un, \"[.]Occ\")[1:5],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\nmu2 &lt;- getContrasts(\n  model12.un,\n  pickCoef(model12.un, \"[.]Educ\")[5:8],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\nnu2 &lt;- getContrasts(\n  model12.un,\n  pickCoef(model12.un, \"[.]Occ\")[6:10],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\ncon &lt;- c(mu1$qvframe[, 1][c(1, 4)], nu1$qvframe[, 1][c(1, 5)],\n         mu2$qvframe[, 1][c(1, 4)], nu2$qvframe[, 1][c(1, 5)])\n\nmodel12 &lt;-\n  gnm(Freq ~ Educ + Occ + L + Educ:L + Occ:L + \n        Mult(1, Educ, Occ) + \n        Mult(L.c, Educ, Occ),\n    constrain = c(34, 37, 38, 42, 46, 49, 50, 54),\n    constrainTo = con,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12,\n    iterStart = 20,\n    iterMax = 100000\n  )\n\nInitialising\nRunning start-up iterations....................\nRunning main iterations.........................................................\n...................\n\n\n\nDeviance is not finite\n\n\nWarning: Algorithm failed - no model could be estimated\n\nsummary(model12)\n\nLength  Class   Mode \n     0   NULL   NULL \n\nmu1\n\n                        Estimate Std. Error\nMult(1, ., Occ).Educ1 -0.6496856 0.02689904\nMult(1, ., Occ).Educ2 -0.2266856 0.03916088\nMult(1, ., Occ).Educ3  0.1712502 0.02789996\nMult(1, ., Occ).Educ4  0.7051210 0.01869796\n\nnu1\n\n                        Estimate Std. Error\nMult(1, Educ, .).Occ1  0.7477472 0.03046619\nMult(1, Educ, .).Occ2  0.2798375 0.04956910\nMult(1, Educ, .).Occ3 -0.3926778 0.05281437\nMult(1, Educ, .).Occ4 -0.2590761 0.04731457\nMult(1, Educ, .).Occ5 -0.3758307 0.08654401\n\nmu2\n\n                          Estimate Std. Error\nMult(L.c, ., Occ).Educ1  0.7697514 0.05982573\nMult(L.c, ., Occ).Educ2 -0.1649990 0.14337525\nMult(L.c, ., Occ).Educ3 -0.6165380 0.08295724\nMult(L.c, ., Occ).Educ4  0.0117856 0.16680372\n\nnu2\n\n                           Estimate Std. Error\nMult(L.c, Educ, .).Occ1  0.04308284 0.07694408\nMult(L.c, Educ, .).Occ2 -0.47712634 0.07295173\nMult(L.c, Educ, .).Occ3 -0.22737747 0.10213888\nMult(L.c, Educ, .).Occ4 -0.16931700 0.06314427\nMult(L.c, Educ, .).Occ5  0.83073797 0.03112819\n\nmodel.summary(model12.un)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 model12.un             34  44.6 -238.  2.70 0.105\n\n# Model 13\nmodel13.un &lt;-\n  gnm(Freq ~ Educ + Occ + L + Educ:L + Occ:L + \n        Mult(1, Educ, Occ, inst = 1) + \n        Mult(1, Educ, Occ, inst = 2),\n    family = poisson,\n    trace = F,\n    tolerance = 1e-8,\n    iterStart = 20,\n    iterMax = 100000,\n    verbose = F\n  )\nmodel.summary(model13.un)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta        p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n1 model13.un             38  117. -199.  5.24 4.93e-10\n\n\n\nlibrary(logmult)\nd &lt;- tibble(Freq, Educ, Occ, Sex, Year, L, Rscore, Cscore)\ntab &lt;- xtabs(Freq ~ Educ + Occ + L, data = d)\n\n# Model 2\nfit &lt;- rcL(tab, nd = 1,\n    layer.effect = \"none\")\n\nInitialising\nRunning start-up iterations..\nRunning main iterations................\nDone\n\nfit\n\nCall:\nrcL(tab = tab, nd = 1, layer.effect = \"none\")\n\nIntrinsic association coefficients:\n     Dim1 \n[1,] 0.657\n\nNormalized row scores (Educ) for all layers:\n     1      2      3      4 \n 1.428  0.416 -0.477 -1.701 \n\nNormalized column scores (Occ) for all layers:\n     1      2      3      4      5 \n 1.171 -0.236 -1.272 -1.076 -1.053 \n\nNormalization weights: marginal\nDeviance:              143.8274\nPearson chi-squared:   152.4751\nDissimilarity index:   6.388286%\nResidual df:           42\nBIC:                   -205.3338\nAIC:                   59.82743\n\n# Model 3\nfit &lt;- rcL(tab, nd = 1,\n    layer.effect = \"heterogeneous\")\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n...................\nDone\n\nfit\n\nCall:\nrcL(tab = tab, nd = 1, layer.effect = \"heterogeneous\")\n\nIntrinsic association coefficients:\n  Dim1 \n1 0.644\n2 0.870\n3 0.562\n4 0.683\n\nNormalized row scores (Educ):\n, , 1\n\n  Dim1  \n1  1.457\n2  0.520\n3 -0.542\n4 -1.488\n\n, , 2\n\n  Dim1  \n1  1.395\n2  0.588\n3 -0.470\n4 -1.759\n\n, , 3\n\n  Dim1  \n1  1.403\n2  0.447\n3 -0.452\n4 -1.793\n\n, , 4\n\n  Dim1  \n1  1.534\n2  0.159\n3 -0.598\n4 -1.161\n\n\nNormalized column scores (Occ):\n, , 1\n\n  Dim1  \n1  1.093\n2 -0.024\n3 -1.537\n4 -1.069\n5 -0.715\n\n, , 2\n\n  Dim1  \n1  1.195\n2 -0.341\n3 -1.118\n4 -1.141\n5 -0.413\n\n, , 3\n\n  Dim1  \n1  0.958\n2  0.312\n3 -1.415\n4 -1.294\n5 -1.417\n\n, , 4\n\n  Dim1  \n1  1.185\n2 -0.383\n3 -1.466\n4 -0.827\n5 -0.337\n\n\nNormalization weights: marginal\nDeviance:              69.06197\nPearson chi-squared:   88.05995\nDissimilarity index:   3.038593%\nResidual df:           24\nBIC:                   -130.4587\nAIC:                   21.06197\n\n# Model 4\nfit &lt;- rcL(tab, nd = 2,\n    layer.effect = \"none\")\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.................\nDone\n\nfit\n\nCall:\nrcL(tab = tab, nd = 2, layer.effect = \"none\")\n\nIntrinsic association coefficients:\n     Dim1   Dim2  \n[1,] 0.6277 0.0863\n\nNormalized row scores (Educ) for all layers:\n  Dim1   Dim2  \n1  1.458  0.480\n2  0.425 -0.103\n3 -0.520 -0.695\n4 -1.549  2.607\n\nNormalized column scores (Occ) for all layers:\n  Dim1    Dim2   \n1  1.1703  0.3450\n2 -0.2552 -1.4735\n3 -1.3890  0.0154\n4 -0.9827  1.1830\n5 -0.8680  2.3096\n\nNormalization weights: marginal\nDeviance:              117.3838\nPearson chi-squared:   122.1628\nDissimilarity index:   5.236715%\nResidual df:           38\nBIC:                   -198.524\nAIC:                   41.38378\n\n# Model 5\nfit &lt;- rcL(tab, nd = 2,\n    layer.effect = \"heterogeneous\")\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n................................................................................\n................................................................................\n................................................................................\n................................................................................\n................................................................................\n................................................................................\n................................................................................\n................................................................................\n................................................................................\n...........................\nDone\n\nfit\n\nCall:\nrcL(tab = tab, nd = 2, layer.effect = \"heterogeneous\")\n\nIntrinsic association coefficients:\n  Dim1   Dim2  \n1 0.6502 0.0943\n2 4.2413 0.4108\n3 0.5696 0.0757\n4 0.6765 0.1914\n\nNormalized row scores (Educ):\n, , 1\n\n  Dim1     Dim2    \n1  1.45352  0.45162\n2  0.51234 -0.02060\n3 -0.53379 -0.69282\n4 -1.51746  2.62495\n\n, , 2\n\n  Dim1     Dim2    \n1  1.52661  0.24250\n2 -0.00802  1.36857\n3 -0.78150  0.23483\n4  0.00888 -2.91553\n\n, , 3\n\n  Dim1     Dim2    \n1  1.38340  0.71281\n2  0.44660 -0.57412\n3 -0.42823 -0.71739\n4 -1.86901  2.36677\n\n, , 4\n\n  Dim1     Dim2    \n1  1.54808  0.21241\n2  0.13984 -0.58450\n3 -0.63135 -0.54666\n4 -0.99808  2.85541\n\n\nNormalized column scores (Occ):\n, , 1\n\n  Dim1     Dim2    \n1  1.06815  0.26848\n2 -0.00474 -1.18599\n3 -1.70563 -0.75487\n4 -0.94238  1.42995\n5 -0.56999  2.63870\n\n, , 2\n\n  Dim1     Dim2    \n1  0.30521  1.09050\n2  0.01328 -0.11121\n3  0.10725 -1.32567\n4 -0.02157 -1.23729\n5 -7.28179  0.87125\n\n, , 3\n\n  Dim1     Dim2    \n1  0.98305 -0.55082\n2  0.24927  0.94783\n3 -1.48810 -1.21427\n4 -1.16872  0.97409\n5 -1.78377 -3.81045\n\n, , 4\n\n  Dim1     Dim2    \n1  1.15659 -0.16207\n2 -0.42550 -0.63682\n3 -1.48072  0.27185\n4 -0.81835  0.40919\n5  0.93490  6.79479\n\n\nNormalization weights: marginal\nDeviance:              5.833864\nPearson chi-squared:   4.354907\nDissimilarity index:   0.436722%\nResidual df:           8\nBIC:                   -60.67303\nAIC:                   -10.16614\n\n# Model 6\nfit &lt;- rcL(tab, nd = 3,\n    layer.effect = \"none\")\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.....\nDone\n\nfit\n\nCall:\nrcL(tab = tab, nd = 3, layer.effect = \"none\")\n\nIntrinsic association coefficients:\n     Dim1   Dim2   Dim3  \n[1,] 0.6287 0.0867 0.0499\n\nNormalized row scores (Educ) for all layers:\n  Dim1   Dim2   Dim3  \n1  1.456  0.533  0.346\n2  0.437 -0.631 -3.762\n3 -0.521 -0.657  0.315\n4 -1.549  2.584 -0.348\n\nNormalized column scores (Occ) for all layers:\n  Dim1    Dim2    Dim3   \n1  1.1701  0.3410 -0.1004\n2 -0.2525 -1.4473  0.3582\n3 -1.3804  0.0413  0.1242\n4 -0.9949  1.0643 -1.0180\n5 -0.8408  3.0518  6.4839\n\nNormalization weights: marginal\nDeviance:              113.1797\nPearson chi-squared:   117.7575\nDissimilarity index:   5.186927%\nResidual df:           36\nBIC:                   -186.1013\nAIC:                   41.17975\n\n# Model 7\nfit &lt;- rcL(tab, nd = 3,\n    layer.effect = \"heterogeneous\")\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.\n\n\n\nDeviance is not finite\n\n\nWarning: Algorithm failed - no model could be estimated\n\nfit\n\nNULL"
  },
  {
    "objectID": "6-Chapter_5.html#表5.1",
    "href": "6-Chapter_5.html#表5.1",
    "title": "5  第5章",
    "section": "5.1 表5.1",
    "text": "5.1 表5.1\n\n# Table 5.1\nFreq &lt;- c(118, 28,  32,  6,  7,\n        218, 28,  97, 12, 14,\n         11,  2,   4,  1,  1,\n        104, 22,  61,  8,  5,\n        117, 24,  70,  9,  7,\n         42,  6,  20,  2,  0,\n         48, 16, 104, 14,  9,\n        128, 52,  81, 14, 12)\n\nworries &lt;- gl(8,5)\nsituations &lt;- gl(5,1,8*5)\n\ntab5.1 &lt;- tibble(Freq, worries, situations)\n\n# Model 1 - Independence\nm1 &lt;- tab5.1 |&gt; \n  gnm(Freq ~ worries + situations,\n      family = poisson,\n      trace = F,\n      tolerance = 1e-12,\n      data = _)\nmodel.summary(m1)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta        p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n1 m1                     28  121. -84.3  9.84 1.31e-13\n\n# Model 2 - RC(1)\nm2 &lt;- tab5.1 |&gt; \n  gnm(Freq ~ worries + situations + Mult(1, worries, situations),\n      family = poisson,\n      trace = F,\n      tolerance = 1e-12,\n      data = _)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...................................................................\n.......\nDone\n\nmodel.summary(m2)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta      p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;\n1 m2                     18  29.2 -103.  4.01 0.0461\n\n# Model 3 - RC(1) with equality constraints on\n# MIL=ECO=MTO, ENR=SAB=OTH and ASAF=IFAA\nworries.a &lt;- worries\nlevels(worries.a) &lt;- factor(c(1, 2, 2, 3, 3, 2, 4, 3))\nworries.a\n\n [1] 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 2 2 2 2 2 4 4 4 4 4 3 3 3 3 3\nLevels: 1 2 3 4\n\nsituations.a &lt;- situations\nlevels(situations.a) &lt;- factor(c(1, 2, 3, 3, 4))\nsituations.a\n\n [1] 1 2 3 3 4 1 2 3 3 4 1 2 3 3 4 1 2 3 3 4 1 2 3 3 4 1 2 3 3 4 1 2 3 3 4 1 2 3 3 4\nLevels: 1 2 3 4\n\nm3.un &lt;- tab5.1 |&gt; \n  gnm(Freq ~ worries + situations + \n        Mult(1, worries.a, situations.a), \n           family = poisson,\n           trace = F, \n           tolerance = 1e-12,\n      data = _)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...................................................\nDone\n\nmodel.summary(m3.un)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 m3.un                  23  29.6 -139.  4.08 0.161\n\nmu &lt;- getContrasts(m3.un, \n                 pickCoef(m3.un, \"[.]worries.a\"),\n                 ref = c(1, 3, 3, 1) / 8, scaleRef = c(1, 3, 3, 1) / 8,\n                 scaleWeights = c(1, 3, 3, 1))\nnu &lt;- getContrasts(m3.un, \n                 pickCoef(m3.un, \"[.]situations.a\"),\n                 ref = c(1, 1, 2, 1) / 5, scaleRef = c(1, 1, 2, 1) / 5,\n                 scaleWeights = c(1, 1, 2, 1))\n\ncon &lt;- c(mu$qvframe[, 1][c(1, 4)], nu$qvframe[, 1][c(1, 4)])\nm3 &lt;- gnm(Freq ~ worries + situations + Mult(1, worries.a, situations.a), \n          family = poisson,\n          constrain = c(14, 17, 18, 21), constrainTo = con,\n          trace = F, \n          tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.......................................................\nDone\n\nsummary(m3);mu;nu;model.summary(m3.un)\n\n\nCall:\ngnm(formula = Freq ~ worries + situations + Mult(1, worries.a, \n    situations.a), constrain = c(14, 17, 18, 21), constrainTo = con, \n    family = poisson, tolerance = 1e-12, trace = F)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-2.55631  -0.35180   0.05564   0.41188   2.91020  \n\nCoefficients:\n                                    Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)                          2.85834    0.05067  56.406  &lt; 2e-16 ***\nworries1                             0.10499    0.16439   0.639  0.52304    \nworries2                             0.88097    0.08378  10.515  &lt; 2e-16 ***\nworries3                            -2.08538    0.21086  -9.890  &lt; 2e-16 ***\nworries4                             0.34128    0.07460   4.575 4.77e-06 ***\nworries5                             0.46792    0.07155   6.540 6.16e-11 ***\nworries6                            -0.78133    0.12531  -6.235 4.51e-10 ***\nworries7                             0.36910    0.28578   1.292  0.19651    \nsituations1                          1.43713    0.08740  16.443  &lt; 2e-16 ***\nsituations2                         -0.02940    0.07766  -0.379  0.70501    \nsituations3                          0.88374    0.07261  12.172  &lt; 2e-16 ***\nsituations4                         -1.07721    0.11438  -9.418  &lt; 2e-16 ***\nMult(., worries.a, situations.a).   -1.35718    0.50966  -2.663  0.00775 ** \nMult(1, ., situations.a).worries.a1 -0.42724         NA      NA       NA    \nMult(1, ., situations.a).worries.a2 -0.17319    0.11548  -1.500  0.13367    \nMult(1, ., situations.a).worries.a3  0.03189    0.09790   0.326  0.74459    \nMult(1, ., situations.a).worries.a4  0.85113         NA      NA       NA    \nMult(1, worries.a, .).situations.a1  0.69874         NA      NA       NA    \nMult(1, worries.a, .).situations.a2  0.29537    0.22737   1.299  0.19392    \nMult(1, worries.a, .).situations.a3 -0.45726    0.41619  -1.099  0.27191    \nMult(1, worries.a, .).situations.a4 -0.07959         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 29.612 on 23 degrees of freedom\nAIC: 249.9\n\nNumber of iterations: 55\n\n\n                                      Estimate Std. Error\nMult(1, ., situations.a).worries.a1 -0.4272363 0.09380998\nMult(1, ., situations.a).worries.a2 -0.1731936 0.04675330\nMult(1, ., situations.a).worries.a3  0.0318943 0.04574940\nMult(1, ., situations.a).worries.a4  0.8511342 0.03998795\n\n\n                                       Estimate Std. Error\nMult(1, worries.a, .).situations.a1  0.69874471 0.08798182\nMult(1, worries.a, .).situations.a2  0.29537072 0.13782241\nMult(1, worries.a, .).situations.a3 -0.45726207 0.06815138\nMult(1, worries.a, .).situations.a4 -0.07959129 0.22251866\n\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 m3.un                  23  29.6 -139.  4.08 0.161\n\n# Model 4 - RC(1) with equality constraints on\n# MIL=ECO=MTO=ENR=SAB=OTH and ASAF=IFAA\nworries.b &lt;- worries\nlevels(worries.b) &lt;- factor(c(1, 2, 2, 2, 2, 2, 3, 2))\nworries.b\n\n [1] 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 2 2 2 2 2\nLevels: 1 2 3\n\nm4.un &lt;- tab5.1 |&gt; \n  gnm(Freq ~ worries + situations + Mult(1, worries.b, situations.a), \n           family = poisson,\n           trace = F, \n           tolerance = 1e-12,\n      data = _)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations..........................\nDone\n\nmodel.summary(m4.un)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta      p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;\n1 m4.un                  24  34.5 -142.  4.80 0.0760\n\n# Model 5\nm5.un &lt;- tab5.1 |&gt; \n  gnm(Freq ~ worries + situations + \n        Mult(1, worries, situations, inst = 1) + \n        Mult(1, worries, situations, inst = 2), \n      family = poisson,\n      trace = F, tolerance = 1e-12,\n      data = _)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.......................................................\nDone\n\nmodel.summary(m5.un)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 m5.un                  10  6.81 -66.7 0.872 0.743\n\n# Model 6 - RC(2) with equality constraints on\n# ECO=MTO=MIL=ENR=SAB and ASAF=IFAA in both dimensions\nworries.c &lt;- worries\nlevels(worries.c) &lt;- factor(c(1,2,2,2,2,2,3,4))\nworries.c\n\n [1] 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 4 4 4 4 4\nLevels: 1 2 3 4\n\nset.seed(12345)\nm6.un &lt;- tab5.1 |&gt; \n  gnm(Freq ~ worries + situations + \n        Mult(1, worries.c, situations.a, inst = 1) + \n        Mult(1, worries.c, situations.a, inst = 2), \n      family = poisson,\n      trace = F, \n      tolerance = 1e-12,\n      data = _)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations............................................\nDone\n\nmodel.summary(m6.un)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 m6.un                  20  13.7 -133.  2.82 0.847"
  },
  {
    "objectID": "6-Chapter_5.html#表5.4",
    "href": "6-Chapter_5.html#表5.4",
    "title": "5  第5章",
    "section": "5.2 表5.4",
    "text": "5.2 表5.4\n最適尺度法として連関モデルを利用する．\n\n# Table 5.4\nFreq&lt;-c(1096,  1847,  1255,  925,    3321,  6123,  6830,  5524,\n        1541,  3134,  3145, 3300,    1915,  4429,  7035,  9421,\n        4183,  5139,  1857, 1272,    8080,  8586,  4788,  4294,\n        6033,  9211,  5046, 1058,   28130, 44589, 20074,  3408,\n        4354, 13430, 18670, 9821,    2250,  9075, 18286, 14358,\n       14587, 31470, 16390, 3751,    8242, 17532, 12825,  3956,\n        1517,  5820,  6197, 2372,     721,  2909,  4141,  2070,\n        3581,  9268,  5463, 1007,    1341,  3808,  3163,   815,\n        1454,  3109,  1055,  888,     563,  1909,  1018,  1051,\n        3237,  3851,   377,  102,     731,   858,   247,    84,\n       14882, 22182,  5363, 1136,   11650, 15818,  5524,  2122,\n        6033,  3475,    63,   18,    1603,  1005,    30,    16,\n        \n        5968,  8783,  7701, 6483,    8733, 14329, 19386, 28143,\n        1011,  2162,  3536, 6649,     697,  1299,  2362, 10796,\n        3214,  3621,  2485, 3177,     793,  1134,  1292,  3597,\n       11532, 16837,  6975, 1839,    2563,  2995,  2060,  1600,\n        1009,  2719,  3521, 3409,     296,   503,   626,  1273,\n        1586,  3025,  1726,  668,     245,   415,   238,   218,\n         387,   941,   564,  316,      86,   138,    79,    48,\n         994,  1988,   542,  145,     158,   259,   101,    56,\n         171,   409,   223,  245,      65,   172,    99,   174,\n         293,   290,    67,   31,      32,    62,    18,    30,\n        4288,  4916,  1452,  766,     616,   794,   347,   300,\n         370,   186,     3,    4,      67,    37,     5,     2)\n\nincome &lt;- gl(4, 1, 192)  # 1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4 ...\nocc &lt;- gl(12, 8, 192)  # 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 ...\nedu1 &lt;- rep(c(1,2), each = 4, length.out = 96)\nedu2 &lt;- rep(c(3,4), each = 4, length.out = 96)\neduc &lt;- c(edu1, edu2) |&gt; factor()\n\n# 確認\nmatrix(income, nrow = 24, ncol = 8, byrow = TRUE)\n\n      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]\n [1,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n [2,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n [3,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n [4,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n [5,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n [6,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n [7,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n [8,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n [9,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n[10,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n[11,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n[12,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n[13,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n[14,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n[15,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n[16,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n[17,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n[18,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n[19,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n[20,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n[21,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n[22,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n[23,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n[24,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\" \n\nmatrix(occ, nrow = 24, ncol = 8, byrow = TRUE)\n\n      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]\n [1,] \"1\"  \"1\"  \"1\"  \"1\"  \"1\"  \"1\"  \"1\"  \"1\" \n [2,] \"2\"  \"2\"  \"2\"  \"2\"  \"2\"  \"2\"  \"2\"  \"2\" \n [3,] \"3\"  \"3\"  \"3\"  \"3\"  \"3\"  \"3\"  \"3\"  \"3\" \n [4,] \"4\"  \"4\"  \"4\"  \"4\"  \"4\"  \"4\"  \"4\"  \"4\" \n [5,] \"5\"  \"5\"  \"5\"  \"5\"  \"5\"  \"5\"  \"5\"  \"5\" \n [6,] \"6\"  \"6\"  \"6\"  \"6\"  \"6\"  \"6\"  \"6\"  \"6\" \n [7,] \"7\"  \"7\"  \"7\"  \"7\"  \"7\"  \"7\"  \"7\"  \"7\" \n [8,] \"8\"  \"8\"  \"8\"  \"8\"  \"8\"  \"8\"  \"8\"  \"8\" \n [9,] \"9\"  \"9\"  \"9\"  \"9\"  \"9\"  \"9\"  \"9\"  \"9\" \n[10,] \"10\" \"10\" \"10\" \"10\" \"10\" \"10\" \"10\" \"10\"\n[11,] \"11\" \"11\" \"11\" \"11\" \"11\" \"11\" \"11\" \"11\"\n[12,] \"12\" \"12\" \"12\" \"12\" \"12\" \"12\" \"12\" \"12\"\n[13,] \"1\"  \"1\"  \"1\"  \"1\"  \"1\"  \"1\"  \"1\"  \"1\" \n[14,] \"2\"  \"2\"  \"2\"  \"2\"  \"2\"  \"2\"  \"2\"  \"2\" \n[15,] \"3\"  \"3\"  \"3\"  \"3\"  \"3\"  \"3\"  \"3\"  \"3\" \n[16,] \"4\"  \"4\"  \"4\"  \"4\"  \"4\"  \"4\"  \"4\"  \"4\" \n[17,] \"5\"  \"5\"  \"5\"  \"5\"  \"5\"  \"5\"  \"5\"  \"5\" \n[18,] \"6\"  \"6\"  \"6\"  \"6\"  \"6\"  \"6\"  \"6\"  \"6\" \n[19,] \"7\"  \"7\"  \"7\"  \"7\"  \"7\"  \"7\"  \"7\"  \"7\" \n[20,] \"8\"  \"8\"  \"8\"  \"8\"  \"8\"  \"8\"  \"8\"  \"8\" \n[21,] \"9\"  \"9\"  \"9\"  \"9\"  \"9\"  \"9\"  \"9\"  \"9\" \n[22,] \"10\" \"10\" \"10\" \"10\" \"10\" \"10\" \"10\" \"10\"\n[23,] \"11\" \"11\" \"11\" \"11\" \"11\" \"11\" \"11\" \"11\"\n[24,] \"12\" \"12\" \"12\" \"12\" \"12\" \"12\" \"12\" \"12\"\n\nmatrix(educ, nrow = 24, ncol = 8, byrow = TRUE)\n\n      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]\n [1,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\" \n [2,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\" \n [3,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\" \n [4,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\" \n [5,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\" \n [6,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\" \n [7,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\" \n [8,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\" \n [9,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\" \n[10,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\" \n[11,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\" \n[12,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\" \n[13,] \"3\"  \"3\"  \"3\"  \"3\"  \"4\"  \"4\"  \"4\"  \"4\" \n[14,] \"3\"  \"3\"  \"3\"  \"3\"  \"4\"  \"4\"  \"4\"  \"4\" \n[15,] \"3\"  \"3\"  \"3\"  \"3\"  \"4\"  \"4\"  \"4\"  \"4\" \n[16,] \"3\"  \"3\"  \"3\"  \"3\"  \"4\"  \"4\"  \"4\"  \"4\" \n[17,] \"3\"  \"3\"  \"3\"  \"3\"  \"4\"  \"4\"  \"4\"  \"4\" \n[18,] \"3\"  \"3\"  \"3\"  \"3\"  \"4\"  \"4\"  \"4\"  \"4\" \n[19,] \"3\"  \"3\"  \"3\"  \"3\"  \"4\"  \"4\"  \"4\"  \"4\" \n[20,] \"3\"  \"3\"  \"3\"  \"3\"  \"4\"  \"4\"  \"4\"  \"4\" \n[21,] \"3\"  \"3\"  \"3\"  \"3\"  \"4\"  \"4\"  \"4\"  \"4\" \n[22,] \"3\"  \"3\"  \"3\"  \"3\"  \"4\"  \"4\"  \"4\"  \"4\" \n[23,] \"3\"  \"3\"  \"3\"  \"3\"  \"4\"  \"4\"  \"4\"  \"4\" \n[24,] \"3\"  \"3\"  \"3\"  \"3\"  \"4\"  \"4\"  \"4\"  \"4\" \n\n# 分析用データ\ntab5.4 &lt;- data.frame(Freq, income, occ, educ)\n########################################################################################\n\n# Table 5.5\n# Model 1: Complete Independence\nm1 &lt;- tab5.4 |&gt; \n  gnm(Freq ~ educ + occ + income, \n          data = _, \n          family = poisson, \n          tolerance = 1e-12)\nmodel.summary(m1) \n\n# A tibble: 1 × 6\n  `Model Description`    df      L2     BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 m1                    174 586906. 584537.  33.8     0\n\n# Model 2: Conditional Independence\nm2 &lt;- tab5.4 |&gt; \n  gnm(Freq ~ educ * occ + income * occ, \n          data = _, \n          family = poisson, \n          tolerance = 1e-12)\nmodel.summary(m2)\n\n# A tibble: 1 × 6\n  `Model Description`    df     L2    BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 m2                    108 27957. 26487.  6.00     0\n\n# Model 3: All two-way interaction\nm3 &lt;- tab5.4 |&gt; \n  gnm(Freq ~ educ * occ + income * occ + educ * income, \n          data = _, \n          family = poisson, tolerance = 1e-12)\nmodel.summary(m3)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 m3                     99 6540. 5192.  2.64     0\n\n# Model 4: RC(1)+RL(1) partial association\nm4 &lt;- tab5.4 |&gt; \n  gnm(Freq ~ educ + occ + income + Mult(1, occ, educ) + Mult(1, occ, income),\n          data = _, \n          family = poisson,\n          tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...................................................................\n.....\nDone\n\nmodel.summary(m4)\n\n# A tibble: 1 × 6\n  `Model Description`    df     L2    BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 m4                    148 70861. 68846.  11.2     0\n\n# Model 5: Model 4 with consistent row (occupation) scores\nm5 &lt;- tab5.4 |&gt; \n  gnm(Freq ~ educ + occ + income + Mult(1, occ, educ + income),\n          data = _, \n          family = poisson, \n          tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...................................................................\n..........................................................................................\n......................................\nDone\n\nmodel.summary(m5)\n\n# A tibble: 1 × 6\n  `Model Description`    df      L2     BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 m5                    158 185515. 183364.  18.3     0\n\nmu &lt;- getContrasts(model = m5, \n                   set = pickCoef(m5, \"[.]occ\")[1:12],\n                   ref = \"mean\", \n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\nmu\n\n                                   Estimate  Std. Error\nMult(1, ., educ + income).occ1  -0.54805987 0.001793134\nMult(1, ., educ + income).occ2  -0.38746682 0.001271727\nMult(1, ., educ + income).occ3  -0.21717857 0.001291161\nMult(1, ., educ + income).occ4  -0.14398575 0.001002368\nMult(1, ., educ + income).occ5  -0.08607017 0.001273939\nMult(1, ., educ + income).occ6   0.15776750 0.001820890\nMult(1, ., educ + income).occ7   0.05029005 0.002500252\nMult(1, ., educ + income).occ8   0.14092026 0.002598170\nMult(1, ., educ + income).occ9   0.02379483 0.003466324\nMult(1, ., educ + income).occ10  0.39930723 0.004697125\nMult(1, ., educ + income).occ11  0.10479535 0.001779509\nMult(1, ., educ + income).occ12  0.50588597 0.004258340\n\n# Model 6: RC(1)+RL(1)+CL(1) partial association\nm6 &lt;- tab5.4 |&gt; \n  gnm(Freq ~ educ + occ + income + \n        Mult(1, occ, educ) + \n        Mult(1, occ, income) +\n        Mult(1, educ, income),\n      data = _, \n      family = poisson, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...................................................................\n..\nDone\n\nmodel.summary(m6)\n\n# A tibble: 1 × 6\n  `Model Description`    df     L2    BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 m6                    143 42101. 40154.  8.27     0\n\n# Model 7: Model 6 with consistent row (occupation) scores\nm7 &lt;- tab5.4 |&gt; \n  gnm(Freq ~ educ + occ + income + \n        Mult(1, occ, educ + income) + \n        Mult(1, educ, income),\n      data = _, \n      family = poisson, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...................................................................\n..........................................................................................\n..........................................................................................\n........................\nDone\n\nmodel.summary(m7)\n\n# A tibble: 1 × 6\n  `Model Description`    df      L2     BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 m7                    153 174073. 171990.  17.8     0\n\nmu &lt;- getContrasts(model = m7, \n                   set = pickCoef(m7, \"[.]occ\"),\n                   ref = \"mean\", \n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\nmu\n\n                                   Estimate  Std. Error\nMult(1, ., educ + income).occ1   0.56931429 0.001883457\nMult(1, ., educ + income).occ2   0.37928161 0.001275097\nMult(1, ., educ + income).occ3   0.22247516 0.001381547\nMult(1, ., educ + income).occ4   0.17045561 0.001046926\nMult(1, ., educ + income).occ5   0.05464251 0.001423421\nMult(1, ., educ + income).occ6  -0.16380722 0.001871288\nMult(1, ., educ + income).occ7  -0.07890623 0.002667870\nMult(1, ., educ + income).occ8  -0.14504188 0.002680434\nMult(1, ., educ + income).occ9  -0.04282708 0.003676179\nMult(1, ., educ + income).occ10 -0.39013284 0.004810546\nMult(1, ., educ + income).occ11 -0.09178943 0.001794307\nMult(1, ., educ + income).occ12 -0.48366450 0.004397647\n\n# Model 8: model 6 with consistent row, column and layer scores\n# currently, this might not be fitted with gnm!\n\n\n表5.5のモデル1については原著および訳書ともに\\(\\Delta\\)の値が間違っているので注意すること（印刷後に修正漏れに気づきました）．実際は33.85である．\n\n\n# 2つの引数についてのリストを作成\n## 第1引数はモデル\nmodels &lt;- list(m1, m2, m3, m4, m5, m6, m7)\n## 第2引数はモデルの内容\nmodel_desctiption &lt;- \n  list(\"完全独立\", \n       \"条件付き独立\", \n       \"すべての2元交互作用\",\n       \"RC(1)+RL(1) 部分連関\",\n       \"一貫した行(職業)スコアのあるRC(1)+RL(1) 部分連関\",\n       \"RC(1)+RL(1)+CL(1) 部分連関\",\n       \"一貫した行(職業)スコアのあるRC(1)+RL(1)+CL(1)部分連関\")\n# 結果をまとめる\nmap2_dfr(models, model_desctiption, model.summary, .id = \"Model\") |&gt; \n  knitr::kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\nModel\nModel Description\ndf\nL2\nBIC\nDelta\np\n\n\n\n\n1\n完全独立\n174\n586906.225\n584536.899\n33.848968\n0\n\n\n2\n条件付き独立\n108\n27957.399\n26486.783\n6.003195\n0\n\n\n3\nすべての2元交互作用\n99\n6540.396\n5192.331\n2.635334\n0\n\n\n4\nRC(1)+RL(1) 部分連関\n148\n70860.986\n68845.698\n11.169390\n0\n\n\n5\n一貫した行(職業)スコアのあるRC(1)+RL(1) 部分連関\n158\n185515.252\n183363.795\n18.266858\n0\n\n\n6\nRC(1)+RL(1)+CL(1) 部分連関\n143\n42101.443\n40154.238\n8.274821\n0\n\n\n7\n一貫した行(職業)スコアのあるRC(1)+RL(1)+CL(1)部分連関\n153\n174073.129\n171989.756\n17.803352\n0"
  },
  {
    "objectID": "7-Chapter_6.html",
    "href": "7-Chapter_6.html",
    "title": "6  第6章",
    "section": "",
    "text": "特になし"
  },
  {
    "objectID": "8-DF.html#第2章-2元表の連関モデル",
    "href": "8-DF.html#第2章-2元表の連関モデル",
    "title": "自由度",
    "section": "第2章　2元表の連関モデル",
    "text": "第2章　2元表の連関モデル\n行変数は\\(A\\)カテゴリは\\(i = 1,2,\\dots,I\\)， 列変数は\\(B\\)でカテゴリは\\(j = 1,2,\\dots,J\\).\n式（2.4）：\\(O\\)モデル\n\\[\\begin{align}\ndf &= \\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}]\\\\\n& = IJ - I - J + 1\\\\\n& = (I - 1)(J - 1)\n\\end{align}\\]\n式（2.6）：\\(FI\\)モデル\n\\[\\begin{align}\ndf & = \\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}+ \\overbrace{(I - 1) \\times (J - 1)}^{\\lambda_{ij}^{AB}}]\\\\\n&= IJ - IJ \\\\\n& = 0\n\\end{align}\\]\n式（2.7）：\\(U\\)モデル\n\\[\\begin{align}\ndf &=\\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B} + \\overbrace{1}^{\\beta}]\\\\\n&= IJ - I - J\n\\end{align}\\]\n式（2.9）：\\(R\\)モデル\n\\[\\begin{align}\ndf &=\\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(I - 1)}^{\\tau_i^A}]\\\\\n&= IJ - 2I - J + 2\\\\\n&= (I - 1)(J - 2)\n\\end{align}\\]\n式（2.11）：\\(C\\)モデル\n\\[\\begin{align}\ndf &=\\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(J - 1)}^{\\tau_j^B}]\\\\\n&= IJ - I - 2J + 2\\\\\n&= (I - 2)(J - 1)\n\\end{align}\\]\n式（2.13）：\\(R+C\\)モデル\n\\[\\begin{align}\ndf &=\\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B} + \\overbrace{(I - 1)}^{\\tau_i^A} + \\overbrace{(J - 2)}^{\\tau_j^B}] \\\\\n&= IJ - 2I - 2J + 4\\\\\n&= (I - 2)(J - 2)\n\\end{align}\\]\n\\[\\begin{align}\ndf &=\\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B} + \\overbrace{(I - 2)}^{\\tau_i^A} + \\overbrace{(J - 1)}^{\\tau_j^B}] \\\\\n&= IJ - 2I - 2J + 4\\\\\n&= (I - 2)(J - 2)\n\\end{align}\\]\n式（2.14）：\\(R+C\\)モデル\n\\[\\begin{align}\ndf &=\\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B} + \\overbrace{1}^{\\beta} + \\overbrace{(I - 2)}^{\\tau_i^A} + \\overbrace{(J - 2)}^{\\tau_j^B}] \\\\\n&= IJ - 2I - 2J + 4\\\\\n&= (I - 2)(J - 2)\n\\end{align}\\]\n式（2.14）で\\(I=J\\)について\\(\\tau_i^A=\\tau_j^B\\)の時\n\\[\\begin{align}\ndf &=  \\overbrace{I^2}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(I - 1)}^{\\lambda_j^B} + \\overbrace{1}^{\\beta} + \\overbrace{(I - 2)}^{\\tau_i^A}]\\\\\n&= I^2 - 3I + 2\\\\\n&= (I - 1)(I - 2)\n\\end{align}\\]\n式（2.16）：\\(RC\\)モデル\n\\[\\begin{align}\ndf &= \\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B} +  \\overbrace{1}^{\\phi} +\n\\overbrace{(I - 2)}^{\\mu_i} + \\overbrace{(J - 2)}^{\\nu_j}]\\\\\n&= IJ - 2I -2J + 4 \\\\\n&= (I - 2)(I - 2)\n\\end{align}\\]\n式（2.20）：\\(U+RC\\)モデル\n\\[\\begin{align}\ndf &=\\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B} + \\overbrace{1}^{\\phi_1} +  \\overbrace{1}^{\\phi_2}+ \\overbrace{(I - 2)}^{\\mu_i} + \\overbrace{(J - 2)}^{\\nu_j}]\\\\\n&= IJ - 2I - 2J + 3\n\\end{align}\\]\n式（2.22）：\\(R+RC\\)モデル\n\\[\\begin{align}\ndf &=\\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B} + \\overbrace{(I - 2)}^{\\tau_i^A} + \\overbrace{1}^{\\phi_1} + \\overbrace{(I - 2)}^{\\mu_i} + \\overbrace{(J - 2)}^{\\nu_j}]\\\\\n&= IJ - 3I - 2J + 6\\\\\n&= (I - 2)(J - 3)\n\\end{align}\\]\n式（2.24）：\\(C+RC\\)モデル\n\\[\\begin{align}\ndf &=\\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B} + \\overbrace{(J - 2)}^{\\tau_j^B} + \\overbrace{1}^{\\phi_1} + \\overbrace{(I - 2)}^{\\mu_i} + \\overbrace{(J - 2)}^{\\nu_j}]\\\\ &= IJ - 2I - 3J + 6\\\\\n&= (I - 3)(J - 2)\n\\end{align}\\]\n式（2.26）：\\(R+C+RC\\)モデル\n\\[\\begin{align}\ndf &= \\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B} + \\overbrace{(I - 3)}^{\\tau_i^A} + \\overbrace{(J - 2)}^{\\tau_j^B}+ \\overbrace{1}^{\\phi_1} + \\overbrace{(I - 2)}^{\\mu_i} + \\overbrace{(J - 2)}^{\\nu_j}]\\\\\n&= IJ - 3I - 3J + 9\\\\\n&= (I - 3)(J - 3)\n\\end{align}\\]\n\\[\\begin{align}\ndf &= \\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B} + \\overbrace{(I - 2)}^{\\tau_i^A} + \\overbrace{(J - 3)}^{\\tau_j^B}+ \\overbrace{1}^{\\phi_1} + \\overbrace{(I - 2)}^{\\mu_i} + \\overbrace{(J - 2)}^{\\nu_j}]\\\\\n&= IJ - 3I - 3J + 9\\\\\n&= (I - 3)(J - 3)\n\\end{align}\\]\n式（2.28）：\\(RC(2)\\)モデル\n\\[\\begin{align}\ndf &= \\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}+ \\overbrace{1}^{\\phi_1} + \\overbrace{(I - 2)}^{\\mu_{i1}} + \\overbrace{(J - 2)}^{\\nu_{j1}} + \\overbrace{1}^{\\phi_2} + \\overbrace{(I - 2)}^{\\mu_{i2}} + \\overbrace{(J - 2)}^{\\nu_{j2}}- \\overbrace{2}^{次元間制約}]\\\\\n&= IJ - 3I - 3J + 9 \\\\\n&= (I - 3)(J - 3)\n\\end{align}\\]\n式（2.31）：\\(RC(M)\\)モデル\n次元間制約については\\(M (M - 1)/2 \\times 2 = M (M - 1)\\)を引けばよい．\\(M (M - 1)/2\\)は次元の組み合わせであり，2は\\(\\mu\\)と\\(\\nu\\)の2種類あるからである．\n\\[\\begin{align}\ndf &=  \\overbrace{IJ}^{セルの数} - \\{\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B} + [\\overbrace{M}^{\\phi_m} + \\overbrace{M(I - 2)}^{\\mu_{im}} + \\overbrace{M(J - 2)}^{\\nu_{jm}} - \\overbrace{M(M - 1)}^{次元間制約}] \\} \\\\\n&=  IJ - I - J + 1 + 2M - MI - MJ + M^2 \\\\\n& = I(J - M - 1) - J + 1 + 2M - MJ + M^2\\\\\n& = I(J - M - 1) - M(J - M - 1) - (J - M - 1) \\\\\n& = (I - M - 1)(J - M - 1)\n\\end{align}\\]\n\\(M = 2\\)の時 \\[\\begin{align}\ndf &=  (I - M - 1)(J - M - 1)\\\\\n&= (I - 2 - 1)(J - 2 - 1) \\\\\n&= (I - 3)(J - 3)\n\\end{align}\\] となり，式（2.28）の\\(RC(2)\\)の自由度となる．"
  },
  {
    "objectID": "8-DF.html#第3章-3元表に対する部分連関モデル",
    "href": "8-DF.html#第3章-3元表に対する部分連関モデル",
    "title": "自由度",
    "section": "第3章　3元表に対する部分連関モデル",
    "text": "第3章　3元表に対する部分連関モデル\n行変数は\\(A\\)カテゴリは\\(i = 1,2,\\dots,I\\)， 列変数は\\(B\\)でカテゴリは\\(j = 1,2,\\dots,J\\)， 列変数は\\(C\\)でカテゴリは\\(k = 1,2,\\dots,K\\).\n式（3.5）：\\(CI\\)モデル\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(J - 1)}^{\\lambda_{ij}^{AB}} + \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}}]\\\\\n& = IJK - IJ - IK + I \\\\\n& = I(JK - J - K + 1) \\\\\n& = I(J - 1)(K - 1)\n\\end{align}\\]\n式（3.7）：\\(CIA\\)モデル\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C} \\\\\n&\\quad-\n\\{\\overbrace{M_1}^{\\phi_r^{AB}} + \\overbrace{M_1(I - 2)}^{\\mu_{ir}} + \\overbrace{M_1(J - 2)}^{\\nu_{ir}} - \\overbrace{M_1(M_1 - 1)}^{次元間制約} \\} \\\\\n&\\quad - \\{\\overbrace{M_2}^{\\phi_r^{AC}} + \\overbrace{M_2(I - 2)}^{\\mu^*_{ir}} + \\overbrace{M_2(K - 2)}^{\\eta_{kr}} - \\overbrace{M_2(M_2 - 1)}^{次元間制約} \\}] \\\\\n&= IJK - I - J - K + 2 - M_1 (I + J - M_1 - 2) - M_2 (I + K - M_2 - 2)\n\\end{align}\\]\n式（3.7）で\\(M_1 = M_2 = 1\\)の時\n\\[\\begin{align}\ndf &= IJK - I - J - K + 2 - M_1 (I + J - M_1 - 2) - M_2 (I + K - M_2 - 2)\\\\\n& =  IJK - I - J - K + 2 - (I + J - 1 - 2) - (I + K - 1 - 2)\\\\\n& = IJK - 3I - 2J - 2K + 8\n\\end{align}\\]\n式（3.7）で\\(M_1 = M_2 = 1\\)かつ\\(\\mu_i = \\mu^*_i\\)の時\n\\[\\begin{align}\ndf &= IJK - I - J - K + 2 - M_1 (I + J - M_1 - 2) - M_2 (K - M_2)\\\\\n& =  IJK - I - J - K + 2 - (I + J - 1 - 2) - (K - 1)\\\\\n& = IJK - 2I - 2J - 2K + 6\n\\end{align}\\]\n式（3.9）\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(J - 1)}^{\\lambda_{ij}^{AB}} +\n\\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}}\n]\\\\\n& = IJK + I + J + K - IJ - IK - JK - 1\\\\\n& = I(JK - J - K + 1) - (JK - J - K + 1)\\\\\n& = I(J - 1)(K - 1) - (J - 1)(K - 1)\\\\\n& = (I - 1)(J - 1)(K - 1)\n\\end{align}\\]\n式（3.10）\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}\\\\\n& \\quad +\n\\overbrace{1}^{\\phi_{1}^{AB}} +\n\\overbrace{(I - 2)}^{\\mu_{i}} +\n\\overbrace{(J - 2)}^{\\nu_{j}} +\n\n\\overbrace{1}^{\\phi_{1}^{AC}} +\n\\overbrace{(I - 2)}^{\\mu_{i}} +\n\\overbrace{(K - 2)}^{\\eta_{j}} +\n\n\\overbrace{1}^{\\phi_{1}^{BC}} +\n\\overbrace{(J - 2)}^{\\nu_{j}} +\n\\overbrace{(K - 2)}^{\\eta_{k}}\n] \\\\\n& = IJK - I - J - K + 2 - [3 - 2(I - 2) -2(J-2) -2(K -2)]\\\\\n& = IJK - 3I - 3J - 3K + 11\n\\end{align}\\]\n式（3.11）\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}\\\\\n& \\quad +\n\\overbrace{1}^{\\phi_{1}^{AB}} +\n\\overbrace{1}^{\\phi_{1}^{AC}} +\n\\overbrace{1}^{\\phi_{1}^{BC}} +\n\\overbrace{(I - 2)}^{\\mu_{i}} +\n\\overbrace{(J - 2)}^{\\nu_{j}} +\n\\overbrace{(K - 2)}^{\\eta_{j}} +\n] \\\\\n& = IJK - I - J - K + 2 - [3 - (I - 2) -(J-2) - (K -2)]\\\\\n& = IJK - 2I - 2J - 2K + 5\n\\end{align}\\]\n式（3.12）\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}\\\\\n& \\quad +\n\\overbrace{M_1}^{\\phi_{m}^{AB}} +\n\\overbrace{M_1(I - 2)}^{\\mu_{im}} +\n\\overbrace{M_1(J - 2)}^{\\nu_{jm}} -\n\\overbrace{M_1(M_1 - 1)}^{次元間制約} \\\\\n\n& \\quad +\n\\overbrace{M_2}^{\\phi_{m}^{AC}} +\n\\overbrace{M_2(I - 2)}^{\\mu^*_{im}} +\n\\overbrace{M_2(K - 2)}^{\\eta_{jm}} -\n\\overbrace{M_2(M_2 - 1)}^{次元間制約} \\\\\n\n& \\quad +\n\\overbrace{M_3}^{\\phi_{m}^{BC}} +\n\\overbrace{M_3(J - 2)}^{\\nu^*_{jm}} +\n\\overbrace{M_3(K - 2)}^{\\eta^*_{km}} -\n\\overbrace{M_3(M_3 - 1)}^{次元間制約}] \\\\\n& = IJK - I - J - K + 2 - M_1(I + J - M_1 - 2) - M_2(I + K - M_2 - 2)- M_3(J + K - M_3 - 2)\n\\end{align}\\]\n式（3.12）で\\(M_1 = M_2 = M_3 = M\\)\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}\\\\\n& \\quad +\n\\overbrace{M}^{\\phi_{m}^{AB}} +\n\\overbrace{M(I - 2)}^{\\mu_{im}} +\n\\overbrace{M(J - 2)}^{\\nu_{jm}} -\n\\overbrace{M(M - 1)}^{次元間制約} \\\\\n\n& \\quad +\n\\overbrace{M}^{\\phi_{m}^{AC}} +\n\\overbrace{M(I - 2)}^{\\mu^*_{im}} +\n\\overbrace{M(K - 2)}^{\\eta_{km}} -\n\\overbrace{M(M - 1)}^{次元間制約} \\\\\n\n& \\quad +\n\\overbrace{M}^{\\phi_{m}^{BC}} +\n\\overbrace{M(J - 2)}^{\\nu^*_{jm}} +\n\\overbrace{M(K - 2)}^{\\eta^*_{km}} -\n\\overbrace{M(M - 1)}^{次元間制約}] \\\\\n& = IJK - I - J - K + 2 - M(I + J - M - 2) - M(I + J - M - 2)- M(I + J - M - 2) \\\\\n& = IJK - I - J - K + 2 - M(2I + 2J + 2K - 3M - 6)\n\\end{align}\\]\n式（3.12）で\\(M_1 = M_2 = M_3 = M\\)かつ一貫したスコア\n必要な次元間制約は\\(3M(M-1)/2\\)ではなく\\(M(M-1)/2\\)である．\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}\\\\\n& \\quad +\n\\overbrace{M}^{\\phi_{m}^{AB}} +\n\\overbrace{M}^{\\phi_{m}^{AC}} +\n\\overbrace{M}^{\\phi_{m}^{BC}} +\n\\overbrace{M(I - 2)}^{\\mu_{im}} +\n\\overbrace{M(J - 2)}^{\\nu_{jm}} +\n\\overbrace{M(K - 2)}^{\\eta_{km}} -\n\\overbrace{M(M - 1)/2}^{次元間制約}] \\\\\n& = IJK - I - J - K + 2 - M(I + J + K - 3) + M(M - 1)/2\n\\end{align}\\]"
  },
  {
    "objectID": "8-DF.html#第4章3元表に対する条件付き連関モデル",
    "href": "8-DF.html#第4章3元表に対する条件付き連関モデル",
    "title": "自由度",
    "section": "第4章：3元表に対する条件付き連関モデル",
    "text": "第4章：3元表に対する条件付き連関モデル\n式（4.1）：\\(CI\\)モデル\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}}]\\\\\n& = IJK - IK - JK + K \\\\\n& = (IJ - I - J + 1)K \\\\\n& = (I - 1)(J - 1)K\n\\end{align}\\]\n式（4.3）：\\(FI\\)モデル\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C} \\\\\n& \\quad + \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} +\n\\overbrace{(I - 1)(J - 1)}^{\\lambda_{ij}^{AB}}]\\\\\n& = IJK - IK - JK - IJ + I + J + K - 1 \\\\\n& = I(JK - K - J + 1) - (JK - K - J + 1)\\\\\n& = (I - 1)(JK - K - J + 1)\\\\\n& = (I - 1)(J - 1 )(K- 1)\n\\end{align}\\]\n式（4.5）：飽和モデル\n\\(FI\\)モデルの自由度\\((I - 1)(J - 1 )(K- 1)\\)を使い，そこから3元交互作用のパラメータ数\\((I - 1)(J - 1 )(K- 1)\\)を引く．\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C} \\\\\n& \\quad + \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} +\n\\overbrace{(I - 1)(J - 1)}^{\\lambda_{ij}^{AB}} +\n\\overbrace{(I - 1)(J - 1)(K - 1)}^{\\lambda_{ijk}^{ABC}}\n] \\\\\n& = (I - 1)(J - 1 )(K- 1) - (I - 1)(J - 1)(K - 1) \\\\\n& = 0\n\\end{align}\\]\n式（4.6）：\\(LL_1\\)\n\\(FI\\)モデルの自由度\\((I - 1)(J - 1 )(K- 1)\\)を使い，そこから\\((K - 1)\\)を引く．\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C} \\\\\n& \\quad + \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} +\n\\overbrace{(I - 1)(J - 1)}^{\\lambda_{ij}^{AB}}  +\n\\overbrace{(K - 1)}^{\\beta_k}]\\\\\n& = (I - 1)(J - 1 )(K- 1) - (K - 1)\\\\\n& = (IJ - I - J)(K- 1)\n\\end{align}\\]\n式（4.10）：\\(LL_2\\)\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C} \\\\\n& \\quad + \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} +\n\\overbrace{(K - 1)}^{\\phi_{k}} +\n\\overbrace{(I - 1)(J - 1)}^{\\psi_{ij}}]\\\\\n& = (I - 1)(J - 1 )(K- 1) - (K - 1) \\\\\n& = (IJ - I - J)(K - 1)\n\\end{align}\\]\n式（4.14）：\\(LL_3\\)\n\\(\\phi_{k}\\)については\\(\\phi_{1} = 0\\)，\\(\\phi_{K} = 1\\)とするなど2つの制約が必要である．\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C} \\\\\n& \\quad + \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} +\n\\overbrace{(I - 1)(J - 1)}^{\\lambda_{ij}^{AB}}]\\\\\n& \\quad + \\overbrace{(K - 2)}^{\\phi_{k}} +\n\\overbrace{(I - 1)(J - 1)}^{\\psi_{ij}}]\\\\\n& = (I - 1)(J - 1)(K- 1) - (K - 2) - (I - 1)(J - 1) \\\\\n& = (I - 1)(J - 1)(K- 2) - (K - 2) \\\\\n& = (IJ - I - J)(K- 2)\n\\end{align}\\]\n式（4.21）：等質\\((R+C)-L\\)\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} \\\\\n& + \\quad \\overbrace{1}^{\\phi} +\n\\overbrace{(I-2)}^{\\tau_i^A} +\n\\overbrace{(J-2)}^{\\tau_j^B}]\\\\\n& = (I-1)(J-1)K - (I-2) - (J - 2) -1\\\\\n& = IJK - IK - JK + K - I - J + 3\\\\\n& = IJK - K(I + J - 1) - (I + J - 1) + 2\\\\\n& = IJK - (K+1)(I + J - 1) + 2\\\\\n\\end{align}\\]\n式（4.24）：異質\\((R+C)-L\\)\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} \\\\\n& + \\quad \\overbrace{K}^{\\phi_k} +\n\\overbrace{(I-2)K}^{\\tau_{ik}^{AC}} +\n\\overbrace{(J-2)K}^{\\tau_{jk}^{BC}}]\\\\\n& = (I-1)(J-1)K - (I-2)K - (J-2)K - K\n\\end{align}\\]\n式（4.27）：部分異質\\((R+C)-L\\)\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} \\\\\n& + \\quad \\overbrace{K}^{\\phi_k} +\n\\overbrace{(I-2)}^{\\tau_{i}^{AC}} +\n\\overbrace{(J-2)}^{\\tau_{j}^{BC}}]\\\\\n& = (I-1)(J-1)K - (I-2) - (J-2) - K\\\\\n& = IJK - IK - JK - I - J + 4\\\\\n& = IJK - (I + J)(K + 1) + 4\n\\end{align}\\]\n式（4.30）：部分異質\\((R+C)-L\\)\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} \\\\\n& + \\quad \\overbrace{K}^{\\phi_k} +\n\\overbrace{(I-2)K}^{\\tau_{ik}^{AC}} +\n\\overbrace{(J-2)}^{\\tau_{j}^{BC}}]\\\\\n& = (I-1)(J-1)K - (I-2)K - (J-2) - K\\\\\n& = IJK - IK - JK + K - IK + 2K - J + 2 - K\\\\\n& = IJK - 2IK - JK + 2K - J + 2\\\\\n& = J(IK - K - 1) - 2(IK - K - 1)\\\\\n& = (J - 2)(IK - K - 1)\n\\end{align}\\]\n式（4.31）：部分異質\\((R+C)-L\\)\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} \\\\\n& + \\quad \\overbrace{K}^{\\phi_k} +\n\\overbrace{(I-2)}^{\\tau_{i}^{AC}} +\n\\overbrace{(J-2)K}^{\\tau_{jk}^{BC}}]\\\\\n& = (I-1)(J-1)K - (I-2) - (J-2)K - K\\\\\n& = IJK - IK - JK + K - I + 2 - JK + 2K - K\\\\\n& = IJK - IK - 2JK + 2K - I + 2\\\\\n& = I(JK - K - 1) - 2(JK - K - 1)\\\\\n& = (I - 2)(JK - K - 1)\n\\end{align}\\]\n式（4.39）：同質\\(RC(M)-L\\)\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} \\\\\n& + \\quad \\overbrace{M}^{\\phi_m} +\n\\overbrace{(I-2)M}^{\\mu_{im}} +\n\\overbrace{(J-2)M}^{\\nu_{jm}} -\n\\overbrace{M(M-1)}^{次元間制約}] \\\\\n& = (I-1)(J-1)K - M(I + J - M - 2)\n\\end{align}\\]\n式（4.42）：異質\\(RC(M)-L\\)\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} \\\\\n& + \\quad \\overbrace{KM}^{\\phi_{mk}} +\n\\overbrace{(I-2)KM}^{\\mu_{imk}} +\n\\overbrace{(J-2)KM}^{\\nu_{jmk}} -\n\\overbrace{KM(M-1)}^{次元間制約}] \\\\\n& = K(I-1)(J-1) - KM(I - 1) - KM(J - 1) - KM^2\\\\\n& = K(I-1)[(J-1) - M] - KM[(J - 1) - M]\\\\\n& = K(I - 1 - M)(J - 1 - M)\n\\end{align}\\]\n式（4.45）\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} \\\\\n& + \\quad \\overbrace{K}^{\\phi_k} +\n\\overbrace{(I-2)}^{\\mu_{i}} + \\overbrace{(J-2)K}^{\\mu_{jk}}]\\\\\n& = IJK - IK - JK + K - K - I + 2 - JK + 2K\\\\\n& = I(JK - K - 1) -2(JK - K - 1)\\\\\n& = (I - 2)(JK - K - 1)\n\\end{align}\\]\n式（4.48）\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} \\\\\n& + \\quad \\overbrace{K}^{\\phi_k} +\n\\overbrace{(I-2)K}^{\\mu_{ik}} + \\overbrace{(J-2)}^{\\mu_{j}}]\\\\\n& \\quad = IJK - IK - JK + K - K - IK + 2K - J + 2\\\\\n& \\quad = J(IK - K - 1) -2(IK - K - 1)\\\\\n& \\quad = (J - 2)(IK - K - 1)\n\\end{align}\\]\n式（4.51）\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} \\\\\n& + \\quad \\overbrace{K}^{\\phi_k} +\n\\overbrace{(I-2)}^{\\mu_{i}} + \\overbrace{(J-2)}^{\\mu_{j}}]\\\\\n& \\quad = (IJK - IK - JK + K) - K - I + 2 - J + 2\\\\\n& \\quad = IJK - K(I + J) - (I + J) + 4\\\\\n& \\quad = IJK - (I + J)(K+1) + 4\n\\end{align}\\]"
  },
  {
    "objectID": "9-Note.html#パッケージ",
    "href": "9-Note.html#パッケージ",
    "title": "補足のノート",
    "section": "パッケージ",
    "text": "パッケージ\n\nlibrary(tidyverse)\nlibrary(broom)\nlibrary(gnm)\nlibrary(vcd)"
  },
  {
    "objectID": "9-Note.html#クロス表の作成",
    "href": "9-Note.html#クロス表の作成",
    "title": "補足のノート",
    "section": "クロス表の作成",
    "text": "クロス表の作成\n\nFreq &lt;- c( 64,  94, 58, 46, \n           57,  94, 54, 40,\n           57, 105, 65, 60,\n           72, 141, 77, 94,\n           36,  97, 54, 78,\n           21,  71, 54, 71)\n# byrow = TRUEとすることを忘れずに．\ntab &lt;- matrix(Freq, nrow = 6, ncol = 4, byrow = TRUE) |&gt; as.table()\ndimnames(tab)\n\n[[1]]\n[1] \"A\" \"B\" \"C\" \"D\" \"E\" \"F\"\n\n[[2]]\n[1] \"A\" \"B\" \"C\" \"D\"\n\ndimnames(tab) &lt;- list(SES = LETTERS[1:6],\n                      MHS = c(\"well\", \"mild\", \"modelrate\", \"impared\"))\ntab\n\n   MHS\nSES well mild modelrate impared\n  A   64   94        58      46\n  B   57   94        54      40\n  C   57  105        65      60\n  D   72  141        77      94\n  E   36   97        54      78\n  F   21   71        54      71"
  },
  {
    "objectID": "9-Note.html#集計データの作成",
    "href": "9-Note.html#集計データの作成",
    "title": "補足のノート",
    "section": "集計データの作成",
    "text": "集計データの作成\n\n表のデータではなく，各変数の組み合わせとその度数からなるデータを作成する．\n度数はまず1行目について数値を並べ（1行1列から1行\\(I\\)列まで），次に2行目について数値を並べる（2行1列から2行\\(I\\)列まで）．これをFreqとする．\n例として「編者による序文」の親の職業と精神的健康の例で考えてみる．これは\\(6\\times4\\)のクロス表なので，まず1行1列から1行4列までの数字を入力し，次に2行1列から2行4列まで入力する．これを3行目から6行目まで繰り返す．表との対応を考えて適当な改行をいれるのもよい．ただしRは改行を入れても入れなくても，単に数値の列（ベクトル）として扱う．\nglによって変数を作成する．度数がどの行と列に対応しているのかに注意してほしい．\n\n\n# 1行1列から1行4列，・・・・，6行1列から6行4列まで順に入力\nFreq &lt;- c( 64, 94, 58, 46, 57, 94, 54, 40, 57, 105, 65, 60, 72, 141, 77, 94, 36,  97, 54, 78, 21, 71, 54, 71)\n\n# 表ようにして入力\nFreq &lt;- c( 64,  94, 58, 46, \n           57,  94, 54, 40,\n           57, 105, 65, 60,\n           72, 141, 77, 94,\n           36,  97, 54, 78,\n           21,  71, 54, 71)\n\n\n行カテゴリと列カテゴリの数は\\(I\\)や\\(J\\)となっている．\nIを使いたいが，Rの関数にすでに用意されているので別の名前を考える．ここではNIとNJとする．\n例のデータでは，行カテゴリ数\\(I = 4\\)，列カテゴリ数\\(J = 5\\)である．\n\n\nNI &lt;- 4\nNJ &lt;- 6\n\n\nでは，Freqに対応する行カテゴリと列カテゴリを並べてみる．先程の入力のルールにしたがうと，行については1行1列から1行4列までの数字を入力しているので1,1,1,1となり，次に2,2,2,2となる．これを繰り返し最後は6,6,6,6となる．列については，1,2,3,4が6回繰り返される．\n\n\nRow &lt;- c(1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6)\nCol &lt;- c(1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4)\nclass(Row)\n\n[1] \"numeric\"\n\nclass(Col)\n\n[1] \"numeric\"\n\n\n\n属性が数値になっているのでas.factor（またはfactor）で因子（factor）に変換する．\n\n\nRow &lt;- as.factor(Row)\nCol &lt;- as.factor(Col)\nclass(Row);class(Col)\n\n[1] \"factor\"\n\n\n[1] \"factor\"\n\nRow\n\n [1] 1 1 1 1 2 2 2 2 3 3 3 3 4 4 4 4 5 5 5 5 6 6 6 6\nLevels: 1 2 3 4 5 6\n\nCol\n\n [1] 1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4\nLevels: 1 2 3 4\n\n\n\n単純な数値の列を作成したければrep関数が便利である．これは整数（integer）となる．\n\n\nRow &lt;- rep(1:4, each = 5)\nCol &lt;- rep(1:5, length.out = 20)\nclass(Row)\n\n[1] \"integer\"\n\nclass(Col)\n\n[1] \"integer\"\n\nRow &lt;- as.factor(Row)\nCol &lt;- as.factor(Col)\nclass(Row)\n\n[1] \"factor\"\n\nclass(Col)\n\n[1] \"factor\"\n\nRow\n\n [1] 1 1 1 1 1 2 2 2 2 2 3 3 3 3 3 4 4 4 4 4\nLevels: 1 2 3 4\n\nCol\n\n [1] 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5\nLevels: 1 2 3 4 5\n\n\n\nglはGenerate Factor Levelsという関数で，repに似ているが，数値ではなく因子を結果として出力する．\n1からnまでの数字をぞれぞれk回繰り返して出力する．\n\n\nRow &lt;- gl(n = 6, k = 4)\nCol &lt;- gl(n = 4, k = 1, length = 24)\nclass(Row)\n\n[1] \"factor\"\n\nclass(Col)\n\n[1] \"factor\"\n\nRow\n\n [1] 1 1 1 1 2 2 2 2 3 3 3 3 4 4 4 4 5 5 5 5 6 6 6 6\nLevels: 1 2 3 4 5 6\n\nCol\n\n [1] 1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4\nLevels: 1 2 3 4\n\n\n\n以上より，Freq，Row，Colの3つの変数が作成された．これらからなるデータを作成する．data.frameとtibbleのどちらでもよいが， tibbleの場合は表示させた後に，データの構造（&lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;）が表示される．\n\n\nd &lt;- data.frame(Freq, Row, Col)\nd\n\n   Freq Row Col\n1    64   1   1\n2    94   1   2\n3    58   1   3\n4    46   1   4\n5    57   2   1\n6    94   2   2\n7    54   2   3\n8    40   2   4\n9    57   3   1\n10  105   3   2\n11   65   3   3\n12   60   3   4\n13   72   4   1\n14  141   4   2\n15   77   4   3\n16   94   4   4\n17   36   5   1\n18   97   5   2\n19   54   5   3\n20   78   5   4\n21   21   6   1\n22   71   6   2\n23   54   6   3\n24   71   6   4\n\n# tibble でもよい\nd &lt;- tibble(Freq, Row, Col)\nd\n\n# A tibble: 24 × 3\n    Freq Row   Col  \n   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;\n 1    64 1     1    \n 2    94 1     2    \n 3    58 1     3    \n 4    46 1     4    \n 5    57 2     1    \n 6    94 2     2    \n 7    54 2     3    \n 8    40 2     4    \n 9    57 3     1    \n10   105 3     2    \n# ℹ 14 more rows\n\n\n\n以上をまとめると次のようになる．本書のプログラム例ではglを使うことが多いのでここで使用方法を覚えておこう．\n\n\nFreq &lt;- c( 64, 94, 58, 46, 57, 94, 54, 40, 57, 105, 65, 60, 72, 141, 77, 94, 36,  97, 54, 78, 21, 71, 54, 71)\nNI &lt;- 4\nNJ &lt;- 6\nRow &lt;- gl(n = NI, k = NJ, length = NI * NJ)\nCol &lt;- gl(n = NJ, k = 1, length = NI * NJ)\nd &lt;- tibble(Freq, Row, Col)\nd\n\n# A tibble: 24 × 3\n    Freq Row   Col  \n   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;\n 1    64 1     1    \n 2    94 1     2    \n 3    58 1     3    \n 4    46 1     4    \n 5    57 1     5    \n 6    94 1     6    \n 7    54 2     1    \n 8    40 2     2    \n 9    57 2     3    \n10   105 2     4    \n# ℹ 14 more rows"
  },
  {
    "objectID": "9-Note.html#glmとgnmの結果の比較",
    "href": "9-Note.html#glmとgnmの結果の比較",
    "title": "補足のノート",
    "section": "GLMとGNMの結果の比較",
    "text": "GLMとGNMの結果の比較\n\nglmとgnmでは適合度や係数は同じだが，出力されるものが異なる．\n\n\nfit_glm &lt;- glm(Freq ~ Row + Col, data = d, family = poisson)\nfit_gnm &lt;- gnm(Freq ~ Row + Col, data = d, family = poisson)\n\n通常の出力も少し違う．\n\nfit_glm\n\n\nCall:  glm(formula = Freq ~ Row + Col, family = poisson, data = d)\n\nCoefficients:\n(Intercept)         Row2         Row3         Row4         Col2         Col3  \n    4.10604     -0.08065      0.22460     -0.16838      0.36930     -0.13588  \n       Col4         Col5         Col6  \n    0.25857     -0.14058      0.27738  \n\nDegrees of Freedom: 23 Total (i.e. Null);  15 Residual\nNull Deviance:      217.4 \nResidual Deviance: 112  AIC: 274.2\n\nfit_gnm\n\n\nCall:\ngnm(formula = Freq ~ Row + Col, family = poisson, data = d)\n\nCoefficients:\n(Intercept)         Row2         Row3         Row4         Col2         Col3  \n    4.10604     -0.08065      0.22460     -0.16838      0.36930     -0.13588  \n       Col4         Col5         Col6  \n    0.25857     -0.14058      0.27738  \n\nDeviance:            112.0398 \nPearson chi-squared: 102.2928 \nResidual df:         15 \n\n\n\nnames(fit_glm)\n\n [1] \"coefficients\"      \"residuals\"         \"fitted.values\"    \n [4] \"effects\"           \"R\"                 \"rank\"             \n [7] \"qr\"                \"family\"            \"linear.predictors\"\n[10] \"deviance\"          \"aic\"               \"null.deviance\"    \n[13] \"iter\"              \"weights\"           \"prior.weights\"    \n[16] \"df.residual\"       \"df.null\"           \"y\"                \n[19] \"converged\"         \"boundary\"          \"model\"            \n[22] \"call\"              \"formula\"           \"terms\"            \n[25] \"data\"              \"offset\"            \"control\"          \n[28] \"method\"            \"contrasts\"         \"xlevels\"          \n\nnames(fit_gnm)\n\n [1] \"call\"          \"formula\"       \"terms\"         \"data\"         \n [5] \"eliminate\"     \"ofInterest\"    \"na.action\"     \"xlevels\"      \n [9] \"offset\"        \"tolerance\"     \"iterStart\"     \"iterMax\"      \n[13] \"coefficients\"  \"residuals\"     \"fitted.values\" \"rank\"         \n[17] \"family\"        \"predictors\"    \"deviance\"      \"aic\"          \n[21] \"iter\"          \"weights\"       \"prior.weights\" \"df.residual\"  \n[25] \"y\"             \"converged\"     \"constrain\"     \"constrainTo\"  \n[29] \"x\"             \"model\"        \n\n\n係数はもちろん同じ．\n\nsummary(fit_glm)\n\n\nCall:\nglm(formula = Freq ~ Row + Col, family = poisson, data = d)\n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  4.10604    0.07692  53.378  &lt; 2e-16 ***\nRow2        -0.08065    0.07104  -1.135 0.256237    \nRow3         0.22460    0.06600   3.403 0.000666 ***\nRow4        -0.16838    0.07271  -2.316 0.020573 *  \nCol2         0.36930    0.08325   4.436 9.17e-06 ***\nCol3        -0.13588    0.09377  -1.449 0.147336    \nCol4         0.25857    0.08522   3.034 0.002413 ** \nCol5        -0.14058    0.09389  -1.497 0.134314    \nCol6         0.27738    0.08488   3.268 0.001083 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 217.40  on 23  degrees of freedom\nResidual deviance: 112.04  on 15  degrees of freedom\nAIC: 274.21\n\nNumber of Fisher Scoring iterations: 4\n\nsummary(fit_gnm)\n\n\nCall:\ngnm(formula = Freq ~ Row + Col, family = poisson, data = d)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-5.0571  -0.4520   0.4274   1.1667   3.5712  \n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  4.10604    0.07692  53.378  &lt; 2e-16 ***\nRow2        -0.08065    0.07104  -1.135 0.256237    \nRow3         0.22460    0.06600   3.403 0.000666 ***\nRow4        -0.16838    0.07271  -2.316 0.020573 *  \nCol2         0.36930    0.08325   4.436 9.17e-06 ***\nCol3        -0.13588    0.09377  -1.449 0.147336    \nCol4         0.25857    0.08522   3.034 0.002413 ** \nCol5        -0.14058    0.09389  -1.497 0.134314    \nCol6         0.27738    0.08488   3.268 0.001083 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nResidual deviance: 112.04 on 15 degrees of freedom\nAIC: 274.21\n\nNumber of iterations: 4\n\n\n\ntidy(fit_glm)\n\n# A tibble: 9 × 5\n  term        estimate std.error statistic    p.value\n  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;\n1 (Intercept)   4.11      0.0769     53.4  0         \n2 Row2         -0.0806    0.0710     -1.14 0.256     \n3 Row3          0.225     0.0660      3.40 0.000666  \n4 Row4         -0.168     0.0727     -2.32 0.0206    \n5 Col2          0.369     0.0833      4.44 0.00000917\n6 Col3         -0.136     0.0938     -1.45 0.147     \n7 Col4          0.259     0.0852      3.03 0.00241   \n8 Col5         -0.141     0.0939     -1.50 0.134     \n9 Col6          0.277     0.0849      3.27 0.00108   \n\ntidy(fit_gnm)\n\nWarning: The `tidy()` method for objects of class `gnm` is not maintained by the broom team, and is only supported through the `glm` tidier method. Please be cautious in interpreting and reporting broom output.\n\nThis warning is displayed once per session.\n\n\n# A tibble: 9 × 5\n  term        estimate std.error statistic    p.value\n  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;\n1 (Intercept)   4.11      0.0769     53.4  0         \n2 Row2         -0.0806    0.0710     -1.14 0.256     \n3 Row3          0.225     0.0660      3.40 0.000666  \n4 Row4         -0.168     0.0727     -2.32 0.0206    \n5 Col2          0.369     0.0833      4.44 0.00000917\n6 Col3         -0.136     0.0938     -1.45 0.147     \n7 Col4          0.259     0.0852      3.03 0.00241   \n8 Col5         -0.141     0.0939     -1.50 0.134     \n9 Col6          0.277     0.0849      3.27 0.00108   \n\n\nnull.devianceとdf.nullがgnmでは出力されない．\n\nglance(fit_glm)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1          217.      23  -128.  274.  285.     112.          15    24\n\nglance(fit_gnm)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -128.  274.  285.     112.          15    24\n\n\n\ngnmで独立モデルと飽和モデル\n\n\nfit_O &lt;- gnm(Freq ~ Row + Col, data = d, family = poisson)\nfit_S &lt;- gnm(Freq ~ Row + Col + Row:Col, data = d, family = poisson)\n\n\nモデルの比較はanovaで可能．\n\n\nanova(fit_O, fit_S)\n\nAnalysis of Deviance Table\n\nModel 1: Freq ~ Row + Col\nModel 2: Freq ~ Row + Col + Row:Col\n  Resid. Df Resid. Dev Df Deviance\n1        15     112.04            \n2         0       0.00 15   112.04\n\n\n\nglance(fit_O)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -128.  274.  285.     112.          15    24\n\nglance(fit_S)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -72.1  192.  220. 4.35e-14           0    24"
  },
  {
    "objectID": "9-Note.html#期待度数",
    "href": "9-Note.html#期待度数",
    "title": "補足のノート",
    "section": "期待度数",
    "text": "期待度数\n\n期待度数を保存すれば期待度数についてのクロス表を作成することができる．飽和モデルの場合は，観測度数のクロス表と一致する．また独立モデルでの期待度数をみると，行によって列の幅が異なっていない（列によって行の幅がことなっていない）ことがわかる．\n\n\nd &lt;- d |&gt; mutate(O_Freq = fit_O$fitted.values,\n              S_Freq = fit_S$fitted.values)\nd |&gt; xtabs(Freq ~ Row + Col, data = _) |&gt; mosaic(shade = TRUE)\n\n\n\nd |&gt; xtabs(O_Freq ~ Row + Col, data = _) |&gt; mosaic(shade = TRUE)\n\n\n\nd |&gt; xtabs(S_Freq ~ Row + Col, data = _) |&gt; mosaic(shade = TRUE)\n\n\n\n\nfit_O$fitted.valuesの代わりにpredict(fit_O, type = \"response\")としても良い．type = \"response\"を忘れないようにする．"
  },
  {
    "objectID": "9-Note.html#モザイクプロット",
    "href": "9-Note.html#モザイクプロット",
    "title": "補足のノート",
    "section": "モザイクプロット",
    "text": "モザイクプロット\n\ngnmパッケージには，mentalHealthが用意されているのでこれを使ってみる．\n\n\nmentalHealth\n\n   count SES      MHS\n1     64   A     well\n2     94   A     mild\n3     58   A moderate\n4     46   A impaired\n5     57   B     well\n6     94   B     mild\n7     54   B moderate\n8     40   B impaired\n9     57   C     well\n10   105   C     mild\n11    65   C moderate\n12    60   C impaired\n13    72   D     well\n14   141   D     mild\n15    77   D moderate\n16    94   D impaired\n17    36   E     well\n18    97   E     mild\n19    54   E moderate\n20    78   E impaired\n21    21   F     well\n22    71   F     mild\n23    54   F moderate\n24    71   F impaired\n\n\n\nxtabsは集計データからクロス表を作成する際に用いる．xtabs(度数 ~ 行変数 + 列変数, data = データ名)とすればよい．mentalHealthではcountが度数を示している．\n\n\ntab_mentalHealth &lt;- xtabs(count ~ SES + MHS, data = mentalHealth)\ntab_mentalHealth\n\n   MHS\nSES well mild moderate impaired\n  A   64   94       58       46\n  B   57   94       54       40\n  C   57  105       65       60\n  D   72  141       77       94\n  E   36   97       54       78\n  F   21   71       54       71\n\n\n\nmosaicでモザイクプロットを図示．影をつけたければshade = TRUEとする．\n\n\nmosaic(tab_mentalHealth,\n       shade = TRUE)"
  },
  {
    "objectID": "9-Note.html#正規化",
    "href": "9-Note.html#正規化",
    "title": "補足のノート",
    "section": "正規化",
    "text": "正規化\n\nモデル適合度を表示するための関数を準備\n\n\nmodel.summary &lt;- function(obj) {\n  aic &lt;- obj$deviance - obj$df * 2 # AIC(L2)\n  bic &lt;- obj$deviance - obj$df * log(sum(obj$y)) #BIC(L2)\n  delta &lt;-\n    100 * sum(abs(obj$y - obj$fitted.values)) / (2 * sum(obj$y))\n  p &lt;- 1 - pchisq(obj$deviance, obj$df, lower.tail = F)\n  Model &lt;- deparse(substitute(obj))\n  result &lt;- tibble(\n    \"Model Description\" = Model,\n    \"df\" = obj$df,\n    \"L2\" = obj$deviance,\n    #\"AIC(L2)\" = aic,\n    \"BIC\" = bic,\n    \"Delta\" = delta,\n    \"p\" = p\n  )\n  return(result)\n}\n\n\n変数と係数と係数の順番を表示するための関数を準備\n\n\n# 変数と係数と係数の順番を表示\nvar_num &lt;- function(model) {\n  data.frame(var = names(model$coefficients),\n             estimate = model$coefficients) |&gt;\n    mutate(estimate = estimate,\n           number = row_number())\n}\n\n\n通常のRCモデルでは行スコアと列スコアが正規化されていない．\nAgresti (2002)\n\n\nset.seed(1)\n##  Goodman Row-Column association model fits well (deviance 3.57, df 8)\nmentalHealth$MHS &lt;- C(mentalHealth$MHS, treatment)\nmentalHealth$SES &lt;- C(mentalHealth$SES, treatment)\n\n# Independent Model\nO &lt;- gnm(count ~ SES + MHS,\n         family = poisson, data = mentalHealth)\n\n# Independent Modelの結果を利用して，初期値を設定\nmult1 &lt;- residSVD(O, SES, MHS)\nRC1 &lt;- gnm(\n  count ~ SES + MHS + Mult(1, SES, MHS),\n  start = c(coef(O), 1, mult1),\n  family = poisson,\n  data = mentalHealth\n)\n\nRunning main iterations..............\nDone\n\n# Estimateには数字があるが，Std. ErrorがNAとなっている．これらのパラメータは識別されていない．\nsummary(RC1)\n\n\nCall:\ngnm(formula = count ~ SES + MHS + Mult(1, SES, MHS), family = poisson, \n    data = mentalHealth, start = c(coef(O), 1, mult1))\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-0.87231  -0.30983   0.01026   0.29898   0.87866  \n\nCoefficients:\n                            Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)                  3.97986         NA      NA       NA\nSESB                        -0.06671         NA      NA       NA\nSESC                         0.05286         NA      NA       NA\nSESD                         0.31721         NA      NA       NA\nSESE                        -0.13824         NA      NA       NA\nSESF                        -0.42641         NA      NA       NA\nMHSmild                      0.63608         NA      NA       NA\nMHSmoderate                  0.11422         NA      NA       NA\nMHSimpaired                  0.09713         NA      NA       NA\nMult(., SES, MHS).           0.56928         NA      NA       NA\nMult(1, ., MHS).SESA        -0.40622         NA      NA       NA\nMult(1, ., MHS).SESB        -0.41074         NA      NA       NA\nMult(1, ., MHS).SESC        -0.03823         NA      NA       NA\nMult(1, ., MHS).SESD         0.15940         NA      NA       NA\nMult(1, ., MHS).SESE         0.64757         NA      NA       NA\nMult(1, ., MHS).SESF         1.04863         NA      NA       NA\nMult(1, SES, .).MHSwell     -0.73506         NA      NA       NA\nMult(1, SES, .).MHSmild      0.17046         NA      NA       NA\nMult(1, SES, .).MHSmoderate  0.33387         NA      NA       NA\nMult(1, SES, .).MHSimpaired  1.08597         NA      NA       NA\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 3.5706 on 8 degrees of freedom\nAIC: 179.74\n\nNumber of iterations: 14\n\ntidy(RC1)\n\n# A tibble: 20 × 5\n   term                        estimate std.error statistic p.value\n   &lt;chr&gt;                          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;\n 1 (Intercept)                   3.98          NA        NA      NA\n 2 SESB                         -0.0667        NA        NA      NA\n 3 SESC                          0.0529        NA        NA      NA\n 4 SESD                          0.317         NA        NA      NA\n 5 SESE                         -0.138         NA        NA      NA\n 6 SESF                         -0.426         NA        NA      NA\n 7 MHSmild                       0.636         NA        NA      NA\n 8 MHSmoderate                   0.114         NA        NA      NA\n 9 MHSimpaired                   0.0971        NA        NA      NA\n10 Mult(., SES, MHS).            0.569         NA        NA      NA\n11 Mult(1, ., MHS).SESA         -0.406         NA        NA      NA\n12 Mult(1, ., MHS).SESB         -0.411         NA        NA      NA\n13 Mult(1, ., MHS).SESC         -0.0382        NA        NA      NA\n14 Mult(1, ., MHS).SESD          0.159         NA        NA      NA\n15 Mult(1, ., MHS).SESE          0.648         NA        NA      NA\n16 Mult(1, ., MHS).SESF          1.05          NA        NA      NA\n17 Mult(1, SES, .).MHSwell      -0.735         NA        NA      NA\n18 Mult(1, SES, .).MHSmild       0.170         NA        NA      NA\n19 Mult(1, SES, .).MHSmoderate   0.334         NA        NA      NA\n20 Mult(1, SES, .).MHSimpaired   1.09          NA        NA      NA\n\n# 行スコアと列スコアがどこにあるかを取り出す．\nvar_num(RC1)\n\n                                                    var    estimate number\n(Intercept)                                 (Intercept)  3.97986269      1\nSESB                                               SESB -0.06671127      2\nSESC                                               SESC  0.05286438      3\nSESD                                               SESD  0.31721060      4\nSESE                                               SESE -0.13824301      5\nSESF                                               SESF -0.42641078      6\nMHSmild                                         MHSmild  0.63608165      7\nMHSmoderate                                 MHSmoderate  0.11422438      8\nMHSimpaired                                 MHSimpaired  0.09712562      9\nMult(., SES, MHS).                   Mult(., SES, MHS).  0.56928163     10\nMult(1, ., MHS).SESA               Mult(1, ., MHS).SESA -0.40622196     11\nMult(1, ., MHS).SESB               Mult(1, ., MHS).SESB -0.41074261     12\nMult(1, ., MHS).SESC               Mult(1, ., MHS).SESC -0.03823317     13\nMult(1, ., MHS).SESD               Mult(1, ., MHS).SESD  0.15940228     14\nMult(1, ., MHS).SESE               Mult(1, ., MHS).SESE  0.64756808     15\nMult(1, ., MHS).SESF               Mult(1, ., MHS).SESF  1.04862845     16\nMult(1, SES, .).MHSwell         Mult(1, SES, .).MHSwell -0.73505533     17\nMult(1, SES, .).MHSmild         Mult(1, SES, .).MHSmild  0.17045549     18\nMult(1, SES, .).MHSmoderate Mult(1, SES, .).MHSmoderate  0.33386631     19\nMult(1, SES, .).MHSimpaired Mult(1, SES, .).MHSimpaired  1.08596564     20\n\n# c(11:16,17:20)\n\n# getContrastsによって正規化された推定値とその標準誤差を示す．まずは重み付けのない／単位標準化された解を求める．\nmu_unit &lt;- getContrasts(\n  model = RC1,\n  set = pickCoef(RC1, \"[.]SES\"),\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\nnu_unit &lt;- getContrasts(\n  model = RC1,\n  set = pickCoef(RC1, \"[.]MHS\"),\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n# 正規化された解を表示\nmu_unit\n\n                         Estimate Std. Error\nMult(1, ., MHS).SESA -0.437796539  0.1127343\nMult(1, ., MHS).SESB -0.441250780  0.1141765\nMult(1, ., MHS).SESC -0.156615493  0.1224095\nMult(1, ., MHS).SESD -0.005601809  0.1126574\nMult(1, ., MHS).SESE  0.367406754  0.1240706\nMult(1, ., MHS).SESF  0.673857866  0.0932365\n\nnu_unit\n\n                               Estimate Std. Error\nMult(1, SES, .).MHSwell     -0.73265426 0.06465622\nMult(1, SES, .).MHSmild     -0.03347418 0.10831242\nMult(1, SES, .).MHSmoderate  0.09270166 0.12250921\nMult(1, SES, .).MHSimpaired  0.67342677 0.07862280\n\n# 正規化制約を確認\nall.equal(sum(mu_unit$qvframe[, 1]), 0)\n\n[1] TRUE\n\nall.equal(sum(nu_unit$qvframe[, 1]), 0)\n\n[1] TRUE\n\nall.equal(sum(mu_unit$qvframe[, 1] ^ 2), 1)\n\n[1] TRUE\n\nall.equal(sum(nu_unit$qvframe[, 1] ^ 2), 1)\n\n[1] TRUE\n\n# 値の制約\ncon &lt;- c(mu_unit$qvframe[, 1][c(1, 6)], nu_unit$qvframe[, 1][c(1, 4)])\ncon\n\n[1] -0.4377965  0.6738579 -0.7326543  0.6734268\n\nRC1 &lt;- gnm(\n  count ~ SES + MHS + Mult(1, SES, MHS),\n  constrain = c(11, 16, 17, 20),\n  constrainTo = con,\n  start = c(coef(O), NA, mult1),\n  family = poisson,\n  data = mentalHealth\n)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...........\nDone\n\nsummary(RC1)\n\n\nCall:\ngnm(formula = count ~ SES + MHS + Mult(1, SES, MHS), constrain = c(11, \n    16, 17, 20), constrainTo = con, family = poisson, data = mentalHealth, \n    start = c(coef(O), NA, mult1))\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-0.87231  -0.30983   0.01026   0.29898   0.87866  \n\nCoefficients:\n                             Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)                  3.840354   0.100134  38.352  &lt; 2e-16 ***\nSESB                        -0.067262   0.089460  -0.752   0.4521    \nSESC                         0.097655   0.088726   1.101   0.2711    \nSESD                         0.386057   0.087802   4.397 1.10e-05 ***\nSESE                        -0.009979   0.110426  -0.090   0.9280    \nSESF                        -0.249331   0.133563  -1.867   0.0619 .  \nMHSmild                      0.722031   0.096153   7.509 5.95e-14 ***\nMHSmoderate                  0.215685   0.108885   1.981   0.0476 *  \nMHSimpaired                  0.269974   0.148273   1.821   0.0686 .  \nMult(., SES, MHS).           0.964896   0.191615   5.036 4.76e-07 ***\nMult(1, ., MHS).SESA        -0.437797         NA      NA       NA    \nMult(1, ., MHS).SESB        -0.441251   0.201840  -2.186   0.0288 *  \nMult(1, ., MHS).SESC        -0.156615   0.176666  -0.887   0.3753    \nMult(1, ., MHS).SESD        -0.005602   0.160260  -0.035   0.9721    \nMult(1, ., MHS).SESE         0.367407   0.191566   1.918   0.0551 .  \nMult(1, ., MHS).SESF         0.673858         NA      NA       NA    \nMult(1, SES, .).MHSwell     -0.732654         NA      NA       NA    \nMult(1, SES, .).MHSmild     -0.033474   0.159023  -0.210   0.8333    \nMult(1, SES, .).MHSmoderate  0.092701   0.180220   0.514   0.6070    \nMult(1, SES, .).MHSimpaired  0.673427         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 3.5706 on 8 degrees of freedom\nAIC: 179.74\n\nNumber of iterations: 11\n\n# intrinsic association parameter\nphi &lt;- summary(RC1)$coefficients[\"Mult(., SES, MHS).\", 1]\nrho &lt;- (-1 + sqrt(1 + 4 * phi ^ 2)) / (2 * phi)\neta &lt;- (2 * phi) ^ (-1)\ntau &lt;- (1 + eta ^ 2) ^ (1 / 2) - eta\nlist(phi, rho, eta, tau)\n\n[[1]]\n[1] 0.9648955\n\n[[2]]\n[1] 0.6080959\n\n[[3]]\n[1] 0.5181908\n\n[[4]]\n[1] 0.6080959\n\nall.equal(rho, tau)\n\n[1] TRUE\n\n## Marginal weighted solution\nrowProbs &lt;- with(mentalHealth, tapply(count, SES, sum) / sum(count))\ncolProbs &lt;- with(mentalHealth, tapply(count, MHS, sum) / sum(count))\nmu &lt;- getContrasts(\n  model = RC1,\n  set = pickCoef(RC1, \"[.]SES\"),\n  ref = rowProbs,\n  scaleRef = rowProbs,\n  scaleWeights = rowProbs\n)\nnu &lt;- getContrasts(\n  model = RC1,\n  set = pickCoef(RC1, \"[.]MHS\"),\n  ref = colProbs,\n  scaleRef = colProbs,\n  scaleWeights = colProbs\n)\ncon &lt;- c(mu$qvframe[, 1][c(1, 6)], nu$qvframe[, 1][c(1, 4)])\nmu\n\n                        Estimate Std. Error\nMult(1, ., MHS).SESA -1.11233083  0.2990944\nMult(1, ., MHS).SESB -1.12143703  0.3138906\nMult(1, ., MHS).SESC -0.37107606  0.3194546\nMult(1, ., MHS).SESD  0.02702925  0.2734878\nMult(1, ., MHS).SESE  1.01036135  0.3149487\nMult(1, ., MHS).SESF  1.81823312  0.2824636\n\nnu\n\n                              Estimate Std. Error\nMult(1, SES, .).MHSwell     -1.6775144  0.1941179\nMult(1, SES, .).MHSmild     -0.1403989  0.2002803\nMult(1, SES, .).MHSmoderate  0.1369925  0.2799954\nMult(1, SES, .).MHSimpaired  1.4136909  0.1724133\n\ncon\n\n[1] -1.112331  1.818233 -1.677514  1.413691\n\n# 正規化制約を確認\nall.equal(sum(mu$qvframe[, 1] * rowProbs), 0)\n\n[1] TRUE\n\nall.equal(sum(nu$qvframe[, 1] * colProbs), 0)\n\n[1] TRUE\n\nall.equal(sum(mu$qvframe[, 1] ^ 2 * rowProbs), 1)\n\n[1] TRUE\n\nall.equal(sum(nu$qvframe[, 1] ^ 2 * colProbs), 1)\n\n[1] TRUE\n\nRC1 &lt;- gnm(\n  count ~ SES + MHS + Mult(1, SES, MHS),\n  constrain = c(11, 16, 17, 20),\n  constrainTo = con,\n  start = c(coef(O), NA, mult1),\n  family = poisson,\n  data = mentalHealth,\n  tolerance = 1e-12\n)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations....................................\nDone\n\nsummary(RC1)\n\n\nCall:\ngnm(formula = count ~ SES + MHS + Mult(1, SES, MHS), constrain = c(11, \n    16, 17, 20), constrainTo = con, family = poisson, data = mentalHealth, \n    start = c(coef(O), NA, mult1), tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-0.87231  -0.30982   0.01026   0.29898   0.87866  \n\nCoefficients:\n                            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)                  3.83919    0.10014  38.338  &lt; 2e-16 ***\nSESB                        -0.06736    0.09033  -0.746   0.4558    \nSESC                         0.10590    0.08929   1.186   0.2356    \nSESD                         0.39873    0.08826   4.517 6.26e-06 ***\nSESE                         0.01363    0.11020   0.124   0.9016    \nSESF                        -0.21674    0.13232  -1.638   0.1014    \nMHSmild                      0.71134    0.09556   7.444 9.77e-14 ***\nMHSmoderate                  0.20306    0.10841   1.873   0.0611 .  \nMHSimpaired                  0.24846    0.14842   1.674   0.0941 .  \nMult(., SES, MHS).           0.16649    0.03306   5.036 4.76e-07 ***\nMult(1, ., MHS).SESA        -1.11233         NA      NA       NA    \nMult(1, ., MHS).SESB        -1.12144    0.53209  -2.108   0.0351 *  \nMult(1, ., MHS).SESC        -0.37108    0.46573  -0.797   0.4256    \nMult(1, ., MHS).SESD         0.02703    0.42248   0.064   0.9490    \nMult(1, ., MHS).SESE         1.01036    0.50501   2.001   0.0454 *  \nMult(1, ., MHS).SESF         1.81823         NA      NA       NA    \nMult(1, SES, .).MHSwell     -1.67751         NA      NA       NA    \nMult(1, SES, .).MHSmild     -0.14040    0.34961  -0.402   0.6880    \nMult(1, SES, .).MHSmoderate  0.13699    0.39621   0.346   0.7295    \nMult(1, SES, .).MHSimpaired  1.41369         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 3.5706 on 8 degrees of freedom\nAIC: 179.74\n\nNumber of iterations: 36\n\ntidy(RC1)\n\n# A tibble: 20 × 5\n   term                        estimate std.error statistic   p.value\n   &lt;chr&gt;                          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;\n 1 (Intercept)                   3.84      0.100    38.3     0       \n 2 SESB                         -0.0674    0.0903   -0.746   4.56e- 1\n 3 SESC                          0.106     0.0893    1.19    2.36e- 1\n 4 SESD                          0.399     0.0883    4.52    6.26e- 6\n 5 SESE                          0.0136    0.110     0.124   9.02e- 1\n 6 SESF                         -0.217     0.132    -1.64    1.01e- 1\n 7 MHSmild                       0.711     0.0956    7.44    9.77e-14\n 8 MHSmoderate                   0.203     0.108     1.87    6.11e- 2\n 9 MHSimpaired                   0.248     0.148     1.67    9.41e- 2\n10 Mult(., SES, MHS).            0.166     0.0331    5.04    4.76e- 7\n11 Mult(1, ., MHS).SESA         -1.11     NA        NA      NA       \n12 Mult(1, ., MHS).SESB         -1.12      0.532    -2.11    3.51e- 2\n13 Mult(1, ., MHS).SESC         -0.371     0.466    -0.797   4.26e- 1\n14 Mult(1, ., MHS).SESD          0.0270    0.422     0.0640  9.49e- 1\n15 Mult(1, ., MHS).SESE          1.01      0.505     2.00    4.54e- 2\n16 Mult(1, ., MHS).SESF          1.82     NA        NA      NA       \n17 Mult(1, SES, .).MHSwell      -1.68     NA        NA      NA       \n18 Mult(1, SES, .).MHSmild      -0.140     0.350    -0.402   6.88e- 1\n19 Mult(1, SES, .).MHSmoderate   0.137     0.396     0.346   7.30e- 1\n20 Mult(1, SES, .).MHSimpaired   1.41     NA        NA      NA"
  },
  {
    "objectID": "9-Note.html#初期値",
    "href": "9-Note.html#初期値",
    "title": "補足のノート",
    "section": "初期値",
    "text": "初期値\n\n# データの準備\nFreq &lt;- c( 39, 50, 18,  4,\n          140,178, 85, 23,\n          108,195, 97, 23,\n          238,598,363,111,\n           78,250,150, 55,\n           50,200,208, 74,\n            8, 29, 46, 21)\n\n\ntab_2.3A &lt;-\n  matrix(Freq,\n         nrow = 7,\n         ncol = 4,\n         byrow = TRUE) |&gt; as.table()\n\npolviews &lt;- gl(n = 7, k = 4)\nfefam &lt;- gl(n = 4, k = 1, length = 28)\nfreq_tab_2.3A &lt;- tibble(Freq, polviews, fefam)\nfreq_tab_2.3A\n\n# A tibble: 28 × 3\n    Freq polviews fefam\n   &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;\n 1    39 1        1    \n 2    50 1        2    \n 3    18 1        3    \n 4     4 1        4    \n 5   140 2        1    \n 6   178 2        2    \n 7    85 2        3    \n 8    23 2        4    \n 9   108 3        1    \n10   195 3        2    \n# ℹ 18 more rows\n\n# 独立モデル\nO &lt;- freq_tab_2.3A |&gt; gnm(\n  Freq ~ polviews + fefam,\n  family = poisson,\n  data = _,\n  tolerance = 1e-12\n)\n\nvar_num(O)\n\n                    var   estimate number\n(Intercept) (Intercept)  3.0603480      1\npolviews2     polviews2  1.3449091      2\npolviews3     polviews3  1.3378420      3\npolviews4     polviews4  2.4682522      4\npolviews5     polviews5  1.5689912      5\npolviews6     polviews6  1.5671133      6\npolviews7     polviews7 -0.0651393      7\nfefam2           fefam2  0.8194665      8\nfefam3           fefam3  0.3804447      9\nfefam4           fefam4 -0.7539609     10\n\nRC &lt;- freq_tab_2.3A |&gt;\n  gnm(\n    Freq ~ polviews + fefam +\n      Mult(1, polviews, fefam),\n    family = poisson,\n    data = _,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations............................\nDone\n\nvar_num(RC)\n\n                                                    var     estimate number\n(Intercept)                                 (Intercept)  2.902702351      1\npolviews2                                     polviews2  1.390548385      2\npolviews3                                     polviews3  1.427149259      3\npolviews4                                     polviews4  2.586614669      4\npolviews5                                     polviews5  1.686005670      5\npolviews6                                     polviews6  1.625948840      6\npolviews7                                     polviews7 -0.114101970      7\nfefam2                                           fefam2  0.889280567      8\nfefam3                                           fefam3  0.414411068      9\nfefam4                                           fefam4 -0.767263370     10\nMult(., polviews, fefam).     Mult(., polviews, fefam).  0.354847803     11\nMult(1, ., fefam).polviews1 Mult(1, ., fefam).polviews1 -4.642973707     12\nMult(1, ., fefam).polviews2 Mult(1, ., fefam).polviews2 -3.587221083     13\nMult(1, ., fefam).polviews3 Mult(1, ., fefam).polviews3 -2.177313145     14\nMult(1, ., fefam).polviews4 Mult(1, ., fefam).polviews4 -0.001967735     15\nMult(1, ., fefam).polviews5 Mult(1, ., fefam).polviews5  0.933577004     16\nMult(1, ., fefam).polviews6 Mult(1, ., fefam).polviews6  3.992993578     17\nMult(1, ., fefam).polviews7 Mult(1, ., fefam).polviews7  6.608154586     18\nMult(1, polviews, .).fefam1 Mult(1, polviews, .).fefam1 -0.468986131     19\nMult(1, polviews, .).fefam2 Mult(1, polviews, .).fefam2 -0.061831609     20\nMult(1, polviews, .).fefam3 Mult(1, polviews, .).fefam3  0.255547101     21\nMult(1, polviews, .).fefam4 Mult(1, polviews, .).fefam4  0.406103105     22\n\nmult1 &lt;- residSVD(O, polviews, fefam)\nmult2 &lt;- residSVD(O, polviews, fefam, d = 2)\nmult3 &lt;- residSVD(O, polviews, fefam, d = 3)\n\nRC &lt;- freq_tab_2.3A |&gt;\n  gnm(\n    Freq ~ polviews + fefam + Mult(1, polviews, fefam),\n    start = c(coef(O), NA, mult1),\n    family = poisson,\n    data = _,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...........................\nDone\n\nsummary(RC)\n\n\nCall:\ngnm(formula = Freq ~ polviews + fefam + Mult(1, polviews, fefam), \n    family = poisson, data = freq_tab_2.3A, start = c(coef(O), \n        NA, mult1), tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.07428  -0.27239   0.03038   0.36792   1.03721  \n\nCoefficients:\n                            Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)                  2.97067         NA      NA       NA\npolviews2                    1.38106         NA      NA       NA\npolviews3                    1.40499         NA      NA       NA\npolviews4                    2.54490         NA      NA       NA\npolviews5                    1.63588         NA      NA       NA\npolviews6                    1.54832         NA      NA       NA\npolviews7                   -0.21523         NA      NA       NA\nfefam2                       0.86521         NA      NA       NA\nfefam3                       0.37157         NA      NA       NA\nfefam4                      -0.81900         NA      NA       NA\nMult(., polviews, fefam).    0.11476         NA      NA       NA\nMult(1, ., fefam).polviews1 -2.23657         NA      NA       NA\nMult(1, ., fefam).polviews2 -1.70908         NA      NA       NA\nMult(1, ., fefam).polviews3 -1.00463         NA      NA       NA\nMult(1, ., fefam).polviews4  0.08226         NA      NA       NA\nMult(1, ., fefam).polviews5  0.54970         NA      NA       NA\nMult(1, ., fefam).polviews6  2.07831         NA      NA       NA\nMult(1, ., fefam).polviews7  3.38495         NA      NA       NA\nMult(1, polviews, .).fefam1 -2.74560         NA      NA       NA\nMult(1, polviews, .).fefam2 -0.22589         NA      NA       NA\nMult(1, polviews, .).fefam3  1.73823         NA      NA       NA\nMult(1, polviews, .).fefam4  2.66996         NA      NA       NA\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 8.0718 on 10 degrees of freedom\nAIC: 215.43\n\nNumber of iterations: 27\n\ntidy(RC)\n\n# A tibble: 22 × 5\n   term        estimate std.error statistic p.value\n   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;\n 1 (Intercept)    2.97         NA        NA      NA\n 2 polviews2      1.38         NA        NA      NA\n 3 polviews3      1.40         NA        NA      NA\n 4 polviews4      2.54         NA        NA      NA\n 5 polviews5      1.64         NA        NA      NA\n 6 polviews6      1.55         NA        NA      NA\n 7 polviews7     -0.215        NA        NA      NA\n 8 fefam2         0.865        NA        NA      NA\n 9 fefam3         0.372        NA        NA      NA\n10 fefam4        -0.819        NA        NA      NA\n# ℹ 12 more rows\n\nglance(RC)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -89.7  215.  239.     8.07          10    28\n\nRC2 &lt;- freq_tab_2.3A |&gt;\n  gnm(\n    Freq ~ polviews + fefam +\n      Mult(1, polviews, fefam, inst = 1) +\n      Mult(1, polviews, fefam, inst = 2),\n    start = c(coef(O), NA, mult2[, 1], NA, mult2[, 2]),\n    family = poisson,\n    data = _,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n..............\nDone\n\nsummary(RC2)\n\n\nCall:\ngnm(formula = Freq ~ polviews + fefam + Mult(1, polviews, fefam, \n    inst = 1) + Mult(1, polviews, fefam, inst = 2), family = poisson, \n    data = freq_tab_2.3A, start = c(coef(O), NA, mult2[, 1], \n        NA, mult2[, 2]), tolerance = 1e-12)\n\nDeviance Residuals: \n      Min         1Q     Median         3Q        Max  \n-0.500439  -0.068726  -0.002705   0.066147   0.535693  \n\nCoefficients:\n                                       Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)                            2.993287         NA      NA       NA\npolviews2                              1.436412         NA      NA       NA\npolviews3                              1.398908         NA      NA       NA\npolviews4                              2.518065         NA      NA       NA\npolviews5                              1.564082         NA      NA       NA\npolviews6                              1.534299         NA      NA       NA\npolviews7                             -0.133562         NA      NA       NA\nfefam2                                 0.814972         NA      NA       NA\nfefam3                                 0.369393         NA      NA       NA\nfefam4                                -0.825633         NA      NA       NA\nMult(., polviews, fefam, inst = 1).    0.111566         NA      NA       NA\nMult(1, ., fefam, inst = 1).polviews1 -2.370011         NA      NA       NA\nMult(1, ., fefam, inst = 1).polviews2 -1.718197         NA      NA       NA\nMult(1, ., fefam, inst = 1).polviews3 -1.055282         NA      NA       NA\nMult(1, ., fefam, inst = 1).polviews4  0.094489         NA      NA       NA\nMult(1, ., fefam, inst = 1).polviews5  0.651356         NA      NA       NA\nMult(1, ., fefam, inst = 1).polviews6  2.082776         NA      NA       NA\nMult(1, ., fefam, inst = 1).polviews7  3.020457         NA      NA       NA\nMult(1, polviews, ., inst = 1).fefam1 -2.548941         NA      NA       NA\nMult(1, polviews, ., inst = 1).fefam2 -0.333340         NA      NA       NA\nMult(1, polviews, ., inst = 1).fefam3  1.824525         NA      NA       NA\nMult(1, polviews, ., inst = 1).fefam4  2.789907         NA      NA       NA\nMult(., polviews, fefam, inst = 2).    0.064972         NA      NA       NA\nMult(1, ., fefam, inst = 2).polviews1 -0.129058         NA      NA       NA\nMult(1, ., fefam, inst = 2).polviews2  1.061518         NA      NA       NA\nMult(1, ., fefam, inst = 2).polviews3 -0.214994         NA      NA       NA\nMult(1, ., fefam, inst = 2).polviews4 -0.595091         NA      NA       NA\nMult(1, ., fefam, inst = 2).polviews5 -1.469833         NA      NA       NA\nMult(1, ., fefam, inst = 2).polviews6 -0.267529         NA      NA       NA\nMult(1, ., fefam, inst = 2).polviews7  1.608264         NA      NA       NA\nMult(1, polviews, ., inst = 2).fefam1  0.298457         NA      NA       NA\nMult(1, polviews, ., inst = 2).fefam2 -1.828478         NA      NA       NA\nMult(1, polviews, ., inst = 2).fefam3  0.195655         NA      NA       NA\nMult(1, polviews, ., inst = 2).fefam4  0.002679         NA      NA       NA\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 1.3691 on 4 degrees of freedom\nAIC: 220.72\n\nNumber of iterations: 71\n\ntidy(RC2)\n\n# A tibble: 34 × 5\n   term        estimate std.error statistic p.value\n   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;\n 1 (Intercept)    2.99         NA        NA      NA\n 2 polviews2      1.44         NA        NA      NA\n 3 polviews3      1.40         NA        NA      NA\n 4 polviews4      2.52         NA        NA      NA\n 5 polviews5      1.56         NA        NA      NA\n 6 polviews6      1.53         NA        NA      NA\n 7 polviews7     -0.134        NA        NA      NA\n 8 fefam2         0.815        NA        NA      NA\n 9 fefam3         0.369        NA        NA      NA\n10 fefam4        -0.826        NA        NA      NA\n# ℹ 24 more rows\n\nglance(RC2)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -86.4  221.  253.     1.37           4    28\n\nRC3 &lt;- freq_tab_2.3A |&gt;\n  gnm(\n    Freq ~ polviews + fefam + Mult(1, polviews, fefam, inst = 1) +\n      Mult(1, polviews, fefam, inst = 2) +\n      Mult(1, polviews, fefam, inst = 3),\n    start = c(coef(O), NA, mult3[, 1], NA, mult3[, 2], NA, mult3[, 3]),\n    family = poisson,\n    data = _,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations......\nDone\n\nsummary(RC3)\n\n\nCall:\ngnm(formula = Freq ~ polviews + fefam + Mult(1, polviews, fefam, \n    inst = 1) + Mult(1, polviews, fefam, inst = 2) + Mult(1, \n    polviews, fefam, inst = 3), family = poisson, data = freq_tab_2.3A, \n    start = c(coef(O), NA, mult3[, 1], NA, mult3[, 2], NA, mult3[, \n        3]), tolerance = 1e-12)\n\nDeviance Residuals: \n   Min      1Q  Median      3Q     Max  \n     0       0       0       0       0  \n\nCoefficients:\n                                      Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)                            2.98832         NA      NA       NA\npolviews2                              1.45668         NA      NA       NA\npolviews3                              1.38302         NA      NA       NA\npolviews4                              2.52059         NA      NA       NA\npolviews5                              1.58491         NA      NA       NA\npolviews6                              1.51818         NA      NA       NA\npolviews7                             -0.10812         NA      NA       NA\nfefam2                                 0.81254         NA      NA       NA\nfefam3                                 0.35325         NA      NA       NA\nfefam4                                -0.80539         NA      NA       NA\nMult(., polviews, fefam, inst = 1).    0.11105         NA      NA       NA\nMult(1, ., fefam, inst = 1).polviews1 -2.36488         NA      NA       NA\nMult(1, ., fefam, inst = 1).polviews2 -1.70985         NA      NA       NA\nMult(1, ., fefam, inst = 1).polviews3 -1.02644         NA      NA       NA\nMult(1, ., fefam, inst = 1).polviews4  0.10832         NA      NA       NA\nMult(1, ., fefam, inst = 1).polviews5  0.61151         NA      NA       NA\nMult(1, ., fefam, inst = 1).polviews6  2.15910         NA      NA       NA\nMult(1, ., fefam, inst = 1).polviews7  2.95936         NA      NA       NA\nMult(1, polviews, ., inst = 1).fefam1 -2.41740         NA      NA       NA\nMult(1, polviews, ., inst = 1).fefam2 -0.28415         NA      NA       NA\nMult(1, polviews, ., inst = 1).fefam3  2.05381         NA      NA       NA\nMult(1, polviews, ., inst = 1).fefam4  2.43636         NA      NA       NA\nMult(., polviews, fefam, inst = 2).    0.06452         NA      NA       NA\nMult(1, ., fefam, inst = 2).polviews1 -0.12647         NA      NA       NA\nMult(1, ., fefam, inst = 2).polviews2  1.13121         NA      NA       NA\nMult(1, ., fefam, inst = 2).polviews3 -0.29985         NA      NA       NA\nMult(1, ., fefam, inst = 2).polviews4 -0.60482         NA      NA       NA\nMult(1, ., fefam, inst = 2).polviews5 -1.37958         NA      NA       NA\nMult(1, ., fefam, inst = 2).polviews6 -0.41755         NA      NA       NA\nMult(1, ., fefam, inst = 2).polviews7  1.74634         NA      NA       NA\nMult(1, polviews, ., inst = 2).fefam1  0.38993         NA      NA       NA\nMult(1, polviews, ., inst = 2).fefam2 -1.83914         NA      NA       NA\nMult(1, polviews, ., inst = 2).fefam3  0.21225         NA      NA       NA\nMult(1, polviews, ., inst = 2).fefam4 -0.11423         NA      NA       NA\nMult(., polviews, fefam, inst = 3).    0.05616         NA      NA       NA\nMult(1, ., fefam, inst = 3).polviews1  2.23238         NA      NA       NA\nMult(1, ., fefam, inst = 3).polviews2  0.46917         NA      NA       NA\nMult(1, ., fefam, inst = 3).polviews3  2.19320         NA      NA       NA\nMult(1, ., fefam, inst = 3).polviews4  0.39281         NA      NA       NA\nMult(1, ., fefam, inst = 3).polviews5 -0.90419         NA      NA       NA\nMult(1, ., fefam, inst = 3).polviews6 -0.22218         NA      NA       NA\nMult(1, ., fefam, inst = 3).polviews7 -2.57455         NA      NA       NA\nMult(1, polviews, ., inst = 3).fefam1  0.34732         NA      NA       NA\nMult(1, polviews, ., inst = 3).fefam2  0.17172         NA      NA       NA\nMult(1, polviews, ., inst = 3).fefam3  0.71728         NA      NA       NA\nMult(1, polviews, ., inst = 3).fefam4 -1.25788         NA      NA       NA\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 2.1316e-14 on 0 degrees of freedom\nAIC: 227.35\n\nNumber of iterations: 6\n\ntidy(RC3)\n\n# A tibble: 46 × 5\n   term        estimate std.error statistic p.value\n   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;\n 1 (Intercept)    2.99         NA        NA      NA\n 2 polviews2      1.46         NA        NA      NA\n 3 polviews3      1.38         NA        NA      NA\n 4 polviews4      2.52         NA        NA      NA\n 5 polviews5      1.58         NA        NA      NA\n 6 polviews6      1.52         NA        NA      NA\n 7 polviews7     -0.108        NA        NA      NA\n 8 fefam2         0.813        NA        NA      NA\n 9 fefam3         0.353        NA        NA      NA\n10 fefam4        -0.805        NA        NA      NA\n# ℹ 36 more rows\n\nglance(RC3)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -85.7  227.  265. 2.13e-14           0    28\n\nlibrary(logmult)\n\n\nAttaching package: 'logmult'\n\n\nThe following object is masked from 'package:vcd':\n\n    assoc\n\n\nThe following object is masked from 'package:gnm':\n\n    se\n\nanoas_model &lt;- anoas(tab_2.3A, nd = 3)\n\nFitting independence model...\nFitting model with 1 dimension...\nInitialising\nRunning start-up iterations..\nRunning main iterations........\nDone\nFitting model with 2 dimensions...\nInitialising\nRunning start-up iterations..\nRunning main iterations...............................\nDone\nFitting model with 3 dimensions...\nInitialising\nRunning start-up iterations..\nRunning main iterations...\nDone\n\nanoas_model\n\n       Res. Df           Res. Dev    Dev./Indep. (%)     Dissim. (%)\nIndep.      18 211.69508974175693 100.00000000000000 8.0917102896466\nRC(1)       10   8.07181892814987   3.81294575041705 1.7673079267546\nRC(2)        4   1.36909098846090   0.64672779615769 0.4963921430961\nRC(3)        0   0.00000000000009   0.00000000000004 0.0000000000002\n                      BIC                AIC Dev. Df\nIndep.  65.12224155397615 175.69508974175693   NA NA\nRC(1)  -73.35754117617279 -11.92818107185013 -204 -8\nRC(2)  -31.20265305326816  -6.63090901153910   -7 -6\nRC(3)    0.00000000000009   0.00000000000009   -1 -4\n\nrc(tab_2.3A, nd = 1)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations............\nDone\n\n\nCall:\nrc(tab = tab_2.3A, nd = 1)\n\nIntrinsic association coefficients:\n Dim1 \n0.257 \n\nNormalized row scores (Rows):\n      A       B       C       D       E       F       G \n 1.8206  1.4153  0.8741  0.0389 -0.3202 -1.4947 -2.4987 \n\nNormalized column scores (Columns):\n     A      B      C      D \n 1.658  0.192 -0.951 -1.493 \n\nNormalization weights: marginal\nDeviance:              8.071819\nPearson chi-squared:   8.168769\nDissimilarity index:   1.767308%\nResidual df:           10\nBIC:                   -73.35754\nAIC:                   -11.92818\n\nrc(tab_2.3A, nd = 2)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations............................\nDone\n\n\nCall:\nrc(tab = tab_2.3A, nd = 2)\n\nIntrinsic association coefficients:\n Dim1  Dim2 \n0.245 0.048 \n\nNormalized row scores (Rows):\n  Dim1    Dim2   \nA  1.9332  0.1608\nB  1.3846 -1.5665\nC  0.9161  0.0381\nD  0.0375  0.3428\nE -0.3632  1.4237\nF -1.5171 -0.4611\nG -2.3120 -3.1663\n\nNormalized column scores (Columns):\n  Dim1   Dim2  \nA  1.625 -1.205\nB  0.220  1.114\nC -0.958 -0.751\nD -1.536 -0.480\n\nNormalization weights: marginal\nDeviance:              1.369091\nPearson chi-squared:   1.369503\nDissimilarity index:   0.4963921%\nResidual df:           4\nBIC:                   -31.20265\nAIC:                   -6.630909\n\nrc(tab_2.3A, nd = 3)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations......\nDone\n\n\nCall:\nrc(tab = tab_2.3A, nd = 3)\n\nIntrinsic association coefficients:\n  Dim1   Dim2   Dim3 \n0.2455 0.0485 0.0204 \n\nNormalized row scores (Rows):\n  Dim1    Dim2    Dim3   \nA  1.9417  0.1575  0.6432\nB  1.3708 -1.5534 -1.0724\nC  0.9319  0.0444  1.6635\nD  0.0365  0.3379  0.0661\nE -0.3566  1.3877 -1.4225\nF -1.5358 -0.3972  0.9283\nG -2.2540 -3.3219 -1.3514\n\nNormalized column scores (Columns):\n  Dim1    Dim2    Dim3   \nA  1.6240 -1.2103 -0.3173\nB  0.2205  1.1151  0.0269\nC -0.9567 -0.7330  1.0506\nD -1.5401 -0.5267 -2.7219\n\nNormalization weights: marginal\nDeviance:              -4.507505e-14\nPearson chi-squared:   2.138457e-27\nDissimilarity index:   3.201213e-14%\nResidual df:           0\nBIC:                   -4.507505e-14\nAIC:                   -4.507505e-14\n\nbind_rows(model.summary(O),\n          model.summary(RC),\n          model.summary(RC2),\n          model.summary(RC3))\n\n# A tibble: 4 × 6\n  `Model Description`    df       L2       BIC    Delta     p\n  &lt;chr&gt;               &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;\n1 O                      18 2.12e+ 2  6.51e+ 1 8.09e+ 0 1    \n2 RC                     10 8.07e+ 0 -7.34e+ 1 1.77e+ 0 0.378\n3 RC2                     4 1.37e+ 0 -3.12e+ 1 4.96e- 1 0.150\n4 RC3                     0 2.13e-14  2.13e-14 3.29e-14 1    \n\n\n\n## 表2.3B\nFreq &lt;- c(518,  95, 6, 35, 5,\n         　 81,  67, 4, 49, 2,\n          452,1003,67,630, 5,\n           71, 157,37,562,12)\n\n\n# データを表形式に変換\ntab_2.3B &lt;-\n  matrix(Freq,\n         nrow = 4,\n         ncol = 5,\n         byrow = TRUE) |&gt; as.table()\n\ntab_2.3B\n\n     A    B    C    D    E\nA  518   95    6   35    5\nB   81   67    4   49    2\nC  452 1003   67  630    5\nD   71  157   37  562   12\n\n# 度数，行変数，列変数からなる集計データを作成\nEduc &lt;- gl(n = 4, k = 5)\nOcc &lt;- gl(n = 5, k = 1, length = 20)\nfreq_tab_2.3B &lt;- tibble(Freq, Educ, Occ)\nfreq_tab_2.3B\n\n# A tibble: 20 × 3\n    Freq Educ  Occ  \n   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;\n 1   518 1     1    \n 2    95 1     2    \n 3     6 1     3    \n 4    35 1     4    \n 5     5 1     5    \n 6    81 2     1    \n 7    67 2     2    \n 8     4 2     3    \n 9    49 2     4    \n10     2 2     5    \n11   452 3     1    \n12  1003 3     2    \n13    67 3     3    \n14   630 3     4    \n15     5 3     5    \n16    71 4     1    \n17   157 4     2    \n18    37 4     3    \n19   562 4     4    \n20    12 4     5    \n\nO &lt;- freq_tab_2.3B |&gt; \n  gnm(Freq ~ Educ + Occ,\n         family = poisson,\n         data = _,\n         tolerance = 1e-12)\n\nmult1 &lt;- residSVD(O, Educ, Occ)\nmult2 &lt;- residSVD(O, Educ, Occ, d = 2)\nmult3 &lt;- residSVD(O, Educ, Occ, d = 3)\n\nRC &lt;- freq_tab_2.3B |&gt;\n  gnm(\n    Freq ~ Educ + Occ + Mult(1, Educ, Occ),\n    family = poisson,\n    data = _,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n..................\nDone\n\nvar_num(RC)\n\n                                        var    estimate number\n(Intercept)                     (Intercept)  4.84609319      1\nEduc2                                 Educ2 -0.84036732      2\nEduc3                                 Educ3  1.43223229      3\nEduc4                                 Educ4 -0.20620288      4\nOcc2                                   Occ2  0.48596765      5\nOcc3                                   Occ3 -2.07003164      6\nOcc4                                   Occ4  0.17468852      7\nOcc5                                   Occ5 -3.56888992      8\nMult(., Educ, Occ).     Mult(., Educ, Occ). 28.27801364      9\nMult(1, ., Occ).Educ1 Mult(1, ., Occ).Educ1  0.31457624     10\nMult(1, ., Occ).Educ2 Mult(1, ., Occ).Educ2  0.06872003     11\nMult(1, ., Occ).Educ3 Mult(1, ., Occ).Educ3 -0.01107907     12\nMult(1, ., Occ).Educ4 Mult(1, ., Occ).Educ4 -0.21810595     13\nMult(1, Educ, .).Occ1 Mult(1, Educ, .).Occ1  0.15385314     14\nMult(1, Educ, .).Occ2 Mult(1, Educ, .).Occ2 -0.04772764     15\nMult(1, Educ, .).Occ3 Mult(1, Educ, .).Occ3 -0.15638745     16\nMult(1, Educ, .).Occ4 Mult(1, Educ, .).Occ4 -0.23730565     17\nMult(1, Educ, .).Occ5 Mult(1, Educ, .).Occ5 -0.11388309     18\n\nRC &lt;- freq_tab_2.3B |&gt;\n  gnm(\n    Freq ~ Educ + Occ + Mult(1, Educ, Occ),\n    start = c(coef(O), 10, mult1),\n    family = poisson,\n    data = _,\n    tolerance = 1e-12\n  )\n\nRunning main iterations.........................................................\n................................................................................\n................................................................................\n................................................................................\n................................................................................\n................................................................................\n...........................................\nDone\n\n\nWarning in gnmFit(modelTools = modelTools, y = y, constrain = constrain, : Fitting algorithm has either not converged or converged\nto a non-solution of the likelihood equations.\nUse exitInfo() for numerical details of last iteration.\n\nRC2 &lt;- freq_tab_2.3B |&gt;\n  gnm(\n    Freq ~ Educ + Occ + instances(Mult(1, Educ, Occ), 2),\n    #      start = c(coef(O), NA, mult2[,1], NA, mult2[,2]),\n    family = poisson,\n    data = _,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.....................................\nDone\n\nRC2\n\n\nCall:\ngnm(formula = Freq ~ Educ + Occ + instances(Mult(1, Educ, Occ), \n    2), family = poisson, data = freq_tab_2.3B, tolerance = 1e-12)\n\nCoefficients:\n                    (Intercept)                            Educ2  \n                        4.90354                         -0.75950  \n                          Educ3                            Educ4  \n                        1.50187                          0.18447  \n                           Occ2                             Occ3  \n                        0.01502                         -2.22224  \n                           Occ4                             Occ5  \n                        0.10667                         -3.38853  \n  Mult(., Educ, Occ, inst = 1).  Mult(1, ., Occ, inst = 1).Educ1  \n                        1.54189                          1.35778  \nMult(1, ., Occ, inst = 1).Educ2  Mult(1, ., Occ, inst = 1).Educ3  \n                        0.27886                         -0.20567  \nMult(1, ., Occ, inst = 1).Educ4  Mult(1, Educ, ., inst = 1).Occ1  \n                       -0.89120                          0.67274  \nMult(1, Educ, ., inst = 1).Occ2  Mult(1, Educ, ., inst = 1).Occ3  \n                       -0.31932                         -0.42628  \nMult(1, Educ, ., inst = 1).Occ4  Mult(1, Educ, ., inst = 1).Occ5  \n                       -0.59644                          0.51900  \n  Mult(., Educ, Occ, inst = 2).  Mult(1, ., Occ, inst = 2).Educ1  \n                        0.26953                         -5.13301  \nMult(1, ., Occ, inst = 2).Educ2  Mult(1, ., Occ, inst = 2).Educ3  \n                       -2.79039                         -6.48668  \nMult(1, ., Occ, inst = 2).Educ4  Mult(1, Educ, ., inst = 2).Occ1  \n                        8.06413                          0.04503  \nMult(1, Educ, ., inst = 2).Occ2  Mult(1, Educ, ., inst = 2).Occ3  \n                       -0.22275                          0.06955  \nMult(1, Educ, ., inst = 2).Occ4  Mult(1, Educ, ., inst = 2).Occ5  \n                        0.14602                          0.69295  \n\nDeviance:            0.6001022 \nPearson chi-squared: 0.5746549 \nResidual df:         2 \n\nRC3 &lt;- freq_tab_2.3B |&gt;\n  gnm(\n    Freq ~ Educ + Occ + instances(Mult(1, Educ, Occ), 3),\n    start = c(coef(O), NA, mult3[, 1], NA, mult3[, 2], NA, mult3[, 3]),\n    family = poisson,\n    data = _,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations......\nDone\n\nRC3\n\n\nCall:\ngnm(formula = Freq ~ Educ + Occ + instances(Mult(1, Educ, Occ), \n    3), family = poisson, data = freq_tab_2.3B, start = c(coef(O), \n    NA, mult3[, 1], NA, mult3[, 2], NA, mult3[, 3]), tolerance = 1e-12)\n\nCoefficients:\n                    (Intercept)                            Educ2  \n                        4.95717                         -0.82096  \n                          Educ3                            Educ4  \n                        1.80233                          0.56088  \n                           Occ2                             Occ3  \n                       -0.01071                         -2.60229  \n                           Occ4                             Occ5  \n                       -0.03443                         -3.33220  \n  Mult(., Educ, Occ, inst = 1).  Mult(1, ., Occ, inst = 1).Educ1  \n                        0.07701                          4.49001  \nMult(1, ., Occ, inst = 1).Educ2  Mult(1, ., Occ, inst = 1).Educ3  \n                        0.73209                         -0.80675  \nMult(1, ., Occ, inst = 1).Educ4  Mult(1, Educ, ., inst = 1).Occ1  \n                       -3.27385                          4.25316  \nMult(1, Educ, ., inst = 1).Occ2  Mult(1, Educ, ., inst = 1).Occ3  \n                       -0.45231                         -1.88306  \nMult(1, Educ, ., inst = 1).Occ4  Mult(1, Educ, ., inst = 1).Occ5  \n                       -3.54657                          0.57475  \n  Mult(., Educ, Occ, inst = 2).  Mult(1, ., Occ, inst = 2).Educ1  \n                        0.03847                          0.71197  \nMult(1, ., Occ, inst = 2).Educ2  Mult(1, ., Occ, inst = 2).Educ3  \n                       -0.60272                         -2.69755  \nMult(1, ., Occ, inst = 2).Educ4  Mult(1, Educ, ., inst = 2).Occ1  \n                        2.85641                          0.42735  \nMult(1, Educ, ., inst = 2).Occ2  Mult(1, Educ, ., inst = 2).Occ3  \n                       -3.63366                          1.48249  \nMult(1, Educ, ., inst = 2).Occ4  Mult(1, Educ, ., inst = 2).Occ5  \n                        1.63057                          9.18646  \n  Mult(., Educ, Occ, inst = 3).  Mult(1, ., Occ, inst = 3).Educ1  \n                        0.18372                         -0.83753  \nMult(1, ., Occ, inst = 3).Educ2  Mult(1, ., Occ, inst = 3).Educ3  \n                        0.12534                         -1.49027  \nMult(1, ., Occ, inst = 3).Educ4  Mult(1, Educ, ., inst = 3).Occ1  \n                       -1.01651                          1.23176  \nMult(1, Educ, ., inst = 3).Occ2  Mult(1, Educ, ., inst = 3).Occ3  \n                        0.88823                         -0.30798  \nMult(1, Educ, ., inst = 3).Occ4  Mult(1, Educ, ., inst = 3).Occ5  \n                        1.20713                          3.02765  \n\nDeviance:            1.625367e-13 \nPearson chi-squared: 3.227351e-27 \nResidual df:         0 \n\nbind_rows(model.summary(O),\n          model.summary(RC),\n          model.summary(RC2),\n          model.summary(RC3))\n\n# A tibble: 4 × 6\n  `Model Description`    df       L2       BIC    Delta     p\n  &lt;chr&gt;               &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;\n1 O                      12 1.37e+ 3  1.27e+ 3 2.39e+ 1 1    \n2 RC                      6 1.66e+ 4  1.66e+ 4 3.12e+ 0 1    \n3 RC2                     2 6.00e- 1 -1.59e+ 1 9.35e- 2 0.259\n4 RC3                     0 1.63e-13  1.63e-13 3.67e-14 1    \n\nanoas_model &lt;- anoas(tab_2.3B, nd = 3)\n\nFitting independence model...\nFitting model with 1 dimension...\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n...\nDone\nFitting model with 2 dimensions...\nInitialising\nRunning start-up iterations..\nRunning main iterations........\nDone\nFitting model with 3 dimensions...\nInitialising\nRunning start-up iterations..\nRunning main iterations......\nDone\n\nanoas_model\n\n       Res. Df           Res. Dev     Dev./Indep. (%)   Dissim. (%)\nIndep.      12 1373.1757656522454 100.000000000000000 23.8615752953\nRC(1)        6  125.0597485501469   9.107337289101130  6.4360390978\nRC(2)        2    0.6001022352683   0.043701778772891  0.0935165802\nRC(3)        0   -0.0000000000001  -0.000000000000008  0.0000000005\n                      BIC                AIC    Dev. Df\nIndep. 1274.0809153306573 1349.1757656522454      NA NA\nRC(1)    75.5123233893528  113.0597485501469 -1248.1 -6\nRC(2)   -15.9157061516631   -3.3998977647317  -124.5 -4\nRC(3)    -0.0000000000001   -0.0000000000001    -0.6 -2"
  },
  {
    "objectID": "9-Note.html#位相モデル",
    "href": "9-Note.html#位相モデル",
    "title": "補足のノート",
    "section": "位相モデル",
    "text": "位相モデル\n\noccupationalStatus\n\n      destination\norigin   1   2   3   4   5   6   7   8\n     1  50  19  26   8   7  11   6   2\n     2  16  40  34  18  11  20   8   3\n     3  12  35  65  66  35  88  23  21\n     4  11  20  58 110  40 183  64  32\n     5   2   8  12  23  25  46  28  12\n     6  12  28 102 162  90 554 230 177\n     7   0   6  19  40  21 158 143  71\n     8   0   3  14  32  15 126  91 106\n\nfreq_occupationalStatus &lt;- data.frame(occupationalStatus)\nfreq_occupationalStatus &lt;- freq_occupationalStatus |&gt; \n  mutate(\n    diag = ifelse(origin == destination, origin, 0) |&gt; factor(),\n    Rscore = scale(as.numeric(origin), scale = FALSE),\n    Cscore = scale(as.numeric(destination), scale = FALSE)\n  )\n\nfit_O &lt;-\n  gnm(Freq ~ origin + destination, family = poisson, data = freq_occupationalStatus)\nfit_QI &lt;-\n  gnm(Freq ~ origin + destination + diag,\n      family = poisson,\n      data = freq_occupationalStatus)\nfit_U &lt;-\n  gnm(Freq ~ origin + destination + Rscore:Cscore,\n      family = poisson,\n      data = freq_occupationalStatus)\nfit_QI_U &lt;-\n  gnm(Freq ~ origin + destination + diag + Rscore:Cscore,\n      family = poisson,\n      data = freq_occupationalStatus)\nfit_S &lt;-\n  gnm(Freq ~ origin + destination + origin:destination,\n      family = poisson,\n      data = freq_occupationalStatus)\n\nfreq_occupationalStatus &lt;- freq_occupationalStatus |&gt; \n  mutate(\n    diag1 = ifelse(origin == 1 &\n                     origin == destination, 1, 0) |&gt; factor(),\n    diag2 = ifelse(origin == 2 &\n                     origin == destination, 1, 0) |&gt; factor(),\n    diag3 = ifelse(origin == 3 &\n                     origin == destination, 1, 0) |&gt; factor(),\n    diag4 = ifelse(origin == 4 &\n                     origin == destination, 1, 0) |&gt; factor(),\n    diag5 = ifelse(origin == 5 &\n                     origin == destination, 1, 0) |&gt; factor(),\n    diag6 = ifelse(origin == 6 &\n                     origin == destination, 1, 0) |&gt; factor(),\n    diag7 = ifelse(origin == 7 &\n                     origin == destination, 1, 0) |&gt; factor(),\n    diag8 = ifelse(origin == 8 &\n                     origin == destination, 1, 0) |&gt; factor()\n  )\n\nfit_QI2 &lt;-\n  gnm(\n    Freq ~ origin + destination + diag1 + diag2 + diag3 + diag4 + diag5 + diag6 + diag7 + diag8,\n    family = poisson,\n    data = freq_occupationalStatus\n  )\n\nsummary(fit_QI)\n\n\nCall:\ngnm(formula = Freq ~ origin + destination + diag, family = poisson, \n    data = freq_occupationalStatus)\n\nDeviance Residuals: \n       Min          1Q      Median          3Q         Max  \n-4.567e+00  -2.318e+00  -1.045e-07   1.018e+00   6.152e+00  \n\nCoefficients:\n             Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)   0.36346    0.17892   2.031 0.042211 *  \norigin2       0.35445    0.14755   2.402 0.016292 *  \norigin3       1.34923    0.12758  10.575  &lt; 2e-16 ***\norigin4       1.76957    0.12322  14.362  &lt; 2e-16 ***\norigin5       0.56615    0.14257   3.971 7.16e-05 ***\norigin6       2.72612    0.11933  22.845  &lt; 2e-16 ***\norigin7       1.54999    0.12619  12.283  &lt; 2e-16 ***\norigin8       1.37488    0.12757  10.777  &lt; 2e-16 ***\ndestination2  0.82044    0.16521   4.966 6.83e-07 ***\ndestination3  1.69007    0.15065  11.219  &lt; 2e-16 ***\ndestination4  2.02648    0.14771  13.719  &lt; 2e-16 ***\ndestination5  1.43966    0.15317   9.399  &lt; 2e-16 ***\ndestination6  2.96856    0.14439  20.559  &lt; 2e-16 ***\ndestination7  2.24512    0.14547  15.434  &lt; 2e-16 ***\ndestination8  1.87534    0.14855  12.624  &lt; 2e-16 ***\ndiag1         3.54857    0.22806  15.560  &lt; 2e-16 ***\ndiag2         2.15053    0.20737  10.370  &lt; 2e-16 ***\ndiag3         0.77163    0.15275   5.052 4.38e-07 ***\ndiag4         0.54098    0.12287   4.403 1.07e-05 ***\ndiag5         0.84961    0.22965   3.700 0.000216 ***\ndiag6         0.25903    0.07531   3.439 0.000583 ***\ndiag7         0.80428    0.11438   7.031 2.04e-12 ***\ndiag8         1.04976    0.12946   8.109  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nResidual deviance: 446.84 on 41 degrees of freedom\nAIC: 815.18\n\nNumber of iterations: 5\n\nsummary(fit_QI2)\n\n\nCall:\ngnm(formula = Freq ~ origin + destination + diag1 + diag2 + diag3 + \n    diag4 + diag5 + diag6 + diag7 + diag8, family = poisson, \n    data = freq_occupationalStatus)\n\nDeviance Residuals: \n       Min          1Q      Median          3Q         Max  \n-4.567e+00  -2.318e+00  -1.045e-07   1.018e+00   6.152e+00  \n\nCoefficients:\n             Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)   0.36346    0.17892   2.031 0.042211 *  \norigin2       0.35445    0.14755   2.402 0.016292 *  \norigin3       1.34923    0.12758  10.575  &lt; 2e-16 ***\norigin4       1.76957    0.12322  14.362  &lt; 2e-16 ***\norigin5       0.56615    0.14257   3.971 7.16e-05 ***\norigin6       2.72612    0.11933  22.845  &lt; 2e-16 ***\norigin7       1.54999    0.12619  12.283  &lt; 2e-16 ***\norigin8       1.37488    0.12757  10.777  &lt; 2e-16 ***\ndestination2  0.82044    0.16521   4.966 6.83e-07 ***\ndestination3  1.69007    0.15065  11.219  &lt; 2e-16 ***\ndestination4  2.02648    0.14771  13.719  &lt; 2e-16 ***\ndestination5  1.43966    0.15317   9.399  &lt; 2e-16 ***\ndestination6  2.96856    0.14439  20.559  &lt; 2e-16 ***\ndestination7  2.24512    0.14547  15.434  &lt; 2e-16 ***\ndestination8  1.87534    0.14855  12.624  &lt; 2e-16 ***\ndiag11        3.54857    0.22806  15.560  &lt; 2e-16 ***\ndiag21        2.15053    0.20737  10.370  &lt; 2e-16 ***\ndiag31        0.77163    0.15275   5.052 4.38e-07 ***\ndiag41        0.54098    0.12287   4.403 1.07e-05 ***\ndiag51        0.84961    0.22965   3.700 0.000216 ***\ndiag61        0.25903    0.07531   3.439 0.000583 ***\ndiag71        0.80428    0.11438   7.031 2.04e-12 ***\ndiag81        1.04976    0.12946   8.109  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nResidual deviance: 446.84 on 41 degrees of freedom\nAIC: 815.18\n\nNumber of iterations: 5\n\nanova(fit_O, fit_QI, fit_U, fit_QI_U, fit_S)\n\nAnalysis of Deviance Table\n\nModel 1: Freq ~ origin + destination\nModel 2: Freq ~ origin + destination + diag\nModel 3: Freq ~ origin + destination + Rscore:Cscore\nModel 4: Freq ~ origin + destination + diag + Rscore:Cscore\nModel 5: Freq ~ origin + destination + origin:destination\n  Resid. Df Resid. Dev Df Deviance\n1        49     954.49            \n2        41     446.84  8   507.65\n3        48     164.33 -7   282.51\n4        40      58.44  8   105.89\n5         0       0.00 40    58.44\n\nbind_rows(\n  model.summary(fit_O),\n  model.summary(fit_QI),\n  model.summary(fit_U),\n  model.summary(fit_QI_U),\n  model.summary(fit_S)\n)\n\n# A tibble: 5 × 6\n  `Model Description`    df      L2      BIC    Delta     p\n  &lt;chr&gt;               &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;\n1 fit_O                  49 9.54e+2  5.55e+2 1.66e+ 1 1    \n2 fit_QI                 41 4.47e+2  1.12e+2 1.00e+ 1 1    \n3 fit_U                  48 1.64e+2 -2.27e+2 7.26e+ 0 1.00 \n4 fit_QI_U               40 5.84e+1 -2.68e+2 3.53e+ 0 0.970\n5 fit_S                   0 4.50e-8  4.50e-8 3.22e-10 1    \n\n\n\ndata(erikson)\nerikson\n\n, , country = EW\n\n      destination\norigin    I   II  III  IVa  IVb  IVc V/VI VIIa VIIb\n  I     311  130   79   24   22    7   70   44    1\n  II    161  128   66   22   11    6  112   47    1\n  III   128  109   89   26   25    3  197  113    4\n  IVa    88   83   43   72   41    5  112   64    4\n  IVb    36   45   38   27   47    3  110   80    4\n  IVc    43   23   25   16   14   99   86   81   40\n  V/VI  356  375  325  108  140    5 1506  839   22\n  VIIa  150  180  187   48   74    9  802  685   15\n  VIIb   12   14   18    5   18   10   96  114   56\n\n, , country = F\n\n      destination\norigin    I   II  III  IVa  IVb  IVc V/VI VIIa VIIb\n  I     105   72   19    9    8    3   26   11    1\n  II     59  113   37    9   14    0   54   34    2\n  III    40   86   64   10   20    4  103   61    4\n  IVa    38   37   17   38   23    2   36   22    1\n  IVb    40   68   55   38   95   10   92   74    7\n  IVc    27   74   77   27   52  461  156  286   73\n  V/VI   36  138   93   22   38    5  339  189    9\n  VIIa   22   88   79   18   24    8  235  209   11\n  VIIb    4   18   26    9   14   19   68  107   47\n\n, , country = S\n\n      destination\norigin    I   II  III  IVa  IVb  IVc V/VI VIIa VIIb\n  I      52   15   13    3    2    0   11    7    0\n  II     30   27   14    3    4    0   27   12    2\n  III    10   19   10    2    4    0   16   11    1\n  IVa    26   24    5   20    8    1   33   22    0\n  IVb     8   13    6    3    9    4   31   20    1\n  IVc    24   47   44   17   22   92  132  144   21\n  V/VI   33   89   40   13   18    5  188  104    5\n  VIIa   32   49   28   14   17    5  159  109    4\n  VIIb    5   10    3    0    6    3   33   42    8\n\ndimnames(erikson)\n\n$origin\n[1] \"I\"    \"II\"   \"III\"  \"IVa\"  \"IVb\"  \"IVc\"  \"V/VI\" \"VIIa\" \"VIIb\"\n\n$destination\n[1] \"I\"    \"II\"   \"III\"  \"IVa\"  \"IVb\"  \"IVc\"  \"V/VI\" \"VIIa\" \"VIIb\"\n\n$country\n[1] \"EW\" \"F\"  \"S\" \n\ndimnames(erikson)$origin &lt;-\n  c(\"I+II\",\"I+II\",\"III\",\"IVab\",\"IVab\",\"IVc\",\"V/VI\",\"VIIa\",\"VIIb\")\ndimnames(erikson)$destination &lt;-\n  c(\"I+II\",\"I+II\",\"III\",\"IVab\",\"IVab\",\"IVc\",\"V/VI\",\"VIIa\",\"VIIb\")\nfreq_erikson &lt;- data.frame(erikson)\nerikson2 &lt;-\n  xtabs(Freq ~ origin + destination + country, data = freq_erikson)\nfreq_erikson &lt;- data.frame(erikson2)\n\nlevelMatrix &lt;- rep(c(2, 3, 4, 6, 5, 6, 6,\n                     3, 3, 4, 6, 4, 5, 6,\n                     4, 4, 2, 5, 5, 5, 5,\n                     6, 6, 5, 1, 6, 5, 2,\n                     4, 4, 5, 6, 3, 4, 5,\n                     5, 4, 5, 5, 3, 3, 5,\n                     6, 6, 5, 3, 5, 4, 1), times = 3) |&gt; as.factor()\nd &lt;- bind_cols(freq_erikson, levelMatrix = levelMatrix)\n\nfit_O &lt;-\n  gnm(\n    Freq ~ origin + destination + country + origin * country +\n      destination * country,\n    family = poisson,\n    data = d\n  )\n\n\nfit_Common &lt;- gnm(\n  Freq ~ origin + destination + country +\n    origin * country + destination * country +\n    origin * destination,\n  family = poisson,\n  data = d\n)\n\nfit_Common_Pattern &lt;- gnm(\n  Freq ~ origin + destination + country +\n    origin * country + destination * country + levelMatrix,\n  family = poisson,\n  data = d\n)\n\nd &lt;- d |&gt; \n  mutate(\n  pred1 = fit_O$fitted.values,\n  pred2 = fit_Common$fitted.values,\n  pred3 = fit_Common_Pattern$fitted.values\n)\n\nsummary(fit_O)\n\n\nCall:\ngnm(formula = Freq ~ origin + destination + country + origin * \n    country + destination * country, family = poisson, data = d)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-12.763   -3.562   -1.393    1.767   22.208  \n\nCoefficients:\n                         Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)               5.74389    0.03348 171.575  &lt; 2e-16 ***\noriginIII                -0.58201    0.04739 -12.281  &lt; 2e-16 ***\noriginIVab               -0.31986    0.04375  -7.312 2.64e-13 ***\noriginIVc                -1.06769    0.05610 -19.032  &lt; 2e-16 ***\noriginV/VI                1.08510    0.03282  33.062  &lt; 2e-16 ***\noriginVIIa                0.54874    0.03564  15.397  &lt; 2e-16 ***\noriginVIIb               -1.28675    0.06100 -21.095  &lt; 2e-16 ***\ndestinationIII           -1.00300    0.03964 -25.305  &lt; 2e-16 ***\ndestinationIVab          -1.16484    0.04211 -27.664  &lt; 2e-16 ***\ndestinationIVc           -2.78106    0.08498 -32.724  &lt; 2e-16 ***\ndestinationV/VI           0.26476    0.02730   9.699  &lt; 2e-16 ***\ndestinationVIIa          -0.13764    0.03009  -4.574 4.78e-06 ***\ndestinationVIIb          -2.78106    0.08500 -32.720  &lt; 2e-16 ***\ncountryF                 -0.88695    0.05988 -14.811  &lt; 2e-16 ***\ncountryS                 -1.74777    0.08424 -20.747  &lt; 2e-16 ***\noriginIII:countryF        0.19716    0.08083   2.439 0.014718 *  \noriginIVab:countryF       0.50479    0.07136   7.073 1.51e-12 ***\noriginIVc:countryF        1.82879    0.07546  24.235  &lt; 2e-16 ***\noriginV/VI:countryF      -0.67387    0.06296 -10.703  &lt; 2e-16 ***\noriginVIIa:countryF      -0.36238    0.06669  -5.434 5.51e-08 ***\noriginVIIb:countryF       0.67364    0.09307   7.238 4.55e-13 ***\noriginIII:countryS       -0.53021    0.14300  -3.708 0.000209 ***\noriginIVab:countryS       0.37251    0.10340   3.603 0.000315 ***\noriginIVc:countryS        1.96213    0.09743  20.138  &lt; 2e-16 ***\noriginV/VI:countryS      -0.28322    0.08719  -3.248 0.001161 ** \noriginVIIa:countryS       0.08166    0.09040   0.903 0.366354    \noriginVIIb:countryS       0.58455    0.13159   4.442 8.90e-06 ***\ndestinationIII:countryF   0.17859    0.06820   2.619 0.008827 ** \ndestinationIVab:countryF  0.34258    0.06963   4.920 8.66e-07 ***\ndestinationIVc:countryF   2.04865    0.10057  20.370  &lt; 2e-16 ***\ndestinationV/VI:countryF -0.22428    0.05085  -4.411 1.03e-05 ***\ndestinationVIIa:countryF  0.06764    0.05340   1.267 0.205290    \ndestinationVIIb:countryF  0.85375    0.12089   7.062 1.64e-12 ***\ndestinationIII:countryS  -0.14353    0.09826  -1.461 0.144099    \ndestinationIVab:countryS  0.03051    0.09891   0.308 0.757741    \ndestinationIVc:countryS   1.24126    0.13514   9.185  &lt; 2e-16 ***\ndestinationV/VI:countryS -0.05932    0.06543  -0.907 0.364667    \ndestinationVIIa:countryS  0.05222    0.07055   0.740 0.459234    \ndestinationVIIb:countryS  0.27845    0.18161   1.533 0.125225    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nResidual deviance: 4860 on 108 degrees of freedom\nAIC: 5752.1\n\nNumber of iterations: 6\n\nnames(fit_Common)\n\n [1] \"call\"          \"formula\"       \"terms\"         \"data\"         \n [5] \"eliminate\"     \"ofInterest\"    \"na.action\"     \"xlevels\"      \n [9] \"offset\"        \"tolerance\"     \"iterStart\"     \"iterMax\"      \n[13] \"coefficients\"  \"residuals\"     \"fitted.values\" \"rank\"         \n[17] \"family\"        \"predictors\"    \"deviance\"      \"aic\"          \n[21] \"iter\"          \"weights\"       \"prior.weights\" \"df.residual\"  \n[25] \"y\"             \"converged\"     \"constrain\"     \"constrainTo\"  \n[29] \"x\"             \"model\"        \n\nnames(summary(fit_Common))\n\n [1] \"call\"           \"ofInterest\"     \"family\"         \"deviance\"      \n [5] \"aic\"            \"df.residual\"    \"iter\"           \"deviance.resid\"\n [9] \"coefficients\"   \"eliminated\"     \"dispersion\"     \"df\"            \n[13] \"cov.scaled\"    \n\nsummary(fit_Common)\n\n\nCall:\ngnm(formula = Freq ~ origin + destination + country + origin * \n    country + destination * country + origin * destination, family = poisson, \n    data = d)\n\nDeviance Residuals: \n      Min         1Q     Median         3Q        Max  \n-2.894368  -0.493141  -0.001321   0.470201   2.903940  \n\nCoefficients:\n                           Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)                 6.59629    0.03453 191.003  &lt; 2e-16 ***\noriginIII                  -1.13823    0.06560 -17.351  &lt; 2e-16 ***\noriginIVab                 -1.07370    0.06143 -17.479  &lt; 2e-16 ***\noriginIVc                  -2.70361    0.09016 -29.987  &lt; 2e-16 ***\noriginV/VI                  0.01007    0.04703   0.214 0.830527    \noriginVIIa                 -0.77338    0.05726 -13.507  &lt; 2e-16 ***\noriginVIIb                 -3.26650    0.13781 -23.702  &lt; 2e-16 ***\ndestinationIII             -1.69227    0.07692 -22.001  &lt; 2e-16 ***\ndestinationIVab            -2.25353    0.09612 -23.445  &lt; 2e-16 ***\ndestinationIVc             -4.55452    0.25826 -17.635  &lt; 2e-16 ***\ndestinationV/VI            -1.34800    0.06703 -20.112  &lt; 2e-16 ***\ndestinationVIIa            -2.03630    0.08773 -23.212  &lt; 2e-16 ***\ndestinationVIIb            -5.12499    0.38197 -13.417  &lt; 2e-16 ***\ncountryF                   -0.79371    0.05423 -14.637  &lt; 2e-16 ***\ncountryS                   -1.65837    0.07661 -21.646  &lt; 2e-16 ***\noriginIII:countryF          0.20390    0.08179   2.493 0.012668 *  \noriginIVab:countryF         0.48071    0.07350   6.540 6.15e-11 ***\noriginIVc:countryF          1.61954    0.08393  19.295  &lt; 2e-16 ***\noriginV/VI:countryF        -0.64330    0.06586  -9.767  &lt; 2e-16 ***\noriginVIIa:countryF        -0.33935    0.07019  -4.835 1.33e-06 ***\noriginVIIb:countryF         0.64616    0.09861   6.553 5.65e-11 ***\noriginIII:countryS         -0.49402    0.14390  -3.433 0.000597 ***\noriginIVab:countryS         0.42215    0.10589   3.987 6.70e-05 ***\noriginIVc:countryS          2.10894    0.10644  19.814  &lt; 2e-16 ***\noriginV/VI:countryS        -0.23466    0.09102  -2.578 0.009934 ** \noriginVIIa:countryS         0.14235    0.09505   1.498 0.134221    \noriginVIIb:countryS         0.72346    0.13754   5.260 1.44e-07 ***\ndestinationIII:countryF     0.17483    0.07130   2.452 0.014209 *  \ndestinationIVab:countryF    0.18250    0.07402   2.465 0.013684 *  \ndestinationIVc:countryF     0.73972    0.11572   6.392 1.64e-10 ***\ndestinationV/VI:countryF   -0.11294    0.05496  -2.055 0.039884 *  \ndestinationVIIa:countryF    0.02129    0.05885   0.362 0.717449    \ndestinationVIIb:countryF    0.11636    0.13452   0.865 0.387023    \ndestinationIII:countryS    -0.22236    0.10142  -2.192 0.028352 *  \ndestinationIVab:countryS   -0.17172    0.10342  -1.660 0.096839 .  \ndestinationIVc:countryS    -0.38697    0.15155  -2.553 0.010668 *  \ndestinationV/VI:countryS   -0.09561    0.07021  -1.362 0.173263    \ndestinationVIIa:countryS   -0.17583    0.07672  -2.292 0.021913 *  \ndestinationVIIb:countryS   -0.64986    0.19498  -3.333 0.000859 ***\noriginIII:destinationIII    0.76642    0.11807   6.491 8.52e-11 ***\noriginIVab:destinationIII   0.52595    0.11560   4.550 5.37e-06 ***\noriginIVc:destinationIII    1.17849    0.13041   9.037  &lt; 2e-16 ***\noriginV/VI:destinationIII   0.87374    0.09195   9.502  &lt; 2e-16 ***\noriginVIIa:destinationIII   1.10866    0.10285  10.779  &lt; 2e-16 ***\noriginVIIb:destinationIII   1.36163    0.20619   6.604 4.01e-11 ***\noriginIII:destinationIVab   0.69419    0.15016   4.623 3.78e-06 ***\noriginIVab:destinationIVab  2.02108    0.11352  17.804  &lt; 2e-16 ***\noriginIVc:destinationIVab   1.73618    0.14216  12.213  &lt; 2e-16 ***\noriginV/VI:destinationIVab  1.12813    0.11169  10.101  &lt; 2e-16 ***\noriginVIIa:destinationIVab  1.25162    0.12471  10.036  &lt; 2e-16 ***\noriginVIIb:destinationIVab  2.01369    0.20909   9.631  &lt; 2e-16 ***\noriginIII:destinationIVc    0.23560    0.45713   0.515 0.606273    \noriginIVab:destinationIVc   1.24669    0.32500   3.836 0.000125 ***\noriginIVc:destinationIVc    5.21749    0.26575  19.633  &lt; 2e-16 ***\noriginV/VI:destinationIVc   0.18607    0.36231   0.514 0.607553    \noriginVIIa:destinationIVc   1.22166    0.33304   3.668 0.000244 ***\noriginVIIb:destinationIVc   3.56730    0.33324  10.705  &lt; 2e-16 ***\noriginIII:destinationV/VI   1.17516    0.09949  11.812  &lt; 2e-16 ***\noriginIVab:destinationV/VI  1.20044    0.09270  12.950  &lt; 2e-16 ***\noriginIVc:destinationV/VI   1.88309    0.10710  17.582  &lt; 2e-16 ***\noriginV/VI:destinationV/VI  2.05945    0.07524  27.372  &lt; 2e-16 ***\noriginVIIa:destinationV/VI  2.21492    0.08327  26.601  &lt; 2e-16 ***\noriginVIIb:destinationV/VI  2.54647    0.15871  16.045  &lt; 2e-16 ***\noriginIII:destinationVIIa   1.28947    0.12352  10.440  &lt; 2e-16 ***\noriginIVab:destinationVIIa  1.46717    0.11334  12.944  &lt; 2e-16 ***\noriginIVc:destinationVIIa   2.84331    0.11806  24.084  &lt; 2e-16 ***\noriginV/VI:destinationVIIa  2.14755    0.09583  22.410  &lt; 2e-16 ***\noriginVIIa:destinationVIIa  2.70994    0.10109  26.807  &lt; 2e-16 ***\noriginVIIb:destinationVIIa  3.48535    0.16446  21.193  &lt; 2e-16 ***\noriginIII:destinationVIIb   1.34327    0.50723   2.648 0.008091 ** \noriginIVab:destinationVIIb  1.75599    0.45232   3.882 0.000104 ***\noriginIVc:destinationVIIb   4.65198    0.39743  11.705  &lt; 2e-16 ***\noriginV/VI:destinationVIIb  1.80532    0.41541   4.346 1.39e-05 ***\noriginVIIa:destinationVIIb  2.31365    0.42297   5.470 4.50e-08 ***\noriginVIIb:destinationVIIb  5.72803    0.41103  13.936  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nResidual deviance: 121.3 on 72 degrees of freedom\nAIC: 1085.4\n\nNumber of iterations: 4\n\nanova(fit_O, fit_Common_Pattern, fit_Common)\n\nAnalysis of Deviance Table\n\nModel 1: Freq ~ origin + destination + country + origin:country + destination:country\nModel 2: Freq ~ origin + destination + country + origin:country + destination:country + \n    levelMatrix\nModel 3: Freq ~ origin + destination + country + origin:country + destination:country + \n    origin:destination\n  Resid. Df Resid. Dev Df Deviance\n1       108     4860.0            \n2       103      505.6  5   4354.4\n3        72      121.3 31    384.3"
  },
  {
    "objectID": "9-Note.html#連関モデルと正準相関分析",
    "href": "9-Note.html#連関モデルと正準相関分析",
    "title": "補足のノート",
    "section": "連関モデルと正準相関分析",
    "text": "連関モデルと正準相関分析\nGoodman (1981) のTable 1のaより．\n\nlibrary(tidyverse)\nlibrary(gnm)\nFreq &lt;- c(5, 3, 10, 11, 4, 5, 8, 6, 26, 11, 3, 6, 23, 11, 1, 2)\nRow &lt;- gl(n = 4, k = 4)\nCol &lt;- gl(n = 4, k = 1, length = 16)\nd &lt;- tibble(Freq, Row, Col) |&gt; \n    mutate(U = as.numeric(Row),\n         V = as.numeric(Col))\nxtabs(Freq ~ Row + Col, data = d)\n\n   Col\nRow  1  2  3  4\n  1  5  3 10 11\n  2  4  5  8  6\n  3 26 11  3  6\n  4 23 11  1  2\n\n\n\n# (1) O\nO &lt;- d |&gt; \n  gnm(Freq ~ Row + Col,\n      family = poisson,\n      data = _)\n# (2) U\nU &lt;- d |&gt; \n  gnm(Freq ~ Row + Col + U:V,\n      family = poisson,\n      data = _)\n# (3) R\nR &lt;- d |&gt; \n  gnm(Freq ~ Row + Col + Row:V,\n      family = poisson,\n      data = _)\n# (4) C\nC &lt;- d |&gt; \n  gnm(Freq ~ Row + Col + Col:U,\n      family = poisson,\n      data = _)\n# (5) RC\nRC &lt;- d |&gt; \n  gnm(Freq ~ Row + Col + Mult(1, Row, Col),\n      family = poisson,\n      data = _)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations........\nDone\n\n# (6) U + RC\nUplusRC &lt;- d |&gt; \n    gnm(Freq ~ Row + Col + U:V + Mult(1, Row, Col),\n      family = poisson,\n      data = _)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations..............\nDone\n\n# (7) R + RC\nRplusRC &lt;- d |&gt; \n    gnm(Freq ~ Row + Col + Row:V + Mult(1, Row, Col),\n      family = poisson,\n      data = _)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...............\nDone\n\n# (8) C + RC\nCplusRC &lt;- d |&gt; \n    gnm(Freq ~ Row + Col + Col:U + Mult(1, Row, Col),\n      family = poisson,\n      data = _)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations....\nDone\n\n# (9) R + C + RC\nRplusCplusRC &lt;- d |&gt; \n    gnm(Freq ~ Row + Col + Row:V + Col:U + Mult(1, Row, Col),\n      family = poisson,\n      data = _)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations..\nDone\n\n# (10) R + C\nRplusC &lt;- d |&gt; \n    gnm(Freq ~ Row + Col + Row:V + Col:U,\n      family = poisson,\n      data = _)\n\nlist(O, U, R, C, RC, UplusRC, RplusRC, CplusRC, RplusCplusRC, RplusC) |&gt; \n  map_dfr(glance, id = \"Model\")\n\n# A tibble: 10 × 8\n   null.deviance df.null logLik   AIC   BIC    deviance df.residual  nobs\n           &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n 1            NA      NA  -53.0 120.  125.  46.9                  9    16\n 2            NA      NA  -35.5  86.9  93.1 11.9                  8    16\n 3            NA      NA  -34.5  88.9  96.7  9.88                 6    16\n 4            NA      NA  -31.7  83.4  91.1  4.35                 6    16\n 5            NA      NA  -30.4  84.8  94.1  1.74                 4    16\n 6            NA      NA  -30.3  86.7  96.7  1.60                 3    16\n 7            NA      NA  -30.3  88.6  99.4  1.49                 2    16\n 8            NA      NA  -29.5  87.1  97.9  0.00771              2    16\n 9            NA      NA  -29.5  89.1 101.   0.00000129           1    16\n10            NA      NA  -30.9  85.9  95.2  2.81                 4    16\n\n\n\nfit &lt;-\n  gnm(Freq ~ Row + Col + Mult(1, Row, Col),\n      family = poisson,\n      data = d)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations........\nDone\n\nsummary(fit)\n\n\nCall:\ngnm(formula = Freq ~ Row + Col + Mult(1, Row, Col), family = poisson, \n    data = d)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-0.51267  -0.25916  -0.03574   0.25369   0.66120  \n\nCoefficients:\n                     Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)            2.2607         NA      NA       NA\nRow2                  -0.1177         NA      NA       NA\nRow3                   0.6089         NA      NA       NA\nRow4                   0.1565         NA      NA       NA\nCol2                  -0.5289         NA      NA       NA\nCol3                  -1.1438         NA      NA       NA\nCol4                  -0.7842         NA      NA       NA\nMult(., Row, Col).   -10.0887         NA      NA       NA\nMult(1, ., Col).Row1   0.4145         NA      NA       NA\nMult(1, ., Col).Row2   0.3209         NA      NA       NA\nMult(1, ., Col).Row3  -0.1926         NA      NA       NA\nMult(1, ., Col).Row4  -0.4234         NA      NA       NA\nMult(1, Row, .).Col1   0.1759         NA      NA       NA\nMult(1, Row, .).Col2   0.0975         NA      NA       NA\nMult(1, Row, .).Col3  -0.2997         NA      NA       NA\nMult(1, Row, .).Col4  -0.1962         NA      NA       NA\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 1.7442 on 4 degrees of freedom\nAIC: 84.814\n\nNumber of iterations: 8\n\nrowProbs &lt;- with(d, tapply(Freq, Row, sum) / sum(Freq))\ncolProbs &lt;- with(d, tapply(Freq, Col, sum) / sum(Freq))\nmu &lt;- getContrasts(\n  fit,\n  pickCoef(fit, \"[.]Row\"),\n  ref = rowProbs,\n  scaleRef = rowProbs,\n  scaleWeights = rowProbs\n)\nnu &lt;- getContrasts(\n  fit,\n  pickCoef(fit, \"[.]Col\"),\n  ref = colProbs,\n  scaleRef = colProbs,\n  scaleWeights = colProbs\n)\nfit &lt;-\n  gnm(\n    Freq ~ Row + Col + Mult(1, Row, Col),\n    family = poisson,\n    data = d,\n    constrain = 9:16,\n    constrainTo = c(mu$qvframe[, 1], -1 * nu$qvframe[, 1])\n  )\n\nInitialising\nRunning main iterations\nDone\n\nmu_score &lt;- rep(mu$qvframe[, 1], each = 4)\nnu_score &lt;- rep(nu$qvframe[, 1], 4)\nd &lt;- d |&gt;  mutate(mu = mu_score,\n              nu = nu_score)\n\n# Canonical correlation\nlibrary(wCorr)\n\nwCorr v1.9.8\n\nwith(d, weightedCorr(mu, x = nu, weights = Freq, method = \"Pearson\"))\n\n[1] -0.5585432\n\nwith(d, weightedCorr(U, x = V, weights = Freq, method = \"Polychoric\"))\n\n[1] -0.5380634\n\nlibrary(polycor)\n\nlibrary(vcdExtra)\n\n\nAttaching package: 'vcdExtra'\n\n\nThe following object is masked from 'package:dplyr':\n\n    summarise\n\nd_ind &lt;- expand.dft(d, dreq = \"Freq\")\nd_ind\n\n# A tibble: 135 × 6\n     Row   Col     U     V    mu     nu\n   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;\n 1     1     1     1     1  1.34  0.851\n 2     1     1     1     1  1.34  0.851\n 3     1     1     1     1  1.34  0.851\n 4     1     1     1     1  1.34  0.851\n 5     1     1     1     1  1.34  0.851\n 6     1     2     1     2  1.34  0.444\n 7     1     2     1     2  1.34  0.444\n 8     1     2     1     2  1.34  0.444\n 9     1     3     1     3  1.34 -1.62 \n10     1     3     1     3  1.34 -1.62 \n# ℹ 125 more rows\n\nlibrary(DescTools)\nCorPolychor(d_ind$U, d_ind$V, ML = TRUE)\n\n[1] -0.5326198\n\n# \nsummary(fit)\n\n\nCall:\ngnm(formula = Freq ~ Row + Col + Mult(1, Row, Col), constrain = 9:16, \n    constrainTo = c(mu$qvframe[, 1], -1 * nu$qvframe[, 1]), family = poisson, \n    data = d)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-0.51267  -0.25916  -0.03574   0.25369   0.66120  \n\nCoefficients:\n                     Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)            2.2730     0.2679   8.484  &lt; 2e-16 ***\nRow2                  -0.1064     0.2823  -0.377 0.706328    \nRow3                   0.6827     0.2698   2.530 0.011397 *  \nRow4                   0.2584     0.2844   0.908 0.363656    \nCol2                  -0.5588     0.2278  -2.454 0.014141 *  \nCol3                  -1.3258     0.3082  -4.301 1.70e-05 ***\nCol4                  -0.9266     0.2677  -3.462 0.000536 ***\nMult(., Row, Col).     0.6577     0.1127   5.836 5.35e-09 ***\nMult(1, ., Col).Row1   1.3355         NA      NA       NA    \nMult(1, ., Col).Row2   1.0593         NA      NA       NA    \nMult(1, ., Col).Row3  -0.4565         NA      NA       NA    \nMult(1, ., Col).Row4  -1.1376         NA      NA       NA    \nMult(1, Row, .).Col1  -0.8514         NA      NA       NA    \nMult(1, Row, .).Col2  -0.4441         NA      NA       NA    \nMult(1, Row, .).Col3   1.6203         NA      NA       NA    \nMult(1, Row, .).Col4   1.0823         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 1.7442 on 8 degrees of freedom\nAIC: 76.814\n\nNumber of iterations: 0\n\nphi &lt;- fit$coefficients[\"Mult(., Row, Col).\"] |&gt; abs()\nrho &lt;- (-1 + sqrt(1 + 4 * phi ^ 2)) / (2 * phi)\neta &lt;- (2 * phi) ^ (-1)\ntau &lt;- (1 + eta ^ 2) ^ (1 / 2) - eta\nmu\n\n                       Estimate Std. Error\nMult(1, ., Col).Row1  1.3354657  0.1909635\nMult(1, ., Col).Row2  1.0592605  0.2590555\nMult(1, ., Col).Row3 -0.4564888  0.2467937\nMult(1, ., Col).Row4 -1.1376490  0.2191522\n\nnu\n\n                       Estimate Std. Error\nMult(1, Row, .).Col1  0.8513968  0.1194283\nMult(1, Row, .).Col2  0.4440776  0.2763713\nMult(1, Row, .).Col3 -1.6203060  0.2558555\nMult(1, Row, .).Col4 -1.0822644  0.2870932\n\nphi\n\nMult(., Row, Col). \n         0.6576831 \n\nrho\n\nMult(., Row, Col). \n         0.4959289 \n\ntau\n\nMult(., Row, Col). \n         0.4959289 \n\ndelta_mu &lt;- abs((-1.3354658 - 1.1376491) / (1 - 4))\ndelta_nu &lt;- abs((-0.8513968 - 1.0822644) / (1 - 4))\n# Adjusted\ntau * ((1 - delta_mu / 12) * (1 - delta_nu / 12)) ^ (-1 / 2)\n\nMult(., Row, Col). \n         0.5282781 \n\nlibrary(logmult)\ntab &lt;- matrix(Freq,\n              nrow = 4,\n              ncol = 4,\n              byrow = TRUE)\nrc2 &lt;- rc(tab,\n          nd = 1,\n          weighting = \"marginal\",\n          se = \"bootstrap\")\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...........\nDone\nComputing bootstrap standard errors...\n.\n\n\nWarning in jackboot(se, ncpus, nreplicates, tab, model, assoc1 =\ngetS3method(\"assoc\", : 3 model replicates failed and their results will be\nskipped. Standard errors will not be completely accurate. Consider raising the\nvalue of iterMax.\n\nsummary(rc2)\n\nCall:\nrc(tab = tab, nd = 1, weighting = \"marginal\", se = \"bootstrap\")\n\nDeviance Residuals:\n    Columns\nRows         A         B         C         D\n   A   0.18575  -0.40583  -0.21673   0.32921\n   B  -0.38647   0.66120   0.30497  -0.51267\n   C   0.23692  -0.44850  -0.07819   0.21153\n   D  -0.15877   0.30399   0.00672  -0.14657\n\nAssociation coefficients:\n               Normalized  Adjusted  Std. error   Pr(&gt;|z|)     \nDim1              0.65768        NA      0.2651  0.0130990  *  \nDim1:RowsA        1.33547   1.08303      0.2442  4.533e-08  ***\nDim1:RowsB        1.05926   0.85904      0.3106  0.0006477  ***\nDim1:RowsC       -0.45649  -0.37020      0.2656  0.0856311  .  \nDim1:RowsD       -1.13765  -0.92261      0.2738  3.243e-05  ***\nDim1:ColumnsA    -0.85140  -0.69046      0.1382  7.336e-10  ***\nDim1:ColumnsB    -0.44408  -0.36014      0.3170  0.1612772     \nDim1:ColumnsC     1.62031   1.31403      0.3335  1.186e-06  ***\nDim1:ColumnsD     1.08226   0.87769      0.3662  0.0031246  ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nNormalization weights: marginal\nDeviance:              1.744218\nPearson chi-squared:   1.760665\nDissimilarity index:   4.670712%\nResidual df:           4\nBIC:                   -17.87688\nAIC:                   -6.255782\n\nassoc(rc2)\n\n$phi\n          Dim1\n[1,] 0.6576832\n\n$row\n, , 1\n\n        Dim1\nA  1.3354659\nB  1.0592602\nC -0.4564886\nD -1.1376492\n\n\n$col\n, , 1\n\n        Dim1\nA -0.8513968\nB -0.4440776\nC  1.6203060\nD  1.0822643\n\n\n$diagonal\nnumeric(0)\n\n$weighting\n[1] \"marginal\"\n\n$row.weights\n  [,1]\nA   29\nB   23\nC   46\nD   37\n\n$col.weights\n  [,1]\nA   58\nB   30\nC   22\nD   25\n\n$vars\n[1] \"Rows\"    \"Columns\"\n\nattr(,\"class\")\n[1] \"assoc.rc\" \"assoc\"   \n\n\n\n\n\n\n\n\nGoodman, Leo A. 1981. “Association Models and Canonical Correlation in the Analysis of Cross-Classifications Having Ordered Categories.” Journal of the American Statistical Association 76 (374): 320–34. https://doi.org/10.1080/01621459.1981.10477651."
  },
  {
    "objectID": "10-R.html#rとrstudioのインストール",
    "href": "10-R.html#rとrstudioのインストール",
    "title": "RとRStudioのインストールと基本的な操作方法",
    "section": "RとRStudioのインストール",
    "text": "RとRStudioのインストール\n\nRのインストールは CRAN（The Comprehensive R Archive Network） から行います．\nRStudioのインストールは Posit から行います．\n\n「2: Install RStudio」を選択してRStudioをインストールしてください．"
  },
  {
    "objectID": "10-R.html#基本的な操作方法",
    "href": "10-R.html#基本的な操作方法",
    "title": "RとRStudioのインストールと基本的な操作方法",
    "section": "基本的な操作方法",
    "text": "基本的な操作方法"
  },
  {
    "objectID": "11-Replication.html#duncan-1979",
    "href": "11-Replication.html#duncan-1979",
    "title": "先行研究の再現",
    "section": "Duncan (1979)",
    "text": "Duncan (1979)\nDuncan (1979) の結果を再現する．まずはデータを作成する．\n\n# Data (p. 795)\nFreq_duncan_1979 &lt;- c(50, 19, 26, 8, 7, 11, 6, 2,\n                      16, 40, 34, 18, 11, 20, 8, 3,\n                      12, 35, 65, 66, 35, 88, 23, 21,\n                      11, 20, 58, 110, 40, 183, 64, 32,\n                      2, 8, 12, 23, 25, 46, 28, 12,\n                      12, 28, 102, 162, 90, 554, 230, 177,\n                      0, 6, 19, 40, 21, 158, 143, 71,\n                      0, 3, 14, 32, 15, 126, 91, 106\n                      )\n\nd_duncan &lt;- tibble(Freq = Freq_duncan_1979,\n                   O = gl(n = 8, k = 8, length = 8 * 8),\n                   D = gl(n = 8, k = 1, length = 8 * 8))\n\n# データの完成\nd_duncan\n\n# A tibble: 64 × 3\n    Freq O     D    \n   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;\n 1    50 1     1    \n 2    19 1     2    \n 3    26 1     3    \n 4     8 1     4    \n 5     7 1     5    \n 6    11 1     6    \n 7     6 1     7    \n 8     2 1     8    \n 9    16 2     1    \n10    40 2     2    \n# ℹ 54 more rows\n\n# Row and column scores\nd_duncan &lt;- d_duncan |&gt; \n  mutate(U = as.numeric(O),\n         V = as.numeric(D))\n\n# 確認\nd_duncan |&gt; count(O, U)\n\n# A tibble: 8 × 3\n  O         U     n\n  &lt;fct&gt; &lt;dbl&gt; &lt;int&gt;\n1 1         1     8\n2 2         2     8\n3 3         3     8\n4 4         4     8\n5 5         5     8\n6 6         6     8\n7 7         7     8\n8 8         8     8\n\nd_duncan |&gt; count(D, V)\n\n# A tibble: 8 × 3\n  D         V     n\n  &lt;fct&gt; &lt;dbl&gt; &lt;int&gt;\n1 1         1     8\n2 2         2     8\n3 3         3     8\n4 4         4     8\n5 5         5     8\n6 6         6     8\n7 7         7     8\n8 8         8     8\n\n# Diagonal parameters\nd_duncan &lt;- d_duncan |&gt; \n  mutate(Diag = case_when(U == V ~ U, \n                          .default = 0))\n# 確認\nd_duncan |&gt; xtabs(Diag ~ O + D, data = _)\n\n   D\nO   1 2 3 4 5 6 7 8\n  1 1 0 0 0 0 0 0 0\n  2 0 2 0 0 0 0 0 0\n  3 0 0 3 0 0 0 0 0\n  4 0 0 0 4 0 0 0 0\n  5 0 0 0 0 5 0 0 0\n  6 0 0 0 0 0 6 0 0\n  7 0 0 0 0 0 0 7 0\n  8 0 0 0 0 0 0 0 8\n\n# factorにする\nd_duncan &lt;- d_duncan |&gt; mutate(Diag = factor(Diag))\n\n# weight \nd_duncan &lt;- d_duncan |&gt; mutate(W = ifelse(Diag != 0, 0, 1))\n\n# weight変数がどのようになっているのかを確認\nd_duncan |&gt; xtabs(W ~ O + D, data = _)\n\n   D\nO   1 2 3 4 5 6 7 8\n  1 0 1 1 1 1 1 1 1\n  2 1 0 1 1 1 1 1 1\n  3 1 1 0 1 1 1 1 1\n  4 1 1 1 0 1 1 1 1\n  5 1 1 1 1 0 1 1 1\n  6 1 1 1 1 1 0 1 1\n  7 1 1 1 1 1 1 0 1\n  8 1 1 1 1 1 1 1 0\n\nd_duncan |&gt; uncount(weights = W) |&gt; \n  xtabs(Freq ~ O + D, data = _)\n\n   D\nO     1   2   3   4   5   6   7   8\n  1   0  19  26   8   7  11   6   2\n  2  16   0  34  18  11  20   8   3\n  3  12  35   0  66  35  88  23  21\n  4  11  20  58   0  40 183  64  32\n  5   2   8  12  23   0  46  28  12\n  6  12  28 102 162  90   0 230 177\n  7   0   6  19  40  21 158   0  71\n  8   0   3  14  32  15 126  91   0\n\n# データの完成\nd_duncan\n\n# A tibble: 64 × 7\n    Freq O     D         U     V Diag      W\n   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt;\n 1    50 1     1         1     1 1         0\n 2    19 1     2         1     2 0         1\n 3    26 1     3         1     3 0         1\n 4     8 1     4         1     4 0         1\n 5     7 1     5         1     5 0         1\n 6    11 1     6         1     6 0         1\n 7     6 1     7         1     7 0         1\n 8     2 1     8         1     8 0         1\n 9    16 2     1         2     1 0         1\n10    40 2     2         2     2 2         0\n# ℹ 54 more rows\n\n\nこのデータについてgnmを用いたモデルの推定を行う．glmでもよい．結果はsummaryでみることができるが，tidyやglanceでも確認でき，これらを使ったほうが表の整理やその後のggplotによる図の作成が簡単である．tidyはgnmをサポートの対象外としているが，glmとほぼ同じ構造なのではじめに警告がでるものの，結果は問題なく出力される．\n\n# (1) Independence\nfit_d_1 &lt;- d_duncan |&gt; \n  gnm(Freq ~ O + D, data = _, family = poisson)\nsummary(fit_d_1)\n\n\nCall:\ngnm(formula = Freq ~ O + D, family = poisson, data = d_duncan)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-5.9252  -3.6322  -0.7127   2.0150  12.8584  \n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  1.33460    0.13099  10.189  &lt; 2e-16 ***\nO2           0.15082    0.12007   1.256 0.209053    \nO3           0.98373    0.10319   9.533  &lt; 2e-16 ***\nO4           1.39016    0.09839  14.130  &lt; 2e-16 ***\nO5           0.19004    0.11899   1.597 0.110244    \nO6           2.35174    0.09213  25.527  &lt; 2e-16 ***\nO7           1.26706    0.09966  12.713  &lt; 2e-16 ***\nO8           1.09861    0.10165  10.808  &lt; 2e-16 ***\nD2           0.43417    0.12642   3.434 0.000594 ***\nD3           1.16436    0.11280  10.322  &lt; 2e-16 ***\nD4           1.49432    0.10896  13.714  &lt; 2e-16 ***\nD5           0.86244    0.11744   7.344 2.08e-13 ***\nD6           2.44361    0.10265  23.805  &lt; 2e-16 ***\nD7           1.75046    0.10668  16.409  &lt; 2e-16 ***\nD8           1.41500    0.10978  12.889  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nResidual deviance: 954.49 on 49 degrees of freedom\nAIC: 1306.8\n\nNumber of iterations: 5\n\ntidy(fit_d_1)\n\nWarning: The `tidy()` method for objects of class `gnm` is not maintained by the broom team, and is only supported through the `glm` tidier method. Please be cautious in interpreting and reporting broom output.\n\nThis warning is displayed once per session.\n\n\n# A tibble: 15 × 5\n   term        estimate std.error statistic   p.value\n   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;\n 1 (Intercept)    1.33     0.131      10.2  2.22e- 24\n 2 O2             0.151    0.120       1.26 2.09e-  1\n 3 O3             0.984    0.103       9.53 1.52e- 21\n 4 O4             1.39     0.0984     14.1  2.49e- 45\n 5 O5             0.190    0.119       1.60 1.10e-  1\n 6 O6             2.35     0.0921     25.5  9.84e-144\n 7 O7             1.27     0.0997     12.7  4.98e- 37\n 8 O8             1.10     0.102      10.8  3.17e- 27\n 9 D2             0.434    0.126       3.43 5.94e-  4\n10 D3             1.16     0.113      10.3  5.59e- 25\n11 D4             1.49     0.109      13.7  8.33e- 43\n12 D5             0.862    0.117       7.34 2.08e- 13\n13 D6             2.44     0.103      23.8  2.93e-125\n14 D7             1.75     0.107      16.4  1.65e- 60\n15 D8             1.42     0.110      12.9  5.18e- 38\n\nglance(fit_d_1)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -638. 1307. 1339.     954.          49    64\n\n# (2) Row effects\nfit_d_2 &lt;- d_duncan |&gt; \n  gnm(Freq ~ O + D + O:V, data = _, family = poisson)\nsummary(fit_d_2)\n\n\nCall:\ngnm(formula = Freq ~ O + D + O:V, family = poisson, data = d_duncan)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-3.1378  -1.0958  -0.3250   0.8183   3.3582  \n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  4.78811    0.19161  24.989  &lt; 2e-16 ***\nO2          -0.69056    0.25946  -2.662  0.00778 ** \nO3          -1.15391    0.24063  -4.795 1.62e-06 ***\nO4          -1.63391    0.24085  -6.784 1.17e-11 ***\nO5          -3.24022    0.33365  -9.711  &lt; 2e-16 ***\nO6          -1.89930    0.23156  -8.202  &lt; 2e-16 ***\nO7          -4.21681    0.30489 -13.831  &lt; 2e-16 ***\nO8          -5.13641    0.34152 -15.040  &lt; 2e-16 ***\nD2           1.24434    0.13842   8.989  &lt; 2e-16 ***\nD3           2.64279    0.15304  17.269  &lt; 2e-16 ***\nD4           3.51911    0.18143  19.396  &lt; 2e-16 ***\nD5           3.33853    0.21802  15.313  &lt; 2e-16 ***\nD6           5.29848    0.24258  21.842  &lt; 2e-16 ***\nD7           4.92699    0.27452  17.947  &lt; 2e-16 ***\nD8           4.86597    0.30300  16.059  &lt; 2e-16 ***\nO1:V        -1.32268    0.07546 -17.529  &lt; 2e-16 ***\nO2:V        -1.05277    0.06472 -16.267  &lt; 2e-16 ***\nO3:V        -0.73047    0.05137 -14.221  &lt; 2e-16 ***\nO4:V        -0.54801    0.04808 -11.397  &lt; 2e-16 ***\nO5:V        -0.47086    0.06225  -7.564 3.92e-14 ***\nO6:V        -0.32377    0.04351  -7.441 1.00e-13 ***\nO7:V        -0.11858    0.05167  -2.295  0.02175 *  \nO8:V         0.00000         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 130.08 on 42 degrees of freedom\nAIC: 496.42\n\nNumber of iterations: 4\n\ntidy(fit_d_2)\n\n# A tibble: 23 × 5\n   term        estimate std.error statistic   p.value\n   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;\n 1 (Intercept)    4.79      0.192     25.0  8.03e-138\n 2 O2            -0.691     0.259     -2.66 7.78e-  3\n 3 O3            -1.15      0.241     -4.80 1.62e-  6\n 4 O4            -1.63      0.241     -6.78 1.17e- 11\n 5 O5            -3.24      0.334     -9.71 2.69e- 22\n 6 O6            -1.90      0.232     -8.20 2.36e- 16\n 7 O7            -4.22      0.305    -13.8  1.67e- 43\n 8 O8            -5.14      0.342    -15.0  4.03e- 51\n 9 D2             1.24      0.138      8.99 2.49e- 19\n10 D3             2.64      0.153     17.3  8.10e- 67\n# ℹ 13 more rows\n\nglance(fit_d_2)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -226.  496.  544.     130.          42    64\n\n# (3) Quasi independence, diagonal omitted\nfit_d_3 &lt;- d_duncan |&gt; gnm(Freq ~ O + D, data = _, weights = W, family = poisson)\nsummary(fit_d_3)\n\n\nCall:\ngnm(formula = Freq ~ O + D, family = poisson, data = d_duncan, \n    weights = W)\n\nDeviance Residuals: \n   Min      1Q  Median      3Q     Max  \n-4.567  -2.318   0.000   1.018   6.152  \n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)   0.3635     0.1789   2.031   0.0422 *  \nO2            0.3545     0.1475   2.402   0.0163 *  \nO3            1.3492     0.1276  10.575  &lt; 2e-16 ***\nO4            1.7696     0.1232  14.362  &lt; 2e-16 ***\nO5            0.5661     0.1426   3.971 7.16e-05 ***\nO6            2.7261     0.1193  22.845  &lt; 2e-16 ***\nO7            1.5500     0.1262  12.283  &lt; 2e-16 ***\nO8            1.3749     0.1276  10.777  &lt; 2e-16 ***\nD2            0.8204     0.1652   4.966 6.83e-07 ***\nD3            1.6901     0.1506  11.219  &lt; 2e-16 ***\nD4            2.0265     0.1477  13.719  &lt; 2e-16 ***\nD5            1.4397     0.1532   9.399  &lt; 2e-16 ***\nD6            2.9686     0.1444  20.559  &lt; 2e-16 ***\nD7            2.2451     0.1455  15.434  &lt; 2e-16 ***\nD8            1.8753     0.1486  12.624  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nResidual deviance: 446.84 on 41 degrees of freedom\nAIC: 748.82\n\nNumber of iterations: 5\n\ntidy(fit_d_3)\n\n# A tibble: 15 × 5\n   term        estimate std.error statistic   p.value\n   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;\n 1 (Intercept)    0.363     0.179      2.03 4.22e-  2\n 2 O2             0.354     0.148      2.40 1.63e-  2\n 3 O3             1.35      0.128     10.6  3.88e- 26\n 4 O4             1.77      0.123     14.4  9.01e- 47\n 5 O5             0.566     0.143      3.97 7.16e-  5\n 6 O6             2.73      0.119     22.8  1.65e-115\n 7 O7             1.55      0.126     12.3  1.12e- 34\n 8 O8             1.37      0.128     10.8  4.42e- 27\n 9 D2             0.820     0.165      4.97 6.83e-  7\n10 D3             1.69      0.151     11.2  3.30e- 29\n11 D4             2.03      0.148     13.7  7.82e- 43\n12 D5             1.44      0.153      9.40 5.50e- 21\n13 D6             2.97      0.144     20.6  6.33e- 94\n14 D7             2.25      0.145     15.4  9.66e- 54\n15 D8             1.88      0.149     12.6  1.56e- 36\n\nglance(fit_d_3)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -359.  749.  781.     447.          41    56\n\n# (3) Quasi independence, diagonal fitted\nfit_d_3b &lt;- d_duncan |&gt; gnm(Freq ~ O + D + Diag, data = _, family = poisson)\nsummary(fit_d_3b)\n\n\nCall:\ngnm(formula = Freq ~ O + D + Diag, family = poisson, data = d_duncan)\n\nDeviance Residuals: \n   Min      1Q  Median      3Q     Max  \n-4.567  -2.318   0.000   1.018   6.152  \n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  0.36346    0.17892   2.031 0.042211 *  \nO2           0.35445    0.14755   2.402 0.016292 *  \nO3           1.34923    0.12758  10.575  &lt; 2e-16 ***\nO4           1.76957    0.12322  14.362  &lt; 2e-16 ***\nO5           0.56615    0.14257   3.971 7.16e-05 ***\nO6           2.72612    0.11933  22.845  &lt; 2e-16 ***\nO7           1.54999    0.12619  12.283  &lt; 2e-16 ***\nO8           1.37488    0.12757  10.777  &lt; 2e-16 ***\nD2           0.82044    0.16521   4.966 6.83e-07 ***\nD3           1.69007    0.15065  11.219  &lt; 2e-16 ***\nD4           2.02648    0.14771  13.719  &lt; 2e-16 ***\nD5           1.43966    0.15317   9.399  &lt; 2e-16 ***\nD6           2.96856    0.14439  20.559  &lt; 2e-16 ***\nD7           2.24512    0.14547  15.434  &lt; 2e-16 ***\nD8           1.87534    0.14855  12.624  &lt; 2e-16 ***\nDiag1        3.54857    0.22806  15.560  &lt; 2e-16 ***\nDiag2        2.15053    0.20737  10.370  &lt; 2e-16 ***\nDiag3        0.77163    0.15275   5.052 4.38e-07 ***\nDiag4        0.54098    0.12287   4.403 1.07e-05 ***\nDiag5        0.84961    0.22965   3.700 0.000216 ***\nDiag6        0.25903    0.07531   3.439 0.000583 ***\nDiag7        0.80428    0.11438   7.031 2.04e-12 ***\nDiag8        1.04976    0.12946   8.109  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nResidual deviance: 446.84 on 41 degrees of freedom\nAIC: 815.18\n\nNumber of iterations: 5\n\ntidy(fit_d_3b)\n\n# A tibble: 23 × 5\n   term        estimate std.error statistic   p.value\n   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;\n 1 (Intercept)    0.363     0.179      2.03 4.22e-  2\n 2 O2             0.354     0.148      2.40 1.63e-  2\n 3 O3             1.35      0.128     10.6  3.88e- 26\n 4 O4             1.77      0.123     14.4  9.01e- 47\n 5 O5             0.566     0.143      3.97 7.16e-  5\n 6 O6             2.73      0.119     22.8  1.65e-115\n 7 O7             1.55      0.126     12.3  1.12e- 34\n 8 O8             1.37      0.128     10.8  4.42e- 27\n 9 D2             0.820     0.165      4.97 6.83e-  7\n10 D3             1.69      0.151     11.2  3.30e- 29\n# ℹ 13 more rows\n\nglance(fit_d_3b)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -385.  815.  865.     447.          41    64\n\n# (4) Uniform association, diagonal omitted\nfit_d_4 &lt;- d_duncan |&gt; gnm(Freq ~  O + D + U:V, data = _, weights = W, family = poisson)\nsummary(fit_d_4)\n\n\nCall:\ngnm(formula = Freq ~ O + D + U:V, family = poisson, data = d_duncan, \n    weights = W)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.6522  -0.6267   0.0000   0.5913   2.0964  \n\nCoefficients:\n             Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  2.109554   0.188406  11.197  &lt; 2e-16 ***\nO2          -0.185071   0.150342  -1.231 0.218324    \nO3           0.229092   0.136939   1.673 0.094337 .  \nO4          -0.060423   0.147813  -0.409 0.682699    \nO5          -2.024528   0.187084 -10.822  &lt; 2e-16 ***\nO6          -0.590189   0.198922  -2.967 0.003008 ** \nO7          -2.570773   0.244589 -10.511  &lt; 2e-16 ***\nO8          -3.518248   0.285046 -12.343  &lt; 2e-16 ***\nD2           0.256818   0.168036   1.528 0.126426    \nD3           0.581222   0.158565   3.666 0.000247 ***\nD4           0.233361   0.167699   1.392 0.164059    \nD5          -1.099156   0.193262  -5.687 1.29e-08 ***\nD6          -0.265555   0.210615  -1.261 0.207362    \nD7          -1.794390   0.250606  -7.160 8.06e-13 ***\nD8          -2.916108   0.289546 -10.071  &lt; 2e-16 ***\nU:V          0.136974   0.007489  18.289  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nResidual deviance: 58.436 on 40 degrees of freedom\nAIC: 362.41\n\nNumber of iterations: 4\n\ntidy(fit_d_4)\n\n# A tibble: 16 × 5\n   term        estimate std.error statistic  p.value\n   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;\n 1 (Intercept)   2.11     0.188      11.2   4.22e-29\n 2 O2           -0.185    0.150      -1.23  2.18e- 1\n 3 O3            0.229    0.137       1.67  9.43e- 2\n 4 O4           -0.0604   0.148      -0.409 6.83e- 1\n 5 O5           -2.02     0.187     -10.8   2.72e-27\n 6 O6           -0.590    0.199      -2.97  3.01e- 3\n 7 O7           -2.57     0.245     -10.5   7.72e-26\n 8 O8           -3.52     0.285     -12.3   5.33e-35\n 9 D2            0.257    0.168       1.53  1.26e- 1\n10 D3            0.581    0.159       3.67  2.47e- 4\n11 D4            0.233    0.168       1.39  1.64e- 1\n12 D5           -1.10     0.193      -5.69  1.29e- 8\n13 D6           -0.266    0.211      -1.26  2.07e- 1\n14 D7           -1.79     0.251      -7.16  8.06e-13\n15 D8           -2.92     0.290     -10.1   7.40e-24\n16 U:V           0.137    0.00749    18.3   1.01e-74\n\nglance(fit_d_4)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -165.  362.  397.     58.4          40    56\n\n# log-odds b_hat\nfit_d_4$coefficients[\"U:V\"] |&gt; exp()\n\n     U:V \n1.146799 \n\nfit_d_4b &lt;- d_duncan |&gt; gnm(Freq ~  O + D + U:V + Diag, data = _, family = poisson)\nsummary(fit_d_4b)\n\n\nCall:\n\ngnm(formula = Freq ~ O + D + U:V + Diag, family = poisson, data = d_duncan)\n\nDeviance Residuals: \n       Min          1Q      Median          3Q         Max  \n-2.652e+00  -6.267e-01  -3.932e-08   5.913e-01   2.096e+00  \n\nCoefficients:\n             Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  2.109554   0.188406  11.197  &lt; 2e-16 ***\nO2          -0.185071   0.150342  -1.231 0.218324    \nO3           0.229092   0.136939   1.673 0.094337 .  \nO4          -0.060423   0.147813  -0.409 0.682699    \nO5          -2.024528   0.187084 -10.822  &lt; 2e-16 ***\nO6          -0.590189   0.198922  -2.967 0.003008 ** \nO7          -2.570773   0.244589 -10.511  &lt; 2e-16 ***\nO8          -3.518248   0.285046 -12.343  &lt; 2e-16 ***\nD2           0.256818   0.168036   1.528 0.126426    \nD3           0.581222   0.158565   3.666 0.000247 ***\nD4           0.233361   0.167699   1.392 0.164059    \nD5          -1.099156   0.193262  -5.687 1.29e-08 ***\nD6          -0.265555   0.210615  -1.261 0.207362    \nD7          -1.794390   0.250606  -7.160 8.06e-13 ***\nD8          -2.916108   0.289546 -10.071  &lt; 2e-16 ***\nU:V          0.136974   0.007489  18.289  &lt; 2e-16 ***\nDiag1        1.665495   0.237383   7.016 2.28e-12 ***\nDiag2        0.959681   0.212122   4.524 6.06e-06 ***\nDiag3        0.021750   0.156530   0.139 0.889490    \nDiag4        0.226399   0.124364   1.820 0.068689 .  \nDiag5        0.808646   0.229754   3.520 0.000432 ***\nDiag6        0.132277   0.077191   1.714 0.086597 .  \nDiag7        0.506709   0.115936   4.371 1.24e-05 ***\nDiag8        0.221880   0.134803   1.646 0.099771 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nResidual deviance: 58.436 on 40 degrees of freedom\nAIC: 428.78\n\nNumber of iterations: 4\n\ntidy(fit_d_4b)\n\n# A tibble: 24 × 5\n   term        estimate std.error statistic  p.value\n   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;\n 1 (Intercept)   2.11       0.188    11.2   4.22e-29\n 2 O2           -0.185      0.150    -1.23  2.18e- 1\n 3 O3            0.229      0.137     1.67  9.43e- 2\n 4 O4           -0.0604     0.148    -0.409 6.83e- 1\n 5 O5           -2.02       0.187   -10.8   2.72e-27\n 6 O6           -0.590      0.199    -2.97  3.01e- 3\n 7 O7           -2.57       0.245   -10.5   7.72e-26\n 8 O8           -3.52       0.285   -12.3   5.33e-35\n 9 D2            0.257      0.168     1.53  1.26e- 1\n10 D3            0.581      0.159     3.67  2.47e- 4\n# ℹ 14 more rows\n\nglance(fit_d_4b)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -190.  429.  481.     58.4          40    64\n\n# log-odds b_hat\nfit_d_4b$coefficients[\"U:V\"] |&gt; exp()\n\n     U:V \n1.146799 \n\n# (5) Row effects, diagonal omitted*\nfit_d_5 &lt;- d_duncan |&gt; gnm(Freq ~ O + D + O:V, data = _, weights = W, family = poisson)\nsummary(fit_d_5)\n\n\nCall:\ngnm(formula = Freq ~ O + D + O:V, family = poisson, data = d_duncan, \n    weights = W)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.5731  -0.5561   0.0000   0.6020   1.4669  \n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  3.30716    0.35290   9.371  &lt; 2e-16 ***\nO2           0.18160    0.40668   0.447   0.6552    \nO3           0.07048    0.35788   0.197   0.8439    \nO4          -0.59546    0.34779  -1.712   0.0869 .  \nO5          -2.17219    0.42137  -5.155 2.54e-07 ***\nO6          -0.68517    0.33031  -2.074   0.0380 *  \nO7          -2.75820    0.38757  -7.117 1.11e-12 ***\nO8          -3.51465    0.43967  -7.994  &lt; 2e-16 ***\nD2           1.38525    0.18314   7.564 3.91e-14 ***\nD3           2.75348    0.19480  14.135  &lt; 2e-16 ***\nD4           3.45305    0.22703  15.210  &lt; 2e-16 ***\nD5           3.20664    0.26857  11.940  &lt; 2e-16 ***\nD6           5.10309    0.30368  16.804  &lt; 2e-16 ***\nD7           4.64707    0.34112  13.623  &lt; 2e-16 ***\nD8           4.58416    0.40156  11.416  &lt; 2e-16 ***\nO1:V        -0.97261    0.09074 -10.719  &lt; 2e-16 ***\nO2:V        -0.91747    0.07796 -11.768  &lt; 2e-16 ***\nO3:V        -0.65692    0.06243 -10.522  &lt; 2e-16 ***\nO4:V        -0.45024    0.05914  -7.613 2.68e-14 ***\nO5:V        -0.38508    0.07183  -5.361 8.29e-08 ***\nO6:V        -0.25744    0.05495  -4.685 2.80e-06 ***\nO7:V        -0.10400    0.06481  -1.605   0.1085    \nO8:V         0.00000         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 45.906 on 34 degrees of freedom\nAIC: 361.88\n\nNumber of iterations: 4\n\ntidy(fit_d_5)\n\n# A tibble: 23 × 5\n   term        estimate std.error statistic  p.value\n   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;\n 1 (Intercept)   3.31       0.353     9.37  7.16e-21\n 2 O2            0.182      0.407     0.447 6.55e- 1\n 3 O3            0.0705     0.358     0.197 8.44e- 1\n 4 O4           -0.595      0.348    -1.71  8.69e- 2\n 5 O5           -2.17       0.421    -5.16  2.54e- 7\n 6 O6           -0.685      0.330    -2.07  3.80e- 2\n 7 O7           -2.76       0.388    -7.12  1.11e-12\n 8 O8           -3.51       0.440    -7.99  1.31e-15\n 9 D2            1.39       0.183     7.56  3.91e-14\n10 D3            2.75       0.195    14.1   2.32e-45\n# ℹ 13 more rows\n\nglance(fit_d_5)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -159.  362.  409.     45.9          34    56\n\n# (5) Row effects, diagonal fitted\nfit_d_5b &lt;- d_duncan |&gt; gnm(Freq ~ O + D + O:V + Diag, data = _, family = poisson)\nsummary(fit_d_5b)\n\n\nCall:\n\ngnm(formula = Freq ~ O + D + O:V + Diag, family = poisson, data = d_duncan)\n\nDeviance Residuals: \n       Min          1Q      Median          3Q         Max  \n-2.573e+00  -5.561e-01   3.495e-08   6.020e-01   1.467e+00  \n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  3.30716    0.35290   9.371  &lt; 2e-16 ***\nO2           0.18160    0.40668   0.447 0.655198    \nO3           0.07048    0.35788   0.197 0.843875    \nO4          -0.59546    0.34779  -1.712 0.086876 .  \nO5          -2.17219    0.42137  -5.155 2.54e-07 ***\nO6          -0.68517    0.33031  -2.074 0.038049 *  \nO7          -2.75820    0.38757  -7.117 1.11e-12 ***\nO8          -3.51465    0.43967  -7.994  &lt; 2e-16 ***\nD2           1.38525    0.18314   7.564 3.91e-14 ***\nD3           2.75348    0.19480  14.135  &lt; 2e-16 ***\nD4           3.45305    0.22703  15.210  &lt; 2e-16 ***\nD5           3.20664    0.26857  11.940  &lt; 2e-16 ***\nD6           5.10309    0.30368  16.804  &lt; 2e-16 ***\nD7           4.64707    0.34112  13.623  &lt; 2e-16 ***\nD8           4.58416    0.40156  11.416  &lt; 2e-16 ***\nO1:V        -0.97261    0.09074 -10.719  &lt; 2e-16 ***\nO2:V        -0.91747    0.07796 -11.768  &lt; 2e-16 ***\nO3:V        -0.65692    0.06243 -10.522  &lt; 2e-16 ***\nO4:V        -0.45024    0.05914  -7.613 2.68e-14 ***\nO5:V        -0.38508    0.07183  -5.361 8.29e-08 ***\nO6:V        -0.25744    0.05495  -4.685 2.80e-06 ***\nO7:V        -0.10400    0.06481  -1.605 0.108538    \nO8:V         0.00000         NA      NA       NA    \nDiag1        1.57747    0.32240   4.893 9.94e-07 ***\nDiag2        0.64980    0.24519   2.650 0.008045 ** \nDiag3        0.01404    0.17040   0.082 0.934327    \nDiag4        0.33668    0.13137   2.563 0.010381 *  \nDiag5        0.80264    0.23091   3.476 0.000509 ***\nDiag6        0.13674    0.07784   1.757 0.078973 .  \nDiag7        0.49482    0.12541   3.946 7.96e-05 ***\nDiag8        0.28677    0.17735   1.617 0.105894    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 45.906 on 34 degrees of freedom\nAIC: 428.25\n\nNumber of iterations: 4\n\ntidy(fit_d_5b)\n\n# A tibble: 31 × 5\n   term        estimate std.error statistic  p.value\n   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;\n 1 (Intercept)   3.31       0.353     9.37  7.16e-21\n 2 O2            0.182      0.407     0.447 6.55e- 1\n 3 O3            0.0705     0.358     0.197 8.44e- 1\n 4 O4           -0.595      0.348    -1.71  8.69e- 2\n 5 O5           -2.17       0.421    -5.16  2.54e- 7\n 6 O6           -0.685      0.330    -2.07  3.80e- 2\n 7 O7           -2.76       0.388    -7.12  1.11e-12\n 8 O8           -3.51       0.440    -7.99  1.31e-15\n 9 D2            1.39       0.183     7.56  3.91e-14\n10 D3            2.75       0.195    14.1   2.32e-45\n# ℹ 21 more rows\n\nglance(fit_d_5b)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -184.  428.  493.     45.9          34    64\n\n\n\n# Tabel 1\nd_duncan_fitted &lt;- \n  d_duncan |&gt; \n  mutate(fitted_1 = predict(fit_d_1, type = \"response\"),\n         fitted_2 = predict(fit_d_2, type = \"response\"),\n         fitted_3 = predict(fit_d_3, type = \"response\"),\n         fitted_4 = predict(fit_d_4, type = \"response\"),\n         fitted_5 = predict(fit_d_5, type = \"response\"))\n\ntab_obs &lt;- d_duncan_fitted |&gt; xtabs(Freq ~ O + D, data = _)\ntab_fitted_1 &lt;- d_duncan_fitted |&gt; xtabs(fitted_1 ~ O + D, data = _)\ntab_fitted_2 &lt;- d_duncan_fitted |&gt; xtabs(fitted_2 ~ O + D, data = _)\ntab_fitted_3 &lt;- d_duncan_fitted |&gt; xtabs(fitted_3 ~ O + D, data = _)\ntab_fitted_4 &lt;- d_duncan_fitted |&gt; xtabs(fitted_4 ~ O + D, data = _)\ntab_fitted_5 &lt;- d_duncan_fitted |&gt; xtabs(fitted_5 ~ O + D, data = _)\n\n# Observed Counts\ntab_obs\n\n   D\nO     1   2   3   4   5   6   7   8\n  1  50  19  26   8   7  11   6   2\n  2  16  40  34  18  11  20   8   3\n  3  12  35  65  66  35  88  23  21\n  4  11  20  58 110  40 183  64  32\n  5   2   8  12  23  25  46  28  12\n  6  12  28 102 162  90 554 230 177\n  7   0   6  19  40  21 158 143  71\n  8   0   3  14  32  15 126  91 106\n\n# Fitted Counts, Model (4)\ntab_fitted_4 |&gt; round(1)\n\n   D\nO       1     2     3     4     5     6     7     8\n  1   9.5  14.0  22.2  18.0   5.4  14.4   3.6   1.3\n  2   9.0  15.3  27.9  25.9   9.0  27.2   7.8   3.3\n  3  15.6  30.5  63.6  67.7  27.0  93.6  30.6  15.0\n  4  13.4  30.0  71.8  87.7  40.0 159.3  59.7  33.7\n  5   2.2   5.5  15.2  21.3  11.1  50.8  21.9  14.1\n  6  10.4  30.6  96.2 154.5  92.7 485.4 239.3 177.3\n  7   1.6   5.5  20.0  36.9  25.4 152.3  86.2  73.2\n  8   0.7   2.8  11.7  24.7  19.5 134.4  87.1  84.9\n\n# Fitted Counts, Model (5)\ntab_fitted_5 |&gt; round(1)\n\n   D\nO       1     2     3     4     5     6     7     8\n  1  10.3  15.6  23.2  17.6   5.2  13.1   3.1   1.1\n  2  13.1  20.9  32.8  26.4   8.2  21.9   5.5   2.1\n  3  15.2  31.5  64.1  66.9  27.1  93.6  30.8  15.0\n  4   9.6  24.4  61.2  78.6  39.1 166.2  67.2  40.2\n  5   2.1   5.8  15.4  21.1  11.2  50.8  21.9  14.0\n  6  10.6  32.9  99.8 155.3  93.8 483.2 236.7 171.8\n  7   1.6   5.6  19.9  36.1  25.4 152.6  87.2  73.8\n  8   0.8   3.2  12.8  25.7  20.1 133.7  84.7  79.6\n\nd_1 &lt;- (tab_obs/tab_fitted_1) |&gt; diag()\nd_2 &lt;- (tab_obs/tab_fitted_2) |&gt; diag()\nd_3 &lt;- (tab_obs/tab_fitted_3) |&gt; diag()\nd_4 &lt;- (tab_obs/tab_fitted_4) |&gt; diag()\nd_5 &lt;- (tab_obs/tab_fitted_5) |&gt; diag()\n\n# Diagonal Ratios\nocc &lt;- c(\"I\",\"II\",\"III\",\"IV\",\"Va\",\"Vb\",\"VI\",\"VII\")\ntibble(occ, d_1, d_2, d_3, d_4, d_5)\n\n# A tibble: 8 × 6\n  occ     d_1   d_2   d_3   d_4   d_5\n  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 I     13.2   1.56 34.8   5.29  4.84\n2 II     5.87  1.57  8.59  2.61  1.92\n3 III    2.00  1.09  2.16  1.02  1.01\n4 IV     1.62  1.25  1.72  1.25  1.40\n5 Va     2.30  1.99  2.34  2.24  2.23\n6 Vb     1.21  1.08  1.30  1.14  1.15\n7 VI     1.84  1.34  2.24  1.66  1.64\n8 VII    2.26  1.16  2.86  1.25  1.33\n\n# Table 2\nModel &lt;- c(\"(1) Independence\",\n           \"(2) Row effects\",\n           \"(3) Quasi independence, diagonal omitted\",\n           \"(4) Uniform association, diagonal omitted\",\n           \"(5) Row effects, diagonal omitted\")\n\n# 複数のモデルの適合度をglanceで示してまとめる\nlist(fit_d_1, fit_d_2, fit_d_3, fit_d_4, fit_d_5) |&gt; \n  map_dfr(glance) |&gt; \n  mutate(Model, .before = 1) |&gt; \n  dplyr::select(Model, L2 = deviance, df = df.residual)\n\n# A tibble: 5 × 3\n  Model                                        L2    df\n  &lt;chr&gt;                                     &lt;dbl&gt; &lt;int&gt;\n1 (1) Independence                          954.     49\n2 (2) Row effects                           130.     42\n3 (3) Quasi independence, diagonal omitted  447.     41\n4 (4) Uniform association, diagonal omitted  58.4    40\n5 (5) Row effects, diagonal omitted          45.9    34\n\n# Figure 2\nb_4 &lt;- exp(fit_d_4$coefficients[\"U:V\"] * (7:0))\nb_5 &lt;- fit_d_5$coefficients[grep(\":V\", names(fit_d_5$coefficients))]\nb_5[\"O8:V\"] &lt;- 0\nb_5 &lt;- exp(b_5 * (-1)) \n\nd_duncan_b_4 &lt;- tibble(y = b_4, Model = \"Model 4\", x = gl(8, 1))\nd_duncan_b_5 &lt;- tibble(y = b_5, Model = \"Model 5\", x = gl(8, 1))\nd &lt;- bind_rows(d_duncan_b_4, d_duncan_b_5)\n\nd |&gt; \n  mutate(x = factor(x, levels = 8:1)) |&gt;\n  ggplot(aes(x = x, y = y, \n             group = Model, \n             linetype = Model,\n             color = Model)) + \n  geom_line() + \n  ylim(1,3) + \n  scale_linetype_manual(values = c(\"longdash\",\"solid\")) +\n  labs(x = \"FATHER'S OCCUPATION (i)\", y = \"b_i/b_8\") +\n  theme_classic() + \n  ggthemes::scale_color_colorblind()\n\n\n\n# mosaic plot\nmosaic(fit_d_1, ~ O + D, residuals_type = \"rstandard\")\n\n\n\nmosaic(fit_d_2, ~ O + D, residuals_type = \"rstandard\")\n\n\n\nmosaic(fit_d_3b, ~ O + D, residuals_type = \"rstandard\")\n\n\n\nmosaic(fit_d_4b, ~ O + D, residuals_type = \"rstandard\")\n\n\n\nmosaic(fit_d_5b, ~ O + D, residuals_type = \"rstandard\")"
  },
  {
    "objectID": "11-Replication.html#yamaguchi-1987",
    "href": "11-Replication.html#yamaguchi-1987",
    "title": "先行研究の再現",
    "section": "Yamaguchi (1987)",
    "text": "Yamaguchi (1987)\nYamaguchi (1987) の結果を再現する．\n\n# Data\nFreq_yamaguchi_1987 &lt;- c(1275, 364, 274, 272, 17,\n                         1055, 597, 394, 443, 31,\n                         1043, 587, 1045, 951, 47,\n                         1159, 791, 1323, 2046, 52,\n                         666, 496, 1031, 1632, 646,\n                         \n                         474, 129, 87, 124, 11,\n                         300, 218, 171, 220, 8,\n                         438, 254, 669, 703, 16,\n                         601, 388, 932, 1789, 37,\n                         76, 56, 125, 295, 191,\n                         \n                         127, 101, 24, 30, 12,\n                         86, 207, 64, 61, 13,\n                         43, 73, 122, 60, 13,\n                         35, 51, 62, 66, 11,\n                         109, 206, 184, 253, 325)\nd_yamaguchi &lt;- tibble(O = gl(5, k = 5, length = 3 * 5 * 5),\n                      D = gl(5, k = 1, length = 3 * 5 * 5),\n                      C = gl(3, k = 5 * 5, length = 3 * 5 * 5),\n                      Freq = Freq_yamaguchi_1987)\nd_yamaguchi\n\n# A tibble: 75 × 4\n   O     D     C      Freq\n   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt;\n 1 1     1     1      1275\n 2 1     2     1       364\n 3 1     3     1       274\n 4 1     4     1       272\n 5 1     5     1        17\n 6 2     1     1      1055\n 7 2     2     1       597\n 8 2     3     1       394\n 9 2     4     1       443\n10 2     5     1        31\n# ℹ 65 more rows\n\n# Diagonal parameters\nd_yamaguchi &lt;- d_yamaguchi |&gt; \n  mutate(Diag = case_when(O == D ~ O, .default = \"0\") |&gt; factor())\n\n# Row and column scores\nd_yamaguchi &lt;- d_yamaguchi |&gt; \n  mutate(U = as.numeric(O),\n         V = as.numeric(D))\n\n# Country dummy\nd_yamaguchi &lt;- d_yamaguchi |&gt; \n  mutate(C1 = case_match(C,\n                         c(\"2\",\"3\") ~ 0,\n                         \"1\" ~ 1),\n         C2 = case_match(C,\n                         c(\"1\",\"3\") ~ 0,\n                         \"2\" ~ 1),\n         C3 = case_match(C,\n                         c(\"1\",\"2\") ~ 0,\n                         \"3\" ~ 1))\n  \n# Off diagonal cells (Diag*C)\n# No association between R and C, given L\nfit_y_1 &lt;- d_yamaguchi |&gt; glm(Freq ~ O*C + D*C + Diag*C, data = _, family = poisson)\nglance(fit_y_1)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -929. 1943. 2040.    1336.          33    75\n\n# U0-Cross-nationally homogeneous uniform association\nfit_y_2 &lt;- d_yamaguchi |&gt; glm(Freq ~ O*C + D*C + Diag*C + U:V, data = _, family = poisson)\nglance(fit_y_2)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -349.  784.  884.     175.          32    75\n\nb_2 &lt;- fit_y_2$coefficients[grep(\"U:V\", names(fit_y_2$coefficients))]\nb_2\n\n      U:V \n0.1850182 \n\n# U1-Cross-nationally uniform uniform association\nfit_y_3 &lt;- d_yamaguchi |&gt; glm(Freq ~ O*C + D*C + Diag*C + U:V*C, data = _, family = poisson)\nglance(fit_y_3)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -344.  779.  883.     166.          30    75\n\nb_3 &lt;- fit_y_3$coefficients[grep(\"U:V\", names(fit_y_3$coefficients))]\nb_3\n\n        U:V      C2:U:V      C3:U:V \n 0.18852859  0.01069127 -0.04990850 \n\n# U2-Cross-nationally uniform uniform association\nfit_y_4 &lt;- d_yamaguchi |&gt; \n  glm(Freq ~ O*C + D*C + Diag*C + U:V + U:V:C3, data = _, family = poisson)\nglance(fit_y_4)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -345.  777.  879.     167.          31    75\n\nb_4 &lt;- fit_y_4$coefficients[grep(\"U:V\", names(fit_y_4$coefficients))]\nb_4\n\n        U:V      U:V:C3 \n 0.19052983 -0.05190974 \n\n# R0-Cross-nationally homogeneous row effect association\nfit_y_5 &lt;- d_yamaguchi |&gt; \n  glm(Freq ~ O*C + D*C + Diag*C + O:V, data = _, family = poisson)\nglance(fit_y_5)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -339.  771.  877.     156.          29    75\n\n# R1-Cross-nationally uniform row effect association\nfit_y_6 &lt;- d_yamaguchi |&gt; \n  glm(Freq ~ O*C + D*C + Diag*C + O:V + U:V*C, data = _, family = poisson)\nglance(fit_y_6)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -335.  766.  878.     148.          27    75\n\nb_6 &lt;- fit_y_6$coefficients[grep(\"V:U\", names(fit_y_6$coefficients))]\nb_6\n\n        V:U      C2:V:U      C3:V:U \n         NA  0.00369588 -0.05053513 \n\n# R2-Cross-nationally uniform row effect association\nfit_y_7 &lt;- d_yamaguchi |&gt; \n  glm(Freq ~ O*C + D*C + Diag*C + O:V + U:V:C3, data = _, family = poisson)\nglance(fit_y_7)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -335.  764.  873.     148.          28    75\n\nb_7 &lt;- fit_y_7$coefficients[grep(\"V:U\", names(fit_y_7$coefficients))]\nb_7\n\n     V:U:C3 \n-0.05122437 \n\n# C0-Cross-nationally homogeneous column effect association\nfit_y_8 &lt;- d_yamaguchi |&gt;\n  glm(Freq ~ O*C + D*C + Diag*C + U:D, data = _, family = poisson)\nglance(fit_y_8)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -295.  682.  789.     67.7          29    75\n\n# C1-Cross-nationally uniform column effect association\nfit_y_9 &lt;- d_yamaguchi |&gt; \n  glm(Freq ~ O*C + D*C + Diag*C + U:D + U:V*C, data = _, family = poisson)\nglance(fit_y_9)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -291.  679.  790.     60.3          27    75\n\nb_9 &lt;- fit_y_9$coefficients[grep(\"U:V\", names(fit_y_9$coefficients))]\nb_9\n\n        U:V      C2:U:V      C3:U:V \n         NA  0.01491735 -0.04242365 \n\n# C2-Cross-nationally uniform column effect association\nfit_y_10 &lt;- d_yamaguchi |&gt; \n  glm(Freq ~ O*C + D*C + Diag*C + U:D + U:V:C3, data = _, family = poisson)\nglance(fit_y_10)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -292.  678.  787.     61.3          28    75\n\nb_10 &lt;- fit_y_10$coefficients[grep(\"U:V\", names(fit_y_10$coefficients))]\nb_10\n\n     U:V:C3 \n-0.04530956 \n\n# H0-Cross-nationally homogeneous homogeneous row & column effect association\nfit_y_11 &lt;- d_yamaguchi |&gt; \n  gnm(Freq ~ O*C + D*C + Diag*C + MultHomog(O, D), \n                               data = _, family = poisson)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.....\nDone\n\nglance(fit_y_11)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -315.  721.  828.     107.          29    75\n\n# H1-Cross-nationally uniform homogeneous row & column effect association\nfit_y_12 &lt;- d_yamaguchi |&gt; \n  gnm(Freq ~ O*C + D*C + Diag*C + MultHomog(O, D) + U:V:C2 + U:V:C3, \n                               data = _, family = poisson)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.....\nDone\n\nglance(fit_y_12)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -310.  717.  828.     98.2          27    75\n\nb_12 &lt;- fit_y_12$coefficients[grep(\"U:V\", names(fit_y_12$coefficients))]\nb_12\n\n      U:V:C2       U:V:C3 \n-0.002548059 -0.052199354 \n\n# H2-Cross-nationally uniform homogeneous row & column effect association\nfit_y_13 &lt;- d_yamaguchi |&gt; gnm(Freq ~ O*C + D*C + Diag*C + MultHomog(O, D) + U:V:C3, \n                               data = _, family = poisson)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.....\nDone\n\nglance(fit_y_13)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -310.  715.  824.     98.2          28    75\n\nb_13 &lt;- fit_y_13$coefficients[grep(\"U:V\", names(fit_y_13$coefficients))]\nb_13\n\n     U:V:C3 \n-0.05173675 \n\n# R+C0 -Cross-nationally uniform row & column effect association\nfit_y_14 &lt;- d_yamaguchi |&gt; \n  glm(Freq ~ O*C + D*C + Diag*C + U:D + O:V, data = _, family = poisson)\nglance(fit_y_14)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -281.  659.  773.     38.8          26    75\n\n# R+C1 -Cross-nationally uniform row & column effect association\nfit_y_15 &lt;- d_yamaguchi |&gt; \n  glm(Freq ~ O*C + D*C + Diag*C + U:D + O:V + U:V:C2 + U:V:C3, data = _, family = poisson)\nglance(fit_y_15)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -278.  658.  776.     33.3          24    75\n\nb_15 &lt;- fit_y_15$coefficients[grep(\"U:V\", names(fit_y_15$coefficients))]\nb_15\n\n      U:V:C2       U:V:C3 \n 0.003287747 -0.041213885 \n\n# R+C2-Cross-nationally uniform row & column effect association\nfit_y_16 &lt;- d_yamaguchi |&gt; \n  glm(Freq ~ O*C + D*C + Diag*C + U:D + O:V + U:V:C3, data = _, family = poisson)\nglance(fit_y_16)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -278.  656.  772.     33.3          25    75\n\nb_16 &lt;- fit_y_16$coefficients[grep(\"U:V\", names(fit_y_16$coefficients))]\nb_16\n\n    U:V:C3 \n-0.0418251 \n\nd_yamaguchi &lt;- d_yamaguchi |&gt; \n  mutate(SYM = c(rep(c(0, 1, 2, 3, 4,\n                       1, 0, 5, 6, 7, \n                       2, 5, 0, 8, 9,\n                       3, 6, 8, 0, 10,\n                       4, 7, 9, 10, 0), 3)) |&gt;  factor())\n\nd_yamaguchi |&gt; dplyr::select(O, D, C, SYM) |&gt; unique()\n\n# A tibble: 75 × 4\n   O     D     C     SYM  \n   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;\n 1 1     1     1     0    \n 2 1     2     1     1    \n 3 1     3     1     2    \n 4 1     4     1     3    \n 5 1     5     1     4    \n 6 2     1     1     1    \n 7 2     2     1     0    \n 8 2     3     1     5    \n 9 2     4     1     6    \n10 2     5     1     7    \n# ℹ 65 more rows\n\n# QS0-Cross-nationally homogeneous quasi-symmetry\nfit_y_17 &lt;- d_yamaguchi |&gt; \n  glm(Freq ~ O*C + D*C + Diag*C + SYM, data = _, family = poisson)\nglance(fit_y_17)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -315.  723.  832.     107.          28    75\n\ntidy(fit_y_17) |&gt; print(n = Inf)\n\n# A tibble: 52 × 5\n   term         estimate std.error statistic    p.value\n   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;\n 1 (Intercept)  4.47        0.0870   51.4     0        \n 2 O2           0.688       0.0658   10.4     1.59e- 25\n 3 O3           1.64        0.0602   27.2     1.06e-162\n 4 O4           2.34        0.0575   40.7     0        \n 5 O5           2.09        0.0650   32.1     1.13e-226\n 6 C2          -1.23        0.0742  -16.6     6.96e- 62\n 7 C3          -2.41        0.115   -21.0     3.48e- 98\n 8 D2          -0.304       0.0519   -5.86    4.74e-  9\n 9 D3           0.359       0.0447    8.04    9.13e- 16\n10 D4           0.811       0.0414   19.6     2.04e- 85\n11 D5          -2.40        0.0947  -25.3     1.06e-141\n12 Diag1        2.68        0.0914   29.3     3.33e-189\n13 Diag2        1.54        0.0992   15.5     3.40e- 54\n14 Diag3        0.487       0.0535    9.10    9.21e- 20\n15 Diag4       -0.000521    0.0479   -0.0109  9.91e-  1\n16 Diag5        2.31        0.0964   24.0     6.95e-127\n17 SYM1         1.78        0.0722   24.7     1.90e-134\n18 SYM2         0.811       0.0517   15.7     1.73e- 55\n19 SYM3         0.256       0.0532    4.80    1.56e-  6\n20 SYM4        NA          NA        NA      NA        \n21 SYM5         0.541       0.0553    9.78    1.35e- 22\n22 SYM6         0.132       0.0563    2.34    1.92e-  2\n23 SYM7        NA          NA        NA      NA        \n24 SYM8        NA          NA        NA      NA        \n25 SYM9        NA          NA        NA      NA        \n26 SYM10       NA          NA        NA      NA        \n27 O2:C2        0.0124      0.0798    0.155   8.77e-  1\n28 O3:C2        0.373       0.0734    5.09    3.57e-  7\n29 O4:C2        0.574       0.0714    8.03    9.65e- 16\n30 O5:C2       -1.02        0.0788  -12.9     2.39e- 38\n31 O2:C3        0.0805      0.120     0.673   5.01e-  1\n32 O3:C3       -0.688       0.116    -5.92    3.20e-  9\n33 O4:C3       -1.19        0.120    -9.92    3.45e- 23\n34 O5:C3        0.409       0.0967    4.23    2.29e-  5\n35 C2:D2        0.0286      0.0541    0.529   5.97e-  1\n36 C3:D2        1.05        0.0901   11.6     2.65e- 31\n37 C2:D3        0.285       0.0489    5.83    5.64e-  9\n38 C3:D3        0.336       0.0893    3.77    1.65e-  4\n39 C2:D4        0.516       0.0498   10.4     3.12e- 25\n40 C3:D4        0.215       0.0862    2.50    1.25e-  2\n41 C2:D5        0.0726      0.148     0.491   6.23e-  1\n42 C3:D5        2.05        0.179    11.4     4.08e- 30\n43 C2:Diag1     0.243       0.0917    2.65    8.12e-  3\n44 C3:Diag1     0.106       0.148     0.720   4.72e-  1\n45 C2:Diag2     0.184       0.102     1.80    7.26e-  2\n46 C3:Diag2     0.225       0.128     1.76    7.91e-  2\n47 C2:Diag3     0.128       0.0743    1.72    8.60e-  2\n48 C3:Diag3     0.617       0.140     4.41    1.05e-  5\n49 C2:Diag4     0.00793     0.0624    0.127   8.99e-  1\n50 C3:Diag4    -0.0490      0.163    -0.300   7.64e-  1\n51 C2:Diag5     0.961       0.174     5.53    3.26e-  8\n52 C3:Diag5    -0.730       0.189    -3.86    1.12e-  4\n\n# QS1-Cross-nationally uniform quasi-symmetry\nfit_y_18 &lt;- d_yamaguchi |&gt; \n  glm(Freq ~ O*C + D*C + Diag*C + SYM + U:V:C2 + U:V:C3, data = _, family = poisson)\nglance(fit_y_18)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -310.  719.  832.     98.2          26    75\n\nb_18 &lt;- fit_y_18$coefficients[grep(\"U:V\", names(fit_y_18$coefficients))]\nb_18\n\n      U:V:C2       U:V:C3 \n-0.002538939 -0.052099153 \n\n# QS2-Cross-nationally uniform quasi-symmetry\nfit_y_19 &lt;- d_yamaguchi |&gt; \n  glm(Freq ~ O*C + D*C + Diag*C + SYM + U:V:C3, data = _, family = poisson)\nglance(fit_y_19)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -310.  717.  828.     98.2          27    75\n\nb_19 &lt;- fit_y_19$coefficients[grep(\"U:V\", names(fit_y_19$coefficients))]\nb_19\n\n     U:V:C3 \n-0.05163812 \n\n# FI0-Cross-nationallyhomogeneous full two-way interaction\nfit_y_20 &lt;- d_yamaguchi |&gt; \n  glm(Freq ~ O*C + D*C + Diag*C + O:D, data = _, family = poisson)\nglance(fit_y_20)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -279.  665.  788.     36.2          22    75\n\n# FI1-Cross-nationally uniform full two-way interaction\nfit_y_21 &lt;- d_yamaguchi |&gt; \n  glm(Freq ~ O*C + D*C + Diag*C + O:D + U:V:C2 + U:V:C3, data = _, family = poisson)\nglance(fit_y_21)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -277.  663.  791.     30.7          20    75\n\nb_21 &lt;- fit_y_21$coefficients[grep(\"U:V\", names(fit_y_21$coefficients))]\nb_21\n\n      U:V:C2       U:V:C3 \n 0.003476173 -0.041081646 \n\n# FI2-Cross-nationally uniform full two-way interaction\nfit_y_22 &lt;- d_yamaguchi |&gt; \n  glm(Freq ~ O*C + D*C + Diag*C + O:D + U:V:C3, data = _, family = poisson)\nglance(fit_y_22)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -277.  661.  787.     30.8          21    75\n\nb_22 &lt;- fit_y_22$coefficients[grep(\"U:V\", names(fit_y_22$coefficients))]\nb_22\n\n     U:V:C3 \n-0.04172632 \n\n\n\nModel &lt;- c(\"No association between R and C, given L\",\n           \"U0-Cross-nationally homogeneous uniform association\",\n           \"U1-Cross-nationally uniform uniform association\",\n           \"U2-Cross-nationally uniform uniform association\",\n           \"R0-Cross-nationally homogeneous row effect association\",\n           \"R1-Cross-nationally uniform row effect association\",\n           \"R2-Cross-nationally uniform row effect association\",\n           \"C0-Cross-nationally homogeneous column effect association\",\n           \"C1-Cross-nationally uniform column effect association\",\n           \"C2-Cross-nationally uniform column effect association\",\n           \"H0-Cross-nationally homogeneous homogeneous row & column effect association\",\n           \"H1-Cross-nationally uniform homogeneousrow & column effect association\",\n           \"H2-Cross-nationally uniform homogeneousrow & column effect association\",\n           \"R+C0 -Cross-nationally uniform row & column effect association\",\n           \"R+C1 -Cross-nationally uniform row & column effect association\",\n           \"R+C2-Cross-nationally uniform row & column effect association\",\n           \"QS0-Cross-nationally homogeneous quasi-symmetry\",\n           \"QS1-Cross-nationally uniform quasi-symmetry\",\n           \"QS2-Cross-nationally uniform quasi-symmetry\",\n           \"FI0-Cross-nationallyhomogeneous full two-way interaction\",\n           \"FI1-Cross-nationally uniform full two-way interaction\",\n           \"FI2-Cross-nationally uniform full two-way interaction\")\n\nlist(fit_y_1, fit_y_2, fit_y_3, fit_y_4, fit_y_5, fit_y_6, fit_y_7, fit_y_8, fit_y_9, fit_y_10,\n     fit_y_11, fit_y_12, fit_y_13, fit_y_14, fit_y_15, fit_y_16, fit_y_17, fit_y_18, fit_y_19,\n     fit_y_20, fit_y_21, fit_y_22) |&gt; \n  map_dfr(glance) |&gt; \n  mutate(Model = Model, .before = 1) |&gt; \n  dplyr::select(-c(2:3)) |&gt; \n  print(n = Inf)\n\n# A tibble: 22 × 7\n   Model                           logLik   AIC   BIC deviance df.residual  nobs\n   &lt;chr&gt;                            &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n 1 No association between R and C…  -929. 1943. 2040.   1336.           33    75\n 2 U0-Cross-nationally homogeneou…  -349.  784.  884.    175.           32    75\n 3 U1-Cross-nationally uniform un…  -344.  779.  883.    166.           30    75\n 4 U2-Cross-nationally uniform un…  -345.  777.  879.    167.           31    75\n 5 R0-Cross-nationally homogeneou…  -339.  771.  877.    156.           29    75\n 6 R1-Cross-nationally uniform ro…  -335.  766.  878.    148.           27    75\n 7 R2-Cross-nationally uniform ro…  -335.  764.  873.    148.           28    75\n 8 C0-Cross-nationally homogeneou…  -295.  682.  789.     67.7          29    75\n 9 C1-Cross-nationally uniform co…  -291.  679.  790.     60.3          27    75\n10 C2-Cross-nationally uniform co…  -292.  678.  787.     61.3          28    75\n11 H0-Cross-nationally homogeneou…  -315.  721.  828.    107.           29    75\n12 H1-Cross-nationally uniform ho…  -310.  717.  828.     98.2          27    75\n13 H2-Cross-nationally uniform ho…  -310.  715.  824.     98.2          28    75\n14 R+C0 -Cross-nationally uniform…  -281.  659.  773.     38.8          26    75\n15 R+C1 -Cross-nationally uniform…  -278.  658.  776.     33.3          24    75\n16 R+C2-Cross-nationally uniform …  -278.  656.  772.     33.3          25    75\n17 QS0-Cross-nationally homogeneo…  -315.  723.  832.    107.           28    75\n18 QS1-Cross-nationally uniform q…  -310.  719.  832.     98.2          26    75\n19 QS2-Cross-nationally uniform q…  -310.  717.  828.     98.2          27    75\n20 FI0-Cross-nationallyhomogeneou…  -279.  665.  788.     36.2          22    75\n21 FI1-Cross-nationally uniform f…  -277.  663.  791.     30.7          20    75\n22 FI2-Cross-nationally uniform f…  -277.  661.  787.     30.8          21    75\n\n\nH1とH2が微妙に異なるが誤差の範囲か．また，FI1の\\(\\beta_1\\)については符号が Yamaguchi (1987) のものとは異なっているがこちらが正しいか．\n\n# R+C2: No uniform difference between any two\nfit_y_23 &lt;- d_yamaguchi |&gt; \n  gnm(Freq ~ O*C + D*C + Diag*C + U:D + O:V + U:V:C3, \n      data = _, family = poisson)\nglance(fit_y_23)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -278.  656.  772.     33.3          25    75\n\ntidy(fit_y_23) |&gt; print(n = Inf)\n\n# A tibble: 53 × 5\n   term        estimate std.error statistic   p.value\n   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;\n 1 (Intercept)  7.07       0.177    39.9     0       \n 2 O2          -0.197      0.253    -0.778   4.37e- 1\n 3 O3          -0.536      0.376    -1.43    1.54e- 1\n 4 O4          -0.722      0.549    -1.32    1.88e- 1\n 5 O5          -1.43       0.656    -2.18    2.96e- 2\n 6 C2          -1.24       0.0742  -16.6     3.30e-62\n 7 C3          -2.60       0.130   -19.9     1.61e-88\n 8 O2:C2        0.0105     0.0799    0.131   8.96e- 1\n 9 O3:C2        0.375      0.0734    5.12    3.13e- 7\n10 O4:C2        0.576      0.0716    8.04    8.77e-16\n11 O5:C2       -1.03       0.0790  -13.1     4.41e-39\n12 O2:C3        0.244      0.131     1.87    6.19e- 2\n13 O3:C3       -0.405      0.154    -2.63    8.56e- 3\n14 O4:C3       -0.777      0.189    -4.11    4.00e- 5\n15 O5:C3        0.911      0.219     4.17    3.08e- 5\n16 D2          -0.670      0.161    -4.16    3.18e- 5\n17 D3          -0.922      0.240    -3.84    1.25e- 4\n18 D4          -0.625      0.351    -1.78    7.49e- 2\n19 D5          -2.26       0.545    -4.15    3.31e- 5\n20 C2:D2        0.0189     0.0536    0.354   7.24e- 1\n21 C3:D2        1.21       0.109    11.1     7.17e-29\n22 C2:D3        0.285      0.0491    5.80    6.73e- 9\n23 C3:D3        0.640      0.156     4.10    4.20e- 5\n24 C2:D4        0.539      0.0498   10.8     2.77e-27\n25 C3:D4        0.672      0.216     3.11    1.87e- 3\n26 C2:D5        0.157      0.148     1.06    2.90e- 1\n27 C3:D5        2.31       0.275     8.38    5.22e-17\n28 Diag1        0.247      0.135     1.83    6.76e- 2\n29 Diag2        0.249      0.0715    3.49    4.90e- 4\n30 Diag3        0.361      0.0460    7.85    4.25e-15\n31 Diag4       -0.00158    0.0564   -0.0280  9.78e- 1\n32 Diag5        3.09       0.177    17.5     1.15e-68\n33 C2:Diag1     0.246      0.0917    2.69    7.22e- 3\n34 C3:Diag1     0.332      0.168     1.98    4.80e- 2\n35 C2:Diag2     0.199      0.102     1.95    5.13e- 2\n36 C3:Diag2     0.246      0.128     1.93    5.38e- 2\n37 C2:Diag3     0.130      0.0742    1.75    8.06e- 2\n38 C3:Diag3     0.590      0.140     4.22    2.49e- 5\n39 C2:Diag4    -0.0134     0.0625   -0.214   8.31e- 1\n40 C3:Diag4    -0.0629     0.163    -0.387   6.99e- 1\n41 C2:Diag5     0.893      0.174     5.13    2.89e- 7\n42 C3:Diag5    -0.264      0.219    -1.21    2.28e- 1\n43 D1:U         0.177      0.136     1.30    1.93e- 1\n44 D2:U         0.245      0.118     2.08    3.73e- 2\n45 D3:U         0.442      0.0941    4.70    2.60e- 6\n46 D4:U         0.476      0.0784    6.07    1.28e- 9\n47 D5:U         0         NA        NA      NA       \n48 O1:V        -0.342      0.105    -3.27    1.08e- 3\n49 O2:V        -0.275      0.0678   -4.05    5.05e- 5\n50 O3:V        -0.116      0.0440   -2.63    8.55e- 3\n51 O4:V         0         NA        NA      NA       \n52 O5:V         0         NA        NA      NA       \n53 U:V:C3      -0.0418     0.0178   -2.35    1.88e- 2\n\n# R+C3: Uniform difference between G.B. and U.S."
  },
  {
    "objectID": "11-Replication.html#xie-1992",
    "href": "11-Replication.html#xie-1992",
    "title": "先行研究の再現",
    "section": "Xie (1992)",
    "text": "Xie (1992)\nXie (1992) の結果を再現する．\n\n# Data\nd_xie &lt;- d_yamaguchi\n# 確認\nd_xie\n\n# A tibble: 75 × 11\n   O     D     C      Freq Diag      U     V    C1    C2    C3 SYM  \n   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;\n 1 1     1     1      1275 1         1     1     1     0     0 0    \n 2 1     2     1       364 0         1     2     1     0     0 1    \n 3 1     3     1       274 0         1     3     1     0     0 2    \n 4 1     4     1       272 0         1     4     1     0     0 3    \n 5 1     5     1        17 0         1     5     1     0     0 4    \n 6 2     1     1      1055 0         2     1     1     0     0 1    \n 7 2     2     1       597 2         2     2     1     0     0 0    \n 8 2     3     1       394 0         2     3     1     0     0 5    \n 9 2     4     1       443 0         2     4     1     0     0 6    \n10 2     5     1        31 0         2     5     1     0     0 7    \n# ℹ 65 more rows\n\n\n\n# Off diagonal cells (Diag*C)\n# Null association between R and C, given L\nfit_x_1 &lt;- d_xie |&gt; glm(Freq ~ O*C + D*C + Diag*C, data = _, family = poisson)\nglance(fit_x_1)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -929. 1943. 2040.    1336.          33    75\n\n# R0 Cross-nationally homogeneous row effect association\nfit_x_2 &lt;- d_xie |&gt; glm(Freq ~ O*C + D*C + Diag*C + O:V, data = _, family = poisson)\nglance(fit_x_2)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -339.  771.  877.     156.          29    75\n\n# R1 Cross-nationally uniform row effect association\nfit_x_3 &lt;- d_xie |&gt; glm(Freq ~ O*C + D*C + Diag*C + O:V + U:V*C, data = _, family = poisson)\nglance(fit_x_3)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -335.  766.  878.     148.          27    75\n\n# Rx Cross-nationally log-multiplicative row effect association\nfit_x_4 &lt;- d_xie |&gt; gnm(Freq ~ O*C + D*C + Diag*C + Mult(C,O,V), data = _, family = poisson)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.......\nDone\n\nglance(fit_x_4)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -335.  766.  877.     148.          27    75\n\n# C0-Cross-nationally homogeneous column effect association\nfit_x_5 &lt;- d_xie |&gt; glm(Freq ~ O*C + D*C + Diag*C + U:D, data = _, family = poisson)\nglance(fit_x_5)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -295.  682.  789.     67.7          29    75\n\n# C1-Cross-nationally uniform column effect association\nfit_x_6 &lt;- d_xie |&gt; glm(Freq ~ O*C + D*C + Diag*C + U:D + U:V*C, data = _, family = poisson)\nglance(fit_x_6)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1        34313.      74  -291.  679.  790.     60.3          27    75\n\n# Cx-Cross-nationally log-multiplicative column effect association\nfit_x_7 &lt;- d_xie |&gt; gnm(Freq ~ O*C + D*C + Diag*C + Mult(C,U,D), data = _, family = poisson)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.......\nDone\n\nglance(fit_x_7)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -291.  677.  789.     58.8          27    75\n\n# (R+C) 0 - Cross-nationally homogeneous row and column effects association I\nfit_x_8 &lt;- d_xie |&gt; gnm(Freq ~ O*C + D*C + Diag*C  + O:V + U:D, data = _, family = poisson)\nglance(fit_x_8)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -281.  659.  773.     38.8          26    75\n\n# (R+C) u - Cross-nationally uniform row and column effects association I\nfit_x_9 &lt;- d_xie |&gt; gnm(Freq ~ O*C + D*C + Diag*C  + O:V + U:D + U:V*C, data = _, family = poisson)\nglance(fit_x_9)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -278.  658.  776.     33.3          24    75\n\n# (R+C) x - Cross-nationally log-multiplicative row and column effects association I\nfit_x_10 &lt;- d_xie |&gt; gnm(Freq ~ O*C + D*C + Diag*C + Mult(C,O:V+U:D), data = _, family = poisson)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.......\nDone\n\nglance(fit_x_10)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -278.  658.  776.     33.0          24    75\n\n# RC0 Cross-nationally homogeneous row and column effects association\nfit_x_11 &lt;- d_xie |&gt; gnm(Freq ~ O*C + D*C + Diag*C + Mult(O,D), data = _, family = poisson)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.......\nDone\n\nglance(fit_x_11)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -280.  658.  772.     37.7          26    75\n\n# RCx Cross-nationally log-multiplicative row and column effects association\nfit_x_12 &lt;- d_xie |&gt; gnm(Freq ~ O*C + D*C + Diag*C + Mult(Exp(C),O,D), data = _, family = poisson)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations........\nDone\n\nglance(fit_x_12)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -277.  657.  775.     32.1          24    75\n\n# FI0 Cross-nationally homogeneous full two-way R and C interaction\nfit_x_13 &lt;- d_xie |&gt; gnm(Freq ~ O*C + D*C + Diag*C + Mult(1,O*D), data = _, family = poisson)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations....\nDone\n\nglance(fit_x_13)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -279.  665.  788.     36.2          22    75\n\n# FIu Cross-nationally uniform full two-way R and C interaction\nfit_x_14 &lt;- d_xie |&gt; gnm(Freq ~ O*C + D*C + Diag*C + Mult(1,O*D) + U:V*C, data = _, family = poisson)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.....\nDone\n\nglance(fit_x_14)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -277.  663.  791.     30.7          20    75\n\n# FIx Cross-nationally log-multiplicative full two-way R and C interaction\nfit_x_15 &lt;- d_xie |&gt; gnm(Freq ~ O*C + D*C + Diag*C + Mult(Exp(C),O*D), data = _, family = poisson)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations........\nDone\n\nglance(fit_x_15)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -277.  664.  791.     30.9          20    75\n\n\n\nModel &lt;- c(\"Null association between R and C, given L\",\n           \"R0 Cross-nationally homogeneous row effect association\",\n           \"R1 Cross-nationally uniform row effect association\",\n           \"Rx Cross-nationally log-multiplicative row effect association\",\n           \"C0-Cross-nationally homogeneous column effect association\",\n           \"C1-Cross-nationally uniform column effect association\",\n           \"Cx-Cross-nationally log-multiplicative column effect association\",\n           \"(R+C) 0 - Cross-nationally homogeneous row and column effects association I\",\n           \"(R+C) u - Cross-nationally uniform row and column effects association I\",\n           \"(R+C) x - Cross-nationally log-multiplicative row and column effects association I\",\n           \"RC0 Cross-nationally homogeneous row and column effects association\",\n           \"RCx Cross-nationally log-multiplicative row and column effects association\",\n           \"FI0 Cross-nationally homogeneous full two-way R and C interaction\",\n           \"FIu Cross-nationally uniform full two-way R and C interaction\",\n           \"FIx Cross-nationally log-multiplicative full two-way R and C interaction\")\n\nlist(fit_x_1, fit_x_2, fit_x_3, fit_x_4, fit_x_5, \n     fit_x_6, fit_x_7, fit_x_8, fit_x_9, fit_x_10,\n     fit_x_11, fit_x_12, fit_x_13, fit_x_14, fit_x_15) |&gt; \n  map_dfr(glance) |&gt; \n  mutate(Model = Model, .before = 1) |&gt; \n  dplyr::select(-c(2:3)) |&gt; \n  print(n = Inf)\n\n# A tibble: 15 × 7\n   Model                           logLik   AIC   BIC deviance df.residual  nobs\n   &lt;chr&gt;                            &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n 1 Null association between R and…  -929. 1943. 2040.   1336.           33    75\n 2 R0 Cross-nationally homogeneou…  -339.  771.  877.    156.           29    75\n 3 R1 Cross-nationally uniform ro…  -335.  766.  878.    148.           27    75\n 4 Rx Cross-nationally log-multip…  -335.  766.  877.    148.           27    75\n 5 C0-Cross-nationally homogeneou…  -295.  682.  789.     67.7          29    75\n 6 C1-Cross-nationally uniform co…  -291.  679.  790.     60.3          27    75\n 7 Cx-Cross-nationally log-multip…  -291.  677.  789.     58.8          27    75\n 8 (R+C) 0 - Cross-nationally hom…  -281.  659.  773.     38.8          26    75\n 9 (R+C) u - Cross-nationally uni…  -278.  658.  776.     33.3          24    75\n10 (R+C) x - Cross-nationally log…  -278.  658.  776.     33.0          24    75\n11 RC0 Cross-nationally homogeneo…  -280.  658.  772.     37.7          26    75\n12 RCx Cross-nationally log-multi…  -277.  657.  775.     32.1          24    75\n13 FI0 Cross-nationally homogeneo…  -279.  665.  788.     36.2          22    75\n14 FIu Cross-nationally uniform f…  -277.  663.  791.     30.7          20    75\n15 FIx Cross-nationally log-multi…  -277.  664.  791.     30.9          20    75"
  },
  {
    "objectID": "11-Replication.html#参考文献",
    "href": "11-Replication.html#参考文献",
    "title": "先行研究の再現",
    "section": "参考文献",
    "text": "参考文献\n\n\n\n\n\n\nDuncan, Otis Dudley. 1979. “How Destination Depends on Origin in the Occupational Mobility Table.” The American Journal of Sociology 84 (4): 793–803. https://www.jstor.org/stable/2778024.\n\n\nXie, Yu. 1992. “The Log-Multiplicative Layer Effect Model for Comparing Mobility Tables.” American Sociological Review 57 (3): 380–95. https://doi.org/10.2307/2096242.\n\n\nYamaguchi, Kazuo. 1987. “Models for Comparing Mobility Tables: Toward Parsimony and Substance.” American Sociological Review 52 (4): 482–94. https://doi.org/10.2307/2095293."
  },
  {
    "objectID": "12-Review.html#因果推論",
    "href": "12-Review.html#因果推論",
    "title": "研究の動向",
    "section": "因果推論",
    "text": "因果推論\n\nYamaguchi (2012)\nKuha and Goldthorpe (2010)"
  },
  {
    "objectID": "12-Review.html#オッズ比",
    "href": "12-Review.html#オッズ比",
    "title": "研究の動向",
    "section": "オッズ比",
    "text": "オッズ比\n\nKarlson and Jann (2023)"
  },
  {
    "objectID": "12-Review.html#限界効果",
    "href": "12-Review.html#限界効果",
    "title": "研究の動向",
    "section": "限界効果",
    "text": "限界効果\n\nMize (2019)"
  },
  {
    "objectID": "12-Review.html#対応分析との関係",
    "href": "12-Review.html#対応分析との関係",
    "title": "研究の動向",
    "section": "対応分析との関係",
    "text": "対応分析との関係\n\nvan der Heijden and de Leeuw (1985)\nvan der Heijden and Worsley (1988)\n\n\n\n\n\n\n\nBouchet-Valat, Milan. 2022. “General Marginal-free Association Indices for Contingency Tables: From the Altham Index to the Intrinsic Association Coefficient.” Sociological Methods & Research 51 (1): 203–36. https://doi.org/10.1177/0049124119852389.\n\n\nBreen, Richard. 2010. “Educational Expansion and Social Mobility in the 20th Century.” Social Forces 89 (2): 365–88. https://doi.org/10.1353/sof.2010.0076.\n\n\nDuncan, Otis Dudley. 1979. “How Destination Depends on Origin in the Occupational Mobility Table.” The American Journal of Sociology 84 (4): 793–803. https://www.jstor.org/stable/2778024.\n\n\nErikson, Robert, and John H. Goldthorpe. 1992. The Constant Flux: A Study of Class Mobility in Industrial Societies. Oxford: Clarendon.\n\n\nHout, Michael. 1984. “Occupational Mobility of Black Men: 1962 to 1973.” American Sociological Review 49 (3): 308. https://doi.org/10.2307/2095276.\n\n\n———. 1988. “More Universalism, Less Structural Mobility: The American Occupational Structure in the 1980s.” American Journal of Sociology 93 (6): 1358–1400. https://doi.org/10.1086/228904.\n\n\nKarlson, Kristian, and Ben Jann. 2023. “Marginal Odds Ratios: What They Are, How to Compute Them, and Why Sociologists Might Want to Use Them.” Sociological Science 10: 332–47. https://doi.org/10.15195/v10.a10.\n\n\nKuha, Jouni, and John H. Goldthorpe. 2010. “Path Analysis for Discrete Variables: The Role of Education in Social Mobility.” Journal of the Royal Statistical Society Series A: Statistics in Society 173 (2): 351–69. https://doi.org/10.1111/j.1467-985X.2009.00620.x.\n\n\nMize, Trenton. 2019. “Best Practices for Estimating, Interpreting, and Presenting Nonlinear Interaction Effects.” Sociological Science 6: 81–117. https://doi.org/10.15195/v6.a4.\n\n\nPfeffer, Fabian T., and Florian R. Hertel. 2015. “How Has Educational Expansion Shaped Social Mobility Trends in the United States?” Social Forces 94 (1): 143–80. https://doi.org/10.1093/sf/sov045.\n\n\nSobel, Michael E., Mark P. Becker, and Susan M. Minick. 1998. “Origins, Destinations, and Association in Occupational Mobility.” The American Journal of Sociology 104 (3): 687–721. https://www.jstor.org/stable/2990885.\n\n\nSobel, Michael E., Michael Hout, and Otis Dudley Duncan. 1985. “Exchange, Structure, and Symmetry in Occupational Mobility.” American Journal of Sociology 91 (2): 359–72. https://www.jstor.org/stable/2779763.\n\n\nvan der Heijden, Peter G. M., and Jan de Leeuw. 1985. “Correspondence Analysis Used Complementary to Loglinear Analysis.” Psychometrika 50 (4): 429–47. https://doi.org/10.1007/BF02296262.\n\n\nvan der Heijden, Peter G. M., and Keith J. Worsley. 1988. “Comment on ‘Correspondence Analysis Used Complementary to Loglinear Analysis’.” Psychometrika 53 (2): 287–91. https://doi.org/10.1007/BF02294139.\n\n\nWong, Raymond Sin-Kwok. 1990. “Understanding Cross-National Variation in Occupational Mobility.” American Sociological Review 55 (4): 560. https://doi.org/10.2307/2095807.\n\n\nXie, Yu. 1992. “The Log-Multiplicative Layer Effect Model for Comparing Mobility Tables.” American Sociological Review 57 (3): 380–95. https://doi.org/10.2307/2096242.\n\n\nYamaguchi, Kazuo. 1987. “Models for Comparing Mobility Tables: Toward Parsimony and Substance.” American Sociological Review 52 (4): 482–94. https://doi.org/10.2307/2095293.\n\n\n———. 2012. “Log-Linear Causal Analysis of Cross-classified Categorical Data.” Sociological Methodology 42 (1): 257–85. https://doi.org/10.1177/0081175012460661.\n\n\nZhou, Xiang. 2015. “Shrinkage Estimation of Log-odds Ratios for Comparing Mobility Tables.” Sociological Methodology 45 (1): 320–56. https://doi.org/10.1177/0081175015570097."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "『カテゴリカルデータの連関モデル』",
    "section": "",
    "text": "はじめに"
  },
  {
    "objectID": "index.html#目的",
    "href": "index.html#目的",
    "title": "『カテゴリカルデータの連関モデル』",
    "section": "目的",
    "text": "目的\nこのページは共立出版の「計量分析One Point」シリーズのひとつとして出版された\nRaymond Wong著・藤原翔訳．2023．『カテゴリカルデータの連関モデル』共立出版． のためのサポートページです．\n2023年11月29日販売\n\n\n大学図書館\nhonto\n紀伊国屋書店ウェブストア\nTSUTAYAオンラインショッピング\n楽天ブックス\nAmazon\n\n本書の付録や補遺とすることも検討しましたが，Association Modelsは他のQuantitative Applications in the Social Sciences (QASS)に比べて分量が多いため（156ページ！），そしてRのバージョンアップやパッケージの更新などに備えるため，正誤表もあわせて公開するためにオンラインで公開することにしました．本書と関連した連関モデルの適用例の情報についても，このサポートページで補うことができればと思います．\nこのサポートページでは，特にRの基本的な操作方法と，Rを用いた連関分析の方法を紹介します．各章ごとにRの実行方法をまとめています．モデルの意味や結果の解釈などについては本書を参考にしてください．\nなおこのサポートページの内容は英語版のサポートページ が元になっています．そちらもぜひ参考にしてください．lem は Jeroen K. Vermunt教授のホームページからダウンロードできます．"
  },
  {
    "objectID": "index.html#構成",
    "href": "index.html#構成",
    "title": "『カテゴリカルデータの連関モデル』",
    "section": "構成",
    "text": "構成\nまず，シリーズ編者による内容紹介，第1章から第6章までをできるだけ再現することを試みます．現在のRのgnmパッケージだけではできないことも部分的にはあります．またそれ以外にも自由度や関連した先行研究の再現 （Duncan (1979), Yamaguchi (1987)，Xie (1992)）などを行います． 他の対数線形モデルや対数乗法モデルについての最近の動向についてもアップデートしていきます．"
  },
  {
    "objectID": "index.html#rのスクリプト",
    "href": "index.html#rのスクリプト",
    "title": "『カテゴリカルデータの連関モデル』",
    "section": "Rのスクリプト",
    "text": "Rのスクリプト\n本サポートページのスクリプトはそのままコピー・アンド・ペーストすることが可能です． スクリプトを選択してコピーしても良いですし，各スクリプトの右上の図をクリックしてもコピーされます．\n\nなおRのスクリプトについては 訳者のGitHubページ の scripts というフォルダに保存されているので，そちらを参照してください．Googleドライブにもスクリプトを保存しておきます．"
  },
  {
    "objectID": "index.html#正誤表",
    "href": "index.html#正誤表",
    "title": "『カテゴリカルデータの連関モデル』",
    "section": "正誤表",
    "text": "正誤表\n\n原著 p. 133，Table 5.5，訳書 p. XX 表5.5のモデル1の\\(\\Delta\\)の値は3.85ではなく33.85です．（2023年11月7日）"
  },
  {
    "objectID": "index.html#サポートページバージョン情報",
    "href": "index.html#サポートページバージョン情報",
    "title": "『カテゴリカルデータの連関モデル』",
    "section": "サポートページバージョン情報",
    "text": "サポートページバージョン情報\nversion 1になるにはもう少し時間がかかります．\n\n2023年5月1日: version 0.1.\n2023年11月7日: version 0.2."
  },
  {
    "objectID": "12-Review.html#sat-model",
    "href": "12-Review.html#sat-model",
    "title": "研究の動向",
    "section": "SAT Model",
    "text": "SAT Model\n\nHout (1984)\nHout (1988)"
  },
  {
    "objectID": "12-Review.html#sdh-model",
    "href": "12-Review.html#sdh-model",
    "title": "研究の動向",
    "section": "SDH Model",
    "text": "SDH Model\n\nSobel, Hout, and Duncan (1985)\nSobel, Becker, and Minick (1998)"
  },
  {
    "objectID": "12-Review.html#unififf",
    "href": "12-Review.html#unififf",
    "title": "研究の動向",
    "section": "Unififf",
    "text": "Unififf\n\nErikson and Goldthorpe (1992)\nXie (1992)"
  },
  {
    "objectID": "12-Review.html#uniform-association",
    "href": "12-Review.html#uniform-association",
    "title": "研究の動向",
    "section": "Uniform Association",
    "text": "Uniform Association\n\nDuncan (1979)"
  },
  {
    "objectID": "12-Review.html#sat-status-autonomy-training-model",
    "href": "12-Review.html#sat-status-autonomy-training-model",
    "title": "研究の動向",
    "section": "SAT (Status-Autonomy-Training) Model",
    "text": "SAT (Status-Autonomy-Training) Model\n\nHout (1984)\nHout (1988)"
  },
  {
    "objectID": "12-Review.html#shd-sobel-hout-duncan-model",
    "href": "12-Review.html#shd-sobel-hout-duncan-model",
    "title": "研究の動向",
    "section": "SHD (Sobel-Hout-Duncan) Model",
    "text": "SHD (Sobel-Hout-Duncan) Model\n\nSobel, Hout, and Duncan (1985)\nSobel, Becker, and Minick (1998)"
  },
  {
    "objectID": "12-Review.html#log-linear-uniform-difference-model",
    "href": "12-Review.html#log-linear-uniform-difference-model",
    "title": "研究の動向",
    "section": "log-linear uniform difference model",
    "text": "log-linear uniform difference model\n\nYamaguchi (1987)\nWong (1990)"
  },
  {
    "objectID": "12-Review.html#simulation",
    "href": "12-Review.html#simulation",
    "title": "研究の動向",
    "section": "Simulation",
    "text": "Simulation\n\nBreen (2010)\nPfeffer and Hertel (2015)"
  },
  {
    "objectID": "12-Review.html#連関係数",
    "href": "12-Review.html#連関係数",
    "title": "研究の動向",
    "section": "連関係数",
    "text": "連関係数\n\nBouchet-Valat (2022)\nZhou (2015)"
  },
  {
    "objectID": "2-Chapter_1.html#クラメールのv",
    "href": "2-Chapter_1.html#クラメールのv",
    "title": "1  第1章",
    "section": "1.1 クラメールのV",
    "text": "1.1 クラメールのV\nクラメールの\\(V\\)も連関の強さをみる指標であり，次のように定義される．\n\\[\\begin{equation}\nV = \\sqrt{\\frac{\\chi^2/n}{{\\rm min}(I-1,J-1)}}\n\\end{equation}\\]\n\\({\\rm min}(I-1,J-1)\\)は括弧内の最小の値であり，\\({\\rm min}(I,J)-1\\)と考えても良い． 値の取りうる範囲は\\[0 \\leq V \\leq 1\\]となり，値が大きいほど2つの変数の連関は強いといえる．\nではクラメールのVを自分で求めてみよう．chisq.test(tab)$statisticでカイ2乗値を取り出すことができるが， 名前がついているのでunname関数で取り除く．as.numericとしても取り除くことができる．\n\ntab\n\n   MHS\nSES well mild modelrate impared\n  A   64   94        58      46\n  B   57   94        54      40\n  C   57  105        65      60\n  D   72  141        77      94\n  E   36   97        54      78\n  F   21   71        54      71\n\nX2 &lt;- chisq.test(tab)$statistic |&gt; unname()   # あるいはas.numeric()\nV &lt;- sqrt(X2/sum(tab)/(min(dim(tab)) - 1))\nV\n\n[1] 0.09609364\n\n\ntabの2行目を10倍，1列目を10倍したデータを考える．これをtab10とする．\n\ntab10 &lt;- tab\ntab10[,1] &lt;- tab10[,1]*10\ntab10[2,] &lt;- tab10[2,]*10\ntab\n\n   MHS\nSES well mild modelrate impared\n  A   64   94        58      46\n  B   57   94        54      40\n  C   57  105        65      60\n  D   72  141        77      94\n  E   36   97        54      78\n  F   21   71        54      71\n\ntab10\n\n   MHS\nSES well mild modelrate impared\n  A  640   94        58      46\n  B 5700  940       540     400\n  C  570  105        65      60\n  D  720  141        77      94\n  E  360   97        54      78\n  F  210   71        54      71\n\n\nこの2つの表について先程の連関係数の値を確認すると，すべての係数について表によって値が異なる．\n\nDescTools::CramerV(tab)\n\n[1] 0.09609364\n\nDescTools::CramerV(tab10)\n\n[1] 0.08200758\n\nDescTools::GoodmanKruskalTau(tab)\n\n[1] 0.004913157\n\nDescTools::GoodmanKruskalTau(tab10)\n\n[1] 0.00498861\n\nDescTools::KendallTauB(tab)\n\n[1] 0.1202322\n\nDescTools::KendallTauB(tab10)\n\n[1] 0.0933437\n\nDescTools::StuartTauC(tab)\n\n[1] 0.124738\n\nDescTools::StuartTauC(tab10)\n\n[1] 0.05978172\n\nDescTools::GoodmanKruskalGamma(tab)\n\n[1] 0.1542894\n\nDescTools::GoodmanKruskalGamma(tab10)\n\n[1] 0.1840237\n\nDescTools::SomersDelta(tab)\n\n[1] 0.1278381\n\nDescTools::SomersDelta(tab10)\n\n[1] 0.1015444\n\nDescTools::UncertCoef(tab)\n\n[1] 0.009135369\n\nDescTools::UncertCoef(tab10)\n\n[1] 0.008655116\n\n\nオッズ比に基づく尺度では表によって値は異ならない． Bouchet-Valat (2022) や Zhou (2015) を参照．\n\n# 2つの表をマージしたデータも作成\ntab_merge &lt;- dplyr::bind_rows(data.frame(as.table(tab)),\n                       data.frame(as.table(tab10)),\n         .id = \"Tab\") |&gt; \n  xtabs(Freq ~ SES + MHS + Tab, data = _)\ntab_merge\n\n, , Tab = 1\n\n   MHS\nSES well mild modelrate impared\n  A   64   94        58      46\n  B   57   94        54      40\n  C   57  105        65      60\n  D   72  141        77      94\n  E   36   97        54      78\n  F   21   71        54      71\n\n, , Tab = 2\n\n   MHS\nSES well mild modelrate impared\n  A  640   94        58      46\n  B 5700  940       540     400\n  C  570  105        65      60\n  D  720  141        77      94\n  E  360   97        54      78\n  F  210   71        54      71\n\n# intrinsic association coefficient\nlogmult::iac(tab, weighting = \"none\")\n\n[1] 1.022284\n\nlogmult::iac(tab10, weighting = \"none\")\n\n[1] 1.022284\n\nlogmult::iac(tab_merge, weighting = \"none\")\n\n       1        2 \n1.022284 1.022284 \n\n# Altham index\nlogmult::iac(tab, weighting = \"none\") * sqrt(nrow(tab) * ncol(tab)) * 2\n\n[1] 10.01629\n\nlogmult::iac(tab10, weighting = \"none\") * sqrt(nrow(tab) * ncol(tab)) * 2\n\n[1] 10.01629\n\nlogmult::iac(tab_merge, weighting = \"none\") * sqrt(nrow(tab) * ncol(tab)) * 2\n\n       1        2 \n10.01629 10.01629 \n\n# Shrinkage Estimation\nlogmult::iac(tab_merge, \n             weighting = \"none\", \n             shrink=TRUE) * sqrt(nrow(tab_merge) * ncol(tab_merge)) * 2 * 2\n\n       1        2 \n20.03259 20.03259 \n\n# Mean absolute odds ratio\nlogmult::maor(tab, weighting = \"uniform\")\n\n[1] 1.695377\n\nlogmult::maor(tab10, weighting = \"uniform\")\n\n[1] 1.695377\n\nlogmult::maor(tab_merge, weighting = \"uniform\")\n\n       1        2 \n1.695377 1.695377 \n\n\nただし周辺重み付けをすれば値は異なる場合もある．\n\n# intrinsic association coefficient\nlogmult::iac(tab, weighting = \"marginal\")\n\n[1] 0.1773414\n\nlogmult::iac(tab10, weighting = \"marginal\")\n\n[1] 0.1182336\n\n# Mean absolute odds ratio\nlogmult::maor(tab, weighting = \"marginal\")\n\n[1] 1.577478\n\nlogmult::maor(tab10, weighting = \"marginal\")\n\n[1] 1.636068"
  },
  {
    "objectID": "2-Chapter_1.html#練習問題",
    "href": "2-Chapter_1.html#練習問題",
    "title": "1  第1章",
    "section": "練習問題",
    "text": "練習問題\noccupationalStatus"
  },
  {
    "objectID": "2-Chapter_1.html#参考文献",
    "href": "2-Chapter_1.html#参考文献",
    "title": "1  第1章",
    "section": "参考文献",
    "text": "参考文献\n\n\n\n\n\n\nBouchet-Valat, Milan. 2022. “General Marginal-free Association Indices for Contingency Tables: From the Altham Index to the Intrinsic Association Coefficient.” Sociological Methods & Research 51 (1): 203–36. https://doi.org/10.1177/0049124119852389.\n\n\nZhou, Xiang. 2015. “Shrinkage Estimation of Log-odds Ratios for Comparing Mobility Tables.” Sociological Methodology 45 (1): 320–56. https://doi.org/10.1177/0081175015570097."
  },
  {
    "objectID": "index.html#文献",
    "href": "index.html#文献",
    "title": "『カテゴリカルデータの連関モデル』",
    "section": "文献",
    "text": "文献\n\n\n\n\n\n\nDuncan, Otis Dudley. 1979. “How Destination Depends on Origin in the Occupational Mobility Table.” The American Journal of Sociology 84 (4): 793–803. https://www.jstor.org/stable/2778024.\n\n\nXie, Yu. 1992. “The Log-Multiplicative Layer Effect Model for Comparing Mobility Tables.” American Sociological Review 57 (3): 380–95. https://doi.org/10.2307/2096242.\n\n\nYamaguchi, Kazuo. 1987. “Models for Comparing Mobility Tables: Toward Parsimony and Substance.” American Sociological Review 52 (4): 482–94. https://doi.org/10.2307/2095293."
  },
  {
    "objectID": "3-Chapter_2.html#対比について",
    "href": "3-Chapter_2.html#対比について",
    "title": "2  第2章",
    "section": "2.1 対比について",
    "text": "2.1 対比について\n回帰モデルにおけるカテゴリカル変数の係数を解釈する上では対比 （contrasts）が重要である．まずはモデルを推定できるようになることのほうが重要なので， ひとまずとばして次の Section 2.2 から読みすすめてもよい．\nまず，デフォルト（標準の状態）でのcontrastsを確認したい．factor変数についてはcontr.treatment，ordered変数についてはcontr.polyという対比が用いられている．contr.treatmentは基準となっている水準とそれぞれの水準を対比する．これはダミーコーディングと呼ばれる． contr.polyは直交多項式（orthogonal polynomials）に基づいた対比を行う（気にしなくてよい）．\n\n# デフォルトのcontrastsを確認\noptions(\"contrasts\")\n\n$contrasts\n        unordered           ordered \n\"contr.treatment\"      \"contr.poly\" \n\n\n\n# defaultのcontrastsの設定（ここでは特に意味はない．constrastをいじった後にデフォルトに戻す）\noptions(contrasts = c(factor = \"contr.treatment\", \n                      ordered = \"contr.poly\"))\n\n具体的に何をしているのかを以下のプログラムで確認する． ダミーコーディングのcontr.treatment以外にも効果コーディングのcontr.sumがある．まずは両者を比較してみたい．\n\n# データの作成\nx &lt;- c(\"A\",\"B\",\"C\",\"D\",\"E\")\n# 確認\nx\n\n[1] \"A\" \"B\" \"C\" \"D\" \"E\"\n\n# 基準カテゴリが0となるような対比\ncontr.treatment(x)\n\n  B C D E\nA 0 0 0 0\nB 1 0 0 0\nC 0 1 0 0\nD 0 0 1 0\nE 0 0 0 1\n\n# 合計が0となるような対比\ncontr.sum(x)\n\n  [,1] [,2] [,3] [,4]\nA    1    0    0    0\nB    0    1    0    0\nC    0    0    1    0\nD    0    0    0    1\nE   -1   -1   -1   -1\n\n\n実際に回帰分析を例にcontr.treatmentとcontr.sumの違いを確認する．データはforcatsパッケージ（tidyverseに含まれる）のgss_cat（A sample of categorical variables from the General Social survey）である．従属変数はtvhours（hours per day watching tv）であり，独立変数はmarital（marital status）とする．\n\n# class別のtvhoursの平均値\ngss_cat |&gt; \n  dplyr::summarise(n = sum(!is.na(tvhours)),\n                   Mean = mean(tvhours, na.rm = TRUE),\n                   .by = marital) |&gt; \n  mutate(Diff_1 = Mean - Mean[marital == \"Never married\"],\n         Diff_2 = Mean - mean(Mean))\n\n# A tibble: 6 × 5\n  marital           n  Mean  Diff_1  Diff_2\n  &lt;fct&gt;         &lt;int&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;\n1 Never married  2995  3.11  0      -0.0379\n2 Divorced       1768  3.09 -0.0198 -0.0576\n3 Widowed        1000  3.91  0.807   0.769 \n4 Married        5172  2.65 -0.455  -0.493 \n5 Separated       393  3.55  0.444   0.407 \n6 No answer         9  2.56 -0.550  -0.587 \n\n\n水準はlevels関数で確認できる．1つ目の水準はNo answerであり，最後の水準はMarriedである．\n\n# 水準の確認\ngss_cat$marital |&gt; levels()\n\n[1] \"No answer\"     \"Never married\" \"Separated\"     \"Divorced\"     \n[5] \"Widowed\"       \"Married\"      \n\n\nまずダミーコーディング（dummy coding）の結果を確認する．\n\n# 回帰分析の例（contr.treatmentを使用）\noptions(contrasts = c(factor = \"contr.treatment\", \n                      ordered = \"contr.poly\"))\n# 回帰分析\nfit_ct &lt;- lm(tvhours ~ marital, data = gss_cat)\n# 回帰分析の結果\nsummary(fit_ct)\n\n\nCall:\nlm(formula = tvhours ~ marital, data = gss_cat)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.9120 -1.6504 -0.6504  0.8948 21.3496 \n\nCoefficients:\n                     Estimate Std. Error t value Pr(&gt;|t|)   \n(Intercept)           2.55556    0.85328   2.995  0.00275 **\nmaritalNever married  0.54962    0.85456   0.643  0.52013   \nmaritalSeparated      0.99406    0.86300   1.152  0.24940   \nmaritalDivorced       0.52985    0.85545   0.619  0.53568   \nmaritalWidowed        1.35644    0.85711   1.583  0.11355   \nmaritalMarried        0.09487    0.85402   0.111  0.91155   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.56 on 11331 degrees of freedom\n  (10146 observations deleted due to missingness)\nMultiple R-squared:  0.02143,   Adjusted R-squared:  0.021 \nF-statistic: 49.63 on 5 and 11331 DF,  p-value: &lt; 2.2e-16\n\n# 回帰分析の係数をtidyで表示\ntidy(fit_ct, conf.int = TRUE)\n\n# A tibble: 6 × 7\n  term                 estimate std.error statistic p.value conf.low conf.high\n  &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1 (Intercept)            2.56       0.853     2.99  0.00275    0.883      4.23\n2 maritalNever married   0.550      0.855     0.643 0.520     -1.13       2.22\n3 maritalSeparated       0.994      0.863     1.15  0.249     -0.698      2.69\n4 maritalDivorced        0.530      0.855     0.619 0.536     -1.15       2.21\n5 maritalWidowed         1.36       0.857     1.58  0.114     -0.324      3.04\n6 maritalMarried         0.0949     0.854     0.111 0.912     -1.58       1.77\n\n# モデルマトリックス\nmodel.matrix(fit_ct) |&gt; unique()\n\n     (Intercept) maritalNever married maritalSeparated maritalDivorced\n1              1                    1                0               0\n3              1                    0                0               0\n5              1                    0                0               1\n9              1                    0                0               0\n88             1                    0                1               0\n1546           1                    0                0               0\n     maritalWidowed maritalMarried\n1                 0              0\n3                 1              0\n5                 0              0\n9                 0              1\n88                0              0\n1546              0              0\n\n\n出力される係数は5つである．maritalはfactorによって水準が設定されているわけではないので，No answerが基準カテゴリとなっており，出力からは省略されている．つまり，No answerの係数は0であり，(Intercept)の値はNo answerの平均値を示している．\n次に効果コーディングの結果を確認する．\n\n# 回帰分析の例（contr.sumを使用）\noptions(contrasts = c(factor = \"contr.sum\", \n                      ordered = \"contr.poly\"))\n# 回帰分析\nfit_cs &lt;- lm(tvhours ~ marital, data = gss_cat)\n# 回帰分析の結果\nsummary(fit_cs)\n\n\nCall:\nlm(formula = tvhours ~ marital, data = gss_cat)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.9120 -1.6504 -0.6504  0.8948 21.3496 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  3.14303    0.14515  21.654  &lt; 2e-16 ***\nmarital1    -0.58747    0.71166  -0.825   0.4091    \nmarital2    -0.03786    0.15009  -0.252   0.8009    \nmarital3     0.40659    0.17940   2.266   0.0234 *  \nmarital4    -0.05762    0.15343  -0.376   0.7072    \nmarital5     0.76897    0.15949   4.821 1.44e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.56 on 11331 degrees of freedom\n  (10146 observations deleted due to missingness)\nMultiple R-squared:  0.02143,   Adjusted R-squared:  0.021 \nF-statistic: 49.63 on 5 and 11331 DF,  p-value: &lt; 2.2e-16\n\n# 回帰分析の係数をtidyで表示\ntidy(fit_cs, conf.int = TRUE)\n\n# A tibble: 6 × 7\n  term        estimate std.error statistic   p.value conf.low conf.high\n  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1 (Intercept)   3.14       0.145    21.7   6.45e-102   2.86       3.43 \n2 marital1     -0.587      0.712    -0.825 4.09e-  1  -1.98       0.808\n3 marital2     -0.0379     0.150    -0.252 8.01e-  1  -0.332      0.256\n4 marital3      0.407      0.179     2.27  2.34e-  2   0.0549     0.758\n5 marital4     -0.0576     0.153    -0.376 7.07e-  1  -0.358      0.243\n6 marital5      0.769      0.159     4.82  1.44e-  6   0.456      1.08 \n\n# モデルマトリックス\nmodel.matrix(fit_cs) |&gt; unique()\n\n     (Intercept) marital1 marital2 marital3 marital4 marital5\n1              1        0        1        0        0        0\n3              1        0        0        0        0        1\n5              1        0        0        0        1        0\n9              1       -1       -1       -1       -1       -1\n88             1        0        0        1        0        0\n1546           1        1        0        0        0        0\n\n\nここでも出力される係数は5つであるが，ここでは最後のカテゴリであるMarriedが省略されている．しかし，最後のカテゴリであるMarriedの係数は0ではない．すべての係数の和が0になるという制約を与えているので，Marriedの係数は他の係数の値の和を0から引いたものとなる．\n\n# classという文字が含まれる係数を取り出し，係数の番号を調べる（2から6）\npickCoef(fit_cs, \"marital\")\n\nmarital1 marital2 marital3 marital4 marital5 \n       2        3        4        5        6 \n\n# 係数の2から6までを取り出し，その和を求める．\nfit_cs$coefficients[2:6] |&gt; sum()\n\n[1] 0.4926049\n\n# 直接次のようにしても良い．\nfit_cs$coefficients[pickCoef(fit_cs, \"marital\")] |&gt; sum()\n\n[1] 0.4926049\n\n# 和を0から引く\n0 - (fit_cs$coefficients[2:6] |&gt; sum())\n\n[1] -0.4926049\n\n\nしたがって，Marriedの係数は-0.4926049となる．\ncontrastsの設定を変更して分析を終えたら必ずもとに戻しておく．\n\n# デフォルトに戻す\noptions(contrasts = c(factor = \"contr.treatment\", ordered = \"contr.poly\"))\n# contrastsを確認\noptions(\"contrasts\")\n\n$contrasts\n           factor           ordered \n\"contr.treatment\"      \"contr.poly\" \n\n\nlmではモデルの中でcontrastsを指定することもできる．2つの方法で係数を比較してみる．\n\n# 回帰分析\nfit_cs2_1 &lt;- lm(tvhours ~ marital, data = gss_cat)\n# 回帰分析の結果\nsummary(fit_cs2_1)\n\n\nCall:\nlm(formula = tvhours ~ marital, data = gss_cat)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.9120 -1.6504 -0.6504  0.8948 21.3496 \n\nCoefficients:\n                     Estimate Std. Error t value Pr(&gt;|t|)   \n(Intercept)           2.55556    0.85328   2.995  0.00275 **\nmaritalNever married  0.54962    0.85456   0.643  0.52013   \nmaritalSeparated      0.99406    0.86300   1.152  0.24940   \nmaritalDivorced       0.52985    0.85545   0.619  0.53568   \nmaritalWidowed        1.35644    0.85711   1.583  0.11355   \nmaritalMarried        0.09487    0.85402   0.111  0.91155   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.56 on 11331 degrees of freedom\n  (10146 observations deleted due to missingness)\nMultiple R-squared:  0.02143,   Adjusted R-squared:  0.021 \nF-statistic: 49.63 on 5 and 11331 DF,  p-value: &lt; 2.2e-16\n\n# 回帰分析の係数をtidyで表示\ntidy(fit_cs2_1, conf.int = TRUE)\n\n# A tibble: 6 × 7\n  term                 estimate std.error statistic p.value conf.low conf.high\n  &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1 (Intercept)            2.56       0.853     2.99  0.00275    0.883      4.23\n2 maritalNever married   0.550      0.855     0.643 0.520     -1.13       2.22\n3 maritalSeparated       0.994      0.863     1.15  0.249     -0.698      2.69\n4 maritalDivorced        0.530      0.855     0.619 0.536     -1.15       2.21\n5 maritalWidowed         1.36       0.857     1.58  0.114     -0.324      3.04\n6 maritalMarried         0.0949     0.854     0.111 0.912     -1.58       1.77\n\n# 回帰分析\nfit_cs2_2 &lt;- lm(tvhours ~ marital, data = gss_cat,\n              contrasts = list(marital = \"contr.sum\"))\n# 回帰分析の結果\nsummary(fit_cs2_2)\n\n\nCall:\nlm(formula = tvhours ~ marital, data = gss_cat, contrasts = list(marital = \"contr.sum\"))\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.9120 -1.6504 -0.6504  0.8948 21.3496 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  3.14303    0.14515  21.654  &lt; 2e-16 ***\nmarital1    -0.58747    0.71166  -0.825   0.4091    \nmarital2    -0.03786    0.15009  -0.252   0.8009    \nmarital3     0.40659    0.17940   2.266   0.0234 *  \nmarital4    -0.05762    0.15343  -0.376   0.7072    \nmarital5     0.76897    0.15949   4.821 1.44e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.56 on 11331 degrees of freedom\n  (10146 observations deleted due to missingness)\nMultiple R-squared:  0.02143,   Adjusted R-squared:  0.021 \nF-statistic: 49.63 on 5 and 11331 DF,  p-value: &lt; 2.2e-16\n\n# 回帰分析の係数をtidyで表示\ntidy(fit_cs2_2)\n\n# A tibble: 6 × 5\n  term        estimate std.error statistic   p.value\n  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;\n1 (Intercept)   3.14       0.145    21.7   6.45e-102\n2 marital1     -0.587      0.712    -0.825 4.09e-  1\n3 marital2     -0.0379     0.150    -0.252 8.01e-  1\n4 marital3      0.407      0.179     2.27  2.34e-  2\n5 marital4     -0.0576     0.153    -0.376 7.07e-  1\n6 marital5      0.769      0.159     4.82  1.44e-  6\n\n\nでは結果を図にしてみる．\n\n# termのカテゴリ名を変換し，最後に`No answer`の行を加える．\nest_ct &lt;- fit_ct |&gt; \n  tidy(conf.int = TRUE) |&gt;   # 回帰分析の係数をtidyで表示し，信頼区間もつける\n  mutate(term = case_when(\n    grepl(\"Never\", term) ~ \"Never married\",\n    grepl(\"Separated\", term) ~ \"Separated\",\n    grepl(\"Divorced\", term) ~ \"Divorced\",\n    grepl(\"Widowed\", term) ~ \"Widowed\",\n    grepl(\"Married\", term) ~ \"Married\",\n    .default = term\n  )) |&gt; \n  add_row(term = \"No answer\", estimate = 0)\nest_ct\n\n# A tibble: 7 × 7\n  term          estimate std.error statistic  p.value conf.low conf.high\n  &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1 (Intercept)     2.56       0.853     2.99   0.00275    0.883      4.23\n2 Never married   0.550      0.855     0.643  0.520     -1.13       2.22\n3 Separated       0.994      0.863     1.15   0.249     -0.698      2.69\n4 Divorced        0.530      0.855     0.619  0.536     -1.15       2.21\n5 Widowed         1.36       0.857     1.58   0.114     -0.324      3.04\n6 Married         0.0949     0.854     0.111  0.912     -1.58       1.77\n7 No answer       0         NA        NA     NA         NA         NA   \n\n# 結果を図示する．\nfig_ct &lt;- est_ct |&gt; \n  ggplot(aes(x = term,\n             y = estimate,\n             ymin = conf.low,\n             ymax = conf.high)) + \n  geom_pointrange() + \n  theme_minimal()\nfig_ct\n\nWarning: Removed 1 rows containing missing values (`geom_segment()`).\n\n\n\n\n# termのカテゴリ名を変換し，最後に`Married`の行を加える．\nest_cs &lt;- fit_cs |&gt; \n  tidy(conf.int = TRUE) |&gt; \n  mutate(term = case_match(term,\n                           \"marital1\" ~ \"No answer\",\n                           \"marital2\" ~ \"Never married\",\n                           \"marital3\" ~ \"Separated\",\n                           \"marital4\" ~ \"Divorced\",\n                           \"marital5\" ~ \"Widowed\",\n                           \"marital6\" ~ \"Married\",\n                           .default = term)) |&gt; \n  add_row(term = \"Married\", \n          estimate = 0 - (fit_cs$coefficients[2:6] |&gt; sum()))\n\n# 結果を図示する．\nfit_cs &lt;- est_cs |&gt; \n  ggplot(aes(x = term,\n             y = estimate,\n             ymin = conf.low,\n             ymax = conf.high)) + \n  geom_pointrange() + \n  theme_minimal()\nfit_cs\n\nWarning: Removed 1 rows containing missing values (`geom_segment()`).\n\n\n\n\n# 図を並べる\nggpubr::ggarrange(fig_ct, fit_cs, nrow = 2)\n\nWarning: Removed 1 rows containing missing values (`geom_segment()`).\nRemoved 1 rows containing missing values (`geom_segment()`)."
  },
  {
    "objectID": "3-Chapter_2.html#sec-tab2_1",
    "href": "3-Chapter_2.html#sec-tab2_1",
    "title": "2  第2章",
    "section": "2.2 表2.1 (p.11)",
    "text": "2.2 表2.1 (p.11)\nまずp.11の表2.1を再現する．クロス表に周辺度数を追加する場合は，addmarginsを用いる．\n\n# 度数\nFreq &lt;- c( 40, 250,\n          160,3000)\nFreq\n\n[1]   40  250  160 3000\n\n\nベクトルを表にする．ここではas.tableでクラスをtableとしている．\n\n# 行列を作成し，表とする．\ntab_2.1 &lt;- matrix(\n  Freq,\n  nrow = 2,\n  ncol = 2,\n  byrow = TRUE,\n  dimnames = c(list(\n    Member = c(\"Member\", \"Nonmember\"),\n    Position = c(\"Have subordinates\",\n            \"No subordinates\")\n  ))\n) |&gt; as.table()\ntab_2.1\n\n           Position\nMember      Have subordinates No subordinates\n  Member                   40             250\n  Nonmember               160            3000\n\n\n周辺分布とモザイクプロットも確認する．本書で指摘されている関係性が図からも見て取れる．\n\n# 周辺分布の表示\nMargins(tab_2.1)\n\n$Member\n       level   freq   perc  cumfreq  cumperc\n1     Member    290   8.4%      290     8.4%\n2  Nonmember  3'160  91.6%    3'450   100.0%\n\n$Position\n               level   freq   perc  cumfreq  cumperc\n1  Have subordinates    200   5.8%      200     5.8%\n2    No subordinates  3'250  94.2%    3'450   100.0%\n\n# モザイクプロット\nvcd::mosaic(tab_2.1, shade = TRUE, keep_aspect_ratio = FALSE)\n\n\n\n\n\n\n\n\n\n\nggplotでモザイクプロット\n\n\n\n\n\n図はすべてggplot()を使用して描きたいという場合は，ggmosaicパッケージを用いる． その前に集計データをvcdExtra::expand.dft()によって個票データに変換し，ggmosaic::geom_mosaicを使用する．\n\n# パッケージの呼び出し\nlibrary(ggmosaic)\n\n\nAttaching package: 'ggmosaic'\n\n\nThe following objects are masked from 'package:vcd':\n\n    mosaic, spine\n\nlibrary(vcdExtra)\n\n\nAttaching package: 'vcdExtra'\n\n\nThe following object is masked from 'package:dplyr':\n\n    summarise\n\n# データの変換\ndf_tab_2.1 &lt;- vcdExtra::expand.dft(data.frame(tab_2.1), dreq = \"Freq\") |&gt; tibble()\ndf_tab_2.1\n\n# A tibble: 3,450 × 2\n   Member Position         \n   &lt;chr&gt;  &lt;chr&gt;            \n 1 Member Have subordinates\n 2 Member Have subordinates\n 3 Member Have subordinates\n 4 Member Have subordinates\n 5 Member Have subordinates\n 6 Member Have subordinates\n 7 Member Have subordinates\n 8 Member Have subordinates\n 9 Member Have subordinates\n10 Member Have subordinates\n# ℹ 3,440 more rows\n\n# ggplotでモザイクプロット\ndf_tab_2.1 |&gt; \n  ggplot() + \n  ggmosaic::geom_mosaic(aes(x = product(Position, Member), fill = Position)) + \n  scale_fill_viridis_d() + \n  coord_flip()   # mosaicと表示をあわせる\n\nWarning: `unite_()` was deprecated in tidyr 1.2.0.\nℹ Please use `unite()` instead.\nℹ The deprecated feature was likely used in the ggmosaic package.\n  Please report the issue at &lt;https://github.com/haleyjeppson/ggmosaic&gt;.\n\n\n\n\n\n\n\n\n表にaddmargins()で周辺度数を追加する．\n\n# A. 度数（周辺度数の追加）\ntab_2.1 |&gt; addmargins()\n\n           Position\nMember      Have subordinates No subordinates  Sum\n  Member                   40             250  290\n  Nonmember               160            3000 3160\n  Sum                     200            3250 3450\n\n\n表の数字を用いてオッズ比を計算する．\n\n# B. Odds \nx &lt;- tab_2.1\n# 1行1列と1行2列\nx[1,1]/x[1,2]\n\n[1] 0.16\n\n# 2行1列と2行2列\nx[2,1]/x[2,2]\n\n[1] 0.05333333\n\n# C. Odds ratio\nOR &lt;- (x[1,1]/x[1,2]) / (x[2,1]/x[2,2])\nOR\n\n[1] 3\n\n\n（対数）オッズ比の信頼区間をもとめる．\n\n# 対数オッズの標準誤差を求める\nSD &lt;- sqrt(1/x[1,1] + 1/x[1,2] + 1/x[2,1] + 1/x[2,2]) \n# 対数オッズ比の信頼区間を求める\nCI_log_OR &lt;- log(OR) + qnorm(c(0.025, 0.975)) * SD\nCI_log_OR\n\n[1] 0.7288936 1.4683310\n\n# オッズ比の信頼区間を求める\nexp(CI_log_OR)\n\n[1] 2.072786 4.341982\n\n\nDescToolsパッケージのOddsRatio関数を用いてオッズ比を求める．conf.level = 0.95とすることで信頼区間を求めることもできる． 先程計算したものと値が一致している．\n\n# OddsRatio関数を用いる\nOddsRatio(tab_2.1, conf.level = 0.95)\n\nodds ratio     lwr.ci     upr.ci \n  3.000000   2.072786   4.341982 \n\n\n\n\n\n\n\n\n関数の中身を確認する．\n\n\n\nOddsRatio()がどのような処理をしているのかについてはOddsRatioと入力し，関数の中身をみることで確認できる．ただし，UseMethod(\"OddsRatio\")となっており，詳細が分からないことがある．その場合は，methods()を用いる．そして，OddsRatio.default*のように*がついているものについてDescTools:::OddsRatio.defaultのように入力することで中身を確認することができる．getAnywhere(OddsRatio.default)としてもよい．\n\n# OddsRatio関数の中身を確認\nOddsRatio\n# methods関数を用いてどこにアクセスすればよいかを確認する\nmethods(OddsRatio)\n# DescTools関数のOddsRatio.defaultの中身を確認する\nDescTools:::OddsRatio.default\n# getAnywhereを利用する\ngetAnywhere(OddsRatio.default)\n\n\n\nさらに詳細な結果をみたければDescToolsパッケージのDescを用いる．\n\n# 詳細なクロス表の分析\nDesc(tab_2.1)\n\n------------------------------------------------------------------------------ \ntab_2.1 (table)\n\nSummary: \nn: 3'450, rows: 2, columns: 2\n\nPearson's Chi-squared test (cont. adj):\n  X-squared = 35.487, df = 1, p-value = 2.568e-09\nFisher's exact test p-value = 9.541e-08\nMcNemar's chi-squared = 19.32, df = 1, p-value = 1.106e-05\n\n                    estimate lwr.ci upr.ci'\n                                          \nodds ratio             3.000  2.073  4.342\nrel. risk (col1)       2.724  1.968  3.770\nrel. risk (col2)       0.908  0.867  0.951\n\n\nContingency Coeff.     0.103\nCramer's V             0.104\nKendall Tau-b          0.104\n\n                                                                 \n            Position   Have subordinates   No subordinates    Sum\nMember                                                           \n                                                                 \nMember      freq                      40               250    290\n            perc                    1.2%              7.2%   8.4%\n            p.row                  13.8%             86.2%      .\n            p.col                  20.0%              7.7%      .\n                                                                 \nNonmember   freq                     160             3'000  3'160\n            perc                    4.6%             87.0%  91.6%\n            p.row                   5.1%             94.9%      .\n            p.col                  80.0%             92.3%      .\n                                                                 \nSum         freq                     200             3'250  3'450\n            perc                    5.8%             94.2% 100.0%\n            p.row                      .                 .      .\n            p.col                      .                 .      .\n                                                                 \n\n----------\n' 95% conf. level\n\n\n\n\n\n次にセルの組み合わせを単位とした集計データを作成し，gnmを適用することでオッズ比を求めてみたい．gl()はn個の水準のある因子を作成する．kは各水準を何度繰り返すのかを指定する．lengthでベクトルの長さを設定することで，その長さになるまで因子の作成が繰り返される．\n\n# 度数のベクトル\nFreq\n\n[1]   40  250  160 3000\n\n# 行変数 1,2の水準のそれぞれを2回くりかえす\nCOMM &lt;- gl(n = 2, k = 2)   # rep(c(1, 2), each = 2) |&gt; factor()\nCOMM\n\n[1] 1 1 2 2\nLevels: 1 2\n\n# 列変数 1,2の水準を大きさが4となるまでそれぞれを1回くりかえす\nSUP  &lt;- gl(n = 2, k = 1, length = 4)   # rep(c(1, 2), times = 2) |&gt; factor()\nSUP\n\n[1] 1 2 1 2\nLevels: 1 2\n\n# 度数，行変数，列変数からなるデータを作成\nfreq_tab_2.1 &lt;- tibble(COMM, SUP, Freq)\n# データの確認\nfreq_tab_2.1\n\n# A tibble: 4 × 3\n  COMM  SUP    Freq\n  &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt;\n1 1     1        40\n2 1     2       250\n3 2     1       160\n4 2     2      3000\n\n\n分析には通常はglmを用いるが，後の分析とあわせてgnmによって推定する．結果は異ならない．family = poissonという指定を忘れないようにすること．何も指定しないとfamily = gaussianとなり，エラーなどを出さずに通常の線形回帰分析を行ってしまうので注意する．\n\n# gnmで推定\nfit &lt;- freq_tab_2.1 |&gt; \n  gnm(Freq ~ COMM + SUP + COMM:SUP, data = _, family = poisson)\n# 結果\nsummary(fit)\n\n\nCall:\ngnm(formula = Freq ~ COMM + SUP + COMM:SUP, family = poisson, \n    data = freq_tab_2.1)\n\nDeviance Residuals: \n[1]  0  0  0  0\n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)   3.6889     0.1581  23.331  &lt; 2e-16 ***\nCOMM2         1.3863     0.1768   7.842  &lt; 2e-16 ***\nSUP2          1.8326     0.1703  10.761  &lt; 2e-16 ***\nCOMM2:SUP2    1.0986     0.1886   5.824 5.75e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nResidual deviance: -5.3113e-13 on 0 degrees of freedom\nAIC: 37.649\n\nNumber of iterations: 2\n\ntidy(fit, conf.int = TRUE)\n\nWarning: The `tidy()` method for objects of class `gnm` is not maintained by the broom team, and is only supported through the `glm` tidier method. Please be cautious in interpreting and reporting broom output.\n\nThis warning is displayed once per session.\n\n\n# A tibble: 4 × 7\n  term        estimate std.error statistic   p.value conf.low conf.high\n  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1 (Intercept)     3.69     0.158     23.3  2.17e-120    3.36       3.98\n2 COMM2           1.39     0.177      7.84 4.43e- 15    1.05       1.75\n3 SUP2            1.83     0.170     10.8  5.24e- 27    1.51       2.18\n4 COMM2:SUP2      1.10     0.189      5.82 5.75e-  9    0.718      1.46\n\n\nCOMM2:SUP2の係数は1.0986である．これは対数オッズなので，指数関数expを適用してオッズ比を求める．\n\n# Odds ratios fit$coefficientsのCOMM2:SUP2の要素のみを取り出し，指数関数expを適用\nfit$coefficients[\"COMM2:SUP2\"] |&gt; exp()\n\nCOMM2:SUP2 \n         3 \n\nfit |&gt; confint(\"COMM2:SUP2\") |&gt; exp()\n\nWaiting for profiling to be done...\n\n\n   2.5 %   97.5 % \n2.049627 4.301359 \n\n\n次のようにしてもよい．\n\n# 係数の\"COMM2:SUP2\"の部分のみを取り出し，expを使用\ncoef(fit)[\"COMM2:SUP2\"] |&gt; exp()\n\nCOMM2:SUP2 \n         3 \n\n# 信頼区間の行が\"COMM2:SUP2\"の部分のみを取り出し，expを使用\nconfint(fit)[\"COMM2:SUP2\",] |&gt; exp()\n\nWaiting for profiling to be done...\n\n\n   2.5 %   97.5 % \n2.049627 4.301359 \n\n\n他の係数についてもまとめて示したければtidy関数を用いる．\n\n# 係数をtidyを用いて表示し，expを適用した新たな変数を作成する．\ntidy(fit, conf.int = TRUE) |&gt; \n  mutate(odds_ratio = exp(estimate), \n         or_conf.high = exp(conf.high),\n         or_conf.low = exp(conf.low))\n\n# A tibble: 4 × 10\n  term      estimate std.error statistic   p.value conf.low conf.high odds_ratio\n  &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;\n1 (Interce…     3.69     0.158     23.3  2.17e-120    3.36       3.98      40.0 \n2 COMM2         1.39     0.177      7.84 4.43e- 15    1.05       1.75       4.00\n3 SUP2          1.83     0.170     10.8  5.24e- 27    1.51       2.18       6.25\n4 COMM2:SU…     1.10     0.189      5.82 5.75e-  9    0.718      1.46       3.00\n# ℹ 2 more variables: or_conf.high &lt;dbl&gt;, or_conf.low &lt;dbl&gt;"
  },
  {
    "objectID": "3-Chapter_2.html#表2.3a-p.32",
    "href": "3-Chapter_2.html#表2.3a-p.32",
    "title": "2  第2章",
    "section": "2.3 表2.3A (p.32)",
    "text": "2.3 表2.3A (p.32)\nまずは表2.3Aを作成する．値をベクトルの形式で入力する．\n\n# 表2.3Aの値を入力\nFreq &lt;- c( 39,  50,  18,   4,\n          140, 178,  85,  23,\n          108, 195,  97,  23,\n          238, 598, 363, 111,\n           78, 250, 150,  55,\n           50, 200, 208,  74,\n            8,  29,  46,  21)\n\nベクトルのデータをmatrixで行列にし，最終的にはas.tableでtable形式にする．\n\n# データを表形式に変換\ntab_2.3A &lt;- matrix(\n  Freq,\n  nrow = 7,\n  ncol = 4,\n  byrow = TRUE,\n  dimnames = c(list(\n    polviews =  c(\n      \"Strongly liberal\",\n      \"Liberal\",\n      \"Slightly liberal\",\n      \"Moderate\",\n      \"Slightly conservative\",\n      \"Conservative\",\n      \"Strongly conservative\"),\n    fefam = c(\"Strongly Disagree\",\n                               \"Disagree\",\n                               \"Agree\",\n                               \"Strongly agree\")\n  ))) |&gt; as.table()\ntab_2.3A\n\n                       fefam\npolviews                Strongly Disagree Disagree Agree Strongly agree\n  Strongly liberal                     39       50    18              4\n  Liberal                             140      178    85             23\n  Slightly liberal                    108      195    97             23\n  Moderate                            238      598   363            111\n  Slightly conservative                78      250   150             55\n  Conservative                         50      200   208             74\n  Strongly conservative                 8       29    46             21\n\n\n\n# 度数，行変数，列変数からなる集計データを作成\npolviews &lt;- gl(n = 7, k = 4)   # 1-7までの各数字について4つ値を出す\nfefam &lt;- gl(n = 4, k = 1, length = 28)   # 1-4までの数字の列を長さが28になるまで繰り返す\n# Freq, polviews, fefamからなるデータを作成\nfreq_tab_2.3A &lt;- tibble(Freq, polviews, fefam)\nfreq_tab_2.3A\n\n# A tibble: 28 × 3\n    Freq polviews fefam\n   &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;\n 1    39 1        1    \n 2    50 1        2    \n 3    18 1        3    \n 4     4 1        4    \n 5   140 2        1    \n 6   178 2        2    \n 7    85 2        3    \n 8    23 2        4    \n 9   108 3        1    \n10   195 3        2    \n# ℹ 18 more rows\n\n\n\nなおtab_2.3Aに対して，data.frameを適用しても集計データは作成される．tableの行変数と列変数が指定されていないと，行変数はVar1，列変数はVar2となるので，必要に応じて名前をrenameで修正する．\n\n\n# 表データにdata.frameを適用し，tibble形式で表示\ndata.frame(tab_2.3A) |&gt; tibble()\n\n# A tibble: 28 × 3\n   polviews              fefam              Freq\n   &lt;fct&gt;                 &lt;fct&gt;             &lt;dbl&gt;\n 1 Strongly liberal      Strongly Disagree    39\n 2 Liberal               Strongly Disagree   140\n 3 Slightly liberal      Strongly Disagree   108\n 4 Moderate              Strongly Disagree   238\n 5 Slightly conservative Strongly Disagree    78\n 6 Conservative          Strongly Disagree    50\n 7 Strongly conservative Strongly Disagree     8\n 8 Strongly liberal      Disagree             50\n 9 Liberal               Disagree            178\n10 Slightly liberal      Disagree            195\n# ℹ 18 more rows\n\n\n以下では複数のモデルの適合度を比較する．そこで，モデル適合度を表示するための関数を作成する．モデルはすべてgnmによって推定されることを前提としている．glmの場合はエラーが出るので注意すること．\n\n# 引数となるobjはgnmの結果\nmodel.summary &lt;- function(obj, Model = NULL){\n  if (sum(class(obj) == \"gnm\") != 1)\n    stop(\"estimate with gnm\")\n  aic &lt;- obj$deviance - obj$df * 2 # AIC(L2)\n  bic &lt;- obj$deviance - obj$df * log(sum(obj$y)) #BIC(L2)\n  delta &lt;- 100 * sum(abs(obj$y - obj$fitted.values)) / (2 * sum(obj$y))\n  p &lt;- pchisq(obj$deviance, obj$df, lower.tail = FALSE)     #p&lt;-ifelse(p&lt;0.001,\"&lt;0.001\",p)\n  result &lt;- matrix(0, 1, 7)\n  if (is.null(Model)){ \n  Model &lt;- deparse(substitute(obj))\n  }\n  result &lt;- tibble(\n    \"Model Description\" = Model,\n    \"df\" = obj$df,\n    \"L2\" = obj$deviance,\n    #\"AIC(L2)\" = aic,\n    \"BIC\" = bic,\n    \"Delta\" = delta,\n    \"p\" = p\n  )\n  return(result)\n  }\n\nコントラストがデフォルトのfactor = \"contr.treatment\"とordered = \"contr.poly\"になっているのかを確認する．\n\n# デフォルトのcontrasts\noptions(\"contrasts\")\n\n$contrasts\n           factor           ordered \n\"contr.treatment\"      \"contr.poly\" \n\n# defaultのcontrastsの設定（ここでは特に意味はない．constrastをいじった後にデフォルトに戻す）\noptions(contrasts = c(factor = \"contr.treatment\", \n                      ordered = \"contr.poly\"))\n\n行スコアと列スコアを用いるので，まずas.integerを用いて行スコア（Rscore）と列スコア（Cscore）の変数を作成する．\n\n# 行変数と列変数の整数値を作成\nfreq_tab_2.3A &lt;- freq_tab_2.3A |&gt; \n  mutate(Rscore = as.integer(polviews),\n         Rscore = Rscore - mean(Rscore),\n         Cscore = as.integer(fefam),\n         Cscore = Cscore - mean(Cscore))\nfreq_tab_2.3A\n\n# A tibble: 28 × 5\n    Freq polviews fefam Rscore Cscore\n   &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt;\n 1    39 1        1         -3   -1.5\n 2    50 1        2         -3   -0.5\n 3    18 1        3         -3    0.5\n 4     4 1        4         -3    1.5\n 5   140 2        1         -2   -1.5\n 6   178 2        2         -2   -0.5\n 7    85 2        3         -2    0.5\n 8    23 2        4         -2    1.5\n 9   108 3        1         -1   -1.5\n10   195 3        2         -1   -0.5\n# ℹ 18 more rows\n\n\n\n2.3.1 独立モデル\n独立モデルは次のようになる．\n\n#  1. O: Independence/Null Association Model\nO &lt;- freq_tab_2.3A |&gt;\n  gnm(Freq ~ polviews + fefam,\n      family = poisson,\n      data = _,\n      tolerance = 1e-12\n      )\n# 結果\nsummary(O)\n\n\nCall:\n\ngnm(formula = Freq ~ polviews + fefam, family = poisson, data = freq_tab_2.3A, \n    tolerance = 1e-12)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-5.7415  -2.5344  -0.4283   1.5557   5.8265  \n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  3.06035    0.10115  30.256  &lt; 2e-16 ***\npolviews2    1.34491    0.10657  12.620  &lt; 2e-16 ***\npolviews3    1.33784    0.10664  12.545  &lt; 2e-16 ***\npolviews4    2.46825    0.09886  24.968  &lt; 2e-16 ***\npolviews5    1.56899    0.10433  15.038  &lt; 2e-16 ***\npolviews6    1.56711    0.10435  15.018  &lt; 2e-16 ***\npolviews7   -0.06514    0.13647  -0.477    0.633    \nfefam2       0.81947    0.04669  17.553  &lt; 2e-16 ***\nfefam3       0.38044    0.05047   7.538 4.76e-14 ***\nfefam4      -0.75396    0.06876 -10.965  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nResidual deviance: 211.7 on 18 degrees of freedom\nAIC: 403.05\n\nNumber of iterations: 5\n\ntidy(O)\n\n# A tibble: 10 × 5\n   term        estimate std.error statistic   p.value\n   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;\n 1 (Intercept)   3.06      0.101     30.3   4.36e-201\n 2 polviews2     1.34      0.107     12.6   1.63e- 36\n 3 polviews3     1.34      0.107     12.5   4.24e- 36\n 4 polviews4     2.47      0.0989    25.0   1.35e-137\n 5 polviews5     1.57      0.104     15.0   4.11e- 51\n 6 polviews6     1.57      0.104     15.0   5.60e- 51\n 7 polviews7    -0.0651    0.136     -0.477 6.33e-  1\n 8 fefam2        0.819     0.0467    17.6   5.65e- 69\n 9 fefam3        0.380     0.0505     7.54  4.76e- 14\n10 fefam4       -0.754     0.0688   -11.0   5.65e- 28\n\nglance(O)\n\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;\n1            NA      NA  -192.  403.  416.     212.          18    28\n\n\n先ほど作成した適合度の関数を用いる．2つめの引数はモデルの名前の詳細を記述可能だが，これは省略してもよい．省略するとモデルをフィットさせた結果のオブジェクトの名前が表示される．\n\n# モデル適合度\nmodel.summary(O, \"O:Independent\")\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta        p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n1 O:Independent          18  212.  65.1  8.09 4.54e-35\n\n\nテキストの表2.4と同じ結果になっているのかを確認してみる．期待度数は様々な方法でとりだすことができる．ここでは元の観測度数の値も表示されるbroomパッケージのaugment関数を用いる．\n\n# broomのaugmentで期待度数を求め，それをもとにL2とBICを計算\nbroom::augment(O, newdata = freq_tab_2.3A, type.predict = \"response\") |&gt; \n  dplyr::summarise(L2 = sum(Freq * log(Freq /　.fitted)) * 2,\n                   BIC = L2 - summary(O)$df.residual * log(sum(Freq)))\n\n# A tibble: 1 × 2\n     L2   BIC\n  &lt;dbl&gt; &lt;dbl&gt;\n1  212.  65.1\n\n# predict関数で期待度数を求める\npredict(O, newdata = freq_tab_2.3A, type = \"response\")\n\n        1         2         3         4         5         6         7         8 \n 21.33498  48.41524  31.21169  10.03809  81.88020 185.80983 119.78540  38.52457 \n        9        10        11        12        13        14        15        16 \n 81.30358 184.50131 118.94184  38.25327 251.79122 571.38703 368.35417 118.46758 \n       17        18        19        20        21        22        23        24 \n102.44635 232.48037 149.87235  48.20093 102.25414 232.04420 149.59116  48.11050 \n       25        26        27        28 \n 19.98953  45.36202  29.24338   9.40506 \n\n# 結果から期待度数を取り出す．\nO$fitted.values\n\n        1         2         3         4         5         6         7         8 \n 21.33498  48.41524  31.21169  10.03809  81.88020 185.80983 119.78540  38.52457 \n        9        10        11        12        13        14        15        16 \n 81.30358 184.50131 118.94184  38.25327 251.79122 571.38703 368.35417 118.46758 \n       17        18        19        20        21        22        23        24 \n102.44635 232.48037 149.87235  48.20093 102.25414 232.04420 149.59116  48.11050 \n       25        26        27        28 \n 19.98953  45.36202  29.24338   9.40506 \n\n\n\n\n2.3.2 一様連関モデル\n一様連関モデルでは先ほど作成した行変数と列変数の整数スコアの積であるRscore:Cscoreを加える．Rscore*CscoreあるいはI(Rscore*Cscore)でもよい．\n\n# 2. U: Uniform Association Model\nU &lt;- freq_tab_2.3A |&gt;\n  gnm(Freq ~ polviews + fefam + Rscore:Cscore,\n    family = poisson,\n    data = _,\n    tolerance = 1e-12)\n\n\n# 結果\nsummary(U)\n\n\nCall:\ngnm(formula = Freq ~ polviews + fefam + Rscore:Cscore, family = poisson, \n    data = freq_tab_2.3A, tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.62563  -0.41050  -0.06989   0.53746   1.67998  \n\nCoefficients:\n              Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)    2.77240    0.10449  26.533  &lt; 2e-16 ***\npolviews2      1.46434    0.10748  13.625  &lt; 2e-16 ***\npolviews3      1.55049    0.10942  14.170  &lt; 2e-16 ***\npolviews4      2.74597    0.10368  26.485  &lt; 2e-16 ***\npolviews5      1.88202    0.10973  17.151  &lt; 2e-16 ***\npolviews6      1.88457    0.10937  17.231  &lt; 2e-16 ***\npolviews7      0.22533    0.13937   1.617    0.106    \nfefam2         0.85993    0.04746  18.117  &lt; 2e-16 ***\nfefam3         0.38502    0.05144   7.484 7.19e-14 ***\nfefam4        -0.85901    0.07109 -12.083  &lt; 2e-16 ***\nRscore:Cscore  0.20211    0.01520  13.299  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nResidual deviance: 20.125 on 17 degrees of freedom\nAIC: 213.48\n\nNumber of iterations: 4\n\n# 信頼区間もあわせてtidyで表示\ntidy(U, conf.int = TRUE)\n\n# A tibble: 11 × 7\n   term          estimate std.error statistic   p.value conf.low conf.high\n   &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n 1 (Intercept)      2.77     0.104      26.5  4.02e-155   2.56       2.97 \n 2 polviews2        1.46     0.107      13.6  2.85e- 42   1.26       1.68 \n 3 polviews3        1.55     0.109      14.2  1.41e- 45   1.34       1.77 \n 4 polviews4        2.75     0.104      26.5  1.45e-154   2.55       2.95 \n 5 polviews5        1.88     0.110      17.2  6.15e- 66   1.67       2.10 \n 6 polviews6        1.88     0.109      17.2  1.55e- 66   1.67       2.10 \n 7 polviews7        0.225    0.139       1.62 1.06e-  1  -0.0485     0.499\n 8 fefam2           0.860    0.0475     18.1  2.33e- 73   0.767      0.954\n 9 fefam3           0.385    0.0514      7.48 7.19e- 14   0.285      0.486\n10 fefam4          -0.859    0.0711    -12.1  1.30e- 33  -1.00      -0.721\n11 Rscore:Cscore    0.202    0.0152     13.3  2.33e- 40   0.173      0.232\n\n\n表2.4Aと同じ結果になっているのかを確認する．\n\n# モデル適合度\nmodel.summary(U, \"U:Uniform\")\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 U:Uniform              17  20.1 -118.  2.77 0.268\n\n\nモデル行列を確認するのもよいだろう．\n\n# model.matrixを適用し，ユニークな値だけを表示\nmodel.matrix(U) |&gt; unique() \n\n   (Intercept) polviews2 polviews3 polviews4 polviews5 polviews6 polviews7\n1            1         0         0         0         0         0         0\n2            1         0         0         0         0         0         0\n3            1         0         0         0         0         0         0\n4            1         0         0         0         0         0         0\n5            1         1         0         0         0         0         0\n6            1         1         0         0         0         0         0\n7            1         1         0         0         0         0         0\n8            1         1         0         0         0         0         0\n9            1         0         1         0         0         0         0\n10           1         0         1         0         0         0         0\n11           1         0         1         0         0         0         0\n12           1         0         1         0         0         0         0\n13           1         0         0         1         0         0         0\n14           1         0         0         1         0         0         0\n15           1         0         0         1         0         0         0\n16           1         0         0         1         0         0         0\n17           1         0         0         0         1         0         0\n18           1         0         0         0         1         0         0\n19           1         0         0         0         1         0         0\n20           1         0         0         0         1         0         0\n21           1         0         0         0         0         1         0\n22           1         0         0         0         0         1         0\n23           1         0         0         0         0         1         0\n24           1         0         0         0         0         1         0\n25           1         0         0         0         0         0         1\n26           1         0         0         0         0         0         1\n27           1         0         0         0         0         0         1\n28           1         0         0         0         0         0         1\n   fefam2 fefam3 fefam4 Rscore:Cscore\n1       0      0      0           4.5\n2       1      0      0           1.5\n3       0      1      0          -1.5\n4       0      0      1          -4.5\n5       0      0      0           3.0\n6       1      0      0           1.0\n7       0      1      0          -1.0\n8       0      0      1          -3.0\n9       0      0      0           1.5\n10      1      0      0           0.5\n11      0      1      0          -0.5\n12      0      0      1          -1.5\n13      0      0      0           0.0\n14      1      0      0           0.0\n15      0      1      0           0.0\n16      0      0      1           0.0\n17      0      0      0          -1.5\n18      1      0      0          -0.5\n19      0      1      0           0.5\n20      0      0      1           1.5\n21      0      0      0          -3.0\n22      1      0      0          -1.0\n23      0      1      0           1.0\n24      0      0      1           3.0\n25      0      0      0          -4.5\n26      1      0      0          -1.5\n27      0      1      0           1.5\n28      0      0      1           4.5\n\n\n\n\n2.3.3 行効果モデル\ncontrastを修正し，polviewsの係数のすべてを足すと0になるように効果コーディングを行ってる．なお行変数と列スコアの積についてはCscore*polviewsとし，Cscore:polviewsとしない．\n\n# contrastを修正している．\noptions(contrasts = c(factor = \"contr.sum\", \n                      ordered = \"contr.treatment\"))\noptions(\"contrasts\")\n\n$contrasts\n           factor           ordered \n      \"contr.sum\" \"contr.treatment\" \n\n# 3. R: Row Effect Model\nR &lt;- freq_tab_2.3A |&gt;\n  gnm(Freq ~ polviews + fefam + Cscore*polviews, \n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n# 結果\nsummary(R)\n\n\nCall:\n\ngnm(formula = Freq ~ polviews + fefam + Cscore * polviews, family = poisson, \n    data = freq_tab_2.3A, tolerance = 1e-12)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-1.5962  -0.4603   0.0477   0.3840   1.5700  \n\nCoefficients:\n                  Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       4.262045   0.029618 143.902  &lt; 2e-16 ***\npolviews1        -1.356438   0.106013 -12.795  &lt; 2e-16 ***\npolviews2         0.075995   0.055906   1.359   0.1740    \npolviews3         0.142487   0.053465   2.665   0.0077 ** \npolviews4         1.357080   0.036418  37.264  &lt; 2e-16 ***\npolviews5         0.478200   0.046111  10.371  &lt; 2e-16 ***\npolviews6         0.489287   0.045766  10.691  &lt; 2e-16 ***\nfefam1           -0.112887   0.046238  -2.441   0.0146 *  \nfefam2            0.758505   0.030086  25.211  &lt; 2e-16 ***\nfefam3            0.295555   0.032630   9.058  &lt; 2e-16 ***\nCscore            0.000000         NA      NA       NA    \npolviews1:Cscore -0.558727   0.107668  -5.189 2.11e-07 ***\npolviews2:Cscore -0.405076   0.059149  -6.848 7.47e-12 ***\npolviews3:Cscore -0.248459   0.057741  -4.303 1.69e-05 ***\npolviews4:Cscore  0.008764   0.039709   0.221   0.8253    \npolviews5:Cscore  0.112245   0.051284   2.189   0.0286 *  \npolviews6:Cscore  0.419079   0.051434   8.148  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 15.906 on 12 degrees of freedom\nAIC: 219.26\n\nNumber of iterations: 4\n\n# 信頼区間もあわせてtidyで表示\ntidy(R, conf.int = TRUE)\n\n# A tibble: 17 × 7\n   term             estimate std.error statistic    p.value conf.low conf.high\n   &lt;chr&gt;               &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n 1 (Intercept)       4.26       0.0296   144.     0           4.20      4.32  \n 2 polviews1        -1.36       0.106    -12.8    1.75e- 37  -1.57     -1.16  \n 3 polviews2         0.0760     0.0559     1.36   1.74e-  1  -0.0351    0.184 \n 4 polviews3         0.142      0.0535     2.67   7.70e-  3   0.0365    0.246 \n 5 polviews4         1.36       0.0364    37.3    6.33e-304   1.29      1.43  \n 6 polviews5         0.478      0.0461    10.4    3.38e- 25   0.387     0.568 \n 7 polviews6         0.489      0.0458    10.7    1.12e- 26   0.399     0.579 \n 8 fefam1           -0.113      0.0462    -2.44   1.46e-  2  -0.204    -0.0224\n 9 fefam2            0.759      0.0301    25.2    3.04e-140   0.700     0.818 \n10 fefam3            0.296      0.0326     9.06   1.33e- 19   0.232     0.359 \n11 Cscore            0         NA         NA     NA          NA        NA     \n12 polviews1:Cscore -0.559      0.108     -5.19   2.11e-  7  -0.774    -0.351 \n13 polviews2:Cscore -0.405      0.0591    -6.85   7.47e- 12  -0.522    -0.290 \n14 polviews3:Cscore -0.248      0.0577    -4.30   1.69e-  5  -0.362    -0.136 \n15 polviews4:Cscore  0.00876    0.0397     0.221  8.25e-  1  -0.0690    0.0867\n16 polviews5:Cscore  0.112      0.0513     2.19   2.86e-  2   0.0117    0.213 \n17 polviews6:Cscore  0.419      0.0514     8.15   3.70e- 16   0.319     0.520 \n\n# モデル適合度\nmodel.summary(R, \"R:Row effect\")\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 R:Row effect           12  15.9 -81.8  2.47 0.196\n\n# モデル行列の確認\nmodel.matrix(R) |&gt; unique()\n\n   (Intercept) polviews1 polviews2 polviews3 polviews4 polviews5 polviews6\n1            1         1         0         0         0         0         0\n2            1         1         0         0         0         0         0\n3            1         1         0         0         0         0         0\n4            1         1         0         0         0         0         0\n5            1         0         1         0         0         0         0\n6            1         0         1         0         0         0         0\n7            1         0         1         0         0         0         0\n8            1         0         1         0         0         0         0\n9            1         0         0         1         0         0         0\n10           1         0         0         1         0         0         0\n11           1         0         0         1         0         0         0\n12           1         0         0         1         0         0         0\n13           1         0         0         0         1         0         0\n14           1         0         0         0         1         0         0\n15           1         0         0         0         1         0         0\n16           1         0         0         0         1         0         0\n17           1         0         0         0         0         1         0\n18           1         0         0         0         0         1         0\n19           1         0         0         0         0         1         0\n20           1         0         0         0         0         1         0\n21           1         0         0         0         0         0         1\n22           1         0         0         0         0         0         1\n23           1         0         0         0         0         0         1\n24           1         0         0         0         0         0         1\n25           1        -1        -1        -1        -1        -1        -1\n26           1        -1        -1        -1        -1        -1        -1\n27           1        -1        -1        -1        -1        -1        -1\n28           1        -1        -1        -1        -1        -1        -1\n   fefam1 fefam2 fefam3 Cscore polviews1:Cscore polviews2:Cscore\n1       1      0      0   -1.5             -1.5              0.0\n2       0      1      0   -0.5             -0.5              0.0\n3       0      0      1    0.5              0.5              0.0\n4      -1     -1     -1    1.5              1.5              0.0\n5       1      0      0   -1.5              0.0             -1.5\n6       0      1      0   -0.5              0.0             -0.5\n7       0      0      1    0.5              0.0              0.5\n8      -1     -1     -1    1.5              0.0              1.5\n9       1      0      0   -1.5              0.0              0.0\n10      0      1      0   -0.5              0.0              0.0\n11      0      0      1    0.5              0.0              0.0\n12     -1     -1     -1    1.5              0.0              0.0\n13      1      0      0   -1.5              0.0              0.0\n14      0      1      0   -0.5              0.0              0.0\n15      0      0      1    0.5              0.0              0.0\n16     -1     -1     -1    1.5              0.0              0.0\n17      1      0      0   -1.5              0.0              0.0\n18      0      1      0   -0.5              0.0              0.0\n19      0      0      1    0.5              0.0              0.0\n20     -1     -1     -1    1.5              0.0              0.0\n21      1      0      0   -1.5              0.0              0.0\n22      0      1      0   -0.5              0.0              0.0\n23      0      0      1    0.5              0.0              0.0\n24     -1     -1     -1    1.5              0.0              0.0\n25      1      0      0   -1.5              1.5              1.5\n26      0      1      0   -0.5              0.5              0.5\n27      0      0      1    0.5             -0.5             -0.5\n28     -1     -1     -1    1.5             -1.5             -1.5\n   polviews3:Cscore polviews4:Cscore polviews5:Cscore polviews6:Cscore\n1               0.0              0.0              0.0              0.0\n2               0.0              0.0              0.0              0.0\n3               0.0              0.0              0.0              0.0\n4               0.0              0.0              0.0              0.0\n5               0.0              0.0              0.0              0.0\n6               0.0              0.0              0.0              0.0\n7               0.0              0.0              0.0              0.0\n8               0.0              0.0              0.0              0.0\n9              -1.5              0.0              0.0              0.0\n10             -0.5              0.0              0.0              0.0\n11              0.5              0.0              0.0              0.0\n12              1.5              0.0              0.0              0.0\n13              0.0             -1.5              0.0              0.0\n14              0.0             -0.5              0.0              0.0\n15              0.0              0.5              0.0              0.0\n16              0.0              1.5              0.0              0.0\n17              0.0              0.0             -1.5              0.0\n18              0.0              0.0             -0.5              0.0\n19              0.0              0.0              0.5              0.0\n20              0.0              0.0              1.5              0.0\n21              0.0              0.0              0.0             -1.5\n22              0.0              0.0              0.0             -0.5\n23              0.0              0.0              0.0              0.5\n24              0.0              0.0              0.0              1.5\n25              1.5              1.5              1.5              1.5\n26              0.5              0.5              0.5              0.5\n27             -0.5             -0.5             -0.5             -0.5\n28             -1.5             -1.5             -1.5             -1.5\n\n\n表2.4の適合度を確認しよう．また，パラメータ推定値については，表2.5のBから確認する． Rの結果では，polviews1からpolviews6までの結果が表示されているが，polviews7は示されていない．パラメータのすべての値を足すと0となることから(\\(\\sum \\tau_i^A=0\\))，polviews7の係数は0-(-0.6721737)=0.6721737となる．これをRで計算するためには係数を取り出し，それらを足したものを0から引けばよい．\n\n# R\n# 取り出す係数を探す\npickCoef(R, \":Cscore\")\n\npolviews1:Cscore polviews2:Cscore polviews3:Cscore polviews4:Cscore \n              12               13               14               15 \npolviews5:Cscore polviews6:Cscore \n              16               17 \n\n# 12から17番目の係数を取り出し，足す\nR$coefficients[12:17] |&gt; sum()\n\n[1] -0.6721737\n\n# 次のようにもできる\nR$coefficients[pickCoef(R, \":Cscore\")] |&gt; sum()\n\n[1] -0.6721737\n\n# 0から足したものを引く\n0 - (R$coefficients[pickCoef(R, \":Cscore\")] |&gt; sum())\n\n[1] 0.6721737\n\n\ncontrastsをもとに戻して同様の分析を行う． 今度はpolviews1:Cscoreの係数が省略されているが，この値は0である（\\(\\tau_1^A=0\\)）．\n\n# alternative (default)\noptions(contrasts = c(factor = \"contr.treatment\",\n                      ordered = \"contr.poly\"))\nRalt &lt;- freq_tab_2.3A |&gt;\n  gnm(Freq ~ polviews + fefam + Cscore*polviews, \n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\n結果は表2.5Bの「他の正規化」の行を確認して欲しい．\n\n# 結果\nsummary(Ralt)\n\n\nCall:\n\ngnm(formula = Freq ~ polviews + fefam + Cscore * polviews, family = poisson, \n    data = freq_tab_2.3A, tolerance = 1e-12)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-1.5962  -0.4603   0.0477   0.3840   1.5700  \n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)        3.6308     0.1443  25.160  &lt; 2e-16 ***\npolviews2          1.4324     0.1342  10.670  &lt; 2e-16 ***\npolviews3          1.4989     0.1329  11.279  &lt; 2e-16 ***\npolviews4          2.7135     0.1246  21.776  &lt; 2e-16 ***\npolviews5          1.8346     0.1290  14.218  &lt; 2e-16 ***\npolviews6          1.8457     0.1289  14.323  &lt; 2e-16 ***\npolviews7          0.1698     0.1589   1.069  0.28508    \nfefam2             0.3127     0.1265   2.471  0.01345 *  \nfefam3            -0.7090     0.2447  -2.897  0.00376 ** \nfefam4            -2.5045     0.3703  -6.763 1.36e-11 ***\nCscore             0.0000         NA      NA       NA    \npolviews2:Cscore   0.1537     0.1362   1.128  0.25925    \npolviews3:Cscore   0.3103     0.1357   2.287  0.02219 *  \npolviews4:Cscore   0.5675     0.1268   4.477 7.58e-06 ***\npolviews5:Cscore   0.6710     0.1326   5.059 4.21e-07 ***\npolviews6:Cscore   0.9778     0.1331   7.346 2.04e-13 ***\npolviews7:Cscore   1.2309     0.1678   7.335 2.22e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 15.906 on 12 degrees of freedom\nAIC: 219.26\n\nNumber of iterations: 4\n\n# 信頼区間もあわせてtidyで表示\ntidy(Ralt, conf.int = TRUE)\n\n# A tibble: 17 × 7\n   term             estimate std.error statistic    p.value conf.low conf.high\n   &lt;chr&gt;               &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n 1 (Intercept)         3.63      0.144     25.2   1.10e-139   3.34       3.90 \n 2 polviews2           1.43      0.134     10.7   1.40e- 26   1.18       1.70 \n 3 polviews3           1.50      0.133     11.3   1.66e- 29   1.25       1.77 \n 4 polviews4           2.71      0.125     21.8   3.89e-105   2.48       2.97 \n 5 polviews5           1.83      0.129     14.2   7.05e- 46   1.59       2.10 \n 6 polviews6           1.85      0.129     14.3   1.58e- 46   1.60       2.11 \n 7 polviews7           0.170     0.159      1.07  2.85e-  1  -0.139      0.486\n 8 fefam2              0.313     0.127      2.47  1.35e-  2   0.0616     0.558\n 9 fefam3             -0.709     0.245     -2.90  3.76e-  3  -1.20      -0.237\n10 fefam4             -2.50      0.370     -6.76  1.36e- 11  -3.24      -1.79 \n11 Cscore              0        NA         NA    NA          NA         NA    \n12 polviews2:Cscore    0.154     0.136      1.13  2.59e-  1  -0.110      0.424\n13 polviews3:Cscore    0.310     0.136      2.29  2.22e-  2   0.0476     0.580\n14 polviews4:Cscore    0.567     0.127      4.48  7.58e-  6   0.323      0.820\n15 polviews5:Cscore    0.671     0.133      5.06  4.21e-  7   0.415      0.935\n16 polviews6:Cscore    0.978     0.133      7.35  2.04e- 13   0.721      1.24 \n17 polviews7:Cscore    1.23      0.168      7.33  2.22e- 13   0.905      1.56 \n\n\nモデルの適合度は全く同じであることがわかる．\n\n# モデル適合度\nmodel.summary(R, \"R: Row effect (effect coding)\")\n\n# A tibble: 1 × 6\n  `Model Description`              df    L2   BIC Delta     p\n  &lt;chr&gt;                         &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 R: Row effect (effect coding)    12  15.9 -81.8  2.47 0.196\n\nmodel.summary(Ralt, \"R: Row effect (dummy coding)\")\n\n# A tibble: 1 × 6\n  `Model Description`             df    L2   BIC Delta     p\n  &lt;chr&gt;                        &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 R: Row effect (dummy coding)    12  15.9 -81.8  2.47 0.196\n\n\n\n# モデル行列の確認\nmodel.matrix(Ralt) |&gt; unique()\n\n   (Intercept) polviews2 polviews3 polviews4 polviews5 polviews6 polviews7\n1            1         0         0         0         0         0         0\n2            1         0         0         0         0         0         0\n3            1         0         0         0         0         0         0\n4            1         0         0         0         0         0         0\n5            1         1         0         0         0         0         0\n6            1         1         0         0         0         0         0\n7            1         1         0         0         0         0         0\n8            1         1         0         0         0         0         0\n9            1         0         1         0         0         0         0\n10           1         0         1         0         0         0         0\n11           1         0         1         0         0         0         0\n12           1         0         1         0         0         0         0\n13           1         0         0         1         0         0         0\n14           1         0         0         1         0         0         0\n15           1         0         0         1         0         0         0\n16           1         0         0         1         0         0         0\n17           1         0         0         0         1         0         0\n18           1         0         0         0         1         0         0\n19           1         0         0         0         1         0         0\n20           1         0         0         0         1         0         0\n21           1         0         0         0         0         1         0\n22           1         0         0         0         0         1         0\n23           1         0         0         0         0         1         0\n24           1         0         0         0         0         1         0\n25           1         0         0         0         0         0         1\n26           1         0         0         0         0         0         1\n27           1         0         0         0         0         0         1\n28           1         0         0         0         0         0         1\n   fefam2 fefam3 fefam4 Cscore polviews2:Cscore polviews3:Cscore\n1       0      0      0   -1.5              0.0              0.0\n2       1      0      0   -0.5              0.0              0.0\n3       0      1      0    0.5              0.0              0.0\n4       0      0      1    1.5              0.0              0.0\n5       0      0      0   -1.5             -1.5              0.0\n6       1      0      0   -0.5             -0.5              0.0\n7       0      1      0    0.5              0.5              0.0\n8       0      0      1    1.5              1.5              0.0\n9       0      0      0   -1.5              0.0             -1.5\n10      1      0      0   -0.5              0.0             -0.5\n11      0      1      0    0.5              0.0              0.5\n12      0      0      1    1.5              0.0              1.5\n13      0      0      0   -1.5              0.0              0.0\n14      1      0      0   -0.5              0.0              0.0\n15      0      1      0    0.5              0.0              0.0\n16      0      0      1    1.5              0.0              0.0\n17      0      0      0   -1.5              0.0              0.0\n18      1      0      0   -0.5              0.0              0.0\n19      0      1      0    0.5              0.0              0.0\n20      0      0      1    1.5              0.0              0.0\n21      0      0      0   -1.5              0.0              0.0\n22      1      0      0   -0.5              0.0              0.0\n23      0      1      0    0.5              0.0              0.0\n24      0      0      1    1.5              0.0              0.0\n25      0      0      0   -1.5              0.0              0.0\n26      1      0      0   -0.5              0.0              0.0\n27      0      1      0    0.5              0.0              0.0\n28      0      0      1    1.5              0.0              0.0\n   polviews4:Cscore polviews5:Cscore polviews6:Cscore polviews7:Cscore\n1               0.0              0.0              0.0              0.0\n2               0.0              0.0              0.0              0.0\n3               0.0              0.0              0.0              0.0\n4               0.0              0.0              0.0              0.0\n5               0.0              0.0              0.0              0.0\n6               0.0              0.0              0.0              0.0\n7               0.0              0.0              0.0              0.0\n8               0.0              0.0              0.0              0.0\n9               0.0              0.0              0.0              0.0\n10              0.0              0.0              0.0              0.0\n11              0.0              0.0              0.0              0.0\n12              0.0              0.0              0.0              0.0\n13             -1.5              0.0              0.0              0.0\n14             -0.5              0.0              0.0              0.0\n15              0.5              0.0              0.0              0.0\n16              1.5              0.0              0.0              0.0\n17              0.0             -1.5              0.0              0.0\n18              0.0             -0.5              0.0              0.0\n19              0.0              0.5              0.0              0.0\n20              0.0              1.5              0.0              0.0\n21              0.0              0.0             -1.5              0.0\n22              0.0              0.0             -0.5              0.0\n23              0.0              0.0              0.5              0.0\n24              0.0              0.0              1.5              0.0\n25              0.0              0.0              0.0             -1.5\n26              0.0              0.0              0.0             -0.5\n27              0.0              0.0              0.0              0.5\n28              0.0              0.0              0.0              1.5"
  },
  {
    "objectID": "3-Chapter_2.html#列効果モデル",
    "href": "3-Chapter_2.html#列効果モデル",
    "title": "2  第2章",
    "section": "2.4 列効果モデル",
    "text": "2.4 列効果モデル\n列効果モデルは行効果モデルと同様の方法で推定すればよい．まずは効果コーディングで推定し，その後にダミーコーディングで推定する．\n\n# contrast\noptions(contrasts = c(factor = \"contr.sum\", \n                      ordered = \"contr.treatment\"))\n# 4. C: Column Effect Model\nC &lt;- freq_tab_2.3A |&gt; \n  gnm(Freq ~ polviews + fefam + Rscore*fefam, family = poisson, \n      data = _, \n      tolerance = 1e-12)\n# 結果\nsummary(C)\n\n\nCall:\n\ngnm(formula = Freq ~ polviews + fefam + Rscore * fefam, family = poisson, \n    data = freq_tab_2.3A, tolerance = 1e-12)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-1.7572  -0.4920   0.1628   0.4922   1.4247  \n\nCoefficients:\n              Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)    4.26735    0.02842 150.161  &lt; 2e-16 ***\npolviews1     -1.34764    0.08885 -15.167  &lt; 2e-16 ***\npolviews2      0.10725    0.05058   2.120 0.033978 *  \npolviews3      0.17817    0.04852   3.672 0.000241 ***\npolviews4      1.35465    0.03449  39.280  &lt; 2e-16 ***\npolviews5      0.47060    0.04547  10.349  &lt; 2e-16 ***\npolviews6      0.45489    0.04714   9.650  &lt; 2e-16 ***\nfefam1        -0.11795    0.03606  -3.271 0.001072 ** \nfefam2         0.75721    0.02817  26.882  &lt; 2e-16 ***\nfefam3         0.27540    0.03195   8.619  &lt; 2e-16 ***\nRscore         0.00000         NA      NA       NA    \nfefam1:Rscore -0.32183    0.02601 -12.373  &lt; 2e-16 ***\nfefam2:Rscore -0.06518    0.02013  -3.238 0.001203 ** \nfefam3:Rscore  0.13740    0.02282   6.021 1.73e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 14.237 on 15 degrees of freedom\nAIC: 211.59\n\nNumber of iterations: 4\n\n# 信頼区間もあわせてtidyで表示\ntidy(C, conf.int = TRUE)\n\n# A tibble: 14 × 7\n   term          estimate std.error statistic    p.value conf.low conf.high\n   &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n 1 (Intercept)     4.27      0.0284    150.    0          4.21       4.32  \n 2 polviews1      -1.35      0.0889    -15.2   5.81e- 52 -1.53      -1.18  \n 3 polviews2       0.107     0.0506      2.12  3.40e-  2  0.00729    0.206 \n 4 polviews3       0.178     0.0485      3.67  2.41e-  4  0.0823     0.273 \n 5 polviews4       1.35      0.0345     39.3   0          1.29       1.42  \n 6 polviews5       0.471     0.0455     10.3   4.22e- 25  0.381      0.559 \n 7 polviews6       0.455     0.0471      9.65  4.94e- 22  0.362      0.547 \n 8 fefam1         -0.118     0.0361     -3.27  1.07e-  3 -0.189     -0.0477\n 9 fefam2          0.757     0.0282     26.9   3.60e-159  0.702      0.813 \n10 fefam3          0.275     0.0320      8.62  6.77e- 18  0.213      0.338 \n11 Rscore          0        NA          NA    NA         NA         NA     \n12 fefam1:Rscore  -0.322     0.0260    -12.4   3.65e- 35 -0.373     -0.271 \n13 fefam2:Rscore  -0.0652    0.0201     -3.24  1.20e-  3 -0.105     -0.0258\n14 fefam3:Rscore   0.137     0.0228      6.02  1.73e-  9  0.0928     0.182 \n\n# モデル適合度\nmodel.summary(C, \"C:Column effect\")\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 C:Column effect        15  14.2 -108.  2.32 0.508\n\n# モデル行列の確認\nmodel.matrix(C) |&gt; unique()\n\n   (Intercept) polviews1 polviews2 polviews3 polviews4 polviews5 polviews6\n1            1         1         0         0         0         0         0\n2            1         1         0         0         0         0         0\n3            1         1         0         0         0         0         0\n4            1         1         0         0         0         0         0\n5            1         0         1         0         0         0         0\n6            1         0         1         0         0         0         0\n7            1         0         1         0         0         0         0\n8            1         0         1         0         0         0         0\n9            1         0         0         1         0         0         0\n10           1         0         0         1         0         0         0\n11           1         0         0         1         0         0         0\n12           1         0         0         1         0         0         0\n13           1         0         0         0         1         0         0\n14           1         0         0         0         1         0         0\n15           1         0         0         0         1         0         0\n16           1         0         0         0         1         0         0\n17           1         0         0         0         0         1         0\n18           1         0         0         0         0         1         0\n19           1         0         0         0         0         1         0\n20           1         0         0         0         0         1         0\n21           1         0         0         0         0         0         1\n22           1         0         0         0         0         0         1\n23           1         0         0         0         0         0         1\n24           1         0         0         0         0         0         1\n25           1        -1        -1        -1        -1        -1        -1\n26           1        -1        -1        -1        -1        -1        -1\n27           1        -1        -1        -1        -1        -1        -1\n28           1        -1        -1        -1        -1        -1        -1\n   fefam1 fefam2 fefam3 Rscore fefam1:Rscore fefam2:Rscore fefam3:Rscore\n1       1      0      0     -3            -3             0             0\n2       0      1      0     -3             0            -3             0\n3       0      0      1     -3             0             0            -3\n4      -1     -1     -1     -3             3             3             3\n5       1      0      0     -2            -2             0             0\n6       0      1      0     -2             0            -2             0\n7       0      0      1     -2             0             0            -2\n8      -1     -1     -1     -2             2             2             2\n9       1      0      0     -1            -1             0             0\n10      0      1      0     -1             0            -1             0\n11      0      0      1     -1             0             0            -1\n12     -1     -1     -1     -1             1             1             1\n13      1      0      0      0             0             0             0\n14      0      1      0      0             0             0             0\n15      0      0      1      0             0             0             0\n16     -1     -1     -1      0             0             0             0\n17      1      0      0      1             1             0             0\n18      0      1      0      1             0             1             0\n19      0      0      1      1             0             0             1\n20     -1     -1     -1      1            -1            -1            -1\n21      1      0      0      2             2             0             0\n22      0      1      0      2             0             2             0\n23      0      0      1      2             0             0             2\n24     -1     -1     -1      2            -2            -2            -2\n25      1      0      0      3             3             0             0\n26      0      1      0      3             0             3             0\n27      0      0      1      3             0             0             3\n28     -1     -1     -1      3            -3            -3            -3\n\n\nすべてを足すと0となることから(\\(\\sum \\tau_j^B=0\\))，polviews7の係数は0-(-0.2496118)=0.2496118となる\n\npickCoef(C, \":Rscore\")\n\nfefam1:Rscore fefam2:Rscore fefam3:Rscore \n           12            13            14 \n\nC$coefficients[pickCoef(C, \":Rscore\")] |&gt; sum()\n\n[1] -0.2496118\n\n0 - (C$coefficients[pickCoef(C, \":Rscore\")] |&gt; sum())\n\n[1] 0.2496118\n\n\n以下はダミーコーディングを用いている．\n\n# alternative (default)\noptions(contrasts = c(factor = \"contr.treatment\",\n                      ordered = \"contr.poly\"))\n# 4. C: Column Effect Model (default)\nCalt &lt;- freq_tab_2.3A |&gt; \n  gnm(Freq ~ polviews + fefam + Rscore*fefam, \n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\n推定値は表2.5Cを確認せよ．\n\n# 結果\nsummary(Calt)\n\n\nCall:\n\ngnm(formula = Freq ~ polviews + fefam + Rscore * fefam, family = poisson, \n    data = freq_tab_2.3A, tolerance = 1e-12)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-1.7572  -0.4920   0.1628   0.4922   1.4247  \n\nCoefficients:\n              Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)    3.76726    0.11222  33.571  &lt; 2e-16 ***\npolviews2      1.13306    0.10785  10.506  &lt; 2e-16 ***\npolviews3      0.88215    0.11310   7.800  &lt; 2e-16 ***\npolviews4      1.73680    0.11708  14.834  &lt; 2e-16 ***\npolviews5      0.53092    0.13848   3.834 0.000126 ***\npolviews6      0.19337    0.16048   1.205 0.228239    \npolviews7     -1.80128    0.20632  -8.730  &lt; 2e-16 ***\nfefam2         0.87516    0.04848  18.050  &lt; 2e-16 ***\nfefam3         0.39335    0.05298   7.424 1.13e-13 ***\nfefam4        -0.79671    0.07451 -10.692  &lt; 2e-16 ***\nRscore         0.00000         NA      NA       NA    \nfefam2:Rscore  0.25665    0.03459   7.421 1.17e-13 ***\nfefam3:Rscore  0.45924    0.03851  11.926  &lt; 2e-16 ***\nfefam4:Rscore  0.57144    0.05297  10.788  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 14.237 on 15 degrees of freedom\nAIC: 211.59\n\nNumber of iterations: 4\n\n# 信頼区間もあわせてtidyで表示\ntidy(Calt, conf.int = TRUE)\n\n# A tibble: 14 × 7\n   term          estimate std.error statistic    p.value conf.low conf.high\n   &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n 1 (Intercept)      3.77     0.112      33.6   4.50e-247    3.54      3.98 \n 2 polviews2        1.13     0.108      10.5   8.08e- 26    0.926     1.35 \n 3 polviews3        0.882    0.113       7.80  6.20e- 15    0.664     1.11 \n 4 polviews4        1.74     0.117      14.8   8.82e- 50    1.51      1.97 \n 5 polviews5        0.531    0.138       3.83  1.26e-  4    0.262     0.806\n 6 polviews6        0.193    0.160       1.20  2.28e-  1   -0.119     0.510\n 7 polviews7       -1.80     0.206      -8.73  2.54e- 18   -2.21     -1.40 \n 8 fefam2           0.875    0.0485     18.1   7.85e- 73    0.781     0.971\n 9 fefam3           0.393    0.0530      7.42  1.13e- 13    0.290     0.498\n10 fefam4          -0.797    0.0745    -10.7   1.11e- 26   -0.944    -0.652\n11 Rscore           0       NA          NA    NA           NA        NA    \n12 fefam2:Rscore    0.257    0.0346      7.42  1.17e- 13    0.189     0.325\n13 fefam3:Rscore    0.459    0.0385     11.9   8.66e- 33    0.384     0.535\n14 fefam4:Rscore    0.571    0.0530     10.8   3.94e- 27    0.468     0.676\n\n\n適合度は効果コーディングとダミーコーディングで変化しない．\n\n# モデル適合度\nmodel.summary(C, \"C:Column effect (effect coding)\") \n\n# A tibble: 1 × 6\n  `Model Description`                df    L2   BIC Delta     p\n  &lt;chr&gt;                           &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 C:Column effect (effect coding)    15  14.2 -108.  2.32 0.508\n\nmodel.summary(Calt, \"C:Column effect (dummy coding)\")\n\n# A tibble: 1 × 6\n  `Model Description`               df    L2   BIC Delta     p\n  &lt;chr&gt;                          &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 C:Column effect (dummy coding)    15  14.2 -108.  2.32 0.508\n\n\n\n# モデル行列の確認\nmodel.matrix(Calt) |&gt; unique()\n\n   (Intercept) polviews2 polviews3 polviews4 polviews5 polviews6 polviews7\n1            1         0         0         0         0         0         0\n2            1         0         0         0         0         0         0\n3            1         0         0         0         0         0         0\n4            1         0         0         0         0         0         0\n5            1         1         0         0         0         0         0\n6            1         1         0         0         0         0         0\n7            1         1         0         0         0         0         0\n8            1         1         0         0         0         0         0\n9            1         0         1         0         0         0         0\n10           1         0         1         0         0         0         0\n11           1         0         1         0         0         0         0\n12           1         0         1         0         0         0         0\n13           1         0         0         1         0         0         0\n14           1         0         0         1         0         0         0\n15           1         0         0         1         0         0         0\n16           1         0         0         1         0         0         0\n17           1         0         0         0         1         0         0\n18           1         0         0         0         1         0         0\n19           1         0         0         0         1         0         0\n20           1         0         0         0         1         0         0\n21           1         0         0         0         0         1         0\n22           1         0         0         0         0         1         0\n23           1         0         0         0         0         1         0\n24           1         0         0         0         0         1         0\n25           1         0         0         0         0         0         1\n26           1         0         0         0         0         0         1\n27           1         0         0         0         0         0         1\n28           1         0         0         0         0         0         1\n   fefam2 fefam3 fefam4 Rscore fefam2:Rscore fefam3:Rscore fefam4:Rscore\n1       0      0      0     -3             0             0             0\n2       1      0      0     -3            -3             0             0\n3       0      1      0     -3             0            -3             0\n4       0      0      1     -3             0             0            -3\n5       0      0      0     -2             0             0             0\n6       1      0      0     -2            -2             0             0\n7       0      1      0     -2             0            -2             0\n8       0      0      1     -2             0             0            -2\n9       0      0      0     -1             0             0             0\n10      1      0      0     -1            -1             0             0\n11      0      1      0     -1             0            -1             0\n12      0      0      1     -1             0             0            -1\n13      0      0      0      0             0             0             0\n14      1      0      0      0             0             0             0\n15      0      1      0      0             0             0             0\n16      0      0      1      0             0             0             0\n17      0      0      0      1             0             0             0\n18      1      0      0      1             1             0             0\n19      0      1      0      1             0             1             0\n20      0      0      1      1             0             0             1\n21      0      0      0      2             0             0             0\n22      1      0      0      2             2             0             0\n23      0      1      0      2             0             2             0\n24      0      0      1      2             0             0             2\n25      0      0      0      3             0             0             0\n26      1      0      0      3             3             0             0\n27      0      1      0      3             0             3             0\n28      0      0      1      3             0             0             3"
  },
  {
    "objectID": "3-Chapter_2.html#行列効果モデルrc",
    "href": "3-Chapter_2.html#行列効果モデルrc",
    "title": "2  第2章",
    "section": "2.5 行・列効果モデル（\\(R+C\\)）",
    "text": "2.5 行・列効果モデル（\\(R+C\\)）\n普通に推定しても収束しない．\n\n# コントラスト\noptions(contrasts = c(factor = \"contr.treatment\",\n                      ordered = \"contr.treatment\"))\n\n# 5. R+C: Row and Column Effect Model\n# 収束しない\nRplusCno &lt;- freq_tab_2.3A |&gt; \n  gnm(Freq ~ polviews + fefam + Cscore:polviews + Rscore:fefam,\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nWarning: glm.fit: algorithm did not converge\n\n\n係数を確認する．この場合，制約は3つ必要であるが2つしかNAとなっていない．テキストや表2.5Dを参照し，どのような制約を課すのかをきめる．ここでは表2.5Dのような制約を課す．\n\nRplusCno\n\n\nCall:\ngnm(formula = Freq ~ polviews + fefam + Cscore:polviews + Rscore:fefam, \n    family = poisson, data = freq_tab_2.3A, tolerance = 1e-12)\n\nCoefficients:\n     (Intercept)         polviews2         polviews3         polviews4  \n      -4.898e+13         8.575e+12         1.715e+13         2.572e+13  \n       polviews5         polviews6         polviews7            fefam2  \n       3.430e+13         4.287e+13         5.145e+13         1.550e+13  \n          fefam3            fefam4  polviews1:Cscore  polviews2:Cscore  \n       3.101e+13         4.651e+13         1.646e+12        -4.070e+12  \npolviews3:Cscore  polviews4:Cscore  polviews5:Cscore  polviews6:Cscore  \n      -9.787e+12        -1.550e+13        -2.122e+13        -2.694e+13  \npolviews7:Cscore     fefam1:Rscore     fefam2:Rscore     fefam3:Rscore  \n      -3.265e+13        -1.715e+13        -1.143e+13        -5.717e+12  \n   fefam4:Rscore  \n              NA  \n\nDeviance:            8.485116 \nPearson chi-squared: 8.477813 \nResidual df:         8 \n\npickCoef(RplusCno, \":Cscore\")  # 行効果\n\npolviews1:Cscore polviews2:Cscore polviews3:Cscore polviews4:Cscore \n              11               12               13               14 \npolviews5:Cscore polviews6:Cscore polviews7:Cscore \n              15               16               17 \n\npickCoef(RplusCno, \":Rscore\")  # 列効果\n\nfefam1:Rscore fefam2:Rscore fefam3:Rscore fefam4:Rscore \n           18            19            20            21 \n\n\nあるいは次のように一覧にしてもよい．\n\n# 変数と係数と係数の順番を表示\ndata.frame(var = names(RplusCno$coefficients),\n           estimate = RplusCno$coefficients) |&gt; \n  mutate(estimate = estimate,\n         number = row_number())\n\n                              var      estimate number\n(Intercept)           (Intercept) -4.898036e+13      1\npolviews2               polviews2  8.574948e+12      2\npolviews3               polviews3  1.714990e+13      3\npolviews4               polviews4  2.572484e+13      4\npolviews5               polviews5  3.429979e+13      5\npolviews6               polviews6  4.287474e+13      6\npolviews7               polviews7  5.144969e+13      7\nfefam2                     fefam2  1.550368e+13      8\nfefam3                     fefam3  3.100736e+13      9\nfefam4                     fefam4  4.651103e+13     10\npolviews1:Cscore polviews1:Cscore  1.646217e+12     11\npolviews2:Cscore polviews2:Cscore -4.070415e+12     12\npolviews3:Cscore polviews3:Cscore -9.787047e+12     13\npolviews4:Cscore polviews4:Cscore -1.550368e+13     14\npolviews5:Cscore polviews5:Cscore -2.122031e+13     15\npolviews6:Cscore polviews6:Cscore -2.693694e+13     16\npolviews7:Cscore polviews7:Cscore -3.265357e+13     17\nfefam1:Rscore       fefam1:Rscore -1.714990e+13     18\nfefam2:Rscore       fefam2:Rscore -1.143326e+13     19\nfefam3:Rscore       fefam3:Rscore -5.716632e+12     20\nfefam4:Rscore       fefam4:Rscore            NA     21\n\n\n制約を課すのは11番目，17番目，18番目の係数であり，これらを0にする．対象となる係数はconstrain = c(11,17,18)で指定し，制約はconstrainTo = c(0, 0, 0)とする．あとは同じである．\n\n# polviews1:Cscore(11) = polviews7:Cscore(17) = fefam1:Rscore(18) = 0\nRplusC &lt;- freq_tab_2.3A |&gt; \n  gnm(Freq ~ polviews + fefam + Cscore:polviews + Rscore:fefam,\n      constrain = c(11, 17, 18), \n      constrainTo = c(0, 0, 0),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n# 結果\nsummary(RplusC)\n\n\nCall:\ngnm(formula = Freq ~ polviews + fefam + Cscore:polviews + Rscore:fefam, \n    constrain = c(11, 17, 18), constrainTo = c(0, 0, 0), family = poisson, \n    data = freq_tab_2.3A, tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.07536  -0.33353   0.01859   0.37548   1.05912  \n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       3.69896    0.14301  25.866  &lt; 2e-16 ***\npolviews2         1.06075    0.12467   8.509  &lt; 2e-16 ***\npolviews3         0.76041    0.13412   5.670 1.43e-08 ***\npolviews4         1.61203    0.15170  10.626  &lt; 2e-16 ***\npolviews5         0.37332    0.18884   1.977 0.048049 *  \npolviews6         0.02433    0.22727   0.107 0.914750    \npolviews7        -2.01888    0.30512  -6.617 3.67e-11 ***\nfefam2            1.00654    0.09822  10.248  &lt; 2e-16 ***\nfefam3            0.65193    0.17688   3.686 0.000228 ***\nfefam4           -0.40872    0.26352  -1.551 0.120895    \npolviews1:Cscore  0.00000         NA      NA       NA    \npolviews2:Cscore -0.08578    0.11437  -0.750 0.453211    \npolviews3:Cscore -0.15923    0.10585  -1.504 0.132498    \npolviews4:Cscore -0.12164    0.09246  -1.316 0.188309    \npolviews5:Cscore -0.22243    0.10510  -2.116 0.034309 *  \npolviews6:Cscore -0.09452    0.11454  -0.825 0.409232    \npolviews7:Cscore  0.00000         NA      NA       NA    \nfefam1:Rscore     0.00000         NA      NA       NA    \nfefam2:Rscore     0.27936    0.04372   6.389 1.67e-10 ***\nfefam3:Rscore     0.48417    0.06239   7.761  &lt; 2e-16 ***\nfefam4:Rscore     0.58586    0.08655   6.769 1.30e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 7.6783 on 10 degrees of freedom\nAIC: 215.03\n\nNumber of iterations: 4\n\n# モデル適合度\nmodel.summary(RplusC)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 RplusC                 10  7.68 -73.8  1.77 0.660\n\n\n11番目，18番目，21番目の係数を0にして推定する．\n\n# polviews1:Cscore(11) = polviews7:Cscore(17) = fefam1:Rscore(18) = 0\nRplusC_2 &lt;- freq_tab_2.3A |&gt; \n  gnm(Freq ~ polviews + fefam + Cscore:polviews + Rscore:fefam,\n      constrain = c(11, 18, 21), \n      constrainTo = c(0, 0, 0),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n# 結果\nsummary(RplusC_2)\n\n\nCall:\ngnm(formula = Freq ~ polviews + fefam + Cscore:polviews + Rscore:fefam, \n    constrain = c(11, 18, 21), constrainTo = c(0, 0, 0), family = poisson, \n    data = freq_tab_2.3A, tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.07536  -0.33353   0.01859   0.37548   1.05912  \n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       3.69896    0.14301  25.866  &lt; 2e-16 ***\npolviews2         1.35368    0.13397  10.104  &lt; 2e-16 ***\npolviews3         1.34627    0.13954   9.648  &lt; 2e-16 ***\npolviews4         2.49082    0.14246  17.485  &lt; 2e-16 ***\npolviews5         1.54505    0.15938   9.694  &lt; 2e-16 ***\npolviews6         1.48899    0.17487   8.515  &lt; 2e-16 ***\npolviews7        -0.26129    0.21592  -1.210 0.226224    \nfefam2            0.42068    0.12573   3.346 0.000820 ***\nfefam3           -0.51980    0.23987  -2.167 0.030233 *  \nfefam4           -2.16632    0.36822  -5.883 4.03e-09 ***\npolviews1:Cscore  0.00000         NA      NA       NA    \npolviews2:Cscore  0.10951    0.12956   0.845 0.397978    \npolviews3:Cscore  0.23134    0.13130   1.762 0.078073 .  \npolviews4:Cscore  0.46422    0.12511   3.711 0.000207 ***\npolviews5:Cscore  0.55872    0.13347   4.186 2.84e-05 ***\npolviews6:Cscore  0.88192    0.13507   6.529 6.61e-11 ***\npolviews7:Cscore  1.17173    0.17310   6.769 1.30e-11 ***\nfefam1:Rscore     0.00000         NA      NA       NA    \nfefam2:Rscore     0.08407    0.03224   2.607 0.009124 ** \nfefam3:Rscore     0.09360    0.03861   2.424 0.015346 *  \nfefam4:Rscore     0.00000         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 7.6783 on 10 degrees of freedom\nAIC: 215.03\n\nNumber of iterations: 4\n\n# モデル適合度\nmodel.summary(RplusC_2)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 RplusC_2               10  7.68 -73.8  1.77 0.660\n\n\nRscore:Cscoreを含めて推定すれば，制約は自動的に課されており（polviewsの1番目と7番目，fefamの1 番目と4番目），特に指定する必要はない．\n\n# 5. R+C: Row and Column Effect Model (Alternative)\nRplusCalt &lt;- freq_tab_2.3A |&gt; \n  gnm(Freq ~ polviews + fefam + Rscore:Cscore + Cscore:polviews + Rscore:fefam,\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n# 結果\nsummary(RplusCalt)\n\n\nCall:\n\ngnm(formula = Freq ~ polviews + fefam + Rscore:Cscore + Cscore:polviews + \n    Rscore:fefam, family = poisson, data = freq_tab_2.3A, tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.07536  -0.33353   0.01859   0.37548   1.05912  \n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       2.82017    0.13999  20.145  &lt; 2e-16 ***\npolviews2         1.35368    0.13397  10.104  &lt; 2e-16 ***\npolviews3         1.34627    0.13954   9.648  &lt; 2e-16 ***\npolviews4         2.49082    0.14246  17.485  &lt; 2e-16 ***\npolviews5         1.54505    0.15938   9.694  &lt; 2e-16 ***\npolviews6         1.48899    0.17487   8.515  &lt; 2e-16 ***\npolviews7        -0.26129    0.21592  -1.210 0.226224    \nfefam2            1.00654    0.09822  10.248  &lt; 2e-16 ***\nfefam3            0.65193    0.17688   3.686 0.000228 ***\nfefam4           -0.40872    0.26352  -1.551 0.120895    \nRscore:Cscore     0.19529    0.02885   6.769  1.3e-11 ***\npolviews2:Cscore -0.08578    0.11437  -0.750 0.453211    \npolviews3:Cscore -0.15923    0.10585  -1.504 0.132498    \npolviews4:Cscore -0.12164    0.09246  -1.316 0.188309    \npolviews5:Cscore -0.22243    0.10510  -2.116 0.034309 *  \npolviews6:Cscore -0.09452    0.11454  -0.825 0.409232    \npolviews7:Cscore  0.00000         NA      NA       NA    \nfefam2:Rscore     0.08407    0.03224   2.607 0.009124 ** \nfefam3:Rscore     0.09360    0.03861   2.424 0.015346 *  \nfefam4:Rscore     0.00000         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 7.6783 on 10 degrees of freedom\nAIC: 215.03\n\nNumber of iterations: 5\n\n# モデル適合度\nmodel.summary(RplusCalt)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 RplusCalt              10  7.68 -73.8  1.77 0.660"
  },
  {
    "objectID": "3-Chapter_2.html#行列効果モデルrc1",
    "href": "3-Chapter_2.html#行列効果モデルrc1",
    "title": "2  第2章",
    "section": "2.6 行・列効果モデル（\\(RC(1)\\)）",
    "text": "2.6 行・列効果モデル（\\(RC(1)\\)）\nRC(1)についてはMult(1,polviews,fefam)を含んだモデルで推定する．結果をみると係数は表示されているものの，標準誤差はNAとなっている．\n\n# 6. RC: RC(1) model\nRC.un &lt;- freq_tab_2.3A |&gt;\n  gnm(Freq ~ polviews + fefam + Mult(1,polviews,fefam),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.................................\nDone\n\n# 結果\nsummary(RC.un)\n\n\nCall:\ngnm(formula = Freq ~ polviews + fefam + Mult(1, polviews, fefam), \n    family = poisson, data = freq_tab_2.3A, tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.07428  -0.27239   0.03038   0.36792   1.03721  \n\nCoefficients:\n                             Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)                   2.90343         NA      NA       NA\npolviews2                     1.39126         NA      NA       NA\npolviews3                     1.42882         NA      NA       NA\npolviews4                     2.58976         NA      NA       NA\npolviews5                     1.68978         NA      NA       NA\npolviews6                     1.63179         NA      NA       NA\npolviews7                    -0.10649         NA      NA       NA\nfefam2                        0.88593         NA      NA       NA\nfefam3                        0.40845         NA      NA       NA\nfefam4                       -0.77446         NA      NA       NA\nMult(., polviews, fefam).    -0.01526         NA      NA       NA\nMult(1, ., fefam).polviews1 -20.40869         NA      NA       NA\nMult(1, ., fefam).polviews2 -15.74474         NA      NA       NA\nMult(1, ., fefam).polviews3  -9.51625         NA      NA       NA\nMult(1, ., fefam).polviews4   0.09368         NA      NA       NA\nMult(1, ., fefam).polviews5   4.22660         NA      NA       NA\nMult(1, ., fefam).polviews6  17.74205         NA      NA       NA\nMult(1, ., fefam).polviews7  29.29493         NA      NA       NA\nMult(1, polviews, .).fefam1   2.47905         NA      NA       NA\nMult(1, polviews, .).fefam2   0.33556         NA      NA       NA\nMult(1, polviews, .).fefam3  -1.33530         NA      NA       NA\nMult(1, polviews, .).fefam4  -2.12791         NA      NA       NA\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 8.0718 on 10 degrees of freedom\nAIC: 215.43\n\nNumber of iterations: 33\n\n# モデル適合度\nmodel.summary(RC.un)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 RC.un                  10  8.07 -73.4  1.77 0.622\n\n\nまずは「重みづけのないまたは単位標準化した解」を求める．scaleWeights = \"unit\"とする．RC.unから.polviewsのある変数をpickCoef(RC.un, \"[.]polviews\")によって取り出す．\n\n# mu[i], i = 1 to 7\nmu &lt;- getContrasts(RC.un, pickCoef(RC.un,\n                                   \"[.]polviews\"),\n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\n\n# 値の方向を揃える\nif (mu$qvframe[1,1] &gt; 0 ) {\n  mu$qvframe[,1] &lt;- -1 * mu$qvframe[,1]\n}\n\n# 合計が0，2乗和が1となっていること確認する．\nlist(\"和\" = sum(mu$qvframe[,1]), \n     \"2乗和\" = sum(mu$qvframe[,1]^2))\n\n$和\n[1] 1.110223e-16\n\n$`2乗和`\n[1] 1\n\n# nu[j], j = 1 to 4\nnu &lt;- getContrasts(RC.un, pickCoef(RC.un, \"[.]fefam\"), \n                   ref = \"mean\",\n                   scaleRef = \"mean\",\n                   scaleWeights = \"unit\")\n\n# 値の方向を揃える\nif (nu$qvframe[1,1] &gt; 0 ) {\n  nu$qvframe[,1] &lt;- -1 * nu$qvframe[,1]\n}\n\n\n# 合計が0，2乗和が1となっていること確認する．\nlist(\"和\" = sum(nu$qvframe[,1]), \n     \"2乗和\" = sum(nu$qvframe[,1]^2))\n\n$和\n[1] 0\n\n$`2乗和`\n[1] 1\n\n# muの1番目と7番目，nuの1番目と4番目の値を取り出し保存する．\ncon &lt;- c(mu$qvframe[,1][c(1,7)],\n         nu$qvframe[,1][c(1,4)])\n\n\n#保存した値で制約を課した上で，再推定する．\nset.seed(1234)\nRC &lt;- freq_tab_2.3A |&gt; \n  gnm(Freq ~ polviews + fefam + Mult(1,polviews,fefam), \n      constrain = c(12,18,19,22),\n      constrainTo = con, \n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.............................\nDone\n\n\nDeviance is not finite 警告メッセージ: Algorithm failed - no model could be estimatedと表示されたらもう一度推定する．set.seedの値をいくつか変えて実行するのがよい．\n表2.5Eの値と一致しているのかを確認する．\n\n# 結果\nsummary(RC)\n\n\nCall:\ngnm(formula = Freq ~ polviews + fefam + Mult(1, polviews, fefam), \n    constrain = c(12, 18, 19, 22), constrainTo = con, family = poisson, \n    data = freq_tab_2.3A, tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.07428  -0.27239   0.03038   0.36792   1.03721  \n\nCoefficients:\n                            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)                  2.82020    0.14578  19.346  &lt; 2e-16 ***\npolviews2                    1.40280    0.12442  11.275  &lt; 2e-16 ***\npolviews3                    1.45577    0.12746  11.421  &lt; 2e-16 ***\npolviews4                    2.64048    0.13143  20.090  &lt; 2e-16 ***\npolviews5                    1.75073    0.14175  12.351  &lt; 2e-16 ***\npolviews6                    1.72618    0.16727  10.320  &lt; 2e-16 ***\npolviews7                    0.01648    0.21938   0.075 0.940107    \nfefam2                       0.91251    0.12222   7.466 8.25e-14 ***\nfefam3                       0.45574    0.20388   2.235 0.025396 *  \nfefam4                      -0.71735    0.24913  -2.879 0.003985 ** \nMult(., polviews, fefam).    2.37331    0.34813   6.817 9.27e-12 ***\nMult(1, ., fefam).polviews1 -0.48165         NA      NA       NA    \nMult(1, ., fefam).polviews2 -0.37580    0.10049  -3.740 0.000184 ***\nMult(1, ., fefam).polviews3 -0.23443    0.09461  -2.478 0.013216 *  \nMult(1, ., fefam).polviews4 -0.01632    0.08366  -0.195 0.845376    \nMult(1, ., fefam).polviews5  0.07749    0.09263   0.837 0.402872    \nMult(1, ., fefam).polviews6  0.38425    0.10926   3.517 0.000437 ***\nMult(1, ., fefam).polviews7  0.64646         NA      NA       NA    \nMult(1, polviews, .).fefam1 -0.74812         NA      NA       NA    \nMult(1, polviews, .).fefam2 -0.14098    0.07469  -1.888 0.059090 .  \nMult(1, polviews, .).fefam3  0.33229    0.09162   3.627 0.000287 ***\nMult(1, polviews, .).fefam4  0.55680         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 8.0718 on 10 degrees of freedom\nAIC: 215.43\n\nNumber of iterations: 29\n\n\n先ほどの単位標準化した解と推定の結果が一致しているのかを確認する．\n\n# 指定したmuとnuの値と結果が一致しているかを確認\nlist(mu = mu, nu = nu)\n\n$mu\n                               Estimate Std. Error\nMult(1, ., fefam).polviews1 -0.48165420 0.06776575\nMult(1, ., fefam).polviews2 -0.37579722 0.05016783\nMult(1, ., fefam).polviews3 -0.23443020 0.04842778\nMult(1, ., fefam).polviews4 -0.01631519 0.03689088\nMult(1, ., fefam).polviews5  0.07748893 0.04931050\nMult(1, ., fefam).polviews6  0.38424697 0.06009815\nMult(1, ., fefam).polviews7  0.64646091 0.06145462\n\n$nu\n                              Estimate Std. Error\nMult(1, polviews, .).fefam1 -0.7481178 0.02662158\nMult(1, polviews, .).fefam2 -0.1409760 0.04671343\nMult(1, polviews, .).fefam3  0.3322937 0.05164241\nMult(1, polviews, .).fefam4  0.5568002 0.04821776\n\n\n和が0，2乗和が1となっていることを確認\n\nsum(mu$qvframe[,1])\n\n[1] 1.110223e-16\n\nsum(mu$qvframe[,1]^2)\n\n[1] 1\n\nsum(nu$qvframe[,1])\n\n[1] 0\n\nsum(nu$qvframe[,1]^2)\n\n[1] 1\n\n\n適合度は変化していない．\n\n# モデル適合度\nmodel.summary(RC.un)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 RC.un                  10  8.07 -73.4  1.77 0.622\n\nmodel.summary(RC)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 RC                     10  8.07 -73.4  1.77 0.622"
  },
  {
    "objectID": "3-Chapter_2.html#周辺重みづけ",
    "href": "3-Chapter_2.html#周辺重みづけ",
    "title": "2  第2章",
    "section": "2.7 周辺重みづけ",
    "text": "2.7 周辺重みづけ\n\n# 行の周辺確率\nrp &lt;- prop.table(apply(tab_2.3A, 1, sum, na.rm = TRUE))\nrp\n\n     Strongly liberal               Liberal      Slightly liberal \n           0.03227682            0.12387322            0.12300087 \n             Moderate Slightly conservative          Conservative \n           0.38092469            0.15498691            0.15469613 \nStrongly conservative \n           0.03024135 \n\nsum(rp)\n\n[1] 1\n\n# 列の周辺確率\ncp &lt;- prop.table(apply(tab_2.3A, 2, sum, na.rm = TRUE))\ncp\n\nStrongly Disagree          Disagree             Agree    Strongly agree \n       0.19220704        0.43617331        0.28118639        0.09043327 \n\nsum(cp)\n\n[1] 1\n\n# mu[i], i = 1 to 7\nmu &lt;- getContrasts(RC.un, pickCoef(RC.un,\n                                   \"[.]polviews\"),\n                   ref = rp,\n                   scaleRef = rp, \n                   scaleWeights = rp)\n\n# 値の方向を揃える\nif (mu$qvframe[1,1] &gt; 0 ) {\n  mu$qvframe[,1] &lt;- -1 * mu$qvframe[,1]\n}\n\n# nu[j], j = 1 to 4\nnu &lt;- getContrasts(RC.un, pickCoef(RC.un, \"[.]fefam\"), \n                   ref = cp,\n                   scaleRef = cp,\n                   scaleWeights = cp)\n\n# 値の方向を揃える\nif (nu$qvframe[1,1] &gt; 0 ) {\n  nu$qvframe[,1] &lt;- -1 * nu$qvframe[,1]\n}\n\n# muの1番目と7番目，nuの1番目と4番目の値を取り出し保存する．\ncon &lt;- c(mu$qvframe[,1][c(1,7)],\n         nu$qvframe[,1][c(1,4)])\n\n\n#保存した値で制約を課した上で，再推定する．\nset.seed(1234)\nRC_mw &lt;- freq_tab_2.3A |&gt; \n  gnm(Freq ~ polviews + fefam + Mult(1,polviews,fefam), \n      constrain = c(12,18,19,22),\n      constrainTo = con, \n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.................................\nDone\n\n\n\n# 結果\nsummary(RC_mw)\n\n\nCall:\ngnm(formula = Freq ~ polviews + fefam + Mult(1, polviews, fefam), \n    constrain = c(12, 18, 19, 22), constrainTo = con, family = poisson, \n    data = freq_tab_2.3A, tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.07428  -0.27239   0.03038   0.36792   1.03721  \n\nCoefficients:\n                            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)                  2.90051    0.14144  20.507  &lt; 2e-16 ***\npolviews2                    1.38735    0.11722  11.835  &lt; 2e-16 ***\npolviews3                    1.41969    0.12024  11.807  &lt; 2e-16 ***\npolviews4                    2.57257    0.12376  20.787  &lt; 2e-16 ***\npolviews5                    1.66913    0.13414  12.443  &lt; 2e-16 ***\npolviews6                    1.59981    0.16013   9.991  &lt; 2e-16 ***\npolviews7                   -0.14816    0.21832  -0.679 0.497376    \nfefam2                       0.90365    0.12173   7.423 1.14e-13 ***\nfefam3                       0.43998    0.20350   2.162 0.030615 *  \nfefam4                      -0.73638    0.24896  -2.958 0.003098 ** \nMult(., polviews, fefam).    0.25673    0.03766   6.817 9.27e-12 ***\nMult(1, ., fefam).polviews1 -1.82062         NA      NA       NA    \nMult(1, ., fefam).polviews2 -1.41532    0.38476  -3.678 0.000235 ***\nMult(1, ., fefam).polviews3 -0.87405    0.36224  -2.413 0.015825 *  \nMult(1, ., fefam).polviews4 -0.03893    0.32031  -0.122 0.903253    \nMult(1, ., fefam).polviews5  0.32022    0.35468   0.903 0.366604    \nMult(1, ., fefam).polviews6  1.49474    0.41835   3.573 0.000353 ***\nMult(1, ., fefam).polviews7  2.49870         NA      NA       NA    \nMult(1, polviews, .).fefam1 -1.65778         NA      NA       NA    \nMult(1, polviews, .).fefam2 -0.19190    0.18033  -1.064 0.287244    \nMult(1, polviews, .).fefam3  0.95076    0.22120   4.298 1.72e-05 ***\nMult(1, polviews, .).fefam4  1.49281         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 8.0718 on 10 degrees of freedom\nAIC: 215.43\n\nNumber of iterations: 33\n\n\n内的連関パラメータ\\(\\phi\\)が0.25673となっている．場合によっては符号が逆となる．\n適合度は変化していない．\n\n# モデル適合度\nmodel.summary(RC.un)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 RC.un                  10  8.07 -73.4  1.77 0.622\n\nmodel.summary(RC)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 RC                     10  8.07 -73.4  1.77 0.622\n\nmodel.summary(RC_mw)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 RC_mw                  10  8.07 -73.4  1.77 0.622"
  },
  {
    "objectID": "3-Chapter_2.html#表2.4a",
    "href": "3-Chapter_2.html#表2.4a",
    "title": "2  第2章",
    "section": "2.8 表2.4A",
    "text": "2.8 表2.4A\n表2.4Aを再現する．\n\nmodels &lt;- list()\nmodels[[1]] &lt;- model.summary(O)\nmodels[[2]] &lt;- model.summary(U)\nmodels[[3]] &lt;- model.summary(R)\nmodels[[4]] &lt;- model.summary(C)\nmodels[[5]] &lt;- model.summary(RplusC)\nmodels[[6]] &lt;- model.summary(RC)\nmodels |&gt; bind_rows() |&gt; kable(digit = 3)\n\n\n\n\nModel Description\ndf\nL2\nBIC\nDelta\np\n\n\n\n\nO\n18\n211.695\n65.122\n8.092\n0.000\n\n\nU\n17\n20.125\n-118.305\n2.766\n0.268\n\n\nR\n12\n15.906\n-81.809\n2.466\n0.196\n\n\nC\n15\n14.237\n-107.907\n2.321\n0.508\n\n\nRplusC\n10\n7.678\n-73.751\n1.772\n0.660\n\n\nRC\n10\n8.072\n-73.358\n1.767\n0.622"
  },
  {
    "objectID": "3-Chapter_2.html#表2.4b",
    "href": "3-Chapter_2.html#表2.4b",
    "title": "2  第2章",
    "section": "2.9 表2.4B",
    "text": "2.9 表2.4B\nモデルの比較のための関数を作成する．引数は2つであり，1つめのモデルと2つめのモデルの比較を行う．2つめが指定されていなければ比較ではなくそのモデルの適合度を示す．\n\nmodel_comparison &lt;- function(x, y = 0) {\n  models |&gt; \n    bind_rows() |&gt;\n    dplyr::summarise(`Model Used` = \n                ifelse(y == 0,\n                       paste0(x),\n                       paste0(x,\"-\",y)),\n              df = ifelse(y == 0, \n                          df[x], \n                          df[x] - df[y]),\n              L2 = ifelse(y == 0, \n                          L2[x], \n                          L2[x] - L2[y]))\n}\n\n表2.4Bは次のように再現できる．\n\n# Table 2.4 Panel B\nbind_rows(model_comparison(1,2),\n          model_comparison(2,6),\n          model_comparison(6),\n          model_comparison(1)) |&gt; kable(digit = 3)\n\n\n\n\nModel Used\ndf\nL2\n\n\n\n\n1-2\n1\n191.571\n\n\n2-6\n7\n12.053\n\n\n6\n10\n8.072\n\n\n1\n18\n211.695\n\n\n\n\n\n表2.4Cも再現できる．\n\n# Table 2.4 Panel C\nbind_rows(model_comparison(2,4),\n          model_comparison(4,6),\n          model_comparison(2,6)) |&gt; kable(digit = 3)\n\n\n\n\nModel Used\ndf\nL2\n\n\n\n\n2-4\n2\n5.887\n\n\n4-6\n5\n6.165\n\n\n2-6\n7\n12.053"
  },
  {
    "objectID": "3-Chapter_2.html#表2.5a",
    "href": "3-Chapter_2.html#表2.5a",
    "title": "2  第2章",
    "section": "2.10 表2.5A",
    "text": "2.10 表2.5A\n係数を取り出して表2.5Aを再現する．\n\nsummary(U)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\"Rscore:Cscore\", Variable))\n\n       Variable  Estimate Std..Error  z.value     Pr...z..\n1 Rscore:Cscore 0.2021125 0.01519706 13.29945 2.331718e-40"
  },
  {
    "objectID": "3-Chapter_2.html#表2.5b",
    "href": "3-Chapter_2.html#表2.5b",
    "title": "2  第2章",
    "section": "2.11 表2.5B",
    "text": "2.11 表2.5B\n省略された係数について，標準誤差を求める方法は次の通り．\n\n# Table 2.5 Panel B \nsummary(R)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\":Cscore\", Variable))\n\n          Variable     Estimate Std..Error    z.value     Pr...z..\n1 polviews1:Cscore -0.558726563 0.10766840 -5.1893275 2.110549e-07\n2 polviews2:Cscore -0.405075736 0.05914888 -6.8484091 7.467575e-12\n3 polviews3:Cscore -0.248458921 0.05774110 -4.3029822 1.685144e-05\n4 polviews4:Cscore  0.008763861 0.03970853  0.2207048 8.253223e-01\n5 polviews5:Cscore  0.112245001 0.05128383  2.1887016 2.861853e-02\n6 polviews6:Cscore  0.419078627 0.05143368  8.1479420 3.701697e-16\n\n# polviews7:Cscoreを求める\nmycontrast &lt;- numeric(length(coef(R)))\nterms &lt;- pickCoef(R,\"[:]Cscore\")\nmycontrast[terms] &lt;- rep(-1,6)\nmycontrast &lt;- cbind(mycontrast)\ncolnames(mycontrast) &lt;- \"polviews7:Cscore\"\ngnm::se(R, mycontrast)\n\n                  Estimate Std. Error\npolviews7:Cscore 0.6721737  0.1003211"
  },
  {
    "objectID": "3-Chapter_2.html#表2.5b他の正規化",
    "href": "3-Chapter_2.html#表2.5b他の正規化",
    "title": "2  第2章",
    "section": "2.12 表2.5B（他の正規化）",
    "text": "2.12 表2.5B（他の正規化）\n\n# Table 2.5 Panel B Alternative\nsummary(Ralt)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\":Cscore\", Variable))\n\n          Variable  Estimate Std..Error  z.value     Pr...z..\n1 polviews2:Cscore 0.1536508  0.1361941 1.128176 2.592458e-01\n2 polviews3:Cscore 0.3102676  0.1356609 2.287082 2.219102e-02\n3 polviews4:Cscore 0.5674904  0.1267654 4.476699 7.580590e-06\n4 polviews5:Cscore 0.6709716  0.1326215 5.059297 4.208051e-07\n5 polviews6:Cscore 0.9778052  0.1331060 7.346062 2.041319e-13\n6 polviews7:Cscore 1.2309003  0.1678130 7.334954 2.217982e-13"
  },
  {
    "objectID": "3-Chapter_2.html#表2.5c",
    "href": "3-Chapter_2.html#表2.5c",
    "title": "2  第2章",
    "section": "2.13 表2.5C",
    "text": "2.13 表2.5C\n同様に列効果の最後のカテゴリの推定値と標準誤差を求める．\n\n# Table 2.5 Panel C\nsummary(C)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\":Rscore\", Variable))\n\n       Variable    Estimate Std..Error    z.value     Pr...z..\n1 fefam1:Rscore -0.32183233 0.02601065 -12.373099 3.654449e-35\n2 fefam2:Rscore -0.06518238 0.02012977  -3.238109 1.203247e-03\n3 fefam3:Rscore  0.13740293 0.02281996   6.021174 1.731567e-09\n\n# fefam4:Rscoreを求める\nmycontrast &lt;- numeric(length(coef(C)))\nterms &lt;- pickCoef(C,\"[:]Rscore\")\nmycontrast[terms] &lt;- rep(-1,3)\nmycontrast &lt;- cbind(mycontrast)\ncolnames(mycontrast) &lt;- \"fefam4:Rscore\"\ngnm::se(C, mycontrast)\n\n               Estimate Std. Error\nfefam4:Rscore 0.2496118 0.03429697"
  },
  {
    "objectID": "3-Chapter_2.html#表2.5c他の正規化",
    "href": "3-Chapter_2.html#表2.5c他の正規化",
    "title": "2  第2章",
    "section": "2.14 表2.5C（他の正規化）",
    "text": "2.14 表2.5C（他の正規化）\n1つ目のカテゴリの値を0とした正規化の場合は次のようになる．\n\n# Table 2.5 Panel C Alternative\nsummary(Calt)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\":Rscore\", Variable))\n\n       Variable  Estimate Std..Error   z.value     Pr...z..\n1 fefam2:Rscore 0.2566499 0.03458604  7.420624 1.165702e-13\n2 fefam3:Rscore 0.4592353 0.03850703 11.926012 8.662502e-33\n3 fefam4:Rscore 0.5714441 0.05297192 10.787680 3.935998e-27"
  },
  {
    "objectID": "3-Chapter_2.html#表2.5d",
    "href": "3-Chapter_2.html#表2.5d",
    "title": "2  第2章",
    "section": "2.15 表2.5D",
    "text": "2.15 表2.5D\n\n# Table 2.5 Panel D\nsummary(RplusC)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\"Rscore|Cscore\", Variable))\n\n           Variable    Estimate Std..Error    z.value     Pr...z..\n1  polviews1:Cscore  0.00000000         NA         NA           NA\n2  polviews2:Cscore -0.08578207 0.11436513 -0.7500719 4.532114e-01\n3  polviews3:Cscore -0.15923097 0.10584890 -1.5043233 1.324981e-01\n4  polviews4:Cscore -0.12164181 0.09246130 -1.3155970 1.883093e-01\n5  polviews5:Cscore -0.22242867 0.10509647 -2.1164238 3.430878e-02\n6  polviews6:Cscore -0.09452143 0.11453734 -0.8252455 4.092322e-01\n7  polviews7:Cscore  0.00000000         NA         NA           NA\n8     fefam1:Rscore  0.00000000         NA         NA           NA\n9     fefam2:Rscore  0.27935717 0.04372418  6.3890770 1.668900e-10\n10    fefam3:Rscore  0.48417258 0.06238681  7.7608170 8.438398e-15\n11    fefam4:Rscore  0.58586364 0.08654948  6.7691179 1.295700e-11"
  },
  {
    "objectID": "3-Chapter_2.html#表2.5d他の正規化",
    "href": "3-Chapter_2.html#表2.5d他の正規化",
    "title": "2  第2章",
    "section": "2.16 表2.5D（他の正規化）",
    "text": "2.16 表2.5D（他の正規化）\n\nsummary(RplusCalt)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\"Rscore|Cscore\", Variable))\n\n           Variable    Estimate Std..Error    z.value     Pr...z..\n1     Rscore:Cscore  0.19528788 0.02884983  6.7691178 1.295700e-11\n2  polviews2:Cscore -0.08578207 0.11436513 -0.7500719 4.532114e-01\n3  polviews3:Cscore -0.15923097 0.10584890 -1.5043233 1.324981e-01\n4  polviews4:Cscore -0.12164181 0.09246130 -1.3155970 1.883093e-01\n5  polviews5:Cscore -0.22242867 0.10509647 -2.1164238 3.430878e-02\n6  polviews6:Cscore -0.09452143 0.11453734 -0.8252455 4.092322e-01\n7  polviews7:Cscore  0.00000000         NA         NA           NA\n8     fefam2:Rscore  0.08406929 0.03224287  2.6073757 9.123919e-03\n9     fefam3:Rscore  0.09359682 0.03861067  2.4241178 1.534563e-02\n10    fefam4:Rscore  0.00000000         NA         NA           NA"
  },
  {
    "objectID": "3-Chapter_2.html#表2.5e",
    "href": "3-Chapter_2.html#表2.5e",
    "title": "2  第2章",
    "section": "2.17 表2.5E",
    "text": "2.17 表2.5E\n\nsummary(RC)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\"Mult\", Variable))\n\n                      Variable    Estimate Std..Error    z.value     Pr...z..\n1    Mult(., polviews, fefam).  2.37330693 0.34812532  6.8173924 9.270782e-12\n2  Mult(1, ., fefam).polviews1 -0.48165420         NA         NA           NA\n3  Mult(1, ., fefam).polviews2 -0.37579722 0.10049018 -3.7396411 1.842832e-04\n4  Mult(1, ., fefam).polviews3 -0.23443020 0.09460850 -2.4778980 1.321589e-02\n5  Mult(1, ., fefam).polviews4 -0.01631519 0.08365831 -0.1950217 8.453760e-01\n6  Mult(1, ., fefam).polviews5  0.07748893 0.09263438  0.8365030 4.028720e-01\n7  Mult(1, ., fefam).polviews6  0.38424697 0.10926427  3.5166753 4.369880e-04\n8  Mult(1, ., fefam).polviews7  0.64646091         NA         NA           NA\n9  Mult(1, polviews, .).fefam1 -0.74811781         NA         NA           NA\n10 Mult(1, polviews, .).fefam2 -0.14097601 0.07468829 -1.8875250 5.908974e-02\n11 Mult(1, polviews, .).fefam3  0.33229365 0.09161751  3.6269668 2.867702e-04\n12 Mult(1, polviews, .).fefam4  0.55680017         NA         NA           NA"
  },
  {
    "objectID": "3-Chapter_2.html#logmultパッケージの利用",
    "href": "3-Chapter_2.html#logmultパッケージの利用",
    "title": "2  第2章",
    "section": "2.18 logmultパッケージの利用",
    "text": "2.18 logmultパッケージの利用\nlogmultはgnmをベースとしてRCモデルを簡単に実行できる関数である．\nまずはlogmultパッケージのanoasで連関分析を行う．データはtableなのでtab_2.3Aを使用する．\nanoasは独立モデル，RC(1)，RC(2)，RC(3)，…と次元がmin(nrow(tab) - 1, ncol(tab) - 1)までのRCモデルを推定する．RC(1)の結果は表2.4Aと一致している．\n\nanoas(tab_2.3A)\n\nFitting independence model...\nFitting model with 1 dimension...\nInitialising\nRunning start-up iterations..\nRunning main iterations...................\nDone\nFitting model with 2 dimensions...\nInitialising\nRunning start-up iterations..\nRunning main iterations..........................\nDone\nFitting model with 3 dimensions...\nInitialising\nRunning start-up iterations..\nRunning main iterations...\nDone\n\n\n       Res. Df           Res. Dev     Dev./Indep. (%)   Dissim. (%)\nIndep.      18 211.69508974175693 100.000000000000000 8.09171028965\nRC(1)       10   8.07181892815000   3.812945750417107 1.76730792765\nRC(2)        4   1.36909098846095   0.646727796157711 0.49639212377\nRC(3)        0  -0.00000000000001  -0.000000000000005 0.00000000004\n                      BIC                AIC Dev. Df\nIndep.  65.12224155397615 175.69508974175693   NA NA\nRC(1)  -73.35754117617265 -11.92818107185000 -204 -8\nRC(2)  -31.20265305326811  -6.63090901153905   -7 -6\nRC(3)   -0.00000000000001  -0.00000000000001   -1 -4\n\n\n表2.5Eの推定値（RC(1)）はrcを用いて次のように再現できる．nd = 1で次元を1としている．標準誤差を求める上で，ブートストラップ法を用いている．結果には\\(\\gamma=\\delta=1/2\\)の場合の係数（Adjusted）が示されている．\n\nrc_fit &lt;- rc(tab_2.3A, \n             nd = 1, \n             se = \"bootstrap\", \n             weighting = \"none\",\n             nreplicates = 100, \n             ncpus = getOption(\"boot.ncpus\")\n             )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...........\nDone\nComputing bootstrap standard errors...\n\n\nLoading required namespace: parallel\n\n\n.\n\nsummary(rc_fit, weighting = \"none\")\n\nCall:\nrc(tab = tab_2.3A, nd = 1, weighting = \"none\", se = \"bootstrap\", \n    nreplicates = 100, ncpus = getOption(\"boot.ncpus\"))\n\nDeviance Residuals:\n    Min       1Q   Median       3Q      Max  \n-1.0743  -0.2724   0.0304   0.3679   1.0372  \n\nAssociation coefficients:\n                                    Normalized   Adjusted  Std. error\nDim1                                  2.373307         NA      0.2735\nDim1:polviewsStrongly liberal         0.481654   0.742014      0.0732\nDim1:polviewsLiberal                  0.375797   0.578936      0.0505\nDim1:polviewsSlightly liberal         0.234430   0.361152      0.0544\nDim1:polviewsModerate                 0.016315   0.025134      0.0326\nDim1:polviewsSlightly conservative   -0.077489  -0.119376      0.0492\nDim1:polviewsConservative            -0.384247  -0.591953      0.0596\nDim1:polviewsStrongly conservative   -0.646461  -0.995908      0.0621\nDim1:fefamStrongly Disagree           0.748118   1.152516      0.0252\nDim1:fefamDisagree                    0.140976   0.217181      0.0470\nDim1:fefamAgree                      -0.332294  -0.511916      0.0583\nDim1:fefamStrongly agree             -0.556800  -0.857781      0.0489\n                                     Pr(&gt;|z|)     \nDim1                                &lt; 2.2e-16  ***\nDim1:polviewsStrongly liberal       4.834e-11  ***\nDim1:polviewsLiberal                1.003e-13  ***\nDim1:polviewsSlightly liberal       1.609e-05  ***\nDim1:polviewsModerate                0.616651     \nDim1:polviewsSlightly conservative   0.114925     \nDim1:polviewsConservative           1.121e-10  ***\nDim1:polviewsStrongly conservative  &lt; 2.2e-16  ***\nDim1:fefamStrongly Disagree         &lt; 2.2e-16  ***\nDim1:fefamDisagree                   0.002683  ** \nDim1:fefamAgree                     1.214e-08  ***\nDim1:fefamStrongly agree            &lt; 2.2e-16  ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nNormalization weights: none\nDeviance:              8.071819\nPearson chi-squared:   8.168769\nDissimilarity index:   1.767308%\nResidual df:           10\nBIC:                   -73.35754\nAIC:                   -11.92818\n\n\n周辺重みづけを用いたい場合は`weighting = “marginal”とする．\n\nrc_fit_wm &lt;- rc(tab_2.3A, \n             nd = 1, \n             se = \"bootstrap\", \n             weighting = \"marginal\",\n             nreplicates = 100, \n             ncpus = getOption(\"boot.ncpus\")\n             )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.............\nDone\nComputing bootstrap standard errors...\n.\n\nsummary(rc_fit_wm)\n\nCall:\nrc(tab = tab_2.3A, nd = 1, weighting = \"marginal\", se = \"bootstrap\", \n    nreplicates = 100, ncpus = getOption(\"boot.ncpus\"))\n\nDeviance Residuals:\n    Min       1Q   Median       3Q      Max  \n-1.0743  -0.2724   0.0304   0.3679   1.0372  \n\nAssociation coefficients:\n                                    Normalized   Adjusted  Std. error\nDim1                                  0.256734         NA      0.0185\nDim1:polviewsStrongly liberal         1.820624   0.922490      0.3333\nDim1:polviewsLiberal                  1.415319   0.717126      0.1601\nDim1:polviewsSlightly liberal         0.874053   0.442873      0.1882\nDim1:polviewsModerate                 0.038935   0.019728      0.0944\nDim1:polviewsSlightly conservative   -0.320222  -0.162253      0.1777\nDim1:polviewsConservative            -1.494737  -0.757366      0.1303\nDim1:polviewsStrongly conservative   -2.498701  -1.266064      0.4518\nDim1:fefamStrongly Disagree           1.657784   0.839980      0.0847\nDim1:fefamDisagree                    0.191902   0.097234      0.0811\nDim1:fefamAgree                      -0.950760  -0.481739      0.0891\nDim1:fefamStrongly agree             -1.492808  -0.756389      0.1960\n                                     Pr(&gt;|z|)     \nDim1                                &lt; 2.2e-16  ***\nDim1:polviewsStrongly liberal       4.701e-08  ***\nDim1:polviewsLiberal                &lt; 2.2e-16  ***\nDim1:polviewsSlightly liberal       3.393e-06  ***\nDim1:polviewsModerate                 0.67992     \nDim1:polviewsSlightly conservative    0.07150  .  \nDim1:polviewsConservative           &lt; 2.2e-16  ***\nDim1:polviewsStrongly conservative  3.197e-08  ***\nDim1:fefamStrongly Disagree         &lt; 2.2e-16  ***\nDim1:fefamDisagree                    0.01798  *  \nDim1:fefamAgree                     &lt; 2.2e-16  ***\nDim1:fefamStrongly agree            2.616e-14  ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nNormalization weights: marginal\nDeviance:              8.071819\nPearson chi-squared:   8.168769\nDissimilarity index:   1.767308%\nResidual df:           10\nBIC:                   -73.35754\nAIC:                   -11.92818\n\n\nこれは先ほど求めた周辺重みづけの結果（内的連関パラメータが0.25673）と一致する．"
  },
  {
    "objectID": "3-Chapter_2.html#表2.3b",
    "href": "3-Chapter_2.html#表2.3b",
    "title": "2  第2章",
    "section": "2.19 表2.3B",
    "text": "2.19 表2.3B\n\n# コントラストを確認\noptions(\"contrasts\")\n\n$contrasts\n           factor           ordered \n\"contr.treatment\" \"contr.treatment\" \n\n# default\noptions(contrasts = c(factor = \"contr.treatment\",\n                      ordered = \"contr.poly\"))\n\nanoasを用いるときにはのエラーを無くすために行列はラベルを用いない．\n\nFreq &lt;- c(518,   95,  6,  35,  5,\n         　81,   67,  4,  49,  2,\n          452, 1003, 67, 630,  5,\n           71,  157, 37, 562, 12)\n\n# データを表形式に変換\ntab_2.3B &lt;- matrix(Freq, \n                   nrow = 4,\n                   ncol = 5,\n                   byrow = TRUE) |&gt; as.table()\ntab_2.3B\n\n     A    B    C    D    E\nA  518   95    6   35    5\nB   81   67    4   49    2\nC  452 1003   67  630    5\nD   71  157   37  562   12\n\n# 度数，行変数，列変数からなる集計データを作成\nEduc &lt;- gl(n = 4, k = 5)\nOcc &lt;- gl(n = 5, k = 1, length = 20)\nfreq_tab_2.3B &lt;- tibble(Freq, Educ, Occ)\nfreq_tab_2.3B\n\n# A tibble: 20 × 3\n    Freq Educ  Occ  \n   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;\n 1   518 1     1    \n 2    95 1     2    \n 3     6 1     3    \n 4    35 1     4    \n 5     5 1     5    \n 6    81 2     1    \n 7    67 2     2    \n 8     4 2     3    \n 9    49 2     4    \n10     2 2     5    \n11   452 3     1    \n12  1003 3     2    \n13    67 3     3    \n14   630 3     4    \n15     5 3     5    \n16    71 4     1    \n17   157 4     2    \n18    37 4     3    \n19   562 4     4    \n20    12 4     5    \n\n# 行変数と列変数の整数値を作成\nfreq_tab_2.3B &lt;- freq_tab_2.3B |&gt; \n  mutate(Rscore = as.numeric(Educ),\n         Cscore = as.numeric(Occ))\nfreq_tab_2.3B\n\n# A tibble: 20 × 5\n    Freq Educ  Occ   Rscore Cscore\n   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt;\n 1   518 1     1          1      1\n 2    95 1     2          1      2\n 3     6 1     3          1      3\n 4    35 1     4          1      4\n 5     5 1     5          1      5\n 6    81 2     1          2      1\n 7    67 2     2          2      2\n 8     4 2     3          2      3\n 9    49 2     4          2      4\n10     2 2     5          2      5\n11   452 3     1          3      1\n12  1003 3     2          3      2\n13    67 3     3          3      3\n14   630 3     4          3      4\n15     5 3     5          3      5\n16    71 4     1          4      1\n17   157 4     2          4      2\n18    37 4     3          4      3\n19   562 4     4          4      4\n20    12 4     5          4      5\n\n\n\nO &lt;- freq_tab_2.3B |&gt; \n  gnm(Freq ~ Educ + Occ, \n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nU &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Rscore:Cscore, \n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nR &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Rscore:Cscore + \n        Educ:Cscore, \n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Rscore:Cscore + \n        Occ:Rscore, \n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nRplusC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Rscore:Cscore + \n        Educ:Cscore + \n        Occ:Rscore,\n      constrain = c(12,16), \n      constrainTo = c(0,0),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Mult(1, Educ, Occ),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n.............................\nDone\n\nUplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ +\n        Rscore:Cscore + \n        Mult(1, Educ, Occ),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n.\nDone\n\nRplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Cscore:Educ + \n        Mult(1, Educ, Occ),\n      constrain = c(9,12),\n      constrainTo = c(0,0),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.......................................\nDone\n\nCplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Rscore:Occ + \n        Mult(1, Educ, Occ),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations......................................................\nDone\n\nRplusCplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Cscore:Educ + \n        Rscore:Occ + \n        Mult(1, Educ, Occ),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...........\nDone\n\nRC2 &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        instances(Mult(1, Educ, Occ),2),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.....................\nDone"
  },
  {
    "objectID": "3-Chapter_2.html#表2.6a",
    "href": "3-Chapter_2.html#表2.6a",
    "title": "2  第2章",
    "section": "2.20 表2.6A",
    "text": "2.20 表2.6A\n表2.6Aを再現する．\n\nmodels &lt;- list()\nmodels[[1]] &lt;- model.summary(O)\nmodels[[2]] &lt;- model.summary(U)\nmodels[[3]] &lt;- model.summary(R)\nmodels[[4]] &lt;- model.summary(C)\nmodels[[5]] &lt;- model.summary(RplusC)\nmodels[[6]] &lt;- model.summary(RC)\nmodels[[7]] &lt;- model.summary(UplusRC)\nmodels[[8]] &lt;- model.summary(RplusRC)\nmodels[[9]] &lt;- model.summary(CplusRC)\nmodels[[10]] &lt;- model.summary(RplusCplusRC)\nmodels[[11]] &lt;- model.summary(RC2)\nmodels |&gt; bind_rows()\n\n# A tibble: 11 × 6\n   `Model Description`    df       L2    BIC   Delta         p\n   &lt;chr&gt;               &lt;int&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;\n 1 O                      12 1373.    1274.  23.9    8.44e-287\n 2 U                      11  244.     153.   8.54   4.99e- 46\n 3 R                       9  206.     132.   7.38   1.85e- 39\n 4 C                       8  155.      89.3  7.47   1.48e- 29\n 5 RplusC                  6   91.6     42.1  4.63   1.40e- 17\n 6 RC                      6  125.      75.5  6.44   1.41e- 24\n 7 UplusRC                 5   17.6    -23.7  1.52   3.49e-  3\n 8 RplusRC                 4    6.94   -26.1  0.832  1.39e-  1\n 9 CplusRC                 3   11.4    -13.4  1.01   9.72e-  3\n10 RplusCplusRC            2    0.278  -16.2  0.0538 8.70e-  1\n11 RC2                     2    0.600  -15.9  0.0935 7.41e-  1"
  },
  {
    "objectID": "3-Chapter_2.html#表2.6b",
    "href": "3-Chapter_2.html#表2.6b",
    "title": "2  第2章",
    "section": "2.21 表2.6B",
    "text": "2.21 表2.6B\n\n# Table 2.4 Panel B\nbind_rows(model_comparison(1,6),\n          model_comparison(6,11),\n          model_comparison(11),\n          model_comparison(1))\n\n# A tibble: 4 × 3\n  `Model Used`    df       L2\n  &lt;chr&gt;        &lt;int&gt;    &lt;dbl&gt;\n1 1-6              6 1248.   \n2 6-11             4  124.   \n3 11               2    0.600\n4 1               12 1373."
  },
  {
    "objectID": "3-Chapter_2.html#表2.6c",
    "href": "3-Chapter_2.html#表2.6c",
    "title": "2  第2章",
    "section": "2.22 表2.6C",
    "text": "2.22 表2.6C\n\n# Table 2.4 Panel C\nbind_rows(model_comparison(1,2),\n          model_comparison(2,6),\n          model_comparison(6,10),\n          model_comparison(10),\n          model_comparison(1))\n\n# A tibble: 5 × 3\n  `Model Used`    df       L2\n  &lt;chr&gt;        &lt;int&gt;    &lt;dbl&gt;\n1 1-2              1 1129.   \n2 2-6              5  119.   \n3 6-10             4  125.   \n4 10               2    0.278\n5 1               12 1373."
  },
  {
    "objectID": "3-Chapter_2.html#表2.7a",
    "href": "3-Chapter_2.html#表2.7a",
    "title": "2  第2章",
    "section": "2.23 表2.7A",
    "text": "2.23 表2.7A\n\nset.seed(1234)\nUplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Rscore:Cscore + \n        Mult(1, Educ, Occ),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n..............\nDone\n\nsummary(UplusRC)\n\n\nCall:\ngnm(formula = Freq ~ Educ + Occ + Rscore:Cscore + Mult(1, Educ, \n    Occ), family = poisson, data = freq_tab_2.3B, tolerance = 1e-12)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.0893  -0.5631   0.1321   0.7372   1.9761  \n\nCoefficients:\n                       Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)             5.49123         NA      NA       NA    \nEduc2                  -2.07045         NA      NA       NA    \nEduc3                  -1.00877         NA      NA       NA    \nEduc4                  -3.55473         NA      NA       NA    \nOcc2                   -1.06909         NA      NA       NA    \nOcc3                   -5.17113         NA      NA       NA    \nOcc4                   -4.53939         NA      NA       NA    \nOcc5                  -10.91018         NA      NA       NA    \nRscore:Cscore           0.55212    0.03429    16.1   &lt;2e-16 ***\nMult(., Educ, Occ).     0.05379         NA      NA       NA    \nMult(1, ., Occ).Educ1  57.38879         NA      NA       NA    \nMult(1, ., Occ).Educ2  28.47707         NA      NA       NA    \nMult(1, ., Occ).Educ3 -10.70009         NA      NA       NA    \nMult(1, ., Occ).Educ4   9.22301         NA      NA       NA    \nMult(1, Educ, .).Occ1   0.06067         NA      NA       NA    \nMult(1, Educ, .).Occ2  -0.31188         NA      NA       NA    \nMult(1, Educ, .).Occ3   0.01526         NA      NA       NA    \nMult(1, Educ, .).Occ4   0.19408         NA      NA       NA    \nMult(1, Educ, .).Occ5   1.34889         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 17.602 on 5 degrees of freedom\nAIC: 163.98\n\nNumber of iterations: 71\n\n# 変数と係数と係数の順番を表示\npickCoef(UplusRC, \"[.]Educ\")\n\nMult(1, ., Occ).Educ1 Mult(1, ., Occ).Educ2 Mult(1, ., Occ).Educ3 \n                   11                    12                    13 \nMult(1, ., Occ).Educ4 \n                   14 \n\npickCoef(UplusRC, \"[.]Occ\")\n\nMult(1, Educ, .).Occ1 Mult(1, Educ, .).Occ2 Mult(1, Educ, .).Occ3 \n                   15                    16                    17 \nMult(1, Educ, .).Occ4 Mult(1, Educ, .).Occ5 \n                   18                    19 \n\ndata.frame(var = names(UplusRC$coefficients),\n           estimate = UplusRC$coefficients) |&gt; \n  mutate(estimate = estimate,\n         number = row_number())\n\n                                        var     estimate number\n(Intercept)                     (Intercept)   5.49123206      1\nEduc2                                 Educ2  -2.07045034      2\nEduc3                                 Educ3  -1.00877122      3\nEduc4                                 Educ4  -3.55472593      4\nOcc2                                   Occ2  -1.06909237      5\nOcc3                                   Occ3  -5.17112951      6\nOcc4                                   Occ4  -4.53939355      7\nOcc5                                   Occ5 -10.91018443      8\nRscore:Cscore                 Rscore:Cscore   0.55211791      9\nMult(., Educ, Occ).     Mult(., Educ, Occ).   0.05378691     10\nMult(1, ., Occ).Educ1 Mult(1, ., Occ).Educ1  57.38878762     11\nMult(1, ., Occ).Educ2 Mult(1, ., Occ).Educ2  28.47707090     12\nMult(1, ., Occ).Educ3 Mult(1, ., Occ).Educ3 -10.70009235     13\nMult(1, ., Occ).Educ4 Mult(1, ., Occ).Educ4   9.22300628     14\nMult(1, Educ, .).Occ1 Mult(1, Educ, .).Occ1   0.06066883     15\nMult(1, Educ, .).Occ2 Mult(1, Educ, .).Occ2  -0.31187524     16\nMult(1, Educ, .).Occ3 Mult(1, Educ, .).Occ3   0.01525644     17\nMult(1, Educ, .).Occ4 Mult(1, Educ, .).Occ4   0.19407628     18\nMult(1, Educ, .).Occ5 Mult(1, Educ, .).Occ5   1.34889132     19\n\nmu &lt;- getContrasts(UplusRC, \n                   pickCoef(UplusRC, \"[.]Educ\"), \n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\nnu &lt;- getContrasts(UplusRC, \n                   pickCoef(UplusRC, \"[.]Occ\"), \n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\n\n# 中心化制約と尺度化制約の確認\nsum(mu$qvframe[,1]) |&gt; round()\n\n[1] 0\n\nsum(mu$qvframe[,1]^2)\n\n[1] 1\n\nsum(nu$qvframe[,1]) |&gt; round()\n\n[1] 0\n\nsum(nu$qvframe[,1]^2)\n\n[1] 1\n\n# 行スコアと列スコアの両端の値を固定する\ncon &lt;- c(mu$qvframe[,1][c(1,4)],nu$qvframe[,1][c(1,5)])\n\nset.seed(1234567)\nUplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Rscore:Cscore + \n        Mult(1, Educ, Occ),\n      constrain = c(11,14,15,19),\n      constrainTo = con,\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n.........\nDone\n\nsummary(UplusRC)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\"Rscore|Cscore|Mult\",\n                      Variable))\n\n                Variable    Estimate Std..Error   z.value     Pr...z..\n1          Rscore:Cscore  0.55211791 0.03429436 16.099379 2.576758e-58\n2    Mult(., Educ, Occ).  3.43558976 0.61932837  5.547283 2.901428e-08\n3  Mult(1, ., Occ).Educ1  0.72242916         NA        NA           NA\n4  Mult(1, ., Occ).Educ2  0.14690561 0.13431003  1.093780 2.740515e-01\n5  Mult(1, ., Occ).Educ3 -0.63296437 0.13149187 -4.813715 1.481501e-06\n6  Mult(1, ., Occ).Educ4 -0.23637040         NA        NA           NA\n7  Mult(1, Educ, .).Occ1 -0.15787324         NA        NA           NA\n8  Mult(1, Educ, .).Occ2 -0.45087063 0.05888770 -7.656448 1.911463e-14\n9  Mult(1, Educ, .).Occ3 -0.19358905 0.08174718 -2.368143 1.787760e-02\n10 Mult(1, Educ, .).Occ4 -0.05295134 0.05110102 -1.036209 3.001047e-01\n11 Mult(1, Educ, .).Occ5  0.85528425         NA        NA           NA"
  },
  {
    "objectID": "3-Chapter_2.html#表2.7b",
    "href": "3-Chapter_2.html#表2.7b",
    "title": "2  第2章",
    "section": "2.24 表2.7B",
    "text": "2.24 表2.7B\n\nRplusRC.un &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Cscore:Educ + \n        Mult(1, Educ, Occ),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.............................\nDone\n\nsummary(RplusRC.un)\n\n\nCall:\ngnm(formula = Freq ~ Educ + Occ + Cscore:Educ + Mult(1, Educ, \n    Occ), family = poisson, data = freq_tab_2.3B, tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-0.96462  -0.24301  -0.05231   0.31330   1.21311  \n\nCoefficients:\n                      Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)             7.8043         NA      NA       NA\nEduc2                  -2.5496         NA      NA       NA\nEduc3                  -1.0924         NA      NA       NA\nEduc4                  -3.6305         NA      NA       NA\nOcc2                    1.0437         NA      NA       NA\nOcc3                   -0.7855         NA      NA       NA\nOcc4                    2.0809         NA      NA       NA\nOcc5                   -1.8534         NA      NA       NA\nEduc1:Cscore           -1.7432         NA      NA       NA\nEduc2:Cscore           -0.9182         NA      NA       NA\nEduc3:Cscore           -0.5398         NA      NA       NA\nEduc4:Cscore            0.0000         NA      NA       NA\nMult(., Educ, Occ).    -0.4213         NA      NA       NA\nMult(1, ., Occ).Educ1  -2.0586         NA      NA       NA\nMult(1, ., Occ).Educ2  -0.7258         NA      NA       NA\nMult(1, ., Occ).Educ3   0.5605         NA      NA       NA\nMult(1, ., Occ).Educ4  -0.2104         NA      NA       NA\nMult(1, Educ, .).Occ1   0.2200         NA      NA       NA\nMult(1, Educ, .).Occ2  -0.9616         NA      NA       NA\nMult(1, Educ, .).Occ3   0.1953         NA      NA       NA\nMult(1, Educ, .).Occ4   0.7768         NA      NA       NA\nMult(1, Educ, .).Occ5   4.8551         NA      NA       NA\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 6.9359 on 4 degrees of freedom\nAIC: 155.31\n\nNumber of iterations: 29\n\npickCoef(RplusRC.un, \"[:]Cscore\")\n\nEduc1:Cscore Educ2:Cscore Educ3:Cscore Educ4:Cscore \n           9           10           11           12 \n\nRplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Cscore:Educ + \n        Mult(1, Educ, Occ),\n      constrain = c(9,12),\n      constrainTo = c(0,0),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations........................................\nDone\n\nsummary(RplusRC)\n\n\nCall:\ngnm(formula = Freq ~ Educ + Occ + Cscore:Educ + Mult(1, Educ, \n    Occ), constrain = c(9, 12), constrainTo = c(0, 0), family = poisson, \n    data = freq_tab_2.3B, tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-0.96462  -0.24301  -0.05231   0.31330   1.21311  \n\nCoefficients:\n                      Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)             5.0338         NA      NA       NA    \nEduc2                  -0.4417         NA      NA       NA    \nEduc3                   3.0501         NA      NA       NA    \nEduc4                  -0.7074         NA      NA       NA    \nOcc2                    0.6767         NA      NA       NA    \nOcc3                   -1.1329         NA      NA       NA    \nOcc4                    1.6580         NA      NA       NA    \nOcc5                   -1.7737         NA      NA       NA    \nEduc1:Cscore            0.0000         NA      NA       NA    \nEduc2:Cscore           -0.4321     0.2210  -1.955   0.0506 .  \nEduc3:Cscore           -1.2670     0.1931  -6.562 5.31e-11 ***\nEduc4:Cscore            0.0000         NA      NA       NA    \nMult(., Educ, Occ).    -1.5191         NA      NA       NA    \nMult(1, ., Occ).Educ1   4.6510         NA      NA       NA    \nMult(1, ., Occ).Educ2   0.9307         NA      NA       NA    \nMult(1, ., Occ).Educ3  -2.6602         NA      NA       NA    \nMult(1, ., Occ).Educ4  -0.5081         NA      NA       NA    \nMult(1, Educ, .).Occ1  -0.1724         NA      NA       NA    \nMult(1, Educ, .).Occ2   0.1674         NA      NA       NA    \nMult(1, Educ, .).Occ3   0.2749         NA      NA       NA    \nMult(1, Educ, .).Occ4   0.4395         NA      NA       NA    \nMult(1, Educ, .).Occ5   0.2568         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 6.9359 on 4 degrees of freedom\nAIC: 155.31\n\nNumber of iterations: 40\n\n# 変数と係数と係数の順番を表示\npickCoef(RplusRC.un, \"[.]Educ\")\n\nMult(1, ., Occ).Educ1 Mult(1, ., Occ).Educ2 Mult(1, ., Occ).Educ3 \n                   14                    15                    16 \nMult(1, ., Occ).Educ4 \n                   17 \n\npickCoef(RplusRC.un, \"[.]Occ\")\n\nMult(1, Educ, .).Occ1 Mult(1, Educ, .).Occ2 Mult(1, Educ, .).Occ3 \n                   18                    19                    20 \nMult(1, Educ, .).Occ4 Mult(1, Educ, .).Occ5 \n                   21                    22 \n\ndata.frame(var = names(RplusRC$coefficients),\n           estimate = RplusRC$coefficients) |&gt; \n  mutate(estimate = estimate,\n         number = row_number())\n\n                                        var   estimate number\n(Intercept)                     (Intercept)  5.0338134      1\nEduc2                                 Educ2 -0.4416984      2\nEduc3                                 Educ3  3.0500999      3\nEduc4                                 Educ4 -0.7074330      4\nOcc2                                   Occ2  0.6766646      5\nOcc3                                   Occ3 -1.1329222      6\nOcc4                                   Occ4  1.6579720      7\nOcc5                                   Occ5 -1.7736652      8\nEduc1:Cscore                   Educ1:Cscore         NA      9\nEduc2:Cscore                   Educ2:Cscore -0.4320760     10\nEduc3:Cscore                   Educ3:Cscore -1.2669500     11\nEduc4:Cscore                   Educ4:Cscore         NA     12\nMult(., Educ, Occ).     Mult(., Educ, Occ). -1.5191478     13\nMult(1, ., Occ).Educ1 Mult(1, ., Occ).Educ1  4.6509709     14\nMult(1, ., Occ).Educ2 Mult(1, ., Occ).Educ2  0.9307366     15\nMult(1, ., Occ).Educ3 Mult(1, ., Occ).Educ3 -2.6601848     16\nMult(1, ., Occ).Educ4 Mult(1, ., Occ).Educ4 -0.5080538     17\nMult(1, Educ, .).Occ1 Mult(1, Educ, .).Occ1 -0.1724067     18\nMult(1, Educ, .).Occ2 Mult(1, Educ, .).Occ2  0.1674123     19\nMult(1, Educ, .).Occ3 Mult(1, Educ, .).Occ3  0.2748827     20\nMult(1, Educ, .).Occ4 Mult(1, Educ, .).Occ4  0.4395333     21\nMult(1, Educ, .).Occ5 Mult(1, Educ, .).Occ5  0.2567545     22\n\nmu &lt;- getContrasts(RplusRC, \n                   pickCoef(RplusRC, \"[.]Educ\"), \n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\nnu &lt;- getContrasts(RplusRC, \n                   pickCoef(RplusRC, \"[.]Occ\"), \n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\ncon &lt;- c(0,0,\n         mu$qvframe[,1][c(1,4)],\n         nu$qvframe[,1][c(1,5)])\n\nRplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Cscore:Educ + \n        Mult(1, Educ, Occ),\n      constrain = c(9,12,14,17,18,22),\n      constrainTo = con,\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.....................................\nDone\n\nsummary(RplusRC)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\"Rscore|Cscore|Mult\", Variable))\n\n                Variable    Estimate Std..Error    z.value     Pr...z..\n1           Educ1:Cscore  0.00000000         NA         NA           NA\n2           Educ2:Cscore -0.43207600  0.2209849 -1.9552282 5.055614e-02\n3           Educ3:Cscore -1.26695003  0.1930731 -6.5620238 5.308234e-11\n4           Educ4:Cscore  0.00000000         NA         NA           NA\n5    Mult(., Educ, Occ). -3.67046405  0.5474332 -6.7048620 2.015968e-11\n6  Mult(1, ., Occ).Educ1  0.75983648         NA         NA           NA\n7  Mult(1, ., Occ).Educ2  0.06145542  0.1367987  0.4492399 6.532586e-01\n8  Mult(1, ., Occ).Educ3 -0.61265036  0.1325427 -4.6222852 3.795357e-06\n9  Mult(1, ., Occ).Educ4 -0.20864153         NA         NA           NA\n10 Mult(1, Educ, .).Occ1 -0.80614447         NA         NA           NA\n11 Mult(1, Educ, .).Occ2 -0.05693272  0.1225191 -0.4646846 6.421573e-01\n12 Mult(1, Educ, .).Occ3  0.18001127  0.1630841  1.1037941 2.696825e-01\n13 Mult(1, Educ, .).Occ4  0.54302264  0.2004941  2.7084221 6.760398e-03\n14 Mult(1, Educ, .).Occ5  0.14004328         NA         NA           NA"
  },
  {
    "objectID": "3-Chapter_2.html#表2.7c",
    "href": "3-Chapter_2.html#表2.7c",
    "title": "2  第2章",
    "section": "2.25 表2.7C",
    "text": "2.25 表2.7C\nAlgorithm failed - no model could be estimatedとなったら再度推定すること．\n\nset.seed(1234)\nCplusRC.un &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Rscore:Occ + \n        Mult(1, Educ, Occ),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...................................................\nDone\n\nsummary(CplusRC.un)\n\n\nCall:\ngnm(formula = Freq ~ Educ + Occ + Rscore:Occ + Mult(1, Educ, \n    Occ), family = poisson, data = freq_tab_2.3B, tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.98938  -0.14103  -0.01486   0.18280   2.20453  \n\nCoefficients:\n                      Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)            7.10137         NA      NA       NA\nEduc2                 -0.60908         NA      NA       NA\nEduc3                  1.91190         NA      NA       NA\nEduc4                  0.89240         NA      NA       NA\nOcc2                  -1.92075         NA      NA       NA\nOcc3                  -5.71514         NA      NA       NA\nOcc4                  -4.14240         NA      NA       NA\nOcc5                  -6.62799         NA      NA       NA\nOcc1:Rscore           -0.95586         NA      NA       NA\nOcc2:Rscore           -0.14909         NA      NA       NA\nOcc3:Rscore            0.31615         NA      NA       NA\nOcc4:Rscore            0.57050         NA      NA       NA\nOcc5:Rscore            0.00000         NA      NA       NA\nMult(., Educ, Occ).    0.66123         NA      NA       NA\nMult(1, ., Occ).Educ1  2.38686         NA      NA       NA\nMult(1, ., Occ).Educ2  0.76217         NA      NA       NA\nMult(1, ., Occ).Educ3 -1.41566         NA      NA       NA\nMult(1, ., Occ).Educ4  2.21619         NA      NA       NA\nMult(1, Educ, .).Occ1  0.05371         NA      NA       NA\nMult(1, Educ, .).Occ2 -0.28583         NA      NA       NA\nMult(1, Educ, .).Occ3  0.04603         NA      NA       NA\nMult(1, Educ, .).Occ4  0.13605         NA      NA       NA\nMult(1, Educ, .).Occ5  0.76573         NA      NA       NA\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 11.405 on 3 degrees of freedom\nAIC: 161.78\n\nNumber of iterations: 51\n\npickCoef(CplusRC.un, \"[:]Rscore\")\n\nOcc1:Rscore Occ2:Rscore Occ3:Rscore Occ4:Rscore Occ5:Rscore \n          9          10          11          12          13 \n\nCplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Rscore:Occ + \n        Mult(1, Educ, Occ),\n      constrain = c(9,13),\n      constrainTo = c(0,0),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations..............................................\nDone\n\nsummary(CplusRC)\n\n\nCall:\ngnm(formula = Freq ~ Educ + Occ + Rscore:Occ + Mult(1, Educ, \n    Occ), constrain = c(9, 13), constrainTo = c(0, 0), family = poisson, \n    data = freq_tab_2.3B, tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.98938  -0.14103  -0.01486   0.18280   2.20453  \n\nCoefficients:\n                      Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)            6.20363         NA      NA       NA    \nEduc2                 -1.63502         NA      NA       NA    \nEduc3                 -0.14273         NA      NA       NA    \nEduc4                 -2.16197         NA      NA       NA    \nOcc2                  -2.71651         NA      NA       NA    \nOcc3                  -5.73314         NA      NA       NA    \nOcc4                  -3.94944         NA      NA       NA    \nOcc5                  -4.95928         NA      NA       NA    \nOcc1:Rscore            0.00000         NA      NA       NA    \nOcc2:Rscore            1.26259    0.16970   7.440 1.00e-13 ***\nOcc3:Rscore            1.28232    0.20937   6.125 9.08e-10 ***\nOcc4:Rscore            1.41583    0.09054  15.638  &lt; 2e-16 ***\nOcc5:Rscore            0.00000         NA      NA       NA    \nMult(., Educ, Occ).    0.19485         NA      NA       NA    \nMult(1, ., Occ).Educ1  2.16357         NA      NA       NA    \nMult(1, ., Occ).Educ2  3.16895         NA      NA       NA    \nMult(1, ., Occ).Educ3  2.80310         NA      NA       NA    \nMult(1, ., Occ).Educ4 16.83940         NA      NA       NA    \nMult(1, Educ, .).Occ1  0.06320         NA      NA       NA    \nMult(1, Educ, .).Occ2 -0.40161         NA      NA       NA    \nMult(1, Educ, .).Occ3  0.05268         NA      NA       NA    \nMult(1, Educ, .).Occ4  0.17592         NA      NA       NA    \nMult(1, Educ, .).Occ5  1.03792         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 11.405 on 3 degrees of freedom\nAIC: 161.78\n\nNumber of iterations: 46\n\nsummary(CplusRC)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\"Rscore|Cscore|Mult\", Variable))\n\n                Variable    Estimate Std..Error   z.value     Pr...z..\n1            Occ1:Rscore  0.00000000         NA        NA           NA\n2            Occ2:Rscore  1.26259006  0.1696974  7.440245 1.004990e-13\n3            Occ3:Rscore  1.28231939  0.2093667  6.124752 9.082487e-10\n4            Occ4:Rscore  1.41582828  0.0905404 15.637531 4.040916e-55\n5            Occ5:Rscore  0.00000000         NA        NA           NA\n6    Mult(., Educ, Occ).  0.19484605         NA        NA           NA\n7  Mult(1, ., Occ).Educ1  2.16357386         NA        NA           NA\n8  Mult(1, ., Occ).Educ2  3.16895075         NA        NA           NA\n9  Mult(1, ., Occ).Educ3  2.80310016         NA        NA           NA\n10 Mult(1, ., Occ).Educ4 16.83939688         NA        NA           NA\n11 Mult(1, Educ, .).Occ1  0.06320167         NA        NA           NA\n12 Mult(1, Educ, .).Occ2 -0.40161169         NA        NA           NA\n13 Mult(1, Educ, .).Occ3  0.05268391         NA        NA           NA\n14 Mult(1, Educ, .).Occ4  0.17591506         NA        NA           NA\n15 Mult(1, Educ, .).Occ5  1.03791723         NA        NA           NA\n\n# 変数と係数と係数の順番を表示\ndata.frame(var = names(CplusRC$coefficients),\n           estimate = CplusRC$coefficients) |&gt; \n  mutate(estimate = estimate,\n         number = row_number())\n\n                                        var    estimate number\n(Intercept)                     (Intercept)  6.20363194      1\nEduc2                                 Educ2 -1.63501732      2\nEduc3                                 Educ3 -0.14273304      3\nEduc4                                 Educ4 -2.16196522      4\nOcc2                                   Occ2 -2.71650934      5\nOcc3                                   Occ3 -5.73314338      6\nOcc4                                   Occ4 -3.94943954      7\nOcc5                                   Occ5 -4.95928306      8\nOcc1:Rscore                     Occ1:Rscore          NA      9\nOcc2:Rscore                     Occ2:Rscore  1.26259006     10\nOcc3:Rscore                     Occ3:Rscore  1.28231939     11\nOcc4:Rscore                     Occ4:Rscore  1.41582828     12\nOcc5:Rscore                     Occ5:Rscore          NA     13\nMult(., Educ, Occ).     Mult(., Educ, Occ).  0.19484605     14\nMult(1, ., Occ).Educ1 Mult(1, ., Occ).Educ1  2.16357386     15\nMult(1, ., Occ).Educ2 Mult(1, ., Occ).Educ2  3.16895075     16\nMult(1, ., Occ).Educ3 Mult(1, ., Occ).Educ3  2.80310016     17\nMult(1, ., Occ).Educ4 Mult(1, ., Occ).Educ4 16.83939688     18\nMult(1, Educ, .).Occ1 Mult(1, Educ, .).Occ1  0.06320167     19\nMult(1, Educ, .).Occ2 Mult(1, Educ, .).Occ2 -0.40161169     20\nMult(1, Educ, .).Occ3 Mult(1, Educ, .).Occ3  0.05268391     21\nMult(1, Educ, .).Occ4 Mult(1, Educ, .).Occ4  0.17591506     22\nMult(1, Educ, .).Occ5 Mult(1, Educ, .).Occ5  1.03791723     23\n\nmu &lt;- getContrasts(CplusRC, \n                   pickCoef(CplusRC, \"[.]Educ\"),\n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\nnu &lt;- getContrasts(CplusRC, \n                   pickCoef(CplusRC, \"[.]Occ\"),\n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\ncon &lt;- c(0,0,\n         mu$qvframe[,1][c(1,4)],\n         nu$qvframe[,1][c(1,5)])\n\nCplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Rscore:Occ + \n        Mult(1, Educ, Occ),\n      constrain = c(9,13,15,18,19,23),\n      constrainTo = con,\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...............................................\nDone\n\nsummary(CplusRC)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\"Rscore|Cscore|Mult\", Variable))\n\n                Variable     Estimate Std..Error   z.value     Pr...z..\n1            Occ1:Rscore  0.000000000         NA        NA           NA\n2            Occ2:Rscore  1.262590058 0.16969738  7.440245 1.004990e-13\n3            Occ3:Rscore  1.282319390 0.20936674  6.124752 9.082487e-10\n4            Occ4:Rscore  1.415828283 0.09054040 15.637531 4.040916e-55\n5            Occ5:Rscore  0.000000000         NA        NA           NA\n6    Mult(., Educ, Occ).  2.509132039 0.47337666  5.300498 1.154873e-07\n7  Mult(1, ., Occ).Educ1 -0.332914652         NA        NA           NA\n8  Mult(1, ., Occ).Educ2 -0.250882838 0.17043562 -1.472009 1.410183e-01\n9  Mult(1, ., Occ).Educ3 -0.280733721 0.25875316 -1.084948 2.779447e-01\n10 Mult(1, ., Occ).Educ4  0.864531211         NA        NA           NA\n11 Mult(1, Educ, .).Occ1 -0.116510615         NA        NA           NA\n12 Mult(1, Educ, .).Occ2 -0.558888360 0.15090381 -3.703607 2.125557e-04\n13 Mult(1, Educ, .).Occ3 -0.126520705 0.12280113 -1.030289 3.028742e-01\n14 Mult(1, Educ, .).Occ4 -0.009237675 0.06533009 -0.141400 8.875539e-01\n15 Mult(1, Educ, .).Occ5  0.811157355         NA        NA           NA"
  },
  {
    "objectID": "3-Chapter_2.html#表2.7d",
    "href": "3-Chapter_2.html#表2.7d",
    "title": "2  第2章",
    "section": "2.26 表2.7D",
    "text": "2.26 表2.7D\nまずは行効果と列効果のパラメータに対して0という制約を課し，その上で推定した行スコアと列スコアを正規化し，再度推定する．\n\nRplusCplusRC.un &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Cscore:Educ + \n        Rscore:Occ + \n        Mult(1, Educ, Occ),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations..............\nDone\n\nsummary(RplusCplusRC.un)\n\n\nCall:\ngnm(formula = Freq ~ Educ + Occ + Cscore:Educ + Rscore:Occ + \n    Mult(1, Educ, Occ), family = poisson, data = freq_tab_2.3B, \n    tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-0.46856  -0.01129  -0.00160   0.02313   0.20690  \n\nCoefficients:\n                       Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)             7.70566         NA      NA       NA\nEduc2                   2.93231         NA      NA       NA\nEduc3                   9.84106         NA      NA       NA\nEduc4                  11.98330         NA      NA       NA\nOcc2                   -5.32506         NA      NA       NA\nOcc3                  -11.88093         NA      NA       NA\nOcc4                  -13.38551         NA      NA       NA\nOcc5                  -18.15374         NA      NA       NA\nEduc1:Cscore            2.30655         NA      NA       NA\nEduc2:Cscore            1.65824         NA      NA       NA\nEduc3:Cscore            0.57607         NA      NA       NA\nEduc4:Cscore            0.00000         NA      NA       NA\nOcc1:Rscore            -3.93278         NA      NA       NA\nOcc2:Rscore            -2.23708         NA      NA       NA\nOcc3:Rscore            -1.05781         NA      NA       NA\nOcc4:Rscore             0.00000         NA      NA       NA\nOcc5:Rscore             0.00000         NA      NA       NA\nMult(., Educ, Occ).     0.30868         NA      NA       NA\nMult(1, ., Occ).Educ1   0.24164         NA      NA       NA\nMult(1, ., Occ).Educ2  -0.05431         NA      NA       NA\nMult(1, ., Occ).Educ3  -0.29807         NA      NA       NA\nMult(1, ., Occ).Educ4   0.43140         NA      NA       NA\nMult(1, Educ, .).Occ1   2.28861         NA      NA       NA\nMult(1, Educ, .).Occ2  -2.69886         NA      NA       NA\nMult(1, Educ, .).Occ3   0.26160         NA      NA       NA\nMult(1, Educ, .).Occ4   0.21052         NA      NA       NA\nMult(1, Educ, .).Occ5   7.13039         NA      NA       NA\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 0.27843 on 2 degrees of freedom\nAIC: 152.66\n\nNumber of iterations: 14\n\npickCoef(RplusCplusRC.un, \"[:]Cscore\")\n\nEduc1:Cscore Educ2:Cscore Educ3:Cscore Educ4:Cscore \n           9           10           11           12 \n\npickCoef(RplusCplusRC.un, \"[:]Rscore\")\n\nOcc1:Rscore Occ2:Rscore Occ3:Rscore Occ4:Rscore Occ5:Rscore \n         13          14          15          16          17 \n\nRplusCplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Cscore:Educ + \n        Rscore:Occ + \n        Mult(1, Educ, Occ),\n      constrain = c(9,12,13,14,17), \n      constrainTo = c(0,0,0,0,0),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations............................\nDone\n\n# 変数と係数と係数の順番を表示\ndata.frame(var = names(CplusRC$coefficients),\n           estimate = CplusRC$coefficients) |&gt; \n  mutate(estimate = estimate,\n         number = row_number())\n\n                                        var     estimate number\n(Intercept)                     (Intercept)  6.132951036      1\nEduc2                                 Educ2 -1.598655285      2\nEduc3                                 Educ3 -0.119602932      3\nEduc4                                 Educ4 -1.631176445      4\nOcc2                                   Occ2 -3.281987830      5\nOcc3                                   Occ3 -5.745938986      6\nOcc4                                   Occ4 -3.812315688      7\nOcc5                                   Occ5 -3.773472310      8\nOcc1:Rscore                     Occ1:Rscore           NA      9\nOcc2:Rscore                     Occ2:Rscore  1.262590058     10\nOcc3:Rscore                     Occ3:Rscore  1.282319390     11\nOcc4:Rscore                     Occ4:Rscore  1.415828283     12\nOcc5:Rscore                     Occ5:Rscore           NA     13\nMult(., Educ, Occ).     Mult(., Educ, Occ).  2.509132039     14\nMult(1, ., Occ).Educ1 Mult(1, ., Occ).Educ1           NA     15\nMult(1, ., Occ).Educ2 Mult(1, ., Occ).Educ2 -0.250882838     16\nMult(1, ., Occ).Educ3 Mult(1, ., Occ).Educ3 -0.280733721     17\nMult(1, ., Occ).Educ4 Mult(1, ., Occ).Educ4           NA     18\nMult(1, Educ, .).Occ1 Mult(1, Educ, .).Occ1           NA     19\nMult(1, Educ, .).Occ2 Mult(1, Educ, .).Occ2 -0.558888360     20\nMult(1, Educ, .).Occ3 Mult(1, Educ, .).Occ3 -0.126520705     21\nMult(1, Educ, .).Occ4 Mult(1, Educ, .).Occ4 -0.009237675     22\nMult(1, Educ, .).Occ5 Mult(1, Educ, .).Occ5           NA     23\n\nmu &lt;- getContrasts(RplusCplusRC, \n                   pickCoef(RplusCplusRC, \"[.]Educ\"), \n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\nnu &lt;- getContrasts(RplusCplusRC,\n                   pickCoef(RplusCplusRC, \"[.]Occ\"), \n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\ncon &lt;- c(0,0,0,0,0,\n         mu$qvframe[,1][c(1,4)],\n         nu$qvframe[,1][c(1,5)])\n\nRplusCplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Cscore:Educ + \n        Rscore:Occ + \n        Mult(1, Educ, Occ),\n      constrain = c(9,12,13,14,17,19,22,23,27), \n      constrainTo = con,\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations......................\nDone\n\nmu\n\n                         Estimate Std. Error\nMult(1, ., Occ).Educ1 -0.76639941 0.03714637\nMult(1, ., Occ).Educ2 -0.05505913 0.08952794\nMult(1, ., Occ).Educ3  0.60073372 0.04744381\nMult(1, ., Occ).Educ4  0.22072481 0.06764890\n\nnu\n\n                         Estimate Std. Error\nMult(1, Educ, .).Occ1  0.83832072 0.02535129\nMult(1, Educ, .).Occ2 -0.04397713 0.08855421\nMult(1, Educ, .).Occ3 -0.11946443 0.09158773\nMult(1, Educ, .).Occ4 -0.50065982 0.06550415\nMult(1, Educ, .).Occ5 -0.17421935 0.12622465\n\nsummary(RplusCplusRC)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\"Rscore|Cscore|Mult\", Variable))\n\n                Variable    Estimate Std..Error    z.value     Pr...z..\n1           Educ1:Cscore  0.00000000         NA         NA           NA\n2           Educ2:Cscore -0.29016794  0.1835938 -1.5804884 1.139951e-01\n3           Educ3:Cscore -0.95452353  0.2168230 -4.4023158 1.071015e-05\n4           Educ4:Cscore  0.00000000         NA         NA           NA\n5            Occ1:Rscore  0.00000000         NA         NA           NA\n6            Occ2:Rscore  0.00000000         NA         NA           NA\n7            Occ3:Rscore  0.39725281  0.1673266  2.3741161 1.759102e-02\n8            Occ4:Rscore  0.32684292  0.1614939  2.0238715 4.298337e-02\n9            Occ5:Rscore  0.00000000         NA         NA           NA\n10   Mult(., Educ, Occ). -2.85715993  0.5343817 -5.3466654 8.958940e-08\n11 Mult(1, ., Occ).Educ1 -0.76639941         NA         NA           NA\n12 Mult(1, ., Occ).Educ2 -0.05505913  0.1291228 -0.4264091 6.698098e-01\n13 Mult(1, ., Occ).Educ3  0.60073372  0.1297703  4.6292078 3.670672e-06\n14 Mult(1, ., Occ).Educ4  0.22072481         NA         NA           NA\n15 Mult(1, Educ, .).Occ1  0.83832072         NA         NA           NA\n16 Mult(1, Educ, .).Occ2 -0.04397713  0.1677272 -0.2621944 7.931715e-01\n17 Mult(1, Educ, .).Occ3 -0.11946443  0.1842187 -0.6484923 5.166666e-01\n18 Mult(1, Educ, .).Occ4 -0.50065982  0.2149854 -2.3288081 1.986923e-02\n19 Mult(1, Educ, .).Occ5 -0.17421935         NA         NA           NA"
  },
  {
    "objectID": "3-Chapter_2.html#表2.7e",
    "href": "3-Chapter_2.html#表2.7e",
    "title": "2  第2章",
    "section": "2.27 表2.7E",
    "text": "2.27 表2.7E\nWongのサポートページにあるように，gnmを用いてRC(2)の係数を推定することは難しい．ここではKateri, Maria. 2014. {}. New York: Birkhäuser. のsupportページにあるプログラムを使用して係数を求める．\n\\(M &gt; 1\\)のRC(M)を推定するためにはgnmのinstancesを用いる． 今はinstances = 2としており，RC(2)を用いている． なお，式(2.35)のように\\(\\phi\\)は推定されない． これらスコアは求まるものの，直交という次元間制約が課されてない． そこで，特異値分解（SVD: singular value decomposition）によって行スコアと列スコアのそれぞれが次元間で直行するような変換を行う．\nまず次元間制約が課されてない行スコアの行列（\\(I\\times m\\)）と列スコアの行列（\\(J\\times m\\)）の積を求め，モデル化での2元交互作用パラメータを求める．\n\nRC2 &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        instances(Mult(Educ, Occ), instances = 2),\n      family = poisson, data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.......................\nDone\n\nsummary(RC2)\n\n\nCall:\ngnm(formula = Freq ~ Educ + Occ + instances(Mult(Educ, Occ), \n    instances = 2), family = poisson, data = freq_tab_2.3B, tolerance = 1e-12)\n\nDeviance Residuals: \n      Min         1Q     Median         3Q        Max  \n-0.631356  -0.030234  -0.004363   0.050323   0.320666  \n\nCoefficients:\n                             Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)                   4.98690         NA      NA       NA\nEduc2                        -0.82270         NA      NA       NA\nEduc3                         1.48754         NA      NA       NA\nEduc4                        -0.08253         NA      NA       NA\nOcc2                          0.02911         NA      NA       NA\nOcc3                         -2.10701         NA      NA       NA\nOcc4                          0.26228         NA      NA       NA\nOcc5                         -3.17251         NA      NA       NA\nMult(., Occ, inst = 1).Educ1 -6.48058         NA      NA       NA\nMult(., Occ, inst = 1).Educ2 -1.57685         NA      NA       NA\nMult(., Occ, inst = 1).Educ3  0.59452         NA      NA       NA\nMult(., Occ, inst = 1).Educ4  3.79509         NA      NA       NA\nMult(Educ, ., inst = 1).Occ1 -0.22164         NA      NA       NA\nMult(Educ, ., inst = 1).Occ2  0.11057         NA      NA       NA\nMult(Educ, ., inst = 1).Occ3  0.15266         NA      NA       NA\nMult(Educ, ., inst = 1).Occ4  0.21204         NA      NA       NA\nMult(Educ, ., inst = 1).Occ5 -0.15669         NA      NA       NA\nMult(., Occ, inst = 2).Educ1 -0.39694         NA      NA       NA\nMult(., Occ, inst = 2).Educ2 -0.26127         NA      NA       NA\nMult(., Occ, inst = 2).Educ3 -0.52436         NA      NA       NA\nMult(., Occ, inst = 2).Educ4  0.45321         NA      NA       NA\nMult(Educ, ., inst = 2).Occ1  0.43735         NA      NA       NA\nMult(Educ, ., inst = 2).Occ2 -0.65193         NA      NA       NA\nMult(Educ, ., inst = 2).Occ3  0.49859         NA      NA       NA\nMult(Educ, ., inst = 2).Occ4  0.79497         NA      NA       NA\nMult(Educ, ., inst = 2).Occ5  2.99034         NA      NA       NA\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 0.6001 on 2 degrees of freedom\nAIC: 152.98\n\nNumber of iterations: 23\n\nRCmodel_coef &lt;- function(RCmodel, row, col, m, data){\n  NI &lt;- RCmodel$xlevels[[1]] |&gt; length()\n  NJ &lt;- RCmodel$xlevels[[2]] |&gt; length()\n  iflag &lt;- 0\n  y &lt;- length(RCmodel$y)\n  X &lt;- gl(NI,NJ,length = y)\n  Y &lt;- gl(NJ,1,length = y)\n  IX &lt;- pickCoef(RCmodel, \n                 paste0(\"[.]\",deparse(substitute(row))))\n  IY &lt;- pickCoef(RCmodel,\n                 paste0(\"[.]\",deparse(substitute(col))))\n  X &lt;- RCmodel$coefficients[IX]\n  Y &lt;- RCmodel$coefficients[IY]\n  mu0 &lt;- matrix(X,nrow = NI,ncol = m)\n  nu0 &lt;- matrix(Y,nrow = NJ,ncol = m)\n  mu &lt;- mu0\n  nu &lt;- nu0\n  A &lt;- mu %*% t(nu) # [NI, M] [M. NJ]\n  R1 &lt;- diag(1,NI)\n  C1 &lt;- diag(1,NJ)\n  Rone &lt;- matrix(rep(1,NI^2),nrow = NI)\n  Cone &lt;- matrix(rep(1,NJ^2),nrow = NJ)\n  rowP &lt;- c(rep(1,NI))\n  colP &lt;- c(rep(1,NJ));\n  data &lt;- RC2$model\n  list(y,X,Y,IX,IY,data)\n  if (iflag == 1) {\n    rowP &lt;- with(data, tapply(freq,row,sum)/sum(freq))\n    colP &lt;- with(data, tapply(freq,col,sum)/sum(freq))}\n  DR &lt;- diag(rowP^(-1/2),NI)\n  DC &lt;- diag(colP^(-1/2),NJ)\n  RWsqr &lt;- diag(rowP^(1/2),NI)\n  CWsqr &lt;- diag(colP^(1/2),NJ)\n  RW &lt;- RWsqr^2\n  CW &lt;- CWsqr^2\n  L &lt;- (R1 - (Rone %*% RW)/sum(RW)) %*% A %*% t(C1 - (Cone %*% CW)/sum(CW))\n  phiv &lt;- svd(RWsqr %*% L %*% CWsqr)$d[1:m]\n  mu &lt;- svd(RWsqr %*% L %*% CWsqr)$u[,1:m]\n  nu &lt;- svd(RWsqr %*% L %*% CWsqr)$v[,1:m]\n  mu &lt;- DR %*% mu\n  nu &lt;- DC %*% nu\n  phi &lt;- diag(phiv, m)\n  L2 &lt;- RCmodel$deviance\n  df &lt;- RCmodel$df.residual\n  p.value &lt;- 1 - pchisq(L2,df)\n  fit.freq &lt;- predict(RCmodel, \n                      type = \"response\", \n                      se.fit = TRUE)\n  \n  print(list(model = RCmodel, \n     L2 = L2, \n     df = df,\n     p.value = p.value,\n     obs_freq = summary(RC2)$y, \n     fit.freq = fit.freq,\n     phi = phi, \n     mu = mu, \n     nu = nu,\n     cor(mu) |&gt; round(3),\n     cor(nu) |&gt; round(3)))\n  }\n\nRCmodel_coef(RC2, row = Educ, col = Occ, m =  2)\n\n$model\n\nCall:\ngnm(formula = Freq ~ Educ + Occ + instances(Mult(Educ, Occ), \n    instances = 2), family = poisson, data = freq_tab_2.3B, tolerance = 1e-12)\n\nCoefficients:\n                 (Intercept)                         Educ2  \n                     4.98690                      -0.82270  \n                       Educ3                         Educ4  \n                     1.48754                      -0.08253  \n                        Occ2                          Occ3  \n                     0.02911                      -2.10701  \n                        Occ4                          Occ5  \n                     0.26228                      -3.17251  \nMult(., Occ, inst = 1).Educ1  Mult(., Occ, inst = 1).Educ2  \n                    -6.48058                      -1.57685  \nMult(., Occ, inst = 1).Educ3  Mult(., Occ, inst = 1).Educ4  \n                     0.59452                       3.79509  \nMult(Educ, ., inst = 1).Occ1  Mult(Educ, ., inst = 1).Occ2  \n                    -0.22164                       0.11057  \nMult(Educ, ., inst = 1).Occ3  Mult(Educ, ., inst = 1).Occ4  \n                     0.15266                       0.21204  \nMult(Educ, ., inst = 1).Occ5  Mult(., Occ, inst = 2).Educ1  \n                    -0.15669                      -0.39694  \nMult(., Occ, inst = 2).Educ2  Mult(., Occ, inst = 2).Educ3  \n                    -0.26127                      -0.52436  \nMult(., Occ, inst = 2).Educ4  Mult(Educ, ., inst = 2).Occ1  \n                     0.45321                       0.43735  \nMult(Educ, ., inst = 2).Occ2  Mult(Educ, ., inst = 2).Occ3  \n                    -0.65193                       0.49859  \nMult(Educ, ., inst = 2).Occ4  Mult(Educ, ., inst = 2).Occ5  \n                     0.79497                       2.99034  \n\nDeviance:            0.6001022 \nPearson chi-squared: 0.5746549 \nResidual df:         2 \n\n$L2\n[1] 0.6001022\n\n$df\n[1] 2\n\n$p.value\n[1] 0.7407804\n\n$obs_freq\nNULL\n\n$fit.freq\n$fit.freq$fit\n          1           2           3           4           5           6 \n 517.836063   95.414391    5.433736   35.145848    5.169961   81.405000 \n          7           8           9          10          11          12 \n  65.976261    5.398934   48.639687    1.580117  451.846566 1003.387842 \n         13          14          15          16          17          18 \n  66.470016  630.136504    5.159072   70.912370  157.221505   36.697314 \n         19          20 \n 562.077961   12.090850 \n\n$fit.freq$se.fit\n        1         2         3         4         5         6         7         8 \n22.748933  9.732333  2.174395  5.860792  2.230227  8.912865  7.856714  1.044826 \n        9        10        11        12        13        14        15        16 \n 6.616317  0.619348 21.250045 31.666672  8.114913 25.088611  2.233235  8.415482 \n       17        18        19        20 \n12.530867  6.041164 23.703381  3.469126 \n\n$fit.freq$residual.scale\n[1] 1\n\n\n$phi\n         [,1]     [,2]\n[1,] 2.600861 0.000000\n[2,] 0.000000 1.521971\n\n$mu\n            [,1]        [,2]\n[1,]  0.74345129  0.27619989\n[2,]  0.08846472 -0.06103682\n[3,] -0.19984223 -0.77722344\n[4,] -0.63207378  0.56206037\n\n$nu\n            [,1]         [,2]\n[1,]  0.76509960 -0.137064850\n[2,]  0.01966104 -0.548959995\n[3,] -0.32245067 -0.119769392\n[4,] -0.55005650 -0.009934123\n[5,]  0.08774653  0.815728360\n\n[[10]]\n     [,1] [,2]\n[1,]    1    0\n[2,]    0    1\n\n[[11]]\n     [,1] [,2]\n[1,]    1    0\n[2,]    0    1\n\n\nlogmultパッケージのrcによってRC(2)を推定する．まずはanoasで連関分析を行う．表2.6Aと同じ結果になっていることを確認する．正規化だけではなく，次元間制約が課されており，表2.7の結果と一致する．\n\nanoas(tab_2.3B)\n\nFitting independence model...\nFitting model with 1 dimension...\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n........\nDone\nFitting model with 2 dimensions...\nInitialising\nRunning start-up iterations..\nRunning main iterations.........\nDone\nFitting model with 3 dimensions...\nInitialising\nRunning start-up iterations..\nRunning main iterations...\nDone\n\n\n       Res. Df            Res. Dev     Dev./Indep. (%)   Dissim. (%)\nIndep.      12 1373.17576565224545 100.000000000000000 23.8615752953\nRC(1)        6  125.05974855014664   9.107337289101110  6.4360390988\nRC(2)        2    0.60010223526822   0.043701778772885  0.0935165803\nRC(3)        0    0.00000000000009   0.000000000000006  0.0000000007\n                       BIC                 AIC    Dev. Df\nIndep. 1274.08091533065726 1349.17576565224545      NA NA\nRC(1)    75.51232338935259  113.05974855014664 -1248.1 -6\nRC(2)   -15.91570615166313   -3.39989776473178  -124.5 -4\nRC(3)     0.00000000000009    0.00000000000009    -0.6 -2\n\n\n\nRC2 &lt;- rc(tab_2.3B, \n          nd = 2, \n          weighting = \"none\", \n          se = \"bootstrap\",\n          nreplicates = 1000, \n          ncpus = getOption(\"boot.ncpus\"))\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.......\nDone\nComputing bootstrap standard errors...\n.\n\n\nWarning in jackboot(se, ncpus, nreplicates, tab, model, assoc1 =\ngetS3method(\"assoc\", : One model replicate failed and its results will be\nskipped. Standard errors will not be completely accurate. Consider raising the\nvalue of iterMax.\n\nsummary(RC2)\n\nCall:\nrc(tab = tab_2.3B, nd = 2, weighting = \"none\", se = \"bootstrap\", \n    nreplicates = 1000, ncpus = getOption(\"boot.ncpus\"))\n\nDeviance Residuals:\n    Columns\nRows         A         B         C         D         E\n   A   0.00720  -0.04245   0.23888  -0.02462  -0.07516\n   B  -0.04493   0.12571  -0.63136   0.05160   0.32067\n   C   0.00722  -0.01224   0.06492  -0.00544  -0.07040\n   D   0.01040  -0.01767   0.04990  -0.00329  -0.02616\n\nAssociation coefficients:\n               Normalized    Adjusted  Std. error   Pr(&gt;|z|)     \nDim1            2.6008615          NA      0.1873  &lt; 2.2e-16  ***\nDim2            1.5219709          NA      0.5272   0.003890  ** \nDim1:RowsA      0.7434513   1.1989778      0.0188  &lt; 2.2e-16  ***\nDim1:RowsB      0.0884647   0.1426687      0.0410   0.031124  *  \nDim1:RowsC     -0.1998422  -0.3222893      0.0226  &lt; 2.2e-16  ***\nDim1:RowsD     -0.6320738  -1.0193572      0.0185  &lt; 2.2e-16  ***\nDim2:RowsA      0.2761999   0.3407428      0.0903   0.002220  ** \nDim2:RowsB     -0.0610368  -0.0753000      0.1571   0.697718     \nDim2:RowsC     -0.7772234  -0.9588465      0.0637  &lt; 2.2e-16  ***\nDim2:RowsD      0.5620604   0.6934037      0.0696  6.804e-16  ***\nDim1:ColumnsA   0.7650996   1.2338904      0.0399  &lt; 2.2e-16  ***\nDim1:ColumnsB   0.0196610   0.0317077      0.0404   0.626275     \nDim1:ColumnsC  -0.3224507  -0.5200222      0.0991   0.001142  ** \nDim1:ColumnsD  -0.5500565  -0.8870864      0.0688  1.277e-15  ***\nDim1:ColumnsE   0.0877465   0.1415105      0.0992   0.376475     \nDim2:ColumnsA  -0.1370648  -0.1690944      0.0473   0.003746  ** \nDim2:ColumnsB  -0.5489600  -0.6772420      0.0805  9.003e-12  ***\nDim2:ColumnsC  -0.1197694  -0.1477573      0.0935   0.200113     \nDim2:ColumnsD  -0.0099341  -0.0122555      0.0708   0.888363     \nDim2:ColumnsE   0.8157284   1.0063493      0.0557  &lt; 2.2e-16  ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nNormalization weights: none\nDeviance:              0.6001022\nPearson chi-squared:   0.5746549\nDissimilarity index:   0.09351658%\nResidual df:           2\nBIC:                   -15.91571\nAIC:                   -3.399898\n\nRC2 |&gt; \n  summary() |&gt;\n  pluck(coefficients) |&gt;\n  data.frame() |&gt;\n  rownames_to_column(var = \"Parameter\") |&gt;\n  arrange(Parameter)\n\n       Parameter   Normalized    Adjusted Std..error      Pr...z..\n1           Dim1  2.600861491          NA 0.18733724  7.996127e-44\n2  Dim1:ColumnsA  0.765099599  1.23389040 0.03987968  4.920472e-82\n3  Dim1:ColumnsB  0.019661041  0.03170773 0.04037365  6.262746e-01\n4  Dim1:ColumnsC -0.322450671 -0.52002222 0.09912245  1.141718e-03\n5  Dim1:ColumnsD -0.550056503 -0.88708639 0.06878444  1.276783e-15\n6  Dim1:ColumnsE  0.087746534  0.14151047 0.09921477  3.764749e-01\n7     Dim1:RowsA  0.743451285  1.19897776 0.01883771  0.000000e+00\n8     Dim1:RowsB  0.088464723  0.14266871 0.04104172  3.112406e-02\n9     Dim1:RowsC -0.199842229 -0.32228929 0.02258981  9.025530e-19\n10    Dim1:RowsD -0.632073780 -1.01935718 0.01851006 1.452479e-255\n11          Dim2  1.521970932          NA 0.52719756  3.890478e-03\n12 Dim2:ColumnsA -0.137064849 -0.16909442 0.04728359  3.746148e-03\n13 Dim2:ColumnsB -0.548959996 -0.67724199 0.08047383  9.003428e-12\n14 Dim2:ColumnsC -0.119769391 -0.14775733 0.09347999  2.001128e-01\n15 Dim2:ColumnsD -0.009934123 -0.01225555 0.07076807  8.883631e-01\n16 Dim2:ColumnsE  0.815728359  1.00634928 0.05570139  1.457086e-48\n17    Dim2:RowsA  0.276199888  0.34074279 0.09028681  2.219741e-03\n18    Dim2:RowsB -0.061036818 -0.07530002 0.15714808  6.977177e-01\n19    Dim2:RowsC -0.777223438 -0.95884646 0.06373209  3.298285e-34\n20    Dim2:RowsD  0.562060367  0.69340368 0.06961379  6.804270e-16\n\n# getS3method(\"assoc\",\"rc\")"
  },
  {
    "objectID": "1-Introduction.html#度数行変数列変数のデータからクロス表を作成",
    "href": "1-Introduction.html#度数行変数列変数のデータからクロス表を作成",
    "title": "シリーズ編者による内容紹介",
    "section": "度数，行変数，列変数のデータからクロス表を作成",
    "text": "度数，行変数，列変数のデータからクロス表を作成\n\n度数，行変数，列変数のデータからクロス表を作成するにはxtabs関数を用いる．\n\n\nd |&gt; xtabs(Freq ~ PSES + MHS, data = _)\n\n    MHS\nPSES   1   2   3   4\n   1  64  94  58  46\n   2  57  94  54  40\n   3  57 105  65  60\n   4  72 141  77  94\n   5  36  97  54  78\n   6  21  71  54  71\n\n\n\nRに初めから準備されているTitanicデータは，多少特殊な集計がされているが，これにdata.frame関数を適用すると，集計データになる．これに対してxtabs関数を用いればクロス表を簡単に作成できる．\n\n\ndata.frame(Titanic) |&gt; xtabs(Freq ~ Class + Survived, data = _)\n\n      Survived\nClass   No Yes\n  1st  122 203\n  2nd  167 118\n  3rd  528 178\n  Crew 673 212\n\ndata.frame(Titanic) |&gt; xtabs(Freq ~ Sex + Survived, data = _)\n\n        Survived\nSex        No  Yes\n  Male   1364  367\n  Female  126  344\n\ndata.frame(Titanic) |&gt; xtabs(Freq ~ Age + Survived, data = _)\n\n       Survived\nAge       No  Yes\n  Child   52   57\n  Adult 1438  654"
  },
  {
    "objectID": "1-Introduction.html#個票データから集計データを作成",
    "href": "1-Introduction.html#個票データから集計データを作成",
    "title": "シリーズ編者による内容紹介",
    "section": "個票データから集計データを作成",
    "text": "個票データから集計データを作成\n\n個票データから集計データを作成する方法はいくつか考えられるが，ここではcount関数を用いる．\n\n\n# スターウォーズデータ\nstarwars\n\n# A tibble: 87 × 14\n   name     height  mass hair_color skin_color eye_color birth_year sex   gender\n   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; \n 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…\n 2 C-3PO       167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…\n 3 R2-D2        96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…\n 4 Darth V…    202   136 none       white      yellow          41.9 male  mascu…\n 5 Leia Or…    150    49 brown      light      brown           19   fema… femin…\n 6 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…\n 7 Beru Wh…    165    75 brown      light      blue            47   fema… femin…\n 8 R5-D4        97    32 &lt;NA&gt;       white, red red             NA   none  mascu…\n 9 Biggs D…    183    84 black      light      brown           24   male  mascu…\n10 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…\n# ℹ 77 more rows\n# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,\n#   vehicles &lt;list&gt;, starships &lt;list&gt;\n\n# 1つの変数にcount関数を適用\nstarwars |&gt; \n  count(sex)\n\n# A tibble: 5 × 2\n  sex                n\n  &lt;chr&gt;          &lt;int&gt;\n1 female            16\n2 hermaphroditic     1\n3 male              60\n4 none               6\n5 &lt;NA&gt;               4\n\n# 2つの変数にcount関数を適用し，集計レベルのデータを作成\nstarwars |&gt; \n  count(sex, gender)\n\n# A tibble: 6 × 3\n  sex            gender        n\n  &lt;chr&gt;          &lt;chr&gt;     &lt;int&gt;\n1 female         feminine     16\n2 hermaphroditic masculine     1\n3 male           masculine    60\n4 none           feminine      1\n5 none           masculine     5\n6 &lt;NA&gt;           &lt;NA&gt;          4\n\n# 欠損値を処理し，nをFreqと名前を変更し，df_dstarwarsとしてデータを保存\ndf_dstarwars &lt;- starwars |&gt; \n  count(sex, gender) |&gt; \n  drop_na() |&gt;\n  rename(Freq = n)\n\n# 確認\ndf_dstarwars\n\n# A tibble: 5 × 3\n  sex            gender     Freq\n  &lt;chr&gt;          &lt;chr&gt;     &lt;int&gt;\n1 female         feminine     16\n2 hermaphroditic masculine     1\n3 male           masculine    60\n4 none           feminine      1\n5 none           masculine     5\n\n\n別の例で分析してみる．palmerpenguinsパッケージにはpenguinsというデータが含まれている．\n\n#install.packages(\"palmerpenguins\")\nlibrary(palmerpenguins)\npenguins\n\n# A tibble: 344 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;\n 1 Adelie  Torgersen           39.1          18.7               181        3750\n 2 Adelie  Torgersen           39.5          17.4               186        3800\n 3 Adelie  Torgersen           40.3          18                 195        3250\n 4 Adelie  Torgersen           NA            NA                  NA          NA\n 5 Adelie  Torgersen           36.7          19.3               193        3450\n 6 Adelie  Torgersen           39.3          20.6               190        3650\n 7 Adelie  Torgersen           38.9          17.8               181        3625\n 8 Adelie  Torgersen           39.2          19.6               195        4675\n 9 Adelie  Torgersen           34.1          18.1               193        3475\n10 Adelie  Torgersen           42            20.2               190        4250\n# ℹ 334 more rows\n# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;\n\n\nこれをもとに集計データを作成する．ここでは種と性別のクロス表を作成する．\n\n# クロス表を作成\ntab_penguines &lt;- xtabs(~ species + sex, data = penguins)\ntab_penguines\n\n           sex\nspecies     female male\n  Adelie        73   73\n  Chinstrap     34   34\n  Gentoo        58   61\n\n\nなお，このクロス表からえられる独立性の検定についての指標や連関の係数は次のようになる．\n\nassocstats(tab_penguines)\n\n                      X^2 df P(&gt; X^2)\nLikelihood Ratio 0.048611  2  0.97599\nPearson          0.048607  2  0.97599\n\nPhi-Coefficient   : NA \nContingency Coeff.: 0.012 \nCramer's V        : 0.012 \n\n\n\n# クロス表をdata.frameとして読み込む\nfreq_penguines_1 &lt;- data.frame(tab_penguines)\nfreq_penguines_1\n\n    species    sex Freq\n1    Adelie female   73\n2 Chinstrap female   34\n3    Gentoo female   58\n4    Adelie   male   73\n5 Chinstrap   male   34\n6    Gentoo   male   61\n\n\ncountを使うこともできる．\n\nfreq_penguines_2 &lt;- penguins |&gt; \n  count(species, sex) |&gt; \n  rename(Freq = n)\nfreq_penguines_2\n\n# A tibble: 8 × 3\n  species   sex     Freq\n  &lt;fct&gt;     &lt;fct&gt;  &lt;int&gt;\n1 Adelie    female    73\n2 Adelie    male      73\n3 Adelie    &lt;NA&gt;       6\n4 Chinstrap female    34\n5 Chinstrap male      34\n6 Gentoo    female    58\n7 Gentoo    male      61\n8 Gentoo    &lt;NA&gt;       5\n\n# 欠損値を処理する\nfreq_penguines_2 &lt;- penguins |&gt; \n  count(species, sex) |&gt; \n  drop_na() |&gt; \n  rename(Freq = n)\nfreq_penguines_2\n\n# A tibble: 6 × 3\n  species   sex     Freq\n  &lt;fct&gt;     &lt;fct&gt;  &lt;int&gt;\n1 Adelie    female    73\n2 Adelie    male      73\n3 Chinstrap female    34\n4 Chinstrap male      34\n5 Gentoo    female    58\n6 Gentoo    male      61\n\n\nではglm関数を用いて対数線形モデルをあてはめる．\n\n# 独立モデル\nfit_penguines_O &lt;- \n  freq_penguines_2 |&gt; \n  glm(Freq ~ species + sex, family = \"poisson\", data = _)\n\n# 飽和モデル\nfit_penguines_FI &lt;- \n  freq_penguines_2 |&gt; \n  glm(Freq ~ species * sex, family = \"poisson\", data = _)\n\n# 適合度を確認する\nfit_penguines_O |&gt; summary()\n\n\nCall:\nglm(formula = Freq ~ species + sex, family = \"poisson\", data = freq_penguines_2)\n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       4.28141    0.09953  43.015  &lt; 2e-16 ***\nspeciesChinstrap -0.76410    0.14682  -5.204 1.95e-07 ***\nspeciesGentoo    -0.20448    0.12350  -1.656   0.0978 .  \nsexmale           0.01802    0.10960   0.164   0.8694    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 30.026097  on 5  degrees of freedom\nResidual deviance:  0.048611  on 2  degrees of freedom\nAIC: 42.901\n\nNumber of Fisher Scoring iterations: 3\n\nfit_penguines_FI |&gt; summary()\n\n\nCall:\nglm(formula = Freq ~ species * sex, family = \"poisson\", data = freq_penguines_2)\n\nCoefficients:\n                           Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)               4.290e+00  1.170e-01  36.658  &lt; 2e-16 ***\nspeciesChinstrap         -7.641e-01  2.076e-01  -3.680 0.000233 ***\nspeciesGentoo            -2.300e-01  1.759e-01  -1.308 0.190985    \nsexmale                  -3.118e-15  1.655e-01   0.000 1.000000    \nspeciesChinstrap:sexmale  3.138e-15  2.936e-01   0.000 1.000000    \nspeciesGentoo:sexmale     5.043e-02  2.470e-01   0.204 0.838248    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 3.0026e+01  on 5  degrees of freedom\nResidual deviance: 1.5543e-15  on 0  degrees of freedom\nAIC: 46.852\n\nNumber of Fisher Scoring iterations: 3\n\nanova(fit_penguines_O, fit_penguines_FI)\n\nAnalysis of Deviance Table\n\nModel 1: Freq ~ species + sex\nModel 2: Freq ~ species * sex\n  Resid. Df Resid. Dev Df Deviance\n1         2   0.048611            \n2         0   0.000000  2 0.048611\n\n\n独立モデルの尤度比カイ2乗統計量はassocstats(tab_penguines)の値と一致している．"
  },
  {
    "objectID": "1-Introduction.html#集計データを個票データに変換",
    "href": "1-Introduction.html#集計データを個票データに変換",
    "title": "シリーズ編者による内容紹介",
    "section": "集計データを個票データに変換",
    "text": "集計データを個票データに変換\n集計データを個票データに変換したいときにはvcdExtraパッケージのexpand.dftを用いる．\n\nlibrary(vcdExtra)\nd_ind &lt;- expand.dft(d, dreq = \"Freq\")\nd_ind\n\n# A tibble: 1,660 × 4\n    PSES   MHS Rscore Cscore\n   &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;\n 1     1     1   -2.5   -1.5\n 2     1     1   -2.5   -1.5\n 3     1     1   -2.5   -1.5\n 4     1     1   -2.5   -1.5\n 5     1     1   -2.5   -1.5\n 6     1     1   -2.5   -1.5\n 7     1     1   -2.5   -1.5\n 8     1     1   -2.5   -1.5\n 9     1     1   -2.5   -1.5\n10     1     1   -2.5   -1.5\n# ℹ 1,650 more rows"
  },
  {
    "objectID": "1-Introduction.html#元クロス分類表の入力",
    "href": "1-Introduction.html#元クロス分類表の入力",
    "title": "シリーズ編者による内容紹介",
    "section": "3元クロス分類表の入力",
    "text": "3元クロス分類表の入力\n\ndata &lt;- c(\n  2,5,1,\n  2,4,7,\n  \n  4,7,5,\n  8,0,1,\n  \n  10,11,5,\n  1,3,4,\n  \n  1,1,1,\n  2,3,4)\n\narray(data, dim = c(2,3,4))\n\n, , 1\n\n     [,1] [,2] [,3]\n[1,]    2    1    4\n[2,]    5    2    7\n\n, , 2\n\n     [,1] [,2] [,3]\n[1,]    4    5    0\n[2,]    7    8    1\n\n, , 3\n\n     [,1] [,2] [,3]\n[1,]   10    5    3\n[2,]   11    1    4\n\n, , 4\n\n     [,1] [,2] [,3]\n[1,]    1    1    3\n[2,]    1    2    4\n\ntab1 &lt;- c(2,5,1,\n          2,4,7) |&gt; matrix(nrow = 2, ncol = 3, byrow =TRUE)\n\n\ntab2 &lt;- c(4,7,5,\n          8,0,1) |&gt; matrix(nrow = 2, ncol = 3, byrow =TRUE)\n\ntab3 &lt;- c(10,11,5,\n          1,3,4) |&gt; matrix(nrow = 2, ncol = 3, byrow =TRUE)\n\ntab4 &lt;- c(1,1,1,\n          2,3,4) |&gt; matrix(nrow = 2, ncol = 3, byrow =TRUE)\n\ntab_merge &lt;- array(c(tab1,tab2,tab3,tab4), dim = c(2,3,4))\ntab_merge\n\n, , 1\n\n     [,1] [,2] [,3]\n[1,]    2    5    1\n[2,]    2    4    7\n\n, , 2\n\n     [,1] [,2] [,3]\n[1,]    4    7    5\n[2,]    8    0    1\n\n, , 3\n\n     [,1] [,2] [,3]\n[1,]   10   11    5\n[2,]    1    3    4\n\n, , 4\n\n     [,1] [,2] [,3]\n[1,]    1    1    1\n[2,]    2    3    4\n\ndimnames(tab_merge) &lt;- list(R = c(\"men\",\"women\"),\n                            C = c(\"blue\",\"red\",\"green\"),\n                            L = c(\"north\",\"south\",\"east\",\"west\"))\ntab_merge\n\n, , L = north\n\n       C\nR       blue red green\n  men      2   5     1\n  women    2   4     7\n\n, , L = south\n\n       C\nR       blue red green\n  men      4   7     5\n  women    8   0     1\n\n, , L = east\n\n       C\nR       blue red green\n  men     10  11     5\n  women    1   3     4\n\n, , L = west\n\n       C\nR       blue red green\n  men      1   1     1\n  women    2   3     4\n\n# フラットな形式で3元表を表示\nftable(tab_merge)\n\n            L north south east west\nR     C                            \nmen   blue        2     4   10    1\n      red         5     7   11    1\n      green       1     5    5    1\nwomen blue        2     8    1    2\n      red         4     0    3    3\n      green       7     1    4    4\n\n\nFriendly and Meyer (2016) を参考に表を作成．\n\n\n\n元のデータ形式\n変換後のデータ形式\n方法\n\n\n\n\nケース形式\n度数形式\ndata.frame(table(d$A,d$B))\n\n\nケース形式\n表形式\ntable(d$A,d$B)\n\n\n度数形式\nケース形式\nexpand.dfr(X)\n\n\n度数形式\n表形式\nxtabs(Freq ~ A + B)\n\n\n表形式\nケース形式\nexpand.dfr(X)\n\n\n表形式\n度数形式\ndata.frame(tab)"
  },
  {
    "objectID": "1-Introduction.html#練習問題",
    "href": "1-Introduction.html#練習問題",
    "title": "シリーズ編者による内容紹介",
    "section": "練習問題",
    "text": "練習問題\n問題0.1 せっかくデータを入力したので，このデータを使って Goodman (1979) の表5A，表5B，表5Cの結果を再現する．使用するデータはmentalHealthのデータである．gnmパッケージに含まれているので呼び出すこと．\n\nlibrary(gnm)\nmentalHealth\n\n   count SES      MHS\n1     64   A     well\n2     94   A     mild\n3     58   A moderate\n4     46   A impaired\n5     57   B     well\n6     94   B     mild\n7     54   B moderate\n8     40   B impaired\n9     57   C     well\n10   105   C     mild\n11    65   C moderate\n12    60   C impaired\n13    72   D     well\n14   141   D     mild\n15    77   D moderate\n16    94   D impaired\n17    36   E     well\n18    97   E     mild\n19    54   E moderate\n20    78   E impaired\n21    21   F     well\n22    71   F     mild\n23    54   F moderate\n24    71   F impaired\n\n\n\n問題0.1.1：xtabsを使用して，行をSESの列をMHSとしたクロス表を作成せよ．mentalHealthでは度数がFreqではなくcountという変数になっていることに注意せよ．\n\n\n\n   MHS\nSES well mild moderate impaired\n  A   64   94       58       46\n  B   57   94       54       40\n  C   57  105       65       60\n  D   72  141       77       94\n  E   36   97       54       78\n  F   21   71       54       71\n\n\n\n問題0.1.2：行パーセントと列パーセントを求めよ．またモザイクプロットを作成せよ．これらの情報をもとに変数間やカテゴリ間にどのような関連があるのかを考察せよ．\n問題0.1.3：mentalHealthのデータに，SESのAからFを順に6から1となるような整数に変換した変数Uを作成して加えよ．またMHSのwellからimpairedを順に4から1となるように変換した変数Vを作成して加えよ．\n\n\nd_mentalHealth &lt;- mentalHealth |&gt; \n  mutate(U = case_match(SES,\n                        \"A\" ~ 6,\n                        \"B\" ~ 5,\n                        \"C\" ~ 4,\n                        \"D\" ~ 3,\n                        \"E\" ~ 2,\n                        \"F\" ~ 1,\n                        .default = NA),\n         V = case_match(MHS,\n                        \"well\" ~ 4,\n                        \"mild\" ~ 3,\n                        \"moderate\" ~ 2,\n                        \"impaired\" ~ 1,\n                        .default = NA)) |&gt; \n  tibble()\nd_mentalHealth\n\n# A tibble: 24 × 5\n   count SES   MHS          U     V\n   &lt;int&gt; &lt;ord&gt; &lt;ord&gt;    &lt;dbl&gt; &lt;dbl&gt;\n 1    64 A     well         6     4\n 2    94 A     mild         6     3\n 3    58 A     moderate     6     2\n 4    46 A     impaired     6     1\n 5    57 B     well         5     4\n 6    94 B     mild         5     3\n 7    54 B     moderate     5     2\n 8    40 B     impaired     5     1\n 9    57 C     well         4     4\n10   105 C     mild         4     3\n# ℹ 14 more rows\n\n\n\n問題0.1.3：Goodman (1979) の表5Aの分析を再現する．表5Aのモデルは，\n\n\nNull Association\n\n\nUniform Association\n\n\nRow-Effect Association\n\n\nColumn-Effect Association\n\n\nRow and Column Effects (I)\n\n\nRow and Column Effects (II)\n\n\nの6つである．(1) Null Association と (2) Uniform Association をgnm（あるいはglm）によって分析せよ．\n\n問題0.2 occupationalStatusは父親と息子の職業の関連をみたクロス表であり，移動表とも呼ばれる．\n\noccupationalStatus\n\n      destination\norigin   1   2   3   4   5   6   7   8\n     1  50  19  26   8   7  11   6   2\n     2  16  40  34  18  11  20   8   3\n     3  12  35  65  66  35  88  23  21\n     4  11  20  58 110  40 183  64  32\n     5   2   8  12  23  25  46  28  12\n     6  12  28 102 162  90 554 230 177\n     7   0   6  19  40  21 158 143  71\n     8   0   3  14  32  15 126  91 106\n\n\n\n問題0.2.1：data.frameを使用して，度数，行変数，列変数からなる集計データを作成せよ．更にそれをtibble()形式に変換せよ（分析を行う上では必須ではない）．\n\n\n\n   origin destination Freq\n1       1           1   50\n2       2           1   16\n3       3           1   12\n4       4           1   11\n5       5           1    2\n6       6           1   12\n7       7           1    0\n8       8           1    0\n9       1           2   19\n10      2           2   40\n11      3           2   35\n12      4           2   20\n13      5           2    8\n14      6           2   28\n15      7           2    6\n16      8           2    3\n17      1           3   26\n18      2           3   34\n19      3           3   65\n20      4           3   58\n21      5           3   12\n22      6           3  102\n23      7           3   19\n24      8           3   14\n25      1           4    8\n26      2           4   18\n27      3           4   66\n28      4           4  110\n29      5           4   23\n30      6           4  162\n31      7           4   40\n32      8           4   32\n33      1           5    7\n34      2           5   11\n35      3           5   35\n36      4           5   40\n37      5           5   25\n38      6           5   90\n39      7           5   21\n40      8           5   15\n41      1           6   11\n42      2           6   20\n43      3           6   88\n44      4           6  183\n45      5           6   46\n46      6           6  554\n47      7           6  158\n48      8           6  126\n49      1           7    6\n50      2           7    8\n51      3           7   23\n52      4           7   64\n53      5           7   28\n54      6           7  230\n55      7           7  143\n56      8           7   91\n57      1           8    2\n58      2           8    3\n59      3           8   21\n60      4           8   32\n61      5           8   12\n62      6           8  177\n63      7           8   71\n64      8           8  106\n\n\n# A tibble: 64 × 3\n   origin destination  Freq\n   &lt;fct&gt;  &lt;fct&gt;       &lt;int&gt;\n 1 1      1              50\n 2 2      1              16\n 3 3      1              12\n 4 4      1              11\n 5 5      1               2\n 6 6      1              12\n 7 7      1               0\n 8 8      1               0\n 9 1      2              19\n10 2      2              40\n# ℹ 54 more rows\n\n\n\n問題0.2.2：行パーセントと列パーセントを求めよ．またモザイクプロットを作成せよ．これらの情報をもとに変数間やカテゴリ間にどのような関連があるのかを考察せよ．\n問題0.2.3：問題0.2.1で作成したデータについてgnmを適用して(1) 独立モデルと (2) 一様連関モデルを用いた分析を行う．\n\n\nfit_O &lt;- d_occupationalStatus |&gt; \n  gnm(Freq ~ origin + destination, data = _)\nfit_U &lt;- d_occupationalStatus |&gt; \n  gnm(Freq ~ origin + destination, data = _)"
  },
  {
    "objectID": "1-Introduction.html#参考文献",
    "href": "1-Introduction.html#参考文献",
    "title": "シリーズ編者による内容紹介",
    "section": "参考文献",
    "text": "参考文献\n\n\n\n\n\n\nGoodman, Leo A. 1979. “Simple Models for the Analysis of Association in Cross-Classifications Having Ordered Categories.” Journal of the American Statistical Association 74 (367): 537–52."
  },
  {
    "objectID": "8-degrees_of_freedom.html#第2章-2元表の連関モデル",
    "href": "8-degrees_of_freedom.html#第2章-2元表の連関モデル",
    "title": "自由度",
    "section": "第2章　2元表の連関モデル",
    "text": "第2章　2元表の連関モデル\n行変数は\\(A\\)カテゴリは\\(i = 1,2,\\dots,I\\)， 列変数は\\(B\\)でカテゴリは\\(j = 1,2,\\dots,J\\).\n式（2.4）：\\(O\\)モデル\n\\[\\begin{align}\ndf &= \\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}]\\\\\n& = IJ - I - J + 1\\\\\n& = (I - 1)(J - 1)\n\\end{align}\\]\n式（2.6）：\\(FI\\)モデル\n\\[\\begin{align}\ndf & = \\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}+ \\overbrace{(I - 1) \\times (J - 1)}^{\\lambda_{ij}^{AB}}]\\\\\n&= IJ - IJ \\\\\n& = 0\n\\end{align}\\]\n式（2.7）：\\(U\\)モデル\n\\[\\begin{align}\ndf &=\\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B} + \\overbrace{1}^{\\beta}]\\\\\n&= IJ - I - J\n\\end{align}\\]\n式（2.9）：\\(R\\)モデル\n\\[\\begin{align}\ndf &=\\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(I - 1)}^{\\tau_i^A}]\\\\\n&= IJ - 2I - J + 2\\\\\n&= (I - 1)(J - 2)\n\\end{align}\\]\n式（2.11）：\\(C\\)モデル\n\\[\\begin{align}\ndf &=\\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(J - 1)}^{\\tau_j^B}]\\\\\n&= IJ - I - 2J + 2\\\\\n&= (I - 2)(J - 1)\n\\end{align}\\]\n式（2.13）：\\(R+C\\)モデル\n\\[\\begin{align}\ndf &=\\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B} + \\overbrace{(I - 1)}^{\\tau_i^A} + \\overbrace{(J - 2)}^{\\tau_j^B}] \\\\\n&= IJ - 2I - 2J + 4\\\\\n&= (I - 2)(J - 2)\n\\end{align}\\]\n\\[\\begin{align}\ndf &=\\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B} + \\overbrace{(I - 2)}^{\\tau_i^A} + \\overbrace{(J - 1)}^{\\tau_j^B}] \\\\\n&= IJ - 2I - 2J + 4\\\\\n&= (I - 2)(J - 2)\n\\end{align}\\]\n式（2.14）：\\(R+C\\)モデル\n\\[\\begin{align}\ndf &=\\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B} + \\overbrace{1}^{\\beta} + \\overbrace{(I - 2)}^{\\tau_i^A} + \\overbrace{(J - 2)}^{\\tau_j^B}] \\\\\n&= IJ - 2I - 2J + 4\\\\\n&= (I - 2)(J - 2)\n\\end{align}\\]\n式（2.14）で\\(I=J\\)について\\(\\tau_i^A=\\tau_j^B\\)の時\n\\[\\begin{align}\ndf &=  \\overbrace{I^2}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(I - 1)}^{\\lambda_j^B} + \\overbrace{1}^{\\beta} + \\overbrace{(I - 2)}^{\\tau_i^A}]\\\\\n&= I^2 - 3I + 2\\\\\n&= (I - 1)(I - 2)\n\\end{align}\\]\n式（2.16）：\\(RC\\)モデル\n\\[\\begin{align}\ndf &= \\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B} +  \\overbrace{1}^{\\phi} +\n\\overbrace{(I - 2)}^{\\mu_i} + \\overbrace{(J - 2)}^{\\nu_j}]\\\\\n&= IJ - 2I -2J + 4 \\\\\n&= (I - 2)(I - 2)\n\\end{align}\\]\n式（2.20）：\\(U+RC\\)モデル\n\\[\\begin{align}\ndf &=\\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B} + \\overbrace{1}^{\\phi_1} +  \\overbrace{1}^{\\phi_2}+ \\overbrace{(I - 2)}^{\\mu_i} + \\overbrace{(J - 2)}^{\\nu_j}]\\\\\n&= IJ - 2I - 2J + 3\n\\end{align}\\]\n式（2.22）：\\(R+RC\\)モデル\n\\[\\begin{align}\ndf &=\\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B} + \\overbrace{(I - 2)}^{\\tau_i^A} + \\overbrace{1}^{\\phi_1} + \\overbrace{(I - 2)}^{\\mu_i} + \\overbrace{(J - 2)}^{\\nu_j}]\\\\\n&= IJ - 3I - 2J + 6\\\\\n&= (I - 2)(J - 3)\n\\end{align}\\]\n式（2.24）：\\(C+RC\\)モデル\n\\[\\begin{align}\ndf &=\\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B} + \\overbrace{(J - 2)}^{\\tau_j^B} + \\overbrace{1}^{\\phi_1} + \\overbrace{(I - 2)}^{\\mu_i} + \\overbrace{(J - 2)}^{\\nu_j}]\\\\ &= IJ - 2I - 3J + 6\\\\\n&= (I - 3)(J - 2)\n\\end{align}\\]\n式（2.26）：\\(R+C+RC\\)モデル\n\\[\\begin{align}\ndf &= \\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B} + \\overbrace{(I - 3)}^{\\tau_i^A} + \\overbrace{(J - 2)}^{\\tau_j^B}+ \\overbrace{1}^{\\phi_1} + \\overbrace{(I - 2)}^{\\mu_i} + \\overbrace{(J - 2)}^{\\nu_j}]\\\\\n&= IJ - 3I - 3J + 9\\\\\n&= (I - 3)(J - 3)\n\\end{align}\\]\n\\[\\begin{align}\ndf &= \\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B} + \\overbrace{(I - 2)}^{\\tau_i^A} + \\overbrace{(J - 3)}^{\\tau_j^B}+ \\overbrace{1}^{\\phi_1} + \\overbrace{(I - 2)}^{\\mu_i} + \\overbrace{(J - 2)}^{\\nu_j}]\\\\\n&= IJ - 3I - 3J + 9\\\\\n&= (I - 3)(J - 3)\n\\end{align}\\]\n式（2.28）：\\(RC(2)\\)モデル\n\\[\\begin{align}\ndf &= \\overbrace{IJ}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}+ \\overbrace{1}^{\\phi_1} + \\overbrace{(I - 2)}^{\\mu_{i1}} + \\overbrace{(J - 2)}^{\\nu_{j1}} + \\overbrace{1}^{\\phi_2} + \\overbrace{(I - 2)}^{\\mu_{i2}} + \\overbrace{(J - 2)}^{\\nu_{j2}}- \\overbrace{2}^{次元間制約}]\\\\\n&= IJ - 3I - 3J + 9 \\\\\n&= (I - 3)(J - 3)\n\\end{align}\\]\n式（2.31）：\\(RC(M)\\)モデル\n次元間制約については\\(M (M - 1)/2 \\times 2 = M (M - 1)\\)を引けばよい．\\(M (M - 1)/2\\)は次元の組み合わせであり，2は\\(\\mu\\)と\\(\\nu\\)の2種類あるからである．\n\\[\\begin{align}\ndf &=  \\overbrace{IJ}^{セルの数} - \\{\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B} + [\\overbrace{M}^{\\phi_m} + \\overbrace{M(I - 2)}^{\\mu_{im}} + \\overbrace{M(J - 2)}^{\\nu_{jm}} - \\overbrace{M(M - 1)}^{次元間制約}] \\} \\\\\n&=  IJ - I - J + 1 + 2M - MI - MJ + M^2 \\\\\n& = I(J - M - 1) - J + 1 + 2M - MJ + M^2\\\\\n& = I(J - M - 1) - M(J - M - 1) - (J - M - 1) \\\\\n& = (I - M - 1)(J - M - 1)\n\\end{align}\\]\n\\(M = 2\\)の時 \\[\\begin{align}\ndf &=  (I - M - 1)(J - M - 1)\\\\\n&= (I - 2 - 1)(J - 2 - 1) \\\\\n&= (I - 3)(J - 3)\n\\end{align}\\] となり，式（2.28）の\\(RC(2)\\)の自由度となる．"
  },
  {
    "objectID": "8-degrees_of_freedom.html#第3章-3元表に対する部分連関モデル",
    "href": "8-degrees_of_freedom.html#第3章-3元表に対する部分連関モデル",
    "title": "自由度",
    "section": "第3章　3元表に対する部分連関モデル",
    "text": "第3章　3元表に対する部分連関モデル\n行変数は\\(A\\)カテゴリは\\(i = 1,2,\\dots,I\\)， 列変数は\\(B\\)でカテゴリは\\(j = 1,2,\\dots,J\\)， 列変数は\\(C\\)でカテゴリは\\(k = 1,2,\\dots,K\\).\n式（3.5）：\\(CI\\)モデル\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(J - 1)}^{\\lambda_{ij}^{AB}} + \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}}]\\\\\n& = IJK - IJ - IK + I \\\\\n& = I(JK - J - K + 1) \\\\\n& = I(J - 1)(K - 1)\n\\end{align}\\]\n式（3.7）：\\(CIA\\)モデル\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C} \\\\\n&\\quad-\n\\{\\overbrace{M_1}^{\\phi_r^{AB}} + \\overbrace{M_1(I - 2)}^{\\mu_{ir}} + \\overbrace{M_1(J - 2)}^{\\nu_{ir}} - \\overbrace{M_1(M_1 - 1)}^{次元間制約} \\} \\\\\n&\\quad - \\{\\overbrace{M_2}^{\\phi_r^{AC}} + \\overbrace{M_2(I - 2)}^{\\mu^*_{ir}} + \\overbrace{M_2(K - 2)}^{\\eta_{kr}} - \\overbrace{M_2(M_2 - 1)}^{次元間制約} \\}] \\\\\n&= IJK - I - J - K + 2 - M_1 (I + J - M_1 - 2) - M_2 (I + K - M_2 - 2)\n\\end{align}\\]\n式（3.7）で\\(M_1 = M_2 = 1\\)の時\n\\[\\begin{align}\ndf &= IJK - I - J - K + 2 - M_1 (I + J - M_1 - 2) - M_2 (I + K - M_2 - 2)\\\\\n& =  IJK - I - J - K + 2 - (I + J - 1 - 2) - (I + K - 1 - 2)\\\\\n& = IJK - 3I - 2J - 2K + 8\n\\end{align}\\]\n式（3.7）で\\(M_1 = M_2 = 1\\)かつ\\(\\mu_i = \\mu^*_i\\)の時\n\\[\\begin{align}\ndf &= IJK - I - J - K + 2 - M_1 (I + J - M_1 - 2) - M_2 (K - M_2)\\\\\n& =  IJK - I - J - K + 2 - (I + J - 1 - 2) - (K - 1)\\\\\n& = IJK - 2I - 2J - 2K + 6\n\\end{align}\\]\n式（3.9）\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(J - 1)}^{\\lambda_{ij}^{AB}} +\n\\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}}\n]\\\\\n& = IJK + I + J + K - IJ - IK - JK - 1\\\\\n& = I(JK - J - K + 1) - (JK - J - K + 1)\\\\\n& = I(J - 1)(K - 1) - (J - 1)(K - 1)\\\\\n& = (I - 1)(J - 1)(K - 1)\n\\end{align}\\]\n式（3.10）\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}\\\\\n& \\quad +\n\\overbrace{1}^{\\phi_{1}^{AB}} +\n\\overbrace{(I - 2)}^{\\mu_{i}} +\n\\overbrace{(J - 2)}^{\\nu_{j}} +\n\n\\overbrace{1}^{\\phi_{1}^{AC}} +\n\\overbrace{(I - 2)}^{\\mu_{i}} +\n\\overbrace{(K - 2)}^{\\eta_{j}} +\n\n\\overbrace{1}^{\\phi_{1}^{BC}} +\n\\overbrace{(J - 2)}^{\\nu_{j}} +\n\\overbrace{(K - 2)}^{\\eta_{k}}\n] \\\\\n& = IJK - I - J - K + 2 - [3 - 2(I - 2) -2(J-2) -2(K -2)]\\\\\n& = IJK - 3I - 3J - 3K + 11\n\\end{align}\\]\n式（3.11）\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}\\\\\n& \\quad +\n\\overbrace{1}^{\\phi_{1}^{AB}} +\n\\overbrace{1}^{\\phi_{1}^{AC}} +\n\\overbrace{1}^{\\phi_{1}^{BC}} +\n\\overbrace{(I - 2)}^{\\mu_{i}} +\n\\overbrace{(J - 2)}^{\\nu_{j}} +\n\\overbrace{(K - 2)}^{\\eta_{j}} +\n] \\\\\n& = IJK - I - J - K + 2 - [3 - (I - 2) -(J-2) - (K -2)]\\\\\n& = IJK - 2I - 2J - 2K + 5\n\\end{align}\\]\n式（3.12）\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}\\\\\n& \\quad +\n\\overbrace{M_1}^{\\phi_{m}^{AB}} +\n\\overbrace{M_1(I - 2)}^{\\mu_{im}} +\n\\overbrace{M_1(J - 2)}^{\\nu_{jm}} -\n\\overbrace{M_1(M_1 - 1)}^{次元間制約} \\\\\n\n& \\quad +\n\\overbrace{M_2}^{\\phi_{m}^{AC}} +\n\\overbrace{M_2(I - 2)}^{\\mu^*_{im}} +\n\\overbrace{M_2(K - 2)}^{\\eta_{jm}} -\n\\overbrace{M_2(M_2 - 1)}^{次元間制約} \\\\\n\n& \\quad +\n\\overbrace{M_3}^{\\phi_{m}^{BC}} +\n\\overbrace{M_3(J - 2)}^{\\nu^*_{jm}} +\n\\overbrace{M_3(K - 2)}^{\\eta^*_{km}} -\n\\overbrace{M_3(M_3 - 1)}^{次元間制約}] \\\\\n& = IJK - I - J - K + 2 - M_1(I + J - M_1 - 2) - M_2(I + K - M_2 - 2)- M_3(J + K - M_3 - 2)\n\\end{align}\\]\n式（3.12）で\\(M_1 = M_2 = M_3 = M\\)\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}\\\\\n& \\quad +\n\\overbrace{M}^{\\phi_{m}^{AB}} +\n\\overbrace{M(I - 2)}^{\\mu_{im}} +\n\\overbrace{M(J - 2)}^{\\nu_{jm}} -\n\\overbrace{M(M - 1)}^{次元間制約} \\\\\n\n& \\quad +\n\\overbrace{M}^{\\phi_{m}^{AC}} +\n\\overbrace{M(I - 2)}^{\\mu^*_{im}} +\n\\overbrace{M(K - 2)}^{\\eta_{km}} -\n\\overbrace{M(M - 1)}^{次元間制約} \\\\\n\n& \\quad +\n\\overbrace{M}^{\\phi_{m}^{BC}} +\n\\overbrace{M(J - 2)}^{\\nu^*_{jm}} +\n\\overbrace{M(K - 2)}^{\\eta^*_{km}} -\n\\overbrace{M(M - 1)}^{次元間制約}] \\\\\n& = IJK - I - J - K + 2 - M(I + J - M - 2) - M(I + J - M - 2)- M(I + J - M - 2) \\\\\n& = IJK - I - J - K + 2 - M(2I + 2J + 2K - 3M - 6)\n\\end{align}\\]\n式（3.12）で\\(M_1 = M_2 = M_3 = M\\)かつ一貫したスコア\n必要な次元間制約は\\(3M(M-1)/2\\)ではなく\\(M(M-1)/2\\)である．\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}\\\\\n& \\quad +\n\\overbrace{M}^{\\phi_{m}^{AB}} +\n\\overbrace{M}^{\\phi_{m}^{AC}} +\n\\overbrace{M}^{\\phi_{m}^{BC}} +\n\\overbrace{M(I - 2)}^{\\mu_{im}} +\n\\overbrace{M(J - 2)}^{\\nu_{jm}} +\n\\overbrace{M(K - 2)}^{\\eta_{km}} -\n\\overbrace{M(M - 1)/2}^{次元間制約}] \\\\\n& = IJK - I - J - K + 2 - M(I + J + K - 3) + M(M - 1)/2\n\\end{align}\\]"
  },
  {
    "objectID": "8-degrees_of_freedom.html#第4章3元表に対する条件付き連関モデル",
    "href": "8-degrees_of_freedom.html#第4章3元表に対する条件付き連関モデル",
    "title": "自由度",
    "section": "第4章：3元表に対する条件付き連関モデル",
    "text": "第4章：3元表に対する条件付き連関モデル\n式（4.1）：\\(CI\\)モデル\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}}]\\\\\n& = IJK - IK - JK + K \\\\\n& = (IJ - I - J + 1)K \\\\\n& = (I - 1)(J - 1)K\n\\end{align}\\]\n式（4.3）：\\(FI\\)モデル\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C} \\\\\n& \\quad + \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} +\n\\overbrace{(I - 1)(J - 1)}^{\\lambda_{ij}^{AB}}]\\\\\n& = IJK - IK - JK - IJ + I + J + K - 1 \\\\\n& = I(JK - K - J + 1) - (JK - K - J + 1)\\\\\n& = (I - 1)(JK - K - J + 1)\\\\\n& = (I - 1)(J - 1 )(K- 1)\n\\end{align}\\]\n式（4.5）：飽和モデル\n\\(FI\\)モデルの自由度\\((I - 1)(J - 1 )(K- 1)\\)を使い，そこから3元交互作用のパラメータ数\\((I - 1)(J - 1 )(K- 1)\\)を引く．\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C} \\\\\n& \\quad + \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} +\n\\overbrace{(I - 1)(J - 1)}^{\\lambda_{ij}^{AB}} +\n\\overbrace{(I - 1)(J - 1)(K - 1)}^{\\lambda_{ijk}^{ABC}}\n] \\\\\n& = (I - 1)(J - 1 )(K- 1) - (I - 1)(J - 1)(K - 1) \\\\\n& = 0\n\\end{align}\\]\n式（4.6）：\\(LL_1\\)\n\\(FI\\)モデルの自由度\\((I - 1)(J - 1 )(K- 1)\\)を使い，そこから\\((K - 1)\\)を引く．\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C} \\\\\n& \\quad + \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} +\n\\overbrace{(I - 1)(J - 1)}^{\\lambda_{ij}^{AB}}  +\n\\overbrace{(K - 1)}^{\\beta_k}]\\\\\n& = (I - 1)(J - 1 )(K- 1) - (K - 1)\\\\\n& = (IJ - I - J)(K- 1)\n\\end{align}\\]\n式（4.10）：\\(LL_2\\)\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C} \\\\\n& \\quad + \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} +\n\\overbrace{(K - 1)}^{\\phi_{k}} +\n\\overbrace{(I - 1)(J - 1)}^{\\psi_{ij}}]\\\\\n& = (I - 1)(J - 1 )(K- 1) - (K - 1) \\\\\n& = (IJ - I - J)(K - 1)\n\\end{align}\\]\n式（4.14）：\\(LL_3\\)\n\\(\\phi_{k}\\)については\\(\\phi_{1} = 0\\)，\\(\\phi_{K} = 1\\)とするなど2つの制約が必要である．\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C} \\\\\n& \\quad + \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} +\n\\overbrace{(I - 1)(J - 1)}^{\\lambda_{ij}^{AB}}]\\\\\n& \\quad + \\overbrace{(K - 2)}^{\\phi_{k}} +\n\\overbrace{(I - 1)(J - 1)}^{\\psi_{ij}}]\\\\\n& = (I - 1)(J - 1)(K- 1) - (K - 2) - (I - 1)(J - 1) \\\\\n& = (I - 1)(J - 1)(K- 2) - (K - 2) \\\\\n& = (IJ - I - J)(K- 2)\n\\end{align}\\]\n式（4.21）：等質\\((R+C)-L\\)\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} \\\\\n& + \\quad \\overbrace{1}^{\\phi} +\n\\overbrace{(I-2)}^{\\tau_i^A} +\n\\overbrace{(J-2)}^{\\tau_j^B}]\\\\\n& = (I-1)(J-1)K - (I-2) - (J - 2) -1\\\\\n& = IJK - IK - JK + K - I - J + 3\\\\\n& = IJK - K(I + J - 1) - (I + J - 1) + 2\\\\\n& = IJK - (K+1)(I + J - 1) + 2\\\\\n\\end{align}\\]\n式（4.24）：異質\\((R+C)-L\\)\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} \\\\\n& + \\quad \\overbrace{K}^{\\phi_k} +\n\\overbrace{(I-2)K}^{\\tau_{ik}^{AC}} +\n\\overbrace{(J-2)K}^{\\tau_{jk}^{BC}}]\\\\\n& = (I-1)(J-1)K - (I-2)K - (J-2)K - K\n\\end{align}\\]\n式（4.27）：部分異質\\((R+C)-L\\)\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} \\\\\n& + \\quad \\overbrace{K}^{\\phi_k} +\n\\overbrace{(I-2)}^{\\tau_{i}^{AC}} +\n\\overbrace{(J-2)}^{\\tau_{j}^{BC}}]\\\\\n& = (I-1)(J-1)K - (I-2) - (J-2) - K\\\\\n& = IJK - IK - JK - I - J + 4\\\\\n& = IJK - (I + J)(K + 1) + 4\n\\end{align}\\]\n式（4.30）：部分異質\\((R+C)-L\\)\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} \\\\\n& + \\quad \\overbrace{K}^{\\phi_k} +\n\\overbrace{(I-2)K}^{\\tau_{ik}^{AC}} +\n\\overbrace{(J-2)}^{\\tau_{j}^{BC}}]\\\\\n& = (I-1)(J-1)K - (I-2)K - (J-2) - K\\\\\n& = IJK - IK - JK + K - IK + 2K - J + 2 - K\\\\\n& = IJK - 2IK - JK + 2K - J + 2\\\\\n& = J(IK - K - 1) - 2(IK - K - 1)\\\\\n& = (J - 2)(IK - K - 1)\n\\end{align}\\]\n式（4.31）：部分異質\\((R+C)-L\\)\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} \\\\\n& + \\quad \\overbrace{K}^{\\phi_k} +\n\\overbrace{(I-2)}^{\\tau_{i}^{AC}} +\n\\overbrace{(J-2)K}^{\\tau_{jk}^{BC}}]\\\\\n& = (I-1)(J-1)K - (I-2) - (J-2)K - K\\\\\n& = IJK - IK - JK + K - I + 2 - JK + 2K - K\\\\\n& = IJK - IK - 2JK + 2K - I + 2\\\\\n& = I(JK - K - 1) - 2(JK - K - 1)\\\\\n& = (I - 2)(JK - K - 1)\n\\end{align}\\]\n式（4.39）：同質\\(RC(M)-L\\)\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} \\\\\n& + \\quad \\overbrace{M}^{\\phi_m} +\n\\overbrace{(I-2)M}^{\\mu_{im}} +\n\\overbrace{(J-2)M}^{\\nu_{jm}} -\n\\overbrace{M(M-1)}^{次元間制約}] \\\\\n& = (I-1)(J-1)K - M(I + J - M - 2)\n\\end{align}\\]\n式（4.42）：異質\\(RC(M)-L\\)\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} \\\\\n& + \\quad \\overbrace{KM}^{\\phi_{mk}} +\n\\overbrace{(I-2)KM}^{\\mu_{imk}} +\n\\overbrace{(J-2)KM}^{\\nu_{jmk}} -\n\\overbrace{KM(M-1)}^{次元間制約}] \\\\\n& = K(I-1)(J-1) - KM(I - 1) - KM(J - 1) - KM^2\\\\\n& = K(I-1)[(J-1) - M] - KM[(J - 1) - M]\\\\\n& = K(I - 1 - M)(J - 1 - M)\n\\end{align}\\]\n式（4.45）\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} \\\\\n& + \\quad \\overbrace{K}^{\\phi_k} +\n\\overbrace{(I-2)}^{\\mu_{i}} + \\overbrace{(J-2)K}^{\\mu_{jk}}]\\\\\n& = IJK - IK - JK + K - K - I + 2 - JK + 2K\\\\\n& = I(JK - K - 1) -2(JK - K - 1)\\\\\n& = (I - 2)(JK - K - 1)\n\\end{align}\\]\n式（4.48）\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} \\\\\n& + \\quad \\overbrace{K}^{\\phi_k} +\n\\overbrace{(I-2)K}^{\\mu_{ik}} + \\overbrace{(J-2)}^{\\mu_{j}}]\\\\\n& \\quad = IJK - IK - JK + K - K - IK + 2K - J + 2\\\\\n& \\quad = J(IK - K - 1) -2(IK - K - 1)\\\\\n& \\quad = (J - 2)(IK - K - 1)\n\\end{align}\\]\n式（4.51）\n\\[\\begin{align}\ndf &= \\overbrace{IJK}^{セルの数} - [\\overbrace{1}^{\\lambda} + \\overbrace{(I - 1)}^{\\lambda_i^A} + \\overbrace{(J - 1)}^{\\lambda_j^B}  + \\overbrace{(K - 1)}^{\\lambda_k^C}+ \\overbrace{(I - 1)(K - 1)}^{\\lambda_{ik}^{AC}} +\n\\overbrace{(J - 1)(K - 1)}^{\\lambda_{jk}^{BC}} \\\\\n& + \\quad \\overbrace{K}^{\\phi_k} +\n\\overbrace{(I-2)}^{\\mu_{i}} + \\overbrace{(J-2)}^{\\mu_{j}}]\\\\\n& \\quad = (IJK - IK - JK + K) - K - I + 2 - J + 2\\\\\n& \\quad = IJK - K(I + J) - (I + J) + 4\\\\\n& \\quad = IJK - (I + J)(K+1) + 4\n\\end{align}\\]"
  }
]