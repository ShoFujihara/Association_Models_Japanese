[
  {
    "objectID": "1-Introduction.html#度数行変数列変数のデータからクロス表を作成",
    "href": "1-Introduction.html#度数行変数列変数のデータからクロス表を作成",
    "title": "シリーズ編者による内容紹介",
    "section": "度数，行変数，列変数のデータからクロス表を作成",
    "text": "度数，行変数，列変数のデータからクロス表を作成\n\n度数，行変数，列変数のデータからクロス表を作成するにはxtabs関数を用いる．\n\n\nd |&gt; xtabs(Freq ~ PSES + MHS, data = _)\n\n    MHS\nPSES   1   2   3   4\n   1  64  94  58  46\n   2  57  94  54  40\n   3  57 105  65  60\n   4  72 141  77  94\n   5  36  97  54  78\n   6  21  71  54  71\n\n\n\nRに初めから準備されているTitanicデータは，多少特殊な集計がされているが，これにdata.frame関数を適用すると，集計データになる．これに対してxtabs関数を用いればクロス表を簡単に作成できる．\n\n\ndata.frame(Titanic) |&gt; xtabs(Freq ~ Class + Survived, data = _)\n\n      Survived\nClass   No Yes\n  1st  122 203\n  2nd  167 118\n  3rd  528 178\n  Crew 673 212\n\ndata.frame(Titanic) |&gt; xtabs(Freq ~ Sex + Survived, data = _)\n\n        Survived\nSex        No  Yes\n  Male   1364  367\n  Female  126  344\n\ndata.frame(Titanic) |&gt; xtabs(Freq ~ Age + Survived, data = _)\n\n       Survived\nAge       No  Yes\n  Child   52   57\n  Adult 1438  654"
  },
  {
    "objectID": "1-Introduction.html#個票データから集計データを作成",
    "href": "1-Introduction.html#個票データから集計データを作成",
    "title": "シリーズ編者による内容紹介",
    "section": "個票データから集計データを作成",
    "text": "個票データから集計データを作成\n\n個票データから集計データを作成する方法はいくつか考えられるが，ここではcount関数を用いる．\n\n\n# スターウォーズデータ\nstarwars\n\n# A tibble: 87 × 14\n   name     height  mass hair_color skin_color eye_color birth_year sex   gender\n   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; \n 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…\n 2 C-3PO       167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…\n 3 R2-D2        96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…\n 4 Darth V…    202   136 none       white      yellow          41.9 male  mascu…\n 5 Leia Or…    150    49 brown      light      brown           19   fema… femin…\n 6 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…\n 7 Beru Wh…    165    75 brown      light      blue            47   fema… femin…\n 8 R5-D4        97    32 &lt;NA&gt;       white, red red             NA   none  mascu…\n 9 Biggs D…    183    84 black      light      brown           24   male  mascu…\n10 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…\n# ℹ 77 more rows\n# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,\n#   vehicles &lt;list&gt;, starships &lt;list&gt;\n\n# 1つの変数にcount関数を適用\nstarwars |&gt; \n  count(sex)\n\n# A tibble: 5 × 2\n  sex                n\n  &lt;chr&gt;          &lt;int&gt;\n1 female            16\n2 hermaphroditic     1\n3 male              60\n4 none               6\n5 &lt;NA&gt;               4\n\n# 2つの変数にcount関数を適用し，集計レベルのデータを作成\nstarwars |&gt; \n  count(sex, gender)\n\n# A tibble: 6 × 3\n  sex            gender        n\n  &lt;chr&gt;          &lt;chr&gt;     &lt;int&gt;\n1 female         feminine     16\n2 hermaphroditic masculine     1\n3 male           masculine    60\n4 none           feminine      1\n5 none           masculine     5\n6 &lt;NA&gt;           &lt;NA&gt;          4\n\n# 欠損値を処理し，nをFreqと名前を変更し，df_dstarwarsとしてデータを保存\ndf_dstarwars &lt;- starwars |&gt; \n  count(sex, gender) |&gt; \n  drop_na() |&gt;\n  rename(Freq = n)\n\n# 確認\ndf_dstarwars\n\n# A tibble: 5 × 3\n  sex            gender     Freq\n  &lt;chr&gt;          &lt;chr&gt;     &lt;int&gt;\n1 female         feminine     16\n2 hermaphroditic masculine     1\n3 male           masculine    60\n4 none           feminine      1\n5 none           masculine     5\n\n\n別の例で分析してみる．palmerpenguinsパッケージにはpenguinsというデータが含まれている．\n\n#install.packages(\"palmerpenguins\")\nlibrary(palmerpenguins)\npenguins\n\n# A tibble: 344 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;\n 1 Adelie  Torgersen           39.1          18.7               181        3750\n 2 Adelie  Torgersen           39.5          17.4               186        3800\n 3 Adelie  Torgersen           40.3          18                 195        3250\n 4 Adelie  Torgersen           NA            NA                  NA          NA\n 5 Adelie  Torgersen           36.7          19.3               193        3450\n 6 Adelie  Torgersen           39.3          20.6               190        3650\n 7 Adelie  Torgersen           38.9          17.8               181        3625\n 8 Adelie  Torgersen           39.2          19.6               195        4675\n 9 Adelie  Torgersen           34.1          18.1               193        3475\n10 Adelie  Torgersen           42            20.2               190        4250\n# ℹ 334 more rows\n# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;\n\n\nこれをもとに集計データを作成する．ここでは種と性別のクロス表を作成する．\n\n# クロス表を作成\ntab_penguines &lt;- xtabs(~ species + sex, data = penguins)\ntab_penguines\n\n           sex\nspecies     female male\n  Adelie        73   73\n  Chinstrap     34   34\n  Gentoo        58   61\n\n\nなお，このクロス表からえられる独立性の検定についての指標や連関の係数は次のようになる．\n\nassocstats(tab_penguines)\n\n                      X^2 df P(&gt; X^2)\nLikelihood Ratio 0.048611  2  0.97599\nPearson          0.048607  2  0.97599\n\nPhi-Coefficient   : NA \nContingency Coeff.: 0.012 \nCramer's V        : 0.012 \n\n\n\n# クロス表をdata.frameとして読み込む\nfreq_penguines_1 &lt;- data.frame(tab_penguines)\nfreq_penguines_1\n\n    species    sex Freq\n1    Adelie female   73\n2 Chinstrap female   34\n3    Gentoo female   58\n4    Adelie   male   73\n5 Chinstrap   male   34\n6    Gentoo   male   61\n\n\ncountを使うこともできる．\n\nfreq_penguines_2 &lt;- penguins |&gt; \n  count(species, sex) |&gt; \n  rename(Freq = n)\nfreq_penguines_2\n\n# A tibble: 8 × 3\n  species   sex     Freq\n  &lt;fct&gt;     &lt;fct&gt;  &lt;int&gt;\n1 Adelie    female    73\n2 Adelie    male      73\n3 Adelie    &lt;NA&gt;       6\n4 Chinstrap female    34\n5 Chinstrap male      34\n6 Gentoo    female    58\n7 Gentoo    male      61\n8 Gentoo    &lt;NA&gt;       5\n\n# 欠損値を処理する\nfreq_penguines_2 &lt;- penguins |&gt; \n  count(species, sex) |&gt; \n  drop_na() |&gt; \n  rename(Freq = n)\nfreq_penguines_2\n\n# A tibble: 6 × 3\n  species   sex     Freq\n  &lt;fct&gt;     &lt;fct&gt;  &lt;int&gt;\n1 Adelie    female    73\n2 Adelie    male      73\n3 Chinstrap female    34\n4 Chinstrap male      34\n5 Gentoo    female    58\n6 Gentoo    male      61\n\n\nではglm関数を用いて対数線形モデルをあてはめる．\n\n# 独立モデル\nfit_penguines_O &lt;- \n  freq_penguines_2 |&gt; \n  glm(Freq ~ species + sex, family = \"poisson\", data = _)\n\n# 飽和モデル\nfit_penguines_FI &lt;- \n  freq_penguines_2 |&gt; \n  glm(Freq ~ species * sex, family = \"poisson\", data = _)\n\n# 適合度を確認する\nfit_penguines_O |&gt; summary()\n\n\nCall:\nglm(formula = Freq ~ species + sex, family = \"poisson\", data = freq_penguines_2)\n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       4.28141    0.09953  43.015  &lt; 2e-16 ***\nspeciesChinstrap -0.76410    0.14682  -5.204 1.95e-07 ***\nspeciesGentoo    -0.20448    0.12350  -1.656   0.0978 .  \nsexmale           0.01802    0.10960   0.164   0.8694    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 30.026097  on 5  degrees of freedom\nResidual deviance:  0.048611  on 2  degrees of freedom\nAIC: 42.901\n\nNumber of Fisher Scoring iterations: 3\n\nfit_penguines_FI |&gt; summary()\n\n\nCall:\nglm(formula = Freq ~ species * sex, family = \"poisson\", data = freq_penguines_2)\n\nCoefficients:\n                           Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)               4.290e+00  1.170e-01  36.658  &lt; 2e-16 ***\nspeciesChinstrap         -7.641e-01  2.076e-01  -3.680 0.000233 ***\nspeciesGentoo            -2.300e-01  1.759e-01  -1.308 0.190985    \nsexmale                  -3.118e-15  1.655e-01   0.000 1.000000    \nspeciesChinstrap:sexmale  3.138e-15  2.936e-01   0.000 1.000000    \nspeciesGentoo:sexmale     5.043e-02  2.470e-01   0.204 0.838248    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 3.0026e+01  on 5  degrees of freedom\nResidual deviance: 1.5543e-15  on 0  degrees of freedom\nAIC: 46.852\n\nNumber of Fisher Scoring iterations: 3\n\nanova(fit_penguines_O, fit_penguines_FI)\n\nAnalysis of Deviance Table\n\nModel 1: Freq ~ species + sex\nModel 2: Freq ~ species * sex\n  Resid. Df Resid. Dev Df Deviance\n1         2   0.048611            \n2         0   0.000000  2 0.048611\n\n\n独立モデルの尤度比カイ2乗統計量はassocstats(tab_penguines)の値と一致している．"
  },
  {
    "objectID": "1-Introduction.html#集計データを個票データに変換",
    "href": "1-Introduction.html#集計データを個票データに変換",
    "title": "シリーズ編者による内容紹介",
    "section": "集計データを個票データに変換",
    "text": "集計データを個票データに変換\n集計データを個票データに変換したいときにはvcdExtraパッケージのexpand.dftを用いる．\n\nlibrary(vcdExtra)\nd_ind &lt;- expand.dft(d, dreq = \"Freq\")\nd_ind\n\n# A tibble: 1,660 × 4\n    PSES   MHS Rscore Cscore\n   &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;\n 1     1     1   -2.5   -1.5\n 2     1     1   -2.5   -1.5\n 3     1     1   -2.5   -1.5\n 4     1     1   -2.5   -1.5\n 5     1     1   -2.5   -1.5\n 6     1     1   -2.5   -1.5\n 7     1     1   -2.5   -1.5\n 8     1     1   -2.5   -1.5\n 9     1     1   -2.5   -1.5\n10     1     1   -2.5   -1.5\n# ℹ 1,650 more rows"
  },
  {
    "objectID": "1-Introduction.html#元クロス分類表の入力",
    "href": "1-Introduction.html#元クロス分類表の入力",
    "title": "シリーズ編者による内容紹介",
    "section": "3元クロス分類表の入力",
    "text": "3元クロス分類表の入力\n\ndata &lt;- c(\n  2,5,1,\n  2,4,7,\n  \n  4,7,5,\n  8,0,1,\n  \n  10,11,5,\n  1,3,4,\n  \n  1,1,1,\n  2,3,4)\n\narray(data, dim = c(2,3,4))\n\n, , 1\n\n     [,1] [,2] [,3]\n[1,]    2    1    4\n[2,]    5    2    7\n\n, , 2\n\n     [,1] [,2] [,3]\n[1,]    4    5    0\n[2,]    7    8    1\n\n, , 3\n\n     [,1] [,2] [,3]\n[1,]   10    5    3\n[2,]   11    1    4\n\n, , 4\n\n     [,1] [,2] [,3]\n[1,]    1    1    3\n[2,]    1    2    4\n\ntab1 &lt;- c(2,5,1,\n          2,4,7) |&gt; matrix(nrow = 2, ncol = 3, byrow =TRUE)\n\n\ntab2 &lt;- c(4,7,5,\n          8,0,1) |&gt; matrix(nrow = 2, ncol = 3, byrow =TRUE)\n\ntab3 &lt;- c(10,11,5,\n          1,3,4) |&gt; matrix(nrow = 2, ncol = 3, byrow =TRUE)\n\ntab4 &lt;- c(1,1,1,\n          2,3,4) |&gt; matrix(nrow = 2, ncol = 3, byrow =TRUE)\n\ntab_merge &lt;- array(c(tab1,tab2,tab3,tab4), dim = c(2,3,4))\ntab_merge\n\n, , 1\n\n     [,1] [,2] [,3]\n[1,]    2    5    1\n[2,]    2    4    7\n\n, , 2\n\n     [,1] [,2] [,3]\n[1,]    4    7    5\n[2,]    8    0    1\n\n, , 3\n\n     [,1] [,2] [,3]\n[1,]   10   11    5\n[2,]    1    3    4\n\n, , 4\n\n     [,1] [,2] [,3]\n[1,]    1    1    1\n[2,]    2    3    4\n\ndimnames(tab_merge) &lt;- list(R = c(\"men\",\"women\"),\n                            C = c(\"blue\",\"red\",\"green\"),\n                            L = c(\"north\",\"south\",\"east\",\"west\"))\ntab_merge\n\n, , L = north\n\n       C\nR       blue red green\n  men      2   5     1\n  women    2   4     7\n\n, , L = south\n\n       C\nR       blue red green\n  men      4   7     5\n  women    8   0     1\n\n, , L = east\n\n       C\nR       blue red green\n  men     10  11     5\n  women    1   3     4\n\n, , L = west\n\n       C\nR       blue red green\n  men      1   1     1\n  women    2   3     4\n\n# フラットな形式で3元表を表示\nftable(tab_merge)\n\n            L north south east west\nR     C                            \nmen   blue        2     4   10    1\n      red         5     7   11    1\n      green       1     5    5    1\nwomen blue        2     8    1    2\n      red         4     0    3    3\n      green       7     1    4    4\n\n\nFriendly and Meyer (2016) を参考に表を作成．\n\n\n\n元のデータ形式\n変換後のデータ形式\n方法\n\n\n\n\nケース形式\n度数形式\ndata.frame(table(d$A,d$B))\n\n\nケース形式\n表形式\ntable(d$A,d$B)\n\n\n度数形式\nケース形式\nexpand.dfr(X)\n\n\n度数形式\n表形式\nxtabs(Freq ~ A + B)\n\n\n表形式\nケース形式\nexpand.dfr(X)\n\n\n表形式\n度数形式\ndata.frame(tab)"
  },
  {
    "objectID": "1-Introduction.html#練習問題",
    "href": "1-Introduction.html#練習問題",
    "title": "シリーズ編者による内容紹介",
    "section": "練習問題",
    "text": "練習問題\n\nせっかくデータを入力したので，このデータを使って Goodman (1979) の表5A，表5B，表5Cの結果を再現しよう．\n分析方法については第2章のプログラムを参考にしてほしい．"
  },
  {
    "objectID": "1-Introduction.html#参考文献",
    "href": "1-Introduction.html#参考文献",
    "title": "シリーズ編者による内容紹介",
    "section": "参考文献",
    "text": "参考文献\n\n\n\n\n\n\nGoodman, Leo A. 1979. “Simple Models for the Analysis of Association in Cross-Classifications Having Ordered Categories.” Journal of the American Statistical Association 74 (367): 537–52."
  },
  {
    "objectID": "3-Chapter_2.html#対比について",
    "href": "3-Chapter_2.html#対比について",
    "title": "2  第2章",
    "section": "2.1 対比について",
    "text": "2.1 対比について\n回帰モデルにおけるカテゴリカル変数の係数を解釈する上では対比 （contrasts）が重要である．まずはモデルを推定できるようになることのほうが重要なので， ひとまずとばして次の Section 2.2 から読みすすめてもよい．\nまず，デフォルト（標準の状態）でのcontrastsを確認したい．factor変数についてはcontr.treatment，ordered変数についてはcontr.polyという対比が用いられている．contr.treatmentは基準となっている水準とそれぞれの水準を対比する．これはダミーコーディングと呼ばれる． contr.polyは直交多項式（orthogonal polynomials）に基づいた対比を行う（気にしなくてよい）．\n\n# デフォルトのcontrastsを確認\noptions(\"contrasts\")\n\n$contrasts\n        unordered           ordered \n\"contr.treatment\"      \"contr.poly\" \n\n\n\n# defaultのcontrastsの設定（ここでは特に意味はない．constrastをいじった後にデフォルトに戻す）\noptions(contrasts = c(factor = \"contr.treatment\", \n                      ordered = \"contr.poly\"))\n\n具体的に何をしているのかを以下のプログラムで確認する． ダミーコーディングのcontr.treatment以外にも効果コーディングのcontr.sumがある．まずは両者を比較してみたい．\n\n# データの作成\nx &lt;- c(\"A\",\"B\",\"C\",\"D\",\"E\")\n# 確認\nx\n\n[1] \"A\" \"B\" \"C\" \"D\" \"E\"\n\n# 基準カテゴリが0となるような対比\ncontr.treatment(x)\n\n  B C D E\nA 0 0 0 0\nB 1 0 0 0\nC 0 1 0 0\nD 0 0 1 0\nE 0 0 0 1\n\n# 合計が0となるような対比\ncontr.sum(x)\n\n  [,1] [,2] [,3] [,4]\nA    1    0    0    0\nB    0    1    0    0\nC    0    0    1    0\nD    0    0    0    1\nE   -1   -1   -1   -1\n\n\n実際に回帰分析を例にcontr.treatmentとcontr.sumの違いを確認する．データはforcatsパッケージ（tidyverseに含まれる）のgss_cat（A sample of categorical variables from the General Social survey）である．従属変数はtvhours（hours per day watching tv）であり，独立変数はmarital（marital status）とする．\n\n# class別のtvhoursの平均値\ngss_cat |&gt; \n  dplyr::summarise(n = sum(!is.na(tvhours)),\n                   Mean = mean(tvhours, na.rm = TRUE),\n                   .by = marital) |&gt; \n  mutate(Diff_1 = Mean - Mean[marital == \"Never married\"],\n         Diff_2 = Mean - mean(Mean))\n\n# A tibble: 6 × 5\n  marital           n  Mean  Diff_1  Diff_2\n  &lt;fct&gt;         &lt;int&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;\n1 Never married  2995  3.11  0      -0.0379\n2 Divorced       1768  3.09 -0.0198 -0.0576\n3 Widowed        1000  3.91  0.807   0.769 \n4 Married        5172  2.65 -0.455  -0.493 \n5 Separated       393  3.55  0.444   0.407 \n6 No answer         9  2.56 -0.550  -0.587 \n\n\n水準はlevels関数で確認できる．1つ目の水準はNo answerであり，最後の水準はMarriedである．\n\ngss_cat$marital |&gt; levels()\n\n[1] \"No answer\"     \"Never married\" \"Separated\"     \"Divorced\"     \n[5] \"Widowed\"       \"Married\"      \n\n\nまずダミーコーディング（dummy coding）の結果を確認する．\n\n# 回帰分析の例（contr.treatmentを使用）\noptions(contrasts = c(factor = \"contr.treatment\", \n                      ordered = \"contr.poly\"))\n# 回帰分析\nfit_ct &lt;- lm(tvhours ~ marital, data = gss_cat)\n# 回帰分析の結果\nsummary(fit_ct)\n\n\nCall:\nlm(formula = tvhours ~ marital, data = gss_cat)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.9120 -1.6504 -0.6504  0.8948 21.3496 \n\nCoefficients:\n                     Estimate Std. Error t value Pr(&gt;|t|)   \n(Intercept)           2.55556    0.85328   2.995  0.00275 **\nmaritalNever married  0.54962    0.85456   0.643  0.52013   \nmaritalSeparated      0.99406    0.86300   1.152  0.24940   \nmaritalDivorced       0.52985    0.85545   0.619  0.53568   \nmaritalWidowed        1.35644    0.85711   1.583  0.11355   \nmaritalMarried        0.09487    0.85402   0.111  0.91155   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.56 on 11331 degrees of freedom\n  (10146 observations deleted due to missingness)\nMultiple R-squared:  0.02143,   Adjusted R-squared:  0.021 \nF-statistic: 49.63 on 5 and 11331 DF,  p-value: &lt; 2.2e-16\n\ntidy(fit_ct)\n\n# A tibble: 6 × 5\n  term                 estimate std.error statistic p.value\n  &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;\n1 (Intercept)            2.56       0.853     2.99  0.00275\n2 maritalNever married   0.550      0.855     0.643 0.520  \n3 maritalSeparated       0.994      0.863     1.15  0.249  \n4 maritalDivorced        0.530      0.855     0.619 0.536  \n5 maritalWidowed         1.36       0.857     1.58  0.114  \n6 maritalMarried         0.0949     0.854     0.111 0.912  \n\n# モデルマトリックス\nmodel.matrix(fit_ct) |&gt; unique()\n\n     (Intercept) maritalNever married maritalSeparated maritalDivorced\n1              1                    1                0               0\n3              1                    0                0               0\n5              1                    0                0               1\n9              1                    0                0               0\n88             1                    0                1               0\n1546           1                    0                0               0\n     maritalWidowed maritalMarried\n1                 0              0\n3                 1              0\n5                 0              0\n9                 0              1\n88                0              0\n1546              0              0\n\n\n出力される係数は5つである．maritalはfactorによって水準が設定されているわけではないので，No answerが基準カテゴリとなっており，出力からは省略されている．つまり，No answerの係数は0であり，(Intercept)の値はNo answerの平均値を示している．\n次に効果コーディングの結果を確認する．\n\n# 回帰分析の例（contr.sumを使用）\noptions(contrasts = c(factor = \"contr.sum\", \n                      ordered = \"contr.poly\"))\n# 回帰分析\nfit_cs &lt;- lm(tvhours ~ marital, data = gss_cat)\n# 回帰分析の結果\nsummary(fit_cs)\n\n\nCall:\nlm(formula = tvhours ~ marital, data = gss_cat)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.9120 -1.6504 -0.6504  0.8948 21.3496 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  3.14303    0.14515  21.654  &lt; 2e-16 ***\nmarital1    -0.58747    0.71166  -0.825   0.4091    \nmarital2    -0.03786    0.15009  -0.252   0.8009    \nmarital3     0.40659    0.17940   2.266   0.0234 *  \nmarital4    -0.05762    0.15343  -0.376   0.7072    \nmarital5     0.76897    0.15949   4.821 1.44e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.56 on 11331 degrees of freedom\n  (10146 observations deleted due to missingness)\nMultiple R-squared:  0.02143,   Adjusted R-squared:  0.021 \nF-statistic: 49.63 on 5 and 11331 DF,  p-value: &lt; 2.2e-16\n\ntidy(fit_cs)\n\n# A tibble: 6 × 5\n  term        estimate std.error statistic   p.value\n  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;\n1 (Intercept)   3.14       0.145    21.7   6.45e-102\n2 marital1     -0.587      0.712    -0.825 4.09e-  1\n3 marital2     -0.0379     0.150    -0.252 8.01e-  1\n4 marital3      0.407      0.179     2.27  2.34e-  2\n5 marital4     -0.0576     0.153    -0.376 7.07e-  1\n6 marital5      0.769      0.159     4.82  1.44e-  6\n\n# モデルマトリックス\nmodel.matrix(fit_cs) |&gt; unique()\n\n     (Intercept) marital1 marital2 marital3 marital4 marital5\n1              1        0        1        0        0        0\n3              1        0        0        0        0        1\n5              1        0        0        0        1        0\n9              1       -1       -1       -1       -1       -1\n88             1        0        0        1        0        0\n1546           1        1        0        0        0        0\n\n\nここでも出力される係数は5つであるが，ここでは最後のカテゴリであるMarriedが省略されている．しかし，最後のカテゴリであるMarriedの係数は0ではない．すべての係数の和が0になるという制約を与えているので，Marriedの係数は他の係数の値の和を0から引いたものとなる．\n\n# classという文字が含まれる係数を取り出し，係数の番号を調べる（2から6）\npickCoef(fit_cs, \"marital\")\n\nmarital1 marital2 marital3 marital4 marital5 \n       2        3        4        5        6 \n\n# 係数の2から6までを取り出し，その和を求める．\nfit_cs$coefficients[2:6] |&gt; sum()\n\n[1] 0.4926049\n\n# 直接次のようにしても良い．\nfit_cs$coefficients[pickCoef(fit_cs, \"marital\")] |&gt; sum()\n\n[1] 0.4926049\n\n# 和を0から引く\n0 - (fit_cs$coefficients[2:6] |&gt; sum())\n\n[1] -0.4926049\n\n\nしたがって，Marriedの係数は-0.4926049となる．\ncontrastsの設定を変更して分析を終えたら必ずもとに戻しておく．\n\n# デフォルトに戻す\noptions(contrasts = c(factor = \"contr.treatment\", ordered = \"contr.poly\"))\noptions(\"contrasts\")\n\n$contrasts\n           factor           ordered \n\"contr.treatment\"      \"contr.poly\" \n\n\nlmではモデルの中でcontrastsを指定することもできる．2つの方法で係数を比較してみる．\n\n# 回帰分析\nfit_cs2_1 &lt;- lm(tvhours ~ marital, data = gss_cat)\n# 回帰分析の結果\nsummary(fit_cs2_1)\n\n\nCall:\nlm(formula = tvhours ~ marital, data = gss_cat)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.9120 -1.6504 -0.6504  0.8948 21.3496 \n\nCoefficients:\n                     Estimate Std. Error t value Pr(&gt;|t|)   \n(Intercept)           2.55556    0.85328   2.995  0.00275 **\nmaritalNever married  0.54962    0.85456   0.643  0.52013   \nmaritalSeparated      0.99406    0.86300   1.152  0.24940   \nmaritalDivorced       0.52985    0.85545   0.619  0.53568   \nmaritalWidowed        1.35644    0.85711   1.583  0.11355   \nmaritalMarried        0.09487    0.85402   0.111  0.91155   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.56 on 11331 degrees of freedom\n  (10146 observations deleted due to missingness)\nMultiple R-squared:  0.02143,   Adjusted R-squared:  0.021 \nF-statistic: 49.63 on 5 and 11331 DF,  p-value: &lt; 2.2e-16\n\n# 回帰分析\nfit_cs2_2 &lt;- lm(tvhours ~ marital, data = gss_cat,\n              contrasts = list(marital = \"contr.sum\"))\n# 回帰分析の結果\nsummary(fit_cs2_2)\n\n\nCall:\nlm(formula = tvhours ~ marital, data = gss_cat, contrasts = list(marital = \"contr.sum\"))\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.9120 -1.6504 -0.6504  0.8948 21.3496 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  3.14303    0.14515  21.654  &lt; 2e-16 ***\nmarital1    -0.58747    0.71166  -0.825   0.4091    \nmarital2    -0.03786    0.15009  -0.252   0.8009    \nmarital3     0.40659    0.17940   2.266   0.0234 *  \nmarital4    -0.05762    0.15343  -0.376   0.7072    \nmarital5     0.76897    0.15949   4.821 1.44e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.56 on 11331 degrees of freedom\n  (10146 observations deleted due to missingness)\nMultiple R-squared:  0.02143,   Adjusted R-squared:  0.021 \nF-statistic: 49.63 on 5 and 11331 DF,  p-value: &lt; 2.2e-16\n\ntidy(fit_cs2_2)\n\n# A tibble: 6 × 5\n  term        estimate std.error statistic   p.value\n  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;\n1 (Intercept)   3.14       0.145    21.7   6.45e-102\n2 marital1     -0.587      0.712    -0.825 4.09e-  1\n3 marital2     -0.0379     0.150    -0.252 8.01e-  1\n4 marital3      0.407      0.179     2.27  2.34e-  2\n5 marital4     -0.0576     0.153    -0.376 7.07e-  1\n6 marital5      0.769      0.159     4.82  1.44e-  6\n\n\nでは結果を図にしてみる．\n\n# termのカテゴリ名を変換し，最後に`No answer`の行を加える．\nest_ct &lt;- fit_ct |&gt; \n  tidy(conf.int = TRUE) |&gt; \n  mutate(term = case_when(\n    grepl(\"Never\", term) ~ \"Never married\",\n    grepl(\"Separated\", term) ~ \"Separated\",\n    grepl(\"Divorced\", term) ~ \"Divorced\",\n    grepl(\"Widowed\", term) ~ \"Widowed\",\n    grepl(\"Married\", term) ~ \"Married\",\n    .default = term\n  )) |&gt; \n  add_row(term = \"No answer\", estimate = 0)\nest_ct\n\n# A tibble: 7 × 7\n  term          estimate std.error statistic  p.value conf.low conf.high\n  &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1 (Intercept)     2.56       0.853     2.99   0.00275    0.883      4.23\n2 Never married   0.550      0.855     0.643  0.520     -1.13       2.22\n3 Separated       0.994      0.863     1.15   0.249     -0.698      2.69\n4 Divorced        0.530      0.855     0.619  0.536     -1.15       2.21\n5 Widowed         1.36       0.857     1.58   0.114     -0.324      3.04\n6 Married         0.0949     0.854     0.111  0.912     -1.58       1.77\n7 No answer       0         NA        NA     NA         NA         NA   \n\n# 結果を図示する．\nfig_ct &lt;- est_ct |&gt; \n  ggplot(aes(x = term,\n             y = estimate,\n             ymin = conf.low,\n             ymax = conf.high)) + \n  geom_pointrange()\nfig_ct\n\nWarning: Removed 1 rows containing missing values (`geom_segment()`).\n\n\n\n\n# termのカテゴリ名を変換し，最後に`Married`の行を加える．\nest_cs &lt;- fit_cs |&gt; \n  tidy(conf.int = TRUE) |&gt; \n  mutate(term = case_match(term,\n                           \"marital1\" ~ \"No answer\",\n                           \"marital2\" ~ \"Never married\",\n                           \"marital3\" ~ \"Separated\",\n                           \"marital4\" ~ \"Divorced\",\n                           \"marital5\" ~ \"Widowed\",\n                           \"marital6\" ~ \"Married\",\n                           .default = term)) |&gt; \n  add_row(term = \"Married\", \n          estimate = 0 - (fit_cs$coefficients[2:6] |&gt; sum()))\n\n# 結果を図示する．\nfit_cs &lt;- est_cs |&gt; \n  ggplot(aes(x = term,\n             y = estimate,\n             ymin = conf.low,\n             ymax = conf.high)) + \n  geom_pointrange()\nfit_cs\n\nWarning: Removed 1 rows containing missing values (`geom_segment()`).\n\n\n\n\n# 図を並べる\nggpubr::ggarrange(fig_ct, fit_cs, nrow = 2)\n\nWarning: Removed 1 rows containing missing values (`geom_segment()`).\nRemoved 1 rows containing missing values (`geom_segment()`)."
  },
  {
    "objectID": "3-Chapter_2.html#sec-tab2_1",
    "href": "3-Chapter_2.html#sec-tab2_1",
    "title": "2  第2章",
    "section": "2.2 表2.1 (p.11)",
    "text": "2.2 表2.1 (p.11)\nまずp.11の表2.1を再現する．クロス表に周辺度数を追加する場合は，addmarginsを用いる．\n\n# 度数\nFreq &lt;- c( 40, 250,\n          160,3000)\nFreq\n\n[1]   40  250  160 3000\n\n\nベクトルを表にする．ここではas.tableでクラスをtableとしている．\n\n# 行列を作成し，表とする．\ntab_2.1 &lt;- matrix(\n  Freq,\n  nrow = 2,\n  ncol = 2,\n  byrow = TRUE,\n  dimnames = c(list(\n    Member = c(\"Member\", \"Nonmember\"),\n    Position = c(\"Have subordinates\",\n            \"No subordinates\")\n  ))\n) |&gt; as.table()\ntab_2.1\n\n           Position\nMember      Have subordinates No subordinates\n  Member                   40             250\n  Nonmember               160            3000\n\n\n周辺分布とモザイクプロットも確認する．本書で指摘されている関係性が図からも見て取れる．\n\n# 周辺分布の表示\nMargins(tab_2.1)\n\n$Member\n       level   freq   perc  cumfreq  cumperc\n1     Member    290   8.4%      290     8.4%\n2  Nonmember  3'160  91.6%    3'450   100.0%\n\n$Position\n               level   freq   perc  cumfreq  cumperc\n1  Have subordinates    200   5.8%      200     5.8%\n2    No subordinates  3'250  94.2%    3'450   100.0%\n\n# モザイクプロット\nvcd::mosaic(tab_2.1, shade = TRUE, keep_aspect_ratio = FALSE)\n\n\n\n\n\n\n\n\n\n\nggplotでモザイクプロット\n\n\n\n\n\n図はすべてggplot()を使用して描きたいという場合は，ggmosaicパッケージを用いる． その前に集計データをvcdExtra::expand.dft()によって個票データに変換し，ggmosaic::geom_mosaicを使用する．\n\n# パッケージの呼び出し\nlibrary(ggmosaic)\n\n\nAttaching package: 'ggmosaic'\n\n\nThe following objects are masked from 'package:vcd':\n\n    mosaic, spine\n\nlibrary(vcdExtra)\n\n\nAttaching package: 'vcdExtra'\n\n\nThe following object is masked from 'package:dplyr':\n\n    summarise\n\n# データの変換\ndf_tab_2.1 &lt;- vcdExtra::expand.dft(data.frame(tab_2.1), dreq = \"Freq\") |&gt; tibble()\ndf_tab_2.1\n\n# A tibble: 3,450 × 2\n   Member Position         \n   &lt;chr&gt;  &lt;chr&gt;            \n 1 Member Have subordinates\n 2 Member Have subordinates\n 3 Member Have subordinates\n 4 Member Have subordinates\n 5 Member Have subordinates\n 6 Member Have subordinates\n 7 Member Have subordinates\n 8 Member Have subordinates\n 9 Member Have subordinates\n10 Member Have subordinates\n# ℹ 3,440 more rows\n\n# ggplotでモザイクプロット\ndf_tab_2.1 |&gt; \n  ggplot() + \n  ggmosaic::geom_mosaic(aes(x = product(Position, Member), fill = Position)) + \n  scale_fill_viridis_d() + \n  coord_flip()   # mosaicと表示をあわせる\n\nWarning: `unite_()` was deprecated in tidyr 1.2.0.\nℹ Please use `unite()` instead.\nℹ The deprecated feature was likely used in the ggmosaic package.\n  Please report the issue at &lt;https://github.com/haleyjeppson/ggmosaic&gt;.\n\n\n\n\n\n\n\n\n表にaddmargins()で周辺度数を追加する．\n\n# A. 度数（周辺度数の追加）\ntab_2.1 |&gt; addmargins()\n\n           Position\nMember      Have subordinates No subordinates  Sum\n  Member                   40             250  290\n  Nonmember               160            3000 3160\n  Sum                     200            3250 3450\n\n\n表の数字を用いてオッズ比を計算する．\n\n# B. Odds \nx &lt;- tab_2.1\nx[1,1]/x[1,2]\n\n[1] 0.16\n\nx[2,1]/x[2,2]\n\n[1] 0.05333333\n\n# C. Odds ratio\nOR &lt;- (x[1,1]/x[1,2]) / (x[2,1]/x[2,2])\nOR\n\n[1] 3\n\n\n（対数）オッズ比の信頼区間をもとめる．\n\n# 対数オッズの標準誤差を求める\nSD &lt;- sqrt(1/x[1,1] + 1/x[1,2] + 1/x[2,1] + 1/x[2,2]) \n# 対数オッズ比の信頼区間を求める\nCI_log_OR &lt;- log(OR) + qnorm(c(0.025, 0.975)) * SD\nCI_log_OR\n\n[1] 0.7288936 1.4683310\n\n# オッズ比の信頼区間を求める\nexp(CI_log_OR)\n\n[1] 2.072786 4.341982\n\n\nDescToolsパッケージのOddsRatio関数を用いてオッズ比を求める．conf.level = 0.95とすることで信頼区間を求めることもできる． 先程計算したものと値が一致している．\n\nOddsRatio(tab_2.1, conf.level = 0.95)\n\nodds ratio     lwr.ci     upr.ci \n  3.000000   2.072786   4.341982 \n\n\n\n\n\n\n\n\n関数の中身を確認する．\n\n\n\nOddsRatio()がどのような処理をしているのかについてはOddsRatioと入力し，関数の中身をみることで確認できる． ただし，UseMethod(\"OddsRatio\")となっており，詳細が分からないことがある．その場合は，methods()を用いる． そして，OddsRatio.default*のように*がついているものについてDescTools:::OddsRatio.defaultのように入力することで中身を確認することができる．getAnywhere(OddsRatio.default)としてもよい．\n\nOddsRatio\nmethods(OddsRatio)\nDescTools:::OddsRatio.default\ngetAnywhere(OddsRatio.default)\n\n\n\nさらに詳細な結果をみたければDescToolsパッケージのDescを用いる．\n\nDesc(tab_2.1)\n\n------------------------------------------------------------------------------ \ntab_2.1 (table)\n\nSummary: \nn: 3'450, rows: 2, columns: 2\n\nPearson's Chi-squared test (cont. adj):\n  X-squared = 35.487, df = 1, p-value = 2.568e-09\nFisher's exact test p-value = 9.541e-08\nMcNemar's chi-squared = 19.32, df = 1, p-value = 1.106e-05\n\n                    estimate lwr.ci upr.ci'\n                                          \nodds ratio             3.000  2.073  4.342\nrel. risk (col1)       2.724  1.968  3.770\nrel. risk (col2)       0.908  0.867  0.951\n\n\nContingency Coeff.     0.103\nCramer's V             0.104\nKendall Tau-b          0.104\n\n                                                                 \n            Position   Have subordinates   No subordinates    Sum\nMember                                                           \n                                                                 \nMember      freq                      40               250    290\n            perc                    1.2%              7.2%   8.4%\n            p.row                  13.8%             86.2%      .\n            p.col                  20.0%              7.7%      .\n                                                                 \nNonmember   freq                     160             3'000  3'160\n            perc                    4.6%             87.0%  91.6%\n            p.row                   5.1%             94.9%      .\n            p.col                  80.0%             92.3%      .\n                                                                 \nSum         freq                     200             3'250  3'450\n            perc                    5.8%             94.2% 100.0%\n            p.row                      .                 .      .\n            p.col                      .                 .      .\n                                                                 \n\n----------\n' 95% conf. level\n\n\n\n\n\n次にセルの組み合わせを単位とした集計データを作成し，gnmを適用することでオッズ比を求めてみたい．gl()はn個の水準のある因子を作成する．kは各水準を何度繰り返すのかを指定する．lengthでベクトルの長さを設定することで，その長さになるまで因子の作成が繰り返される．\n\n# 度数のベクトル\nFreq\n\n[1]   40  250  160 3000\n\n# 行変数\nCOMM &lt;- gl(n = 2, k = 2)\nCOMM\n\n[1] 1 1 2 2\nLevels: 1 2\n\n# 列変数\nSUP  &lt;- gl(n = 2, k = 1, length = 4)\nSUP\n\n[1] 1 2 1 2\nLevels: 1 2\n\n# 度数，行変数，列変数からなるデータを作成\nfreq_tab_2.1 &lt;- tibble(COMM, SUP, Freq)\n# データの確認\nfreq_tab_2.1\n\n# A tibble: 4 × 3\n  COMM  SUP    Freq\n  &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt;\n1 1     1        40\n2 1     2       250\n3 2     1       160\n4 2     2      3000\n\n\n分析には通常はglmを用いるが，後の分析とあわせてgnmによって推定する．結果は異ならない．family = poissonという指定を忘れないようにすること．何も指定しないとfamily = gaussianとなり，通常の線形回帰分析を行ってしまうので注意する．\n\n# gnmで推定\nfit &lt;- freq_tab_2.1 |&gt; \n  gnm(Freq ~ COMM + SUP + COMM:SUP, data = _, family = poisson)\n# 結果\nsummary(fit)\n\n\nCall:\ngnm(formula = Freq ~ COMM + SUP + COMM:SUP, family = poisson, \n    data = freq_tab_2.1)\n\nDeviance Residuals: \n[1]  0  0  0  0\n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)   3.6889     0.1581  23.331  &lt; 2e-16 ***\nCOMM2         1.3863     0.1768   7.842  &lt; 2e-16 ***\nSUP2          1.8326     0.1703  10.761  &lt; 2e-16 ***\nCOMM2:SUP2    1.0986     0.1886   5.824 5.75e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nResidual deviance: -5.3113e-13 on 0 degrees of freedom\nAIC: 37.649\n\nNumber of iterations: 2\n\n\nCOMM2:SUP2の係数は1.0986である．これは対数オッズなので，指数関数expを適用してオッズ比を求める．\n\n# Odds ratios fit$coefficientsのCOMM2:SUP2の要素のみを取り出し，指数関数expを適用\nfit$coefficients[\"COMM2:SUP2\"] |&gt; exp()\n\nCOMM2:SUP2 \n         3 \n\nfit |&gt; confint(\"COMM2:SUP2\") |&gt; exp()\n\nWaiting for profiling to be done...\n\n\n   2.5 %   97.5 % \n2.049627 4.301359 \n\n\n次のようにしてもよい．\n\ncoef(fit)[\"COMM2:SUP2\"] |&gt; exp()\n\nCOMM2:SUP2 \n         3 \n\nconfint(fit)[\"COMM2:SUP2\",] |&gt; exp()\n\nWaiting for profiling to be done...\n\n\n   2.5 %   97.5 % \n2.049627 4.301359"
  },
  {
    "objectID": "3-Chapter_2.html#表2.3a-p.32",
    "href": "3-Chapter_2.html#表2.3a-p.32",
    "title": "2  第2章",
    "section": "2.3 表2.3A (p.32)",
    "text": "2.3 表2.3A (p.32)\nまずは表2.3Aを作成する．値をベクトルの形式で入力する．\n\nFreq &lt;- c( 39,  50,  18,   4,\n          140, 178,  85,  23,\n          108, 195,  97,  23,\n          238, 598, 363, 111,\n           78, 250, 150,  55,\n           50, 200, 208,  74,\n            8,  29,  46,  21)\n\nベクトルのデータをmatrixで行列にし，最終的にはas.tableでtable形式にする．\n\n# データを表形式に変換\ntab_2.3A &lt;- matrix(\n  Freq,\n  nrow = 7,\n  ncol = 4,\n  byrow = TRUE,\n  dimnames = c(list(\n    polviews =  c(\n      \"Strongly liberal\",\n      \"Liberal\",\n      \"Slightly liberal\",\n      \"Moderate\",\n      \"Slightly conservative\",\n      \"Conservative\",\n      \"Strongly conservative\"),\n    fefam = c(\"Strongly Disagree\",\n                               \"Disagree\",\n                               \"Agree\",\n                               \"Strongly agree\")\n  ))) |&gt; as.table()\ntab_2.3A\n\n                       fefam\npolviews                Strongly Disagree Disagree Agree Strongly agree\n  Strongly liberal                     39       50    18              4\n  Liberal                             140      178    85             23\n  Slightly liberal                    108      195    97             23\n  Moderate                            238      598   363            111\n  Slightly conservative                78      250   150             55\n  Conservative                         50      200   208             74\n  Strongly conservative                 8       29    46             21\n\n\n\n# 度数，行変数，列変数からなる集計データを作成\npolviews &lt;- gl(n = 7, k = 4)   # 1-7までの各数字について4つ値を出す\nfefam &lt;- gl(n = 4, k = 1, length = 28)   # 1-4までの数字の列を長さが28になるまで繰り返す\nfreq_tab_2.3A &lt;- tibble(Freq, polviews, fefam)\nfreq_tab_2.3A\n\n# A tibble: 28 × 3\n    Freq polviews fefam\n   &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;\n 1    39 1        1    \n 2    50 1        2    \n 3    18 1        3    \n 4     4 1        4    \n 5   140 2        1    \n 6   178 2        2    \n 7    85 2        3    \n 8    23 2        4    \n 9   108 3        1    \n10   195 3        2    \n# ℹ 18 more rows\n\n\n\nなおtab_2.3Aに対して，data.frameを適用しても集計データは作成される．tableの行変数と列変数が指定されていないと，行変数はVar1，列変数はVar2となるので，必要に応じて名前をrenameで修正する ．\n\n\ndata.frame(tab_2.3A) |&gt; \n  tibble()\n\n# A tibble: 28 × 3\n   polviews              fefam              Freq\n   &lt;fct&gt;                 &lt;fct&gt;             &lt;dbl&gt;\n 1 Strongly liberal      Strongly Disagree    39\n 2 Liberal               Strongly Disagree   140\n 3 Slightly liberal      Strongly Disagree   108\n 4 Moderate              Strongly Disagree   238\n 5 Slightly conservative Strongly Disagree    78\n 6 Conservative          Strongly Disagree    50\n 7 Strongly conservative Strongly Disagree     8\n 8 Strongly liberal      Disagree             50\n 9 Liberal               Disagree            178\n10 Slightly liberal      Disagree            195\n# ℹ 18 more rows\n\n\n以下では複数のモデルの適合度を比較する．そこで，モデル適合度を表示するための関数を作成する．モデルはすべてgnmによって推定されることを前提としている．glmの場合はエラーが出るので注意すること．\n\n# 引数となるobjはgnmの結果\nmodel.summary &lt;- function(obj, Model = NULL){\n  if (sum(class(obj) == \"gnm\") != 1)\n    stop(\"estimate with gnm\")\n  aic &lt;- obj$deviance - obj$df * 2 # AIC(L2)\n  bic &lt;- obj$deviance - obj$df * log(sum(obj$y)) #BIC(L2)\n  delta &lt;- 100 * sum(abs(obj$y - obj$fitted.values)) / (2 * sum(obj$y))\n  p &lt;- pchisq(obj$deviance, obj$df, lower.tail = FALSE)     #p&lt;-ifelse(p&lt;0.001,\"&lt;0.001\",p)\n  result &lt;- matrix(0, 1, 7)\n  if (is.null(Model)){ \n  Model &lt;- deparse(substitute(obj))\n  }\n  result &lt;- tibble(\n    \"Model Description\" = Model,\n    \"df\" = obj$df,\n    \"L2\" = obj$deviance,\n    #\"AIC(L2)\" = aic,\n    \"BIC\" = bic,\n    \"Delta\" = delta,\n    \"p\" = p\n  )\n  return(result)\n  }\n\nコントラストがデフォルトのfactor = \"contr.treatment\"とordered = \"contr.poly\"になっているのかを確認する．\n\n# デフォルトのcontrasts\noptions(\"contrasts\")\n\n$contrasts\n           factor           ordered \n\"contr.treatment\"      \"contr.poly\" \n\n# defaultのcontrastsの設定（ここでは特に意味はない．constrastをいじった後にデフォルトに戻す）\noptions(contrasts = c(factor = \"contr.treatment\", \n                      ordered = \"contr.poly\"))\n\n行スコアと列スコアを用いるので，まずas.integerを用いて行スコア（Rscore）と列スコア（Cscore）の変数を作成する．\n\n# 行変数と列変数の整数値を作成\nfreq_tab_2.3A &lt;- freq_tab_2.3A |&gt; \n  mutate(Rscore = as.integer(polviews),\n         Rscore = Rscore - mean(Rscore),\n         Cscore = as.integer(fefam),\n         Cscore = Cscore - mean(Cscore))\nfreq_tab_2.3A\n\n# A tibble: 28 × 5\n    Freq polviews fefam Rscore Cscore\n   &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt;\n 1    39 1        1         -3   -1.5\n 2    50 1        2         -3   -0.5\n 3    18 1        3         -3    0.5\n 4     4 1        4         -3    1.5\n 5   140 2        1         -2   -1.5\n 6   178 2        2         -2   -0.5\n 7    85 2        3         -2    0.5\n 8    23 2        4         -2    1.5\n 9   108 3        1         -1   -1.5\n10   195 3        2         -1   -0.5\n# ℹ 18 more rows\n\n\n\n2.3.1 独立モデル\n独立モデルは次のようになる．\n\n#  1. O: Independence/Null Association Model\nO &lt;- freq_tab_2.3A |&gt;\n  gnm(Freq ~ polviews + fefam,\n      family = poisson,\n      data = _,\n      tolerance = 1e-12\n      )\n# 結果\nsummary(O)\n\n\nCall:\n\ngnm(formula = Freq ~ polviews + fefam, family = poisson, data = freq_tab_2.3A, \n    tolerance = 1e-12)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-5.7415  -2.5344  -0.4283   1.5557   5.8265  \n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  3.06035    0.10115  30.256  &lt; 2e-16 ***\npolviews2    1.34491    0.10657  12.620  &lt; 2e-16 ***\npolviews3    1.33784    0.10664  12.545  &lt; 2e-16 ***\npolviews4    2.46825    0.09886  24.968  &lt; 2e-16 ***\npolviews5    1.56899    0.10433  15.038  &lt; 2e-16 ***\npolviews6    1.56711    0.10435  15.018  &lt; 2e-16 ***\npolviews7   -0.06514    0.13647  -0.477    0.633    \nfefam2       0.81947    0.04669  17.553  &lt; 2e-16 ***\nfefam3       0.38044    0.05047   7.538 4.76e-14 ***\nfefam4      -0.75396    0.06876 -10.965  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nResidual deviance: 211.7 on 18 degrees of freedom\nAIC: 403.05\n\nNumber of iterations: 5\n\n\n先ほど作成した適合度の関数を用いる．2つめの引数はモデルの名前の詳細を記述可能だが，これは省略してもよい．\n\n# モデル適合度\nmodel.summary(O, \"O:Independent\")\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta        p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n1 O:Independent          18  212.  65.1  8.09 4.54e-35\n\n\nテキストの表2.4と同じ結果になっているのかを確認してみる．\n\nbroom::augment(O, newdata = freq_tab_2.3A, type.predict = \"response\") |&gt; \n  dplyr::summarise(L2 = sum(Freq * log( Freq / .fitted)) * 2,\n                   BIC = L2 - summary(O)$df.residual * log(sum(freq_tab_2.3A$Freq)))\n\nWarning: The `augment()` method for objects of class `gnm` is not maintained by the broom team, and is only supported through the `glm` tidier method. Please be cautious in interpreting and reporting broom output.\n\nThis warning is displayed once per session.\n\n\n# A tibble: 1 × 2\n     L2   BIC\n  &lt;dbl&gt; &lt;dbl&gt;\n1  212.  65.1\n\npredict(O, newdata = freq_tab_2.3A, type = \"response\")\n\n        1         2         3         4         5         6         7         8 \n 21.33498  48.41524  31.21169  10.03809  81.88020 185.80983 119.78540  38.52457 \n        9        10        11        12        13        14        15        16 \n 81.30358 184.50131 118.94184  38.25327 251.79122 571.38703 368.35417 118.46758 \n       17        18        19        20        21        22        23        24 \n102.44635 232.48037 149.87235  48.20093 102.25414 232.04420 149.59116  48.11050 \n       25        26        27        28 \n 19.98953  45.36202  29.24338   9.40506 \n\nO$fitted.values\n\n        1         2         3         4         5         6         7         8 \n 21.33498  48.41524  31.21169  10.03809  81.88020 185.80983 119.78540  38.52457 \n        9        10        11        12        13        14        15        16 \n 81.30358 184.50131 118.94184  38.25327 251.79122 571.38703 368.35417 118.46758 \n       17        18        19        20        21        22        23        24 \n102.44635 232.48037 149.87235  48.20093 102.25414 232.04420 149.59116  48.11050 \n       25        26        27        28 \n 19.98953  45.36202  29.24338   9.40506 \n\n\n\n\n2.3.2 一様連関モデル\n一様連関モデルでは先ほど作成した行変数と列変数の整数スコアの積であるRscore:Cscoreを加える．Rscore*CscoreあるいはI(Rscore*Cscore)でもよい．\n\n# 2. U: Uniform Association Model\nU &lt;- freq_tab_2.3A |&gt;\n  gnm(Freq ~ polviews + fefam + Rscore:Cscore,\n    family = poisson,\n    data = _,\n    tolerance = 1e-12)\n\n\n# 結果\nsummary(U)\n\n\nCall:\ngnm(formula = Freq ~ polviews + fefam + Rscore:Cscore, family = poisson, \n    data = freq_tab_2.3A, tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.62563  -0.41050  -0.06989   0.53746   1.67998  \n\nCoefficients:\n              Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)    2.77240    0.10449  26.533  &lt; 2e-16 ***\npolviews2      1.46434    0.10748  13.625  &lt; 2e-16 ***\npolviews3      1.55049    0.10942  14.170  &lt; 2e-16 ***\npolviews4      2.74597    0.10368  26.485  &lt; 2e-16 ***\npolviews5      1.88202    0.10973  17.151  &lt; 2e-16 ***\npolviews6      1.88457    0.10937  17.231  &lt; 2e-16 ***\npolviews7      0.22533    0.13937   1.617    0.106    \nfefam2         0.85993    0.04746  18.117  &lt; 2e-16 ***\nfefam3         0.38502    0.05144   7.484 7.19e-14 ***\nfefam4        -0.85901    0.07109 -12.083  &lt; 2e-16 ***\nRscore:Cscore  0.20211    0.01520  13.299  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nResidual deviance: 20.125 on 17 degrees of freedom\nAIC: 213.48\n\nNumber of iterations: 4\n\n\n表2.4Aと同じ結果になっているのかを確認する．\n\n# モデル適合度\nmodel.summary(U, \"U:Uniform\")\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 U:Uniform              17  20.1 -118.  2.77 0.268\n\n\nモデル行列を確認するのもよいだろう．\n\n# model.matrixを適用し，ユニークな値だけを表示\nmodel.matrix(U) |&gt; unique() \n\n   (Intercept) polviews2 polviews3 polviews4 polviews5 polviews6 polviews7\n1            1         0         0         0         0         0         0\n2            1         0         0         0         0         0         0\n3            1         0         0         0         0         0         0\n4            1         0         0         0         0         0         0\n5            1         1         0         0         0         0         0\n6            1         1         0         0         0         0         0\n7            1         1         0         0         0         0         0\n8            1         1         0         0         0         0         0\n9            1         0         1         0         0         0         0\n10           1         0         1         0         0         0         0\n11           1         0         1         0         0         0         0\n12           1         0         1         0         0         0         0\n13           1         0         0         1         0         0         0\n14           1         0         0         1         0         0         0\n15           1         0         0         1         0         0         0\n16           1         0         0         1         0         0         0\n17           1         0         0         0         1         0         0\n18           1         0         0         0         1         0         0\n19           1         0         0         0         1         0         0\n20           1         0         0         0         1         0         0\n21           1         0         0         0         0         1         0\n22           1         0         0         0         0         1         0\n23           1         0         0         0         0         1         0\n24           1         0         0         0         0         1         0\n25           1         0         0         0         0         0         1\n26           1         0         0         0         0         0         1\n27           1         0         0         0         0         0         1\n28           1         0         0         0         0         0         1\n   fefam2 fefam3 fefam4 Rscore:Cscore\n1       0      0      0           4.5\n2       1      0      0           1.5\n3       0      1      0          -1.5\n4       0      0      1          -4.5\n5       0      0      0           3.0\n6       1      0      0           1.0\n7       0      1      0          -1.0\n8       0      0      1          -3.0\n9       0      0      0           1.5\n10      1      0      0           0.5\n11      0      1      0          -0.5\n12      0      0      1          -1.5\n13      0      0      0           0.0\n14      1      0      0           0.0\n15      0      1      0           0.0\n16      0      0      1           0.0\n17      0      0      0          -1.5\n18      1      0      0          -0.5\n19      0      1      0           0.5\n20      0      0      1           1.5\n21      0      0      0          -3.0\n22      1      0      0          -1.0\n23      0      1      0           1.0\n24      0      0      1           3.0\n25      0      0      0          -4.5\n26      1      0      0          -1.5\n27      0      1      0           1.5\n28      0      0      1           4.5\n\n\n\n\n2.3.3 行効果モデル\ncontrastを修正し，polviewsの係数のすべてを足すと0になるように効果コーディングを行ってる．なお行変数と列スコアの積についてはCscore*polviewsとし，Cscore:polviewsとしない．\n\n# 3. R: Row Effect Model\n# contrastを修正している．\noptions(contrasts = c(factor = \"contr.sum\", \n                      ordered = \"contr.treatment\"))\noptions(\"contrasts\")\n\n$contrasts\n           factor           ordered \n      \"contr.sum\" \"contr.treatment\" \n\nR &lt;- freq_tab_2.3A |&gt;\n  gnm(Freq ~ polviews + fefam + Cscore*polviews, \n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n# 結果\nsummary(R)\n\n\nCall:\n\ngnm(formula = Freq ~ polviews + fefam + Cscore * polviews, family = poisson, \n    data = freq_tab_2.3A, tolerance = 1e-12)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-1.5962  -0.4603   0.0477   0.3840   1.5700  \n\nCoefficients:\n                  Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       4.262045   0.029618 143.902  &lt; 2e-16 ***\npolviews1        -1.356438   0.106013 -12.795  &lt; 2e-16 ***\npolviews2         0.075995   0.055906   1.359   0.1740    \npolviews3         0.142487   0.053465   2.665   0.0077 ** \npolviews4         1.357080   0.036418  37.264  &lt; 2e-16 ***\npolviews5         0.478200   0.046111  10.371  &lt; 2e-16 ***\npolviews6         0.489287   0.045766  10.691  &lt; 2e-16 ***\nfefam1           -0.112887   0.046238  -2.441   0.0146 *  \nfefam2            0.758505   0.030086  25.211  &lt; 2e-16 ***\nfefam3            0.295555   0.032630   9.058  &lt; 2e-16 ***\nCscore            0.000000         NA      NA       NA    \npolviews1:Cscore -0.558727   0.107668  -5.189 2.11e-07 ***\npolviews2:Cscore -0.405076   0.059149  -6.848 7.47e-12 ***\npolviews3:Cscore -0.248459   0.057741  -4.303 1.69e-05 ***\npolviews4:Cscore  0.008764   0.039709   0.221   0.8253    \npolviews5:Cscore  0.112245   0.051284   2.189   0.0286 *  \npolviews6:Cscore  0.419079   0.051434   8.148  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 15.906 on 12 degrees of freedom\nAIC: 219.26\n\nNumber of iterations: 4\n\n# モデル適合度\nmodel.summary(R, \"R:Row effect\")\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 R:Row effect           12  15.9 -81.8  2.47 0.196\n\n# モデル行列の確認\nmodel.matrix(R) |&gt; unique()\n\n   (Intercept) polviews1 polviews2 polviews3 polviews4 polviews5 polviews6\n1            1         1         0         0         0         0         0\n2            1         1         0         0         0         0         0\n3            1         1         0         0         0         0         0\n4            1         1         0         0         0         0         0\n5            1         0         1         0         0         0         0\n6            1         0         1         0         0         0         0\n7            1         0         1         0         0         0         0\n8            1         0         1         0         0         0         0\n9            1         0         0         1         0         0         0\n10           1         0         0         1         0         0         0\n11           1         0         0         1         0         0         0\n12           1         0         0         1         0         0         0\n13           1         0         0         0         1         0         0\n14           1         0         0         0         1         0         0\n15           1         0         0         0         1         0         0\n16           1         0         0         0         1         0         0\n17           1         0         0         0         0         1         0\n18           1         0         0         0         0         1         0\n19           1         0         0         0         0         1         0\n20           1         0         0         0         0         1         0\n21           1         0         0         0         0         0         1\n22           1         0         0         0         0         0         1\n23           1         0         0         0         0         0         1\n24           1         0         0         0         0         0         1\n25           1        -1        -1        -1        -1        -1        -1\n26           1        -1        -1        -1        -1        -1        -1\n27           1        -1        -1        -1        -1        -1        -1\n28           1        -1        -1        -1        -1        -1        -1\n   fefam1 fefam2 fefam3 Cscore polviews1:Cscore polviews2:Cscore\n1       1      0      0   -1.5             -1.5              0.0\n2       0      1      0   -0.5             -0.5              0.0\n3       0      0      1    0.5              0.5              0.0\n4      -1     -1     -1    1.5              1.5              0.0\n5       1      0      0   -1.5              0.0             -1.5\n6       0      1      0   -0.5              0.0             -0.5\n7       0      0      1    0.5              0.0              0.5\n8      -1     -1     -1    1.5              0.0              1.5\n9       1      0      0   -1.5              0.0              0.0\n10      0      1      0   -0.5              0.0              0.0\n11      0      0      1    0.5              0.0              0.0\n12     -1     -1     -1    1.5              0.0              0.0\n13      1      0      0   -1.5              0.0              0.0\n14      0      1      0   -0.5              0.0              0.0\n15      0      0      1    0.5              0.0              0.0\n16     -1     -1     -1    1.5              0.0              0.0\n17      1      0      0   -1.5              0.0              0.0\n18      0      1      0   -0.5              0.0              0.0\n19      0      0      1    0.5              0.0              0.0\n20     -1     -1     -1    1.5              0.0              0.0\n21      1      0      0   -1.5              0.0              0.0\n22      0      1      0   -0.5              0.0              0.0\n23      0      0      1    0.5              0.0              0.0\n24     -1     -1     -1    1.5              0.0              0.0\n25      1      0      0   -1.5              1.5              1.5\n26      0      1      0   -0.5              0.5              0.5\n27      0      0      1    0.5             -0.5             -0.5\n28     -1     -1     -1    1.5             -1.5             -1.5\n   polviews3:Cscore polviews4:Cscore polviews5:Cscore polviews6:Cscore\n1               0.0              0.0              0.0              0.0\n2               0.0              0.0              0.0              0.0\n3               0.0              0.0              0.0              0.0\n4               0.0              0.0              0.0              0.0\n5               0.0              0.0              0.0              0.0\n6               0.0              0.0              0.0              0.0\n7               0.0              0.0              0.0              0.0\n8               0.0              0.0              0.0              0.0\n9              -1.5              0.0              0.0              0.0\n10             -0.5              0.0              0.0              0.0\n11              0.5              0.0              0.0              0.0\n12              1.5              0.0              0.0              0.0\n13              0.0             -1.5              0.0              0.0\n14              0.0             -0.5              0.0              0.0\n15              0.0              0.5              0.0              0.0\n16              0.0              1.5              0.0              0.0\n17              0.0              0.0             -1.5              0.0\n18              0.0              0.0             -0.5              0.0\n19              0.0              0.0              0.5              0.0\n20              0.0              0.0              1.5              0.0\n21              0.0              0.0              0.0             -1.5\n22              0.0              0.0              0.0             -0.5\n23              0.0              0.0              0.0              0.5\n24              0.0              0.0              0.0              1.5\n25              1.5              1.5              1.5              1.5\n26              0.5              0.5              0.5              0.5\n27             -0.5             -0.5             -0.5             -0.5\n28             -1.5             -1.5             -1.5             -1.5\n\n\n表2.4の適合度を確認しよう．また，パラメータ推定値については，表2.5のBから確認する． Rの結果では，polviews1からpolviews6までの結果が表示されているが，polviews7は示されていない．パラメータのすべての値を足すと0となることから(\\(\\sum \\tau_i^A=0\\))，polviews7の係数は0-(-0.6721737)=0.6721737となる．これをRで計算するためには係数を取り出し，それらを足したものを0から引けばよい．\n\n# R\n# 取り出す係数を探す\npickCoef(R, \":Cscore\")\n\npolviews1:Cscore polviews2:Cscore polviews3:Cscore polviews4:Cscore \n              12               13               14               15 \npolviews5:Cscore polviews6:Cscore \n              16               17 \n\n# 12から17番目の係数を取り出し，足す\nR$coefficients[12:17] |&gt; sum()\n\n[1] -0.6721737\n\n# 次のようにもできる\nR$coefficients[pickCoef(R, \":Cscore\")] |&gt; sum()\n\n[1] -0.6721737\n\n# 0から足したものを引く\n0 - (R$coefficients[pickCoef(R, \":Cscore\")] |&gt; sum())\n\n[1] 0.6721737\n\n\ncontrastsをもとに戻して同様の分析を行う． 今度はpolviews1:Cscoreの係数が省略されているが，この値は0である（\\(\\tau_1^A=0\\)）．\n\n# alternative (default)\noptions(contrasts = c(factor = \"contr.treatment\",\n                      ordered = \"contr.poly\"))\nRalt &lt;- freq_tab_2.3A |&gt;\n  gnm(Freq ~ polviews + fefam + Cscore*polviews, \n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\n結果は表2.5Bの「他の正規化」の行を確認して欲しい．\n\n# 結果\nsummary(Ralt)\n\n\nCall:\n\ngnm(formula = Freq ~ polviews + fefam + Cscore * polviews, family = poisson, \n    data = freq_tab_2.3A, tolerance = 1e-12)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-1.5962  -0.4603   0.0477   0.3840   1.5700  \n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)        3.6308     0.1443  25.160  &lt; 2e-16 ***\npolviews2          1.4324     0.1342  10.670  &lt; 2e-16 ***\npolviews3          1.4989     0.1329  11.279  &lt; 2e-16 ***\npolviews4          2.7135     0.1246  21.776  &lt; 2e-16 ***\npolviews5          1.8346     0.1290  14.218  &lt; 2e-16 ***\npolviews6          1.8457     0.1289  14.323  &lt; 2e-16 ***\npolviews7          0.1698     0.1589   1.069  0.28508    \nfefam2             0.3127     0.1265   2.471  0.01345 *  \nfefam3            -0.7090     0.2447  -2.897  0.00376 ** \nfefam4            -2.5045     0.3703  -6.763 1.36e-11 ***\nCscore             0.0000         NA      NA       NA    \npolviews2:Cscore   0.1537     0.1362   1.128  0.25925    \npolviews3:Cscore   0.3103     0.1357   2.287  0.02219 *  \npolviews4:Cscore   0.5675     0.1268   4.477 7.58e-06 ***\npolviews5:Cscore   0.6710     0.1326   5.059 4.21e-07 ***\npolviews6:Cscore   0.9778     0.1331   7.346 2.04e-13 ***\npolviews7:Cscore   1.2309     0.1678   7.335 2.22e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 15.906 on 12 degrees of freedom\nAIC: 219.26\n\nNumber of iterations: 4\n\n\nモデルの適合度は全く同じであることがわかる．\n\n# モデル適合度\nmodel.summary(R, \"R: Row effect (effect coding)\")\n\n# A tibble: 1 × 6\n  `Model Description`              df    L2   BIC Delta     p\n  &lt;chr&gt;                         &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 R: Row effect (effect coding)    12  15.9 -81.8  2.47 0.196\n\nmodel.summary(Ralt, \"R: Row effect (dummy coding)\")\n\n# A tibble: 1 × 6\n  `Model Description`             df    L2   BIC Delta     p\n  &lt;chr&gt;                        &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 R: Row effect (dummy coding)    12  15.9 -81.8  2.47 0.196\n\n\n\n# モデル行列の確認\nmodel.matrix(Ralt) |&gt; unique()\n\n   (Intercept) polviews2 polviews3 polviews4 polviews5 polviews6 polviews7\n1            1         0         0         0         0         0         0\n2            1         0         0         0         0         0         0\n3            1         0         0         0         0         0         0\n4            1         0         0         0         0         0         0\n5            1         1         0         0         0         0         0\n6            1         1         0         0         0         0         0\n7            1         1         0         0         0         0         0\n8            1         1         0         0         0         0         0\n9            1         0         1         0         0         0         0\n10           1         0         1         0         0         0         0\n11           1         0         1         0         0         0         0\n12           1         0         1         0         0         0         0\n13           1         0         0         1         0         0         0\n14           1         0         0         1         0         0         0\n15           1         0         0         1         0         0         0\n16           1         0         0         1         0         0         0\n17           1         0         0         0         1         0         0\n18           1         0         0         0         1         0         0\n19           1         0         0         0         1         0         0\n20           1         0         0         0         1         0         0\n21           1         0         0         0         0         1         0\n22           1         0         0         0         0         1         0\n23           1         0         0         0         0         1         0\n24           1         0         0         0         0         1         0\n25           1         0         0         0         0         0         1\n26           1         0         0         0         0         0         1\n27           1         0         0         0         0         0         1\n28           1         0         0         0         0         0         1\n   fefam2 fefam3 fefam4 Cscore polviews2:Cscore polviews3:Cscore\n1       0      0      0   -1.5              0.0              0.0\n2       1      0      0   -0.5              0.0              0.0\n3       0      1      0    0.5              0.0              0.0\n4       0      0      1    1.5              0.0              0.0\n5       0      0      0   -1.5             -1.5              0.0\n6       1      0      0   -0.5             -0.5              0.0\n7       0      1      0    0.5              0.5              0.0\n8       0      0      1    1.5              1.5              0.0\n9       0      0      0   -1.5              0.0             -1.5\n10      1      0      0   -0.5              0.0             -0.5\n11      0      1      0    0.5              0.0              0.5\n12      0      0      1    1.5              0.0              1.5\n13      0      0      0   -1.5              0.0              0.0\n14      1      0      0   -0.5              0.0              0.0\n15      0      1      0    0.5              0.0              0.0\n16      0      0      1    1.5              0.0              0.0\n17      0      0      0   -1.5              0.0              0.0\n18      1      0      0   -0.5              0.0              0.0\n19      0      1      0    0.5              0.0              0.0\n20      0      0      1    1.5              0.0              0.0\n21      0      0      0   -1.5              0.0              0.0\n22      1      0      0   -0.5              0.0              0.0\n23      0      1      0    0.5              0.0              0.0\n24      0      0      1    1.5              0.0              0.0\n25      0      0      0   -1.5              0.0              0.0\n26      1      0      0   -0.5              0.0              0.0\n27      0      1      0    0.5              0.0              0.0\n28      0      0      1    1.5              0.0              0.0\n   polviews4:Cscore polviews5:Cscore polviews6:Cscore polviews7:Cscore\n1               0.0              0.0              0.0              0.0\n2               0.0              0.0              0.0              0.0\n3               0.0              0.0              0.0              0.0\n4               0.0              0.0              0.0              0.0\n5               0.0              0.0              0.0              0.0\n6               0.0              0.0              0.0              0.0\n7               0.0              0.0              0.0              0.0\n8               0.0              0.0              0.0              0.0\n9               0.0              0.0              0.0              0.0\n10              0.0              0.0              0.0              0.0\n11              0.0              0.0              0.0              0.0\n12              0.0              0.0              0.0              0.0\n13             -1.5              0.0              0.0              0.0\n14             -0.5              0.0              0.0              0.0\n15              0.5              0.0              0.0              0.0\n16              1.5              0.0              0.0              0.0\n17              0.0             -1.5              0.0              0.0\n18              0.0             -0.5              0.0              0.0\n19              0.0              0.5              0.0              0.0\n20              0.0              1.5              0.0              0.0\n21              0.0              0.0             -1.5              0.0\n22              0.0              0.0             -0.5              0.0\n23              0.0              0.0              0.5              0.0\n24              0.0              0.0              1.5              0.0\n25              0.0              0.0              0.0             -1.5\n26              0.0              0.0              0.0             -0.5\n27              0.0              0.0              0.0              0.5\n28              0.0              0.0              0.0              1.5"
  },
  {
    "objectID": "3-Chapter_2.html#列効果モデル",
    "href": "3-Chapter_2.html#列効果モデル",
    "title": "2  第2章",
    "section": "2.4 列効果モデル",
    "text": "2.4 列効果モデル\n列効果モデルは行効果モデルと同様の方法で推定すればよい．まずは効果コーディングで推定し，その後にダミーコーディングで推定する．\n\n# 4. C: Column Effect Model\n# contrast\noptions(contrasts = c(factor = \"contr.sum\", \n                      ordered = \"contr.treatment\"))\nC &lt;- freq_tab_2.3A |&gt; \n  gnm(Freq ~ polviews + fefam + Rscore*fefam, family = poisson, \n      data = _, \n      tolerance = 1e-12)\n# 結果\nsummary(C)\n\n\nCall:\n\ngnm(formula = Freq ~ polviews + fefam + Rscore * fefam, family = poisson, \n    data = freq_tab_2.3A, tolerance = 1e-12)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-1.7572  -0.4920   0.1628   0.4922   1.4247  \n\nCoefficients:\n              Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)    4.26735    0.02842 150.161  &lt; 2e-16 ***\npolviews1     -1.34764    0.08885 -15.167  &lt; 2e-16 ***\npolviews2      0.10725    0.05058   2.120 0.033978 *  \npolviews3      0.17817    0.04852   3.672 0.000241 ***\npolviews4      1.35465    0.03449  39.280  &lt; 2e-16 ***\npolviews5      0.47060    0.04547  10.349  &lt; 2e-16 ***\npolviews6      0.45489    0.04714   9.650  &lt; 2e-16 ***\nfefam1        -0.11795    0.03606  -3.271 0.001072 ** \nfefam2         0.75721    0.02817  26.882  &lt; 2e-16 ***\nfefam3         0.27540    0.03195   8.619  &lt; 2e-16 ***\nRscore         0.00000         NA      NA       NA    \nfefam1:Rscore -0.32183    0.02601 -12.373  &lt; 2e-16 ***\nfefam2:Rscore -0.06518    0.02013  -3.238 0.001203 ** \nfefam3:Rscore  0.13740    0.02282   6.021 1.73e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 14.237 on 15 degrees of freedom\nAIC: 211.59\n\nNumber of iterations: 4\n\n# モデル適合度\nmodel.summary(C, \"C:Column effect\")\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 C:Column effect        15  14.2 -108.  2.32 0.508\n\n# モデル行列の確認\nmodel.matrix(C) |&gt; unique()\n\n   (Intercept) polviews1 polviews2 polviews3 polviews4 polviews5 polviews6\n1            1         1         0         0         0         0         0\n2            1         1         0         0         0         0         0\n3            1         1         0         0         0         0         0\n4            1         1         0         0         0         0         0\n5            1         0         1         0         0         0         0\n6            1         0         1         0         0         0         0\n7            1         0         1         0         0         0         0\n8            1         0         1         0         0         0         0\n9            1         0         0         1         0         0         0\n10           1         0         0         1         0         0         0\n11           1         0         0         1         0         0         0\n12           1         0         0         1         0         0         0\n13           1         0         0         0         1         0         0\n14           1         0         0         0         1         0         0\n15           1         0         0         0         1         0         0\n16           1         0         0         0         1         0         0\n17           1         0         0         0         0         1         0\n18           1         0         0         0         0         1         0\n19           1         0         0         0         0         1         0\n20           1         0         0         0         0         1         0\n21           1         0         0         0         0         0         1\n22           1         0         0         0         0         0         1\n23           1         0         0         0         0         0         1\n24           1         0         0         0         0         0         1\n25           1        -1        -1        -1        -1        -1        -1\n26           1        -1        -1        -1        -1        -1        -1\n27           1        -1        -1        -1        -1        -1        -1\n28           1        -1        -1        -1        -1        -1        -1\n   fefam1 fefam2 fefam3 Rscore fefam1:Rscore fefam2:Rscore fefam3:Rscore\n1       1      0      0     -3            -3             0             0\n2       0      1      0     -3             0            -3             0\n3       0      0      1     -3             0             0            -3\n4      -1     -1     -1     -3             3             3             3\n5       1      0      0     -2            -2             0             0\n6       0      1      0     -2             0            -2             0\n7       0      0      1     -2             0             0            -2\n8      -1     -1     -1     -2             2             2             2\n9       1      0      0     -1            -1             0             0\n10      0      1      0     -1             0            -1             0\n11      0      0      1     -1             0             0            -1\n12     -1     -1     -1     -1             1             1             1\n13      1      0      0      0             0             0             0\n14      0      1      0      0             0             0             0\n15      0      0      1      0             0             0             0\n16     -1     -1     -1      0             0             0             0\n17      1      0      0      1             1             0             0\n18      0      1      0      1             0             1             0\n19      0      0      1      1             0             0             1\n20     -1     -1     -1      1            -1            -1            -1\n21      1      0      0      2             2             0             0\n22      0      1      0      2             0             2             0\n23      0      0      1      2             0             0             2\n24     -1     -1     -1      2            -2            -2            -2\n25      1      0      0      3             3             0             0\n26      0      1      0      3             0             3             0\n27      0      0      1      3             0             0             3\n28     -1     -1     -1      3            -3            -3            -3\n\n\nすべてを足すと0となることから(\\(\\sum \\tau_j^B=0\\))，polviews7の係数は0-(-0.2496118)=0.2496118となる\n\npickCoef(C, \":Rscore\")\n\nfefam1:Rscore fefam2:Rscore fefam3:Rscore \n           12            13            14 \n\nC$coefficients[pickCoef(C, \":Rscore\")] |&gt; sum()\n\n[1] -0.2496118\n\n0 - (C$coefficients[pickCoef(C, \":Rscore\")] |&gt; sum())\n\n[1] 0.2496118\n\n\n以下はダミーコーディングを用いている．\n\n# alternative (default)\noptions(contrasts = c(factor = \"contr.treatment\",\n                      ordered = \"contr.poly\"))\nCalt &lt;- freq_tab_2.3A |&gt; \n  gnm(Freq ~ polviews + fefam + Rscore*fefam, \n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\n推定値は表2.5Cを確認せよ．\n\n# 結果\nsummary(Calt)\n\n\nCall:\n\ngnm(formula = Freq ~ polviews + fefam + Rscore * fefam, family = poisson, \n    data = freq_tab_2.3A, tolerance = 1e-12)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-1.7572  -0.4920   0.1628   0.4922   1.4247  \n\nCoefficients:\n              Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)    3.76726    0.11222  33.571  &lt; 2e-16 ***\npolviews2      1.13306    0.10785  10.506  &lt; 2e-16 ***\npolviews3      0.88215    0.11310   7.800  &lt; 2e-16 ***\npolviews4      1.73680    0.11708  14.834  &lt; 2e-16 ***\npolviews5      0.53092    0.13848   3.834 0.000126 ***\npolviews6      0.19337    0.16048   1.205 0.228239    \npolviews7     -1.80128    0.20632  -8.730  &lt; 2e-16 ***\nfefam2         0.87516    0.04848  18.050  &lt; 2e-16 ***\nfefam3         0.39335    0.05298   7.424 1.13e-13 ***\nfefam4        -0.79671    0.07451 -10.692  &lt; 2e-16 ***\nRscore         0.00000         NA      NA       NA    \nfefam2:Rscore  0.25665    0.03459   7.421 1.17e-13 ***\nfefam3:Rscore  0.45924    0.03851  11.926  &lt; 2e-16 ***\nfefam4:Rscore  0.57144    0.05297  10.788  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 14.237 on 15 degrees of freedom\nAIC: 211.59\n\nNumber of iterations: 4\n\n\n適合度は効果コーディングとダミーコーディングで変化しない．\n\n# モデル適合度\nmodel.summary(C, \"C:Column effect (effect coding)\") \n\n# A tibble: 1 × 6\n  `Model Description`                df    L2   BIC Delta     p\n  &lt;chr&gt;                           &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 C:Column effect (effect coding)    15  14.2 -108.  2.32 0.508\n\nmodel.summary(Calt, \"C:Column effect (dummy coding)\")\n\n# A tibble: 1 × 6\n  `Model Description`               df    L2   BIC Delta     p\n  &lt;chr&gt;                          &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 C:Column effect (dummy coding)    15  14.2 -108.  2.32 0.508\n\n\n\n# モデル行列の確認\nmodel.matrix(Calt) |&gt; unique()\n\n   (Intercept) polviews2 polviews3 polviews4 polviews5 polviews6 polviews7\n1            1         0         0         0         0         0         0\n2            1         0         0         0         0         0         0\n3            1         0         0         0         0         0         0\n4            1         0         0         0         0         0         0\n5            1         1         0         0         0         0         0\n6            1         1         0         0         0         0         0\n7            1         1         0         0         0         0         0\n8            1         1         0         0         0         0         0\n9            1         0         1         0         0         0         0\n10           1         0         1         0         0         0         0\n11           1         0         1         0         0         0         0\n12           1         0         1         0         0         0         0\n13           1         0         0         1         0         0         0\n14           1         0         0         1         0         0         0\n15           1         0         0         1         0         0         0\n16           1         0         0         1         0         0         0\n17           1         0         0         0         1         0         0\n18           1         0         0         0         1         0         0\n19           1         0         0         0         1         0         0\n20           1         0         0         0         1         0         0\n21           1         0         0         0         0         1         0\n22           1         0         0         0         0         1         0\n23           1         0         0         0         0         1         0\n24           1         0         0         0         0         1         0\n25           1         0         0         0         0         0         1\n26           1         0         0         0         0         0         1\n27           1         0         0         0         0         0         1\n28           1         0         0         0         0         0         1\n   fefam2 fefam3 fefam4 Rscore fefam2:Rscore fefam3:Rscore fefam4:Rscore\n1       0      0      0     -3             0             0             0\n2       1      0      0     -3            -3             0             0\n3       0      1      0     -3             0            -3             0\n4       0      0      1     -3             0             0            -3\n5       0      0      0     -2             0             0             0\n6       1      0      0     -2            -2             0             0\n7       0      1      0     -2             0            -2             0\n8       0      0      1     -2             0             0            -2\n9       0      0      0     -1             0             0             0\n10      1      0      0     -1            -1             0             0\n11      0      1      0     -1             0            -1             0\n12      0      0      1     -1             0             0            -1\n13      0      0      0      0             0             0             0\n14      1      0      0      0             0             0             0\n15      0      1      0      0             0             0             0\n16      0      0      1      0             0             0             0\n17      0      0      0      1             0             0             0\n18      1      0      0      1             1             0             0\n19      0      1      0      1             0             1             0\n20      0      0      1      1             0             0             1\n21      0      0      0      2             0             0             0\n22      1      0      0      2             2             0             0\n23      0      1      0      2             0             2             0\n24      0      0      1      2             0             0             2\n25      0      0      0      3             0             0             0\n26      1      0      0      3             3             0             0\n27      0      1      0      3             0             3             0\n28      0      0      1      3             0             0             3"
  },
  {
    "objectID": "3-Chapter_2.html#行列効果モデルrc",
    "href": "3-Chapter_2.html#行列効果モデルrc",
    "title": "2  第2章",
    "section": "2.5 行・列効果モデル（\\(R+C\\)）",
    "text": "2.5 行・列効果モデル（\\(R+C\\)）\n普通に推定しても収束しない．\n\n# コントラスト\noptions(contrasts = c(factor = \"contr.treatment\",\n                      ordered = \"contr.treatment\"))\n\n# 5. R+C: Row and Column Effect Model\n# 収束しない\nRplusCno &lt;- freq_tab_2.3A |&gt; \n  gnm(Freq ~ polviews + fefam + Cscore:polviews + Rscore:fefam,\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nWarning: glm.fit: algorithm did not converge\n\n\n係数を確認する．この場合，制約は3つ必要であるが2つしかNAとなっていない．テキストや表2.5Dを参照し，どのような制約を課すのかをきめる．ここでは表2.5Dのような制約を課す．\n\nRplusCno\n\n\nCall:\ngnm(formula = Freq ~ polviews + fefam + Cscore:polviews + Rscore:fefam, \n    family = poisson, data = freq_tab_2.3A, tolerance = 1e-12)\n\nCoefficients:\n     (Intercept)         polviews2         polviews3         polviews4  \n      -4.898e+13         8.575e+12         1.715e+13         2.572e+13  \n       polviews5         polviews6         polviews7            fefam2  \n       3.430e+13         4.287e+13         5.145e+13         1.550e+13  \n          fefam3            fefam4  polviews1:Cscore  polviews2:Cscore  \n       3.101e+13         4.651e+13         1.646e+12        -4.070e+12  \npolviews3:Cscore  polviews4:Cscore  polviews5:Cscore  polviews6:Cscore  \n      -9.787e+12        -1.550e+13        -2.122e+13        -2.694e+13  \npolviews7:Cscore     fefam1:Rscore     fefam2:Rscore     fefam3:Rscore  \n      -3.265e+13        -1.715e+13        -1.143e+13        -5.717e+12  \n   fefam4:Rscore  \n              NA  \n\nDeviance:            8.485116 \nPearson chi-squared: 8.477813 \nResidual df:         8 \n\npickCoef(RplusCno, \":Cscore\")  # 行効果\n\npolviews1:Cscore polviews2:Cscore polviews3:Cscore polviews4:Cscore \n              11               12               13               14 \npolviews5:Cscore polviews6:Cscore polviews7:Cscore \n              15               16               17 \n\npickCoef(RplusCno, \":Rscore\")  # 列効果\n\nfefam1:Rscore fefam2:Rscore fefam3:Rscore fefam4:Rscore \n           18            19            20            21 \n\n\nあるいは次のように一覧にしてもよい．\n\n# 変数と係数と係数の順番を表示\ndata.frame(var = names(RplusCno$coefficients),\n           estimate = RplusCno$coefficients) |&gt; \n  mutate(estimate = estimate,\n         number = row_number())\n\n                              var      estimate number\n(Intercept)           (Intercept) -4.898036e+13      1\npolviews2               polviews2  8.574948e+12      2\npolviews3               polviews3  1.714990e+13      3\npolviews4               polviews4  2.572484e+13      4\npolviews5               polviews5  3.429979e+13      5\npolviews6               polviews6  4.287474e+13      6\npolviews7               polviews7  5.144969e+13      7\nfefam2                     fefam2  1.550368e+13      8\nfefam3                     fefam3  3.100736e+13      9\nfefam4                     fefam4  4.651103e+13     10\npolviews1:Cscore polviews1:Cscore  1.646217e+12     11\npolviews2:Cscore polviews2:Cscore -4.070415e+12     12\npolviews3:Cscore polviews3:Cscore -9.787047e+12     13\npolviews4:Cscore polviews4:Cscore -1.550368e+13     14\npolviews5:Cscore polviews5:Cscore -2.122031e+13     15\npolviews6:Cscore polviews6:Cscore -2.693694e+13     16\npolviews7:Cscore polviews7:Cscore -3.265357e+13     17\nfefam1:Rscore       fefam1:Rscore -1.714990e+13     18\nfefam2:Rscore       fefam2:Rscore -1.143326e+13     19\nfefam3:Rscore       fefam3:Rscore -5.716632e+12     20\nfefam4:Rscore       fefam4:Rscore            NA     21\n\n\n制約を課すのは11番目，17番目，18番目の係数であり，これらを0にする．対象となる係数はconstrain = c(11,17,18)で指定し，制約はconstrainTo = c(0, 0, 0)とする．あとは同じである．\n\n# polviews1:Cscore(11) = polviews7:Cscore(17) = fefam1:Rscore(18) = 0\nRplusC &lt;- freq_tab_2.3A |&gt; \n  gnm(Freq ~ polviews + fefam + Cscore:polviews + Rscore:fefam,\n      constrain = c(11, 17, 18), \n      constrainTo = c(0, 0, 0),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n# 結果\nsummary(RplusC)\n\n\nCall:\ngnm(formula = Freq ~ polviews + fefam + Cscore:polviews + Rscore:fefam, \n    constrain = c(11, 17, 18), constrainTo = c(0, 0, 0), family = poisson, \n    data = freq_tab_2.3A, tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.07536  -0.33353   0.01859   0.37548   1.05912  \n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       3.69896    0.14301  25.866  &lt; 2e-16 ***\npolviews2         1.06075    0.12467   8.509  &lt; 2e-16 ***\npolviews3         0.76041    0.13412   5.670 1.43e-08 ***\npolviews4         1.61203    0.15170  10.626  &lt; 2e-16 ***\npolviews5         0.37332    0.18884   1.977 0.048049 *  \npolviews6         0.02433    0.22727   0.107 0.914750    \npolviews7        -2.01888    0.30512  -6.617 3.67e-11 ***\nfefam2            1.00654    0.09822  10.248  &lt; 2e-16 ***\nfefam3            0.65193    0.17688   3.686 0.000228 ***\nfefam4           -0.40872    0.26352  -1.551 0.120895    \npolviews1:Cscore  0.00000         NA      NA       NA    \npolviews2:Cscore -0.08578    0.11437  -0.750 0.453211    \npolviews3:Cscore -0.15923    0.10585  -1.504 0.132498    \npolviews4:Cscore -0.12164    0.09246  -1.316 0.188309    \npolviews5:Cscore -0.22243    0.10510  -2.116 0.034309 *  \npolviews6:Cscore -0.09452    0.11454  -0.825 0.409232    \npolviews7:Cscore  0.00000         NA      NA       NA    \nfefam1:Rscore     0.00000         NA      NA       NA    \nfefam2:Rscore     0.27936    0.04372   6.389 1.67e-10 ***\nfefam3:Rscore     0.48417    0.06239   7.761  &lt; 2e-16 ***\nfefam4:Rscore     0.58586    0.08655   6.769 1.30e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 7.6783 on 10 degrees of freedom\nAIC: 215.03\n\nNumber of iterations: 4\n\n# モデル適合度\nmodel.summary(RplusC)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 RplusC                 10  7.68 -73.8  1.77 0.660\n\n\n11番目，18番目，21番目の係数を0にして推定する．\n\n# polviews1:Cscore(11) = polviews7:Cscore(17) = fefam1:Rscore(18) = 0\nRplusC_2 &lt;- freq_tab_2.3A |&gt; \n  gnm(Freq ~ polviews + fefam + Cscore:polviews + Rscore:fefam,\n      constrain = c(11, 18, 21), \n      constrainTo = c(0, 0, 0),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n# 結果\nsummary(RplusC_2)\n\n\nCall:\ngnm(formula = Freq ~ polviews + fefam + Cscore:polviews + Rscore:fefam, \n    constrain = c(11, 18, 21), constrainTo = c(0, 0, 0), family = poisson, \n    data = freq_tab_2.3A, tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.07536  -0.33353   0.01859   0.37548   1.05912  \n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       3.69896    0.14301  25.866  &lt; 2e-16 ***\npolviews2         1.35368    0.13397  10.104  &lt; 2e-16 ***\npolviews3         1.34627    0.13954   9.648  &lt; 2e-16 ***\npolviews4         2.49082    0.14246  17.485  &lt; 2e-16 ***\npolviews5         1.54505    0.15938   9.694  &lt; 2e-16 ***\npolviews6         1.48899    0.17487   8.515  &lt; 2e-16 ***\npolviews7        -0.26129    0.21592  -1.210 0.226224    \nfefam2            0.42068    0.12573   3.346 0.000820 ***\nfefam3           -0.51980    0.23987  -2.167 0.030233 *  \nfefam4           -2.16632    0.36822  -5.883 4.03e-09 ***\npolviews1:Cscore  0.00000         NA      NA       NA    \npolviews2:Cscore  0.10951    0.12956   0.845 0.397978    \npolviews3:Cscore  0.23134    0.13130   1.762 0.078073 .  \npolviews4:Cscore  0.46422    0.12511   3.711 0.000207 ***\npolviews5:Cscore  0.55872    0.13347   4.186 2.84e-05 ***\npolviews6:Cscore  0.88192    0.13507   6.529 6.61e-11 ***\npolviews7:Cscore  1.17173    0.17310   6.769 1.30e-11 ***\nfefam1:Rscore     0.00000         NA      NA       NA    \nfefam2:Rscore     0.08407    0.03224   2.607 0.009124 ** \nfefam3:Rscore     0.09360    0.03861   2.424 0.015346 *  \nfefam4:Rscore     0.00000         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 7.6783 on 10 degrees of freedom\nAIC: 215.03\n\nNumber of iterations: 4\n\n# モデル適合度\nmodel.summary(RplusC_2)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 RplusC_2               10  7.68 -73.8  1.77 0.660\n\n\nRscore:Cscoreを含めて推定すれば，制約は自動的に課されており（polviewsの1番目と7番目，fefamの1 番目と4番目），特に指定する必要はない．\n\n# 5. R+C: Row and Column Effect Model (Alternative)\nRplusCalt &lt;- freq_tab_2.3A |&gt; \n  gnm(Freq ~ polviews + fefam + Rscore:Cscore + Cscore:polviews + Rscore:fefam,\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n# 結果\nsummary(RplusCalt)\n\n\nCall:\n\ngnm(formula = Freq ~ polviews + fefam + Rscore:Cscore + Cscore:polviews + \n    Rscore:fefam, family = poisson, data = freq_tab_2.3A, tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.07536  -0.33353   0.01859   0.37548   1.05912  \n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       2.82017    0.13999  20.145  &lt; 2e-16 ***\npolviews2         1.35368    0.13397  10.104  &lt; 2e-16 ***\npolviews3         1.34627    0.13954   9.648  &lt; 2e-16 ***\npolviews4         2.49082    0.14246  17.485  &lt; 2e-16 ***\npolviews5         1.54505    0.15938   9.694  &lt; 2e-16 ***\npolviews6         1.48899    0.17487   8.515  &lt; 2e-16 ***\npolviews7        -0.26129    0.21592  -1.210 0.226224    \nfefam2            1.00654    0.09822  10.248  &lt; 2e-16 ***\nfefam3            0.65193    0.17688   3.686 0.000228 ***\nfefam4           -0.40872    0.26352  -1.551 0.120895    \nRscore:Cscore     0.19529    0.02885   6.769  1.3e-11 ***\npolviews2:Cscore -0.08578    0.11437  -0.750 0.453211    \npolviews3:Cscore -0.15923    0.10585  -1.504 0.132498    \npolviews4:Cscore -0.12164    0.09246  -1.316 0.188309    \npolviews5:Cscore -0.22243    0.10510  -2.116 0.034309 *  \npolviews6:Cscore -0.09452    0.11454  -0.825 0.409232    \npolviews7:Cscore  0.00000         NA      NA       NA    \nfefam2:Rscore     0.08407    0.03224   2.607 0.009124 ** \nfefam3:Rscore     0.09360    0.03861   2.424 0.015346 *  \nfefam4:Rscore     0.00000         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 7.6783 on 10 degrees of freedom\nAIC: 215.03\n\nNumber of iterations: 5\n\n# モデル適合度\nmodel.summary(RplusCalt)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 RplusCalt              10  7.68 -73.8  1.77 0.660"
  },
  {
    "objectID": "3-Chapter_2.html#行列効果モデルrc1",
    "href": "3-Chapter_2.html#行列効果モデルrc1",
    "title": "2  第2章",
    "section": "2.6 行・列効果モデル（\\(RC(1)\\)）",
    "text": "2.6 行・列効果モデル（\\(RC(1)\\)）\nRC(1)についてはMult(1,polviews,fefam)を含んだモデルで推定する．結果をみると係数は表示されているものの，標準誤差はNAとなっている．\n\n# 6. RC: RC(1) model\nRC.un &lt;- freq_tab_2.3A |&gt;\n  gnm(Freq ~ polviews + fefam + Mult(1,polviews,fefam),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations........................\nDone\n\n# 結果\nsummary(RC.un)\n\n\nCall:\ngnm(formula = Freq ~ polviews + fefam + Mult(1, polviews, fefam), \n    family = poisson, data = freq_tab_2.3A, tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.07428  -0.27239   0.03038   0.36792   1.03721  \n\nCoefficients:\n                            Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)                  2.88344         NA      NA       NA\npolviews2                    1.39062         NA      NA       NA\npolviews3                    1.42733         NA      NA       NA\npolviews4                    2.58695         NA      NA       NA\npolviews5                    1.68640         NA      NA       NA\npolviews6                    1.62657         NA      NA       NA\npolviews7                   -0.11330         NA      NA       NA\nfefam2                       0.90571         NA      NA       NA\nfefam3                       0.44364         NA      NA       NA\nfefam4                      -0.73195         NA      NA       NA\nMult(., polviews, fefam).    1.24386         NA      NA       NA\nMult(1, ., fefam).polviews1  1.28214         NA      NA       NA\nMult(1, ., fefam).polviews2  0.99757         NA      NA       NA\nMult(1, ., fefam).polviews3  0.61753         NA      NA       NA\nMult(1, ., fefam).polviews4  0.03118         NA      NA       NA\nMult(1, ., fefam).polviews5 -0.22099         NA      NA       NA\nMult(1, ., fefam).polviews6 -1.04564         NA      NA       NA\nMult(1, ., fefam).polviews7 -1.75055         NA      NA       NA\nMult(1, polviews, .).fefam1  0.49658         NA      NA       NA\nMult(1, polviews, .).fefam2  0.06565         NA      NA       NA\nMult(1, polviews, .).fefam3 -0.27025         NA      NA       NA\nMult(1, polviews, .).fefam4 -0.42959         NA      NA       NA\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 8.0718 on 10 degrees of freedom\nAIC: 215.43\n\nNumber of iterations: 24\n\n# モデル適合度\nmodel.summary(RC.un)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 RC.un                  10  8.07 -73.4  1.77 0.622\n\n\nまずは「重みづけのないまたは単位標準化した解」を求める．scaleWeights = \"unit\"とする．RC.unから.polviewsのある変数をpickCoef(RC.un, \"[.]polviews\")によって取り出す．\n\n# mu[i], i = 1 to 7\nmu &lt;- getContrasts(RC.un, pickCoef(RC.un,\n                                   \"[.]polviews\"),\n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\n\n# 値の方向を揃える\nif (mu$qvframe[1,1] &gt; 0 ) {\n  mu$qvframe[,1] &lt;- -1 * mu$qvframe[,1]\n}\n\n# 合計が0，2乗和が1となっていること確認する．\nlist(\"和\" = sum(mu$qvframe[,1]), \n     \"2乗和\" = sum(mu$qvframe[,1]^2))\n\n$和\n[1] -1.110223e-16\n\n$`2乗和`\n[1] 1\n\n# nu[j], j = 1 to 4\nnu &lt;- getContrasts(RC.un, pickCoef(RC.un, \"[.]fefam\"), \n                   ref = \"mean\",\n                   scaleRef = \"mean\",\n                   scaleWeights = \"unit\")\n\n# 値の方向を揃える\nif (nu$qvframe[1,1] &gt; 0 ) {\n  nu$qvframe[,1] &lt;- -1 * nu$qvframe[,1]\n}\n\n\n# 合計が0，2乗和が1となっていること確認する．\nlist(\"和\" = sum(nu$qvframe[,1]), \n     \"2乗和\" = sum(nu$qvframe[,1]^2))\n\n$和\n[1] 1.110223e-16\n\n$`2乗和`\n[1] 1\n\n# muの1番目と7番目，nuの1番目と4番目の値を取り出し保存する．\ncon &lt;- c(mu$qvframe[,1][c(1,7)],\n         nu$qvframe[,1][c(1,4)])\n\n\n#保存した値で制約を課した上で，再推定する．\nset.seed(1234)\nRC &lt;- freq_tab_2.3A |&gt; \n  gnm(Freq ~ polviews + fefam + Mult(1,polviews,fefam), \n      constrain = c(12,18,19,22),\n      constrainTo = con, \n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.................................\nDone\n\n\nDeviance is not finite 警告メッセージ: Algorithm failed - no model could be estimatedと表示されたらもう一度推定する．set.seedの値をいくつか変えて実行するのがよい．\n表2.5Eの値と一致しているのかを確認する．\n\n# 結果\nsummary(RC)\n\n\nCall:\ngnm(formula = Freq ~ polviews + fefam + Mult(1, polviews, fefam), \n    constrain = c(12, 18, 19, 22), constrainTo = con, family = poisson, \n    data = freq_tab_2.3A, tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.07428  -0.27239   0.03038   0.36792   1.03721  \n\nCoefficients:\n                            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)                  2.82020    0.14578  19.346  &lt; 2e-16 ***\npolviews2                    1.40280    0.12442  11.275  &lt; 2e-16 ***\npolviews3                    1.45577    0.12746  11.421  &lt; 2e-16 ***\npolviews4                    2.64048    0.13143  20.090  &lt; 2e-16 ***\npolviews5                    1.75073    0.14175  12.351  &lt; 2e-16 ***\npolviews6                    1.72618    0.16727  10.320  &lt; 2e-16 ***\npolviews7                    0.01648    0.21938   0.075 0.940107    \nfefam2                       0.91251    0.12222   7.466 8.25e-14 ***\nfefam3                       0.45574    0.20388   2.235 0.025396 *  \nfefam4                      -0.71735    0.24913  -2.879 0.003985 ** \nMult(., polviews, fefam).    2.37331    0.34813   6.817 9.27e-12 ***\nMult(1, ., fefam).polviews1 -0.48165         NA      NA       NA    \nMult(1, ., fefam).polviews2 -0.37580    0.10049  -3.740 0.000184 ***\nMult(1, ., fefam).polviews3 -0.23443    0.09461  -2.478 0.013216 *  \nMult(1, ., fefam).polviews4 -0.01632    0.08366  -0.195 0.845376    \nMult(1, ., fefam).polviews5  0.07749    0.09263   0.837 0.402872    \nMult(1, ., fefam).polviews6  0.38425    0.10926   3.517 0.000437 ***\nMult(1, ., fefam).polviews7  0.64646         NA      NA       NA    \nMult(1, polviews, .).fefam1 -0.74812         NA      NA       NA    \nMult(1, polviews, .).fefam2 -0.14098    0.07469  -1.888 0.059090 .  \nMult(1, polviews, .).fefam3  0.33229    0.09162   3.627 0.000287 ***\nMult(1, polviews, .).fefam4  0.55680         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 8.0718 on 10 degrees of freedom\nAIC: 215.43\n\nNumber of iterations: 33\n\n\n先ほどの単位標準化した解と推定の結果が一致しているのかを確認する．\n\n# 指定したmuとnuの値と結果が一致しているかを確認\nlist(mu = mu, nu = nu)\n\n$mu\n                               Estimate Std. Error\nMult(1, ., fefam).polviews1 -0.48165420 0.06776575\nMult(1, ., fefam).polviews2 -0.37579722 0.05016783\nMult(1, ., fefam).polviews3 -0.23443020 0.04842778\nMult(1, ., fefam).polviews4 -0.01631519 0.03689088\nMult(1, ., fefam).polviews5  0.07748893 0.04931050\nMult(1, ., fefam).polviews6  0.38424697 0.06009815\nMult(1, ., fefam).polviews7  0.64646091 0.06145462\n\n$nu\n                              Estimate Std. Error\nMult(1, polviews, .).fefam1 -0.7481178 0.02662158\nMult(1, polviews, .).fefam2 -0.1409760 0.04671343\nMult(1, polviews, .).fefam3  0.3322937 0.05164241\nMult(1, polviews, .).fefam4  0.5568002 0.04821776\n\n\n和が0，2乗和が1となっていることを確認\n\nsum(mu$qvframe[,1])\n\n[1] -1.110223e-16\n\nsum(mu$qvframe[,1]^2)\n\n[1] 1\n\nsum(nu$qvframe[,1])\n\n[1] 1.110223e-16\n\nsum(nu$qvframe[,1]^2)\n\n[1] 1\n\n\n適合度は変化していない．\n\n# モデル適合度\nmodel.summary(RC.un)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 RC.un                  10  8.07 -73.4  1.77 0.622\n\nmodel.summary(RC)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 RC                     10  8.07 -73.4  1.77 0.622"
  },
  {
    "objectID": "3-Chapter_2.html#周辺重みづけ",
    "href": "3-Chapter_2.html#周辺重みづけ",
    "title": "2  第2章",
    "section": "2.7 周辺重みづけ",
    "text": "2.7 周辺重みづけ\n\n# 行の周辺確率\nrp &lt;- prop.table(apply(tab_2.3A, 1, sum, na.rm = TRUE))\nrp\n\n     Strongly liberal               Liberal      Slightly liberal \n           0.03227682            0.12387322            0.12300087 \n             Moderate Slightly conservative          Conservative \n           0.38092469            0.15498691            0.15469613 \nStrongly conservative \n           0.03024135 \n\nsum(rp)\n\n[1] 1\n\n# 列の周辺確率\ncp &lt;- prop.table(apply(tab_2.3A, 2, sum, na.rm = TRUE))\ncp\n\nStrongly Disagree          Disagree             Agree    Strongly agree \n       0.19220704        0.43617331        0.28118639        0.09043327 \n\nsum(cp)\n\n[1] 1\n\n# mu[i], i = 1 to 7\nmu &lt;- getContrasts(RC.un, pickCoef(RC.un,\n                                   \"[.]polviews\"),\n                   ref = rp,\n                   scaleRef = rp, \n                   scaleWeights = rp)\n\n# 値の方向を揃える\nif (mu$qvframe[1,1] &gt; 0 ) {\n  mu$qvframe[,1] &lt;- -1 * mu$qvframe[,1]\n}\n\n# nu[j], j = 1 to 4\nnu &lt;- getContrasts(RC.un, pickCoef(RC.un, \"[.]fefam\"), \n                   ref = cp,\n                   scaleRef = cp,\n                   scaleWeights = cp)\n\n# 値の方向を揃える\nif (nu$qvframe[1,1] &gt; 0 ) {\n  nu$qvframe[,1] &lt;- -1 * nu$qvframe[,1]\n}\n\n# muの1番目と7番目，nuの1番目と4番目の値を取り出し保存する．\ncon &lt;- c(mu$qvframe[,1][c(1,7)],\n         nu$qvframe[,1][c(1,4)])\n\n\n#保存した値で制約を課した上で，再推定する．\nset.seed(1234)\nRC_mw &lt;- freq_tab_2.3A |&gt; \n  gnm(Freq ~ polviews + fefam + Mult(1,polviews,fefam), \n      constrain = c(12,18,19,22),\n      constrainTo = con, \n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...................................\nDone\n\n\n\n# 結果\nsummary(RC_mw)\n\n\nCall:\ngnm(formula = Freq ~ polviews + fefam + Mult(1, polviews, fefam), \n    constrain = c(12, 18, 19, 22), constrainTo = con, family = poisson, \n    data = freq_tab_2.3A, tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.07428  -0.27239   0.03038   0.36792   1.03721  \n\nCoefficients:\n                            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)                  2.90051    0.14144  20.507  &lt; 2e-16 ***\npolviews2                    1.38735    0.11722  11.835  &lt; 2e-16 ***\npolviews3                    1.41969    0.12024  11.807  &lt; 2e-16 ***\npolviews4                    2.57257    0.12376  20.787  &lt; 2e-16 ***\npolviews5                    1.66913    0.13414  12.443  &lt; 2e-16 ***\npolviews6                    1.59981    0.16013   9.991  &lt; 2e-16 ***\npolviews7                   -0.14816    0.21832  -0.679 0.497376    \nfefam2                       0.90365    0.12173   7.423 1.14e-13 ***\nfefam3                       0.43998    0.20350   2.162 0.030615 *  \nfefam4                      -0.73638    0.24896  -2.958 0.003098 ** \nMult(., polviews, fefam).    0.25673    0.03766   6.817 9.27e-12 ***\nMult(1, ., fefam).polviews1 -1.82062         NA      NA       NA    \nMult(1, ., fefam).polviews2 -1.41532    0.38476  -3.678 0.000235 ***\nMult(1, ., fefam).polviews3 -0.87405    0.36224  -2.413 0.015825 *  \nMult(1, ., fefam).polviews4 -0.03893    0.32031  -0.122 0.903253    \nMult(1, ., fefam).polviews5  0.32022    0.35468   0.903 0.366604    \nMult(1, ., fefam).polviews6  1.49474    0.41835   3.573 0.000353 ***\nMult(1, ., fefam).polviews7  2.49870         NA      NA       NA    \nMult(1, polviews, .).fefam1 -1.65778         NA      NA       NA    \nMult(1, polviews, .).fefam2 -0.19190    0.18033  -1.064 0.287244    \nMult(1, polviews, .).fefam3  0.95076    0.22120   4.298 1.72e-05 ***\nMult(1, polviews, .).fefam4  1.49281         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 8.0718 on 10 degrees of freedom\nAIC: 215.43\n\nNumber of iterations: 35\n\n\n内的連関パラメータ\\(\\phi\\)が0.25673となっている．場合によっては符号が逆となる．\n適合度は変化していない．\n\n# モデル適合度\nmodel.summary(RC.un)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 RC.un                  10  8.07 -73.4  1.77 0.622\n\nmodel.summary(RC)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 RC                     10  8.07 -73.4  1.77 0.622\n\nmodel.summary(RC_mw)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 RC_mw                  10  8.07 -73.4  1.77 0.622"
  },
  {
    "objectID": "3-Chapter_2.html#表2.4a",
    "href": "3-Chapter_2.html#表2.4a",
    "title": "2  第2章",
    "section": "2.8 表2.4A",
    "text": "2.8 表2.4A\n表2.4Aを再現する．\n\nmodels &lt;- list()\nmodels[[1]] &lt;- model.summary(O)\nmodels[[2]] &lt;- model.summary(U)\nmodels[[3]] &lt;- model.summary(R)\nmodels[[4]] &lt;- model.summary(C)\nmodels[[5]] &lt;- model.summary(RplusC)\nmodels[[6]] &lt;- model.summary(RC)\nmodels |&gt; bind_rows() |&gt; kable(digit = 3)\n\n\n\n\nModel Description\ndf\nL2\nBIC\nDelta\np\n\n\n\n\nO\n18\n211.695\n65.122\n8.092\n0.000\n\n\nU\n17\n20.125\n-118.305\n2.766\n0.268\n\n\nR\n12\n15.906\n-81.809\n2.466\n0.196\n\n\nC\n15\n14.237\n-107.907\n2.321\n0.508\n\n\nRplusC\n10\n7.678\n-73.751\n1.772\n0.660\n\n\nRC\n10\n8.072\n-73.358\n1.767\n0.622"
  },
  {
    "objectID": "3-Chapter_2.html#表2.4b",
    "href": "3-Chapter_2.html#表2.4b",
    "title": "2  第2章",
    "section": "2.9 表2.4B",
    "text": "2.9 表2.4B\nモデルの比較のための関数を作成する．引数は2つであり，1つめのモデルと2つめのモデルの比較を行う．2つめが指定されていなければ比較ではなくそのモデルの適合度を示す．\n\nmodel_comparison &lt;- function(x, y = 0) {\n  models |&gt; \n    bind_rows() |&gt;\n    dplyr::summarise(`Model Used` = \n                ifelse(y == 0,\n                       paste0(x),\n                       paste0(x,\"-\",y)),\n              df = ifelse(y == 0, \n                          df[x], \n                          df[x] - df[y]),\n              L2 = ifelse(y == 0, \n                          L2[x], \n                          L2[x] - L2[y]))\n}\n\n表2.4Bは次のように再現できる．\n\n# Table 2.4 Panel B\nbind_rows(model_comparison(1,2),\n          model_comparison(2,6),\n          model_comparison(6),\n          model_comparison(1)) |&gt; kable(digit = 3)\n\n\n\n\nModel Used\ndf\nL2\n\n\n\n\n1-2\n1\n191.571\n\n\n2-6\n7\n12.053\n\n\n6\n10\n8.072\n\n\n1\n18\n211.695\n\n\n\n\n\n表2.4Cも再現できる．\n\n# Table 2.4 Panel C\nbind_rows(model_comparison(2,4),\n          model_comparison(4,6),\n          model_comparison(2,6)) |&gt; kable(digit = 3)\n\n\n\n\nModel Used\ndf\nL2\n\n\n\n\n2-4\n2\n5.887\n\n\n4-6\n5\n6.165\n\n\n2-6\n7\n12.053"
  },
  {
    "objectID": "3-Chapter_2.html#表2.5a",
    "href": "3-Chapter_2.html#表2.5a",
    "title": "2  第2章",
    "section": "2.10 表2.5A",
    "text": "2.10 表2.5A\n係数を取り出して表2.5Aを再現する．\n\nsummary(U)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\"Rscore:Cscore\", Variable))\n\n       Variable  Estimate Std..Error  z.value     Pr...z..\n1 Rscore:Cscore 0.2021125 0.01519706 13.29945 2.331718e-40"
  },
  {
    "objectID": "3-Chapter_2.html#表2.5b",
    "href": "3-Chapter_2.html#表2.5b",
    "title": "2  第2章",
    "section": "2.11 表2.5B",
    "text": "2.11 表2.5B\n省略された係数について，標準誤差を求める方法は次の通り．\n\n# Table 2.5 Panel B \nsummary(R)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\":Cscore\", Variable))\n\n          Variable     Estimate Std..Error    z.value     Pr...z..\n1 polviews1:Cscore -0.558726563 0.10766840 -5.1893275 2.110549e-07\n2 polviews2:Cscore -0.405075736 0.05914888 -6.8484091 7.467575e-12\n3 polviews3:Cscore -0.248458921 0.05774110 -4.3029822 1.685144e-05\n4 polviews4:Cscore  0.008763861 0.03970853  0.2207048 8.253223e-01\n5 polviews5:Cscore  0.112245001 0.05128383  2.1887016 2.861853e-02\n6 polviews6:Cscore  0.419078627 0.05143368  8.1479420 3.701697e-16\n\n# polviews7:Cscoreを求める\nmycontrast &lt;- numeric(length(coef(R)))\nterms &lt;- pickCoef(R,\"[:]Cscore\")\nmycontrast[terms] &lt;- rep(-1,6)\nmycontrast &lt;- cbind(mycontrast)\ncolnames(mycontrast) &lt;- \"polviews7:Cscore\"\ngnm::se(R, mycontrast)\n\n                  Estimate Std. Error\npolviews7:Cscore 0.6721737  0.1003211"
  },
  {
    "objectID": "3-Chapter_2.html#表2.5b他の正規化",
    "href": "3-Chapter_2.html#表2.5b他の正規化",
    "title": "2  第2章",
    "section": "2.12 表2.5B（他の正規化）",
    "text": "2.12 表2.5B（他の正規化）\n\n# Table 2.5 Panel B Alternative\nsummary(Ralt)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\":Cscore\", Variable))\n\n          Variable  Estimate Std..Error  z.value     Pr...z..\n1 polviews2:Cscore 0.1536508  0.1361941 1.128176 2.592458e-01\n2 polviews3:Cscore 0.3102676  0.1356609 2.287082 2.219102e-02\n3 polviews4:Cscore 0.5674904  0.1267654 4.476699 7.580590e-06\n4 polviews5:Cscore 0.6709716  0.1326215 5.059297 4.208051e-07\n5 polviews6:Cscore 0.9778052  0.1331060 7.346062 2.041319e-13\n6 polviews7:Cscore 1.2309003  0.1678130 7.334954 2.217982e-13"
  },
  {
    "objectID": "3-Chapter_2.html#表2.5c",
    "href": "3-Chapter_2.html#表2.5c",
    "title": "2  第2章",
    "section": "2.13 表2.5C",
    "text": "2.13 表2.5C\n同様に列効果の最後のカテゴリの推定値と標準誤差を求める．\n\n# Table 2.5 Panel C\nsummary(C)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\":Rscore\", Variable))\n\n       Variable    Estimate Std..Error    z.value     Pr...z..\n1 fefam1:Rscore -0.32183233 0.02601065 -12.373099 3.654449e-35\n2 fefam2:Rscore -0.06518238 0.02012977  -3.238109 1.203247e-03\n3 fefam3:Rscore  0.13740293 0.02281996   6.021174 1.731567e-09\n\n# fefam4:Rscoreを求める\nmycontrast &lt;- numeric(length(coef(C)))\nterms &lt;- pickCoef(C,\"[:]Rscore\")\nmycontrast[terms] &lt;- rep(-1,3)\nmycontrast &lt;- cbind(mycontrast)\ncolnames(mycontrast) &lt;- \"fefam4:Rscore\"\ngnm::se(C, mycontrast)\n\n               Estimate Std. Error\nfefam4:Rscore 0.2496118 0.03429697"
  },
  {
    "objectID": "3-Chapter_2.html#表2.5c他の正規化",
    "href": "3-Chapter_2.html#表2.5c他の正規化",
    "title": "2  第2章",
    "section": "2.14 表2.5C（他の正規化）",
    "text": "2.14 表2.5C（他の正規化）\n1つ目のカテゴリの値を0とした正規化の場合は次のようになる．\n\n# Table 2.5 Panel C Alternative\nsummary(Calt)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\":Rscore\", Variable))\n\n       Variable  Estimate Std..Error   z.value     Pr...z..\n1 fefam2:Rscore 0.2566499 0.03458604  7.420624 1.165702e-13\n2 fefam3:Rscore 0.4592353 0.03850703 11.926012 8.662502e-33\n3 fefam4:Rscore 0.5714441 0.05297192 10.787680 3.935998e-27"
  },
  {
    "objectID": "3-Chapter_2.html#表2.5d",
    "href": "3-Chapter_2.html#表2.5d",
    "title": "2  第2章",
    "section": "2.15 表2.5D",
    "text": "2.15 表2.5D\n\n# Table 2.5 Panel D\nsummary(RplusC)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\"Rscore|Cscore\", Variable))\n\n           Variable    Estimate Std..Error    z.value     Pr...z..\n1  polviews1:Cscore  0.00000000         NA         NA           NA\n2  polviews2:Cscore -0.08578207 0.11436513 -0.7500719 4.532114e-01\n3  polviews3:Cscore -0.15923097 0.10584890 -1.5043233 1.324981e-01\n4  polviews4:Cscore -0.12164181 0.09246130 -1.3155970 1.883093e-01\n5  polviews5:Cscore -0.22242867 0.10509647 -2.1164238 3.430878e-02\n6  polviews6:Cscore -0.09452143 0.11453734 -0.8252455 4.092322e-01\n7  polviews7:Cscore  0.00000000         NA         NA           NA\n8     fefam1:Rscore  0.00000000         NA         NA           NA\n9     fefam2:Rscore  0.27935717 0.04372418  6.3890770 1.668900e-10\n10    fefam3:Rscore  0.48417258 0.06238681  7.7608170 8.438398e-15\n11    fefam4:Rscore  0.58586364 0.08654948  6.7691179 1.295700e-11"
  },
  {
    "objectID": "3-Chapter_2.html#表2.5d他の正規化",
    "href": "3-Chapter_2.html#表2.5d他の正規化",
    "title": "2  第2章",
    "section": "2.16 表2.5D（他の正規化）",
    "text": "2.16 表2.5D（他の正規化）\n\nsummary(RplusCalt)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\"Rscore|Cscore\", Variable))\n\n           Variable    Estimate Std..Error    z.value     Pr...z..\n1     Rscore:Cscore  0.19528788 0.02884983  6.7691178 1.295700e-11\n2  polviews2:Cscore -0.08578207 0.11436513 -0.7500719 4.532114e-01\n3  polviews3:Cscore -0.15923097 0.10584890 -1.5043233 1.324981e-01\n4  polviews4:Cscore -0.12164181 0.09246130 -1.3155970 1.883093e-01\n5  polviews5:Cscore -0.22242867 0.10509647 -2.1164238 3.430878e-02\n6  polviews6:Cscore -0.09452143 0.11453734 -0.8252455 4.092322e-01\n7  polviews7:Cscore  0.00000000         NA         NA           NA\n8     fefam2:Rscore  0.08406929 0.03224287  2.6073757 9.123919e-03\n9     fefam3:Rscore  0.09359682 0.03861067  2.4241178 1.534563e-02\n10    fefam4:Rscore  0.00000000         NA         NA           NA"
  },
  {
    "objectID": "3-Chapter_2.html#表2.5e",
    "href": "3-Chapter_2.html#表2.5e",
    "title": "2  第2章",
    "section": "2.17 表2.5E",
    "text": "2.17 表2.5E\n\nsummary(RC)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\"Mult\", Variable))\n\n                      Variable    Estimate Std..Error    z.value     Pr...z..\n1    Mult(., polviews, fefam).  2.37330693 0.34812532  6.8173924 9.270782e-12\n2  Mult(1, ., fefam).polviews1 -0.48165420         NA         NA           NA\n3  Mult(1, ., fefam).polviews2 -0.37579722 0.10049018 -3.7396411 1.842832e-04\n4  Mult(1, ., fefam).polviews3 -0.23443020 0.09460850 -2.4778980 1.321589e-02\n5  Mult(1, ., fefam).polviews4 -0.01631519 0.08365831 -0.1950217 8.453760e-01\n6  Mult(1, ., fefam).polviews5  0.07748893 0.09263438  0.8365030 4.028720e-01\n7  Mult(1, ., fefam).polviews6  0.38424697 0.10926427  3.5166753 4.369880e-04\n8  Mult(1, ., fefam).polviews7  0.64646091         NA         NA           NA\n9  Mult(1, polviews, .).fefam1 -0.74811781         NA         NA           NA\n10 Mult(1, polviews, .).fefam2 -0.14097601 0.07468829 -1.8875250 5.908974e-02\n11 Mult(1, polviews, .).fefam3  0.33229365 0.09161751  3.6269668 2.867702e-04\n12 Mult(1, polviews, .).fefam4  0.55680017         NA         NA           NA"
  },
  {
    "objectID": "3-Chapter_2.html#logmultパッケージの利用",
    "href": "3-Chapter_2.html#logmultパッケージの利用",
    "title": "2  第2章",
    "section": "2.18 logmultパッケージの利用",
    "text": "2.18 logmultパッケージの利用\nlogmultはgnmをベースとしてRCモデルを簡単に実行できる関数である．\nまずはlogmultパッケージのanoasで連関分析を行う．データはtableなのでtab_2.3Aを使用する．\nanoasは独立モデル，RC(1)，RC(2)，RC(3)，…と次元がmin(nrow(tab) - 1, ncol(tab) - 1)までのRCモデルを推定する．RC(1)の結果は表2.4Aと一致している．\n\nanoas(tab_2.3A)\n\nFitting independence model...\nFitting model with 1 dimension...\nInitialising\nRunning start-up iterations..\nRunning main iterations...................\nDone\nFitting model with 2 dimensions...\nInitialising\nRunning start-up iterations..\nRunning main iterations..........................\nDone\nFitting model with 3 dimensions...\nInitialising\nRunning start-up iterations..\nRunning main iterations...\nDone\n\n\n       Res. Df           Res. Dev     Dev./Indep. (%)   Dissim. (%)\nIndep.      18 211.69508974175693 100.000000000000000 8.09171028965\nRC(1)       10   8.07181892815000   3.812945750417107 1.76730792765\nRC(2)        4   1.36909098846095   0.646727796157711 0.49639212377\nRC(3)        0  -0.00000000000001  -0.000000000000005 0.00000000004\n                      BIC                AIC Dev. Df\nIndep.  65.12224155397615 175.69508974175693   NA NA\nRC(1)  -73.35754117617265 -11.92818107185000 -204 -8\nRC(2)  -31.20265305326811  -6.63090901153905   -7 -6\nRC(3)   -0.00000000000001  -0.00000000000001   -1 -4\n\n\n表2.5Eの推定値（RC(1)）はrcを用いて次のように再現できる．nd = 1で次元を1としている．標準誤差を求める上で，ブートストラップ法を用いている．結果には\\(\\gamma=\\delta=1/2\\)の場合の係数（Adjusted）が示されている．\n\nrc_fit &lt;- rc(tab_2.3A, \n             nd = 1, \n             se = \"bootstrap\", \n             weighting = \"none\",\n             nreplicates = 100, \n             ncpus = getOption(\"boot.ncpus\")\n             )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...........\nDone\nComputing bootstrap standard errors...\n\n\nLoading required namespace: parallel\n\n\n.\n\nsummary(rc_fit, weighting = \"none\")\n\nCall:\nrc(tab = tab_2.3A, nd = 1, weighting = \"none\", se = \"bootstrap\", \n    nreplicates = 100, ncpus = getOption(\"boot.ncpus\"))\n\nDeviance Residuals:\n    Min       1Q   Median       3Q      Max  \n-1.0743  -0.2724   0.0304   0.3679   1.0372  \n\nAssociation coefficients:\n                                    Normalized   Adjusted  Std. error\nDim1                                  2.373307         NA      0.2735\nDim1:polviewsStrongly liberal         0.481654   0.742014      0.0732\nDim1:polviewsLiberal                  0.375797   0.578936      0.0505\nDim1:polviewsSlightly liberal         0.234430   0.361152      0.0544\nDim1:polviewsModerate                 0.016315   0.025134      0.0326\nDim1:polviewsSlightly conservative   -0.077489  -0.119376      0.0492\nDim1:polviewsConservative            -0.384247  -0.591953      0.0596\nDim1:polviewsStrongly conservative   -0.646461  -0.995908      0.0621\nDim1:fefamStrongly Disagree           0.748118   1.152516      0.0252\nDim1:fefamDisagree                    0.140976   0.217181      0.0470\nDim1:fefamAgree                      -0.332294  -0.511916      0.0583\nDim1:fefamStrongly agree             -0.556800  -0.857781      0.0489\n                                     Pr(&gt;|z|)     \nDim1                                &lt; 2.2e-16  ***\nDim1:polviewsStrongly liberal       4.834e-11  ***\nDim1:polviewsLiberal                1.003e-13  ***\nDim1:polviewsSlightly liberal       1.609e-05  ***\nDim1:polviewsModerate                0.616651     \nDim1:polviewsSlightly conservative   0.114925     \nDim1:polviewsConservative           1.121e-10  ***\nDim1:polviewsStrongly conservative  &lt; 2.2e-16  ***\nDim1:fefamStrongly Disagree         &lt; 2.2e-16  ***\nDim1:fefamDisagree                   0.002683  ** \nDim1:fefamAgree                     1.214e-08  ***\nDim1:fefamStrongly agree            &lt; 2.2e-16  ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nNormalization weights: none\nDeviance:              8.071819\nPearson chi-squared:   8.168769\nDissimilarity index:   1.767308%\nResidual df:           10\nBIC:                   -73.35754\nAIC:                   -11.92818\n\n\n周辺重みづけを用いたい場合は`weighting = “marginal”とする．\n\nrc_fit_wm &lt;- rc(tab_2.3A, \n             nd = 1, \n             se = \"bootstrap\", \n             weighting = \"marginal\",\n             nreplicates = 100, \n             ncpus = getOption(\"boot.ncpus\")\n             )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.............\nDone\nComputing bootstrap standard errors...\n.\n\nsummary(rc_fit_wm)\n\nCall:\nrc(tab = tab_2.3A, nd = 1, weighting = \"marginal\", se = \"bootstrap\", \n    nreplicates = 100, ncpus = getOption(\"boot.ncpus\"))\n\nDeviance Residuals:\n    Min       1Q   Median       3Q      Max  \n-1.0743  -0.2724   0.0304   0.3679   1.0372  \n\nAssociation coefficients:\n                                    Normalized   Adjusted  Std. error\nDim1                                  0.256734         NA      0.0185\nDim1:polviewsStrongly liberal         1.820624   0.922490      0.3333\nDim1:polviewsLiberal                  1.415319   0.717126      0.1601\nDim1:polviewsSlightly liberal         0.874053   0.442873      0.1882\nDim1:polviewsModerate                 0.038935   0.019728      0.0944\nDim1:polviewsSlightly conservative   -0.320222  -0.162253      0.1777\nDim1:polviewsConservative            -1.494737  -0.757366      0.1303\nDim1:polviewsStrongly conservative   -2.498701  -1.266064      0.4518\nDim1:fefamStrongly Disagree           1.657784   0.839980      0.0847\nDim1:fefamDisagree                    0.191902   0.097234      0.0811\nDim1:fefamAgree                      -0.950760  -0.481739      0.0891\nDim1:fefamStrongly agree             -1.492808  -0.756389      0.1960\n                                     Pr(&gt;|z|)     \nDim1                                &lt; 2.2e-16  ***\nDim1:polviewsStrongly liberal       4.701e-08  ***\nDim1:polviewsLiberal                &lt; 2.2e-16  ***\nDim1:polviewsSlightly liberal       3.393e-06  ***\nDim1:polviewsModerate                 0.67992     \nDim1:polviewsSlightly conservative    0.07150  .  \nDim1:polviewsConservative           &lt; 2.2e-16  ***\nDim1:polviewsStrongly conservative  3.197e-08  ***\nDim1:fefamStrongly Disagree         &lt; 2.2e-16  ***\nDim1:fefamDisagree                    0.01798  *  \nDim1:fefamAgree                     &lt; 2.2e-16  ***\nDim1:fefamStrongly agree            2.616e-14  ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nNormalization weights: marginal\nDeviance:              8.071819\nPearson chi-squared:   8.168769\nDissimilarity index:   1.767308%\nResidual df:           10\nBIC:                   -73.35754\nAIC:                   -11.92818\n\n\nこれは先ほど求めた周辺重みづけの結果（内的連関パラメータが0.25673）と一致する．"
  },
  {
    "objectID": "3-Chapter_2.html#表2.3b",
    "href": "3-Chapter_2.html#表2.3b",
    "title": "2  第2章",
    "section": "2.19 表2.3B",
    "text": "2.19 表2.3B\n\n# コントラストを確認\noptions(\"contrasts\")\n\n$contrasts\n           factor           ordered \n\"contr.treatment\" \"contr.treatment\" \n\n# default\noptions(contrasts = c(factor = \"contr.treatment\",\n                      ordered = \"contr.poly\"))\n\nanoasを用いるときにはのエラーを無くすために行列はラベルを用いない．\n\nFreq &lt;- c(518,   95,  6,  35,  5,\n         　81,   67,  4,  49,  2,\n          452, 1003, 67, 630,  5,\n           71,  157, 37, 562, 12)\n\n# データを表形式に変換\ntab_2.3B &lt;- matrix(Freq, \n                   nrow = 4,\n                   ncol = 5,\n                   byrow = TRUE) |&gt; as.table()\ntab_2.3B\n\n     A    B    C    D    E\nA  518   95    6   35    5\nB   81   67    4   49    2\nC  452 1003   67  630    5\nD   71  157   37  562   12\n\n# 度数，行変数，列変数からなる集計データを作成\nEduc &lt;- gl(n = 4, k = 5)\nOcc &lt;- gl(n = 5, k = 1, length = 20)\nfreq_tab_2.3B &lt;- tibble(Freq, Educ, Occ)\nfreq_tab_2.3B\n\n# A tibble: 20 × 3\n    Freq Educ  Occ  \n   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;\n 1   518 1     1    \n 2    95 1     2    \n 3     6 1     3    \n 4    35 1     4    \n 5     5 1     5    \n 6    81 2     1    \n 7    67 2     2    \n 8     4 2     3    \n 9    49 2     4    \n10     2 2     5    \n11   452 3     1    \n12  1003 3     2    \n13    67 3     3    \n14   630 3     4    \n15     5 3     5    \n16    71 4     1    \n17   157 4     2    \n18    37 4     3    \n19   562 4     4    \n20    12 4     5    \n\n# 行変数と列変数の整数値を作成\nfreq_tab_2.3B &lt;- freq_tab_2.3B |&gt; \n  mutate(Rscore = as.numeric(Educ),\n         Cscore = as.numeric(Occ))\nfreq_tab_2.3B\n\n# A tibble: 20 × 5\n    Freq Educ  Occ   Rscore Cscore\n   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt;\n 1   518 1     1          1      1\n 2    95 1     2          1      2\n 3     6 1     3          1      3\n 4    35 1     4          1      4\n 5     5 1     5          1      5\n 6    81 2     1          2      1\n 7    67 2     2          2      2\n 8     4 2     3          2      3\n 9    49 2     4          2      4\n10     2 2     5          2      5\n11   452 3     1          3      1\n12  1003 3     2          3      2\n13    67 3     3          3      3\n14   630 3     4          3      4\n15     5 3     5          3      5\n16    71 4     1          4      1\n17   157 4     2          4      2\n18    37 4     3          4      3\n19   562 4     4          4      4\n20    12 4     5          4      5\n\n\n\nO &lt;- freq_tab_2.3B |&gt; \n  gnm(Freq ~ Educ + Occ, \n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nU &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Rscore:Cscore, \n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nR &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Rscore:Cscore + \n        Educ:Cscore, \n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Rscore:Cscore + \n        Occ:Rscore, \n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nRplusC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Rscore:Cscore + \n        Educ:Cscore + \n        Occ:Rscore,\n      constrain = c(12,16), \n      constrainTo = c(0,0),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Mult(1, Educ, Occ),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n.............................\nDone\n\nUplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ +\n        Rscore:Cscore + \n        Mult(1, Educ, Occ),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n.\nDone\n\nRplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Cscore:Educ + \n        Mult(1, Educ, Occ),\n      constrain = c(9,12),\n      constrainTo = c(0,0),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.......................................\nDone\n\nCplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Rscore:Occ + \n        Mult(1, Educ, Occ),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations......................................................\nDone\n\nRplusCplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Cscore:Educ + \n        Rscore:Occ + \n        Mult(1, Educ, Occ),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...........\nDone\n\nRC2 &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        instances(Mult(1, Educ, Occ),2),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.....................\nDone"
  },
  {
    "objectID": "3-Chapter_2.html#表2.6a",
    "href": "3-Chapter_2.html#表2.6a",
    "title": "2  第2章",
    "section": "2.20 表2.6A",
    "text": "2.20 表2.6A\n表2.6Aを再現する．\n\nmodels &lt;- list()\nmodels[[1]] &lt;- model.summary(O)\nmodels[[2]] &lt;- model.summary(U)\nmodels[[3]] &lt;- model.summary(R)\nmodels[[4]] &lt;- model.summary(C)\nmodels[[5]] &lt;- model.summary(RplusC)\nmodels[[6]] &lt;- model.summary(RC)\nmodels[[7]] &lt;- model.summary(UplusRC)\nmodels[[8]] &lt;- model.summary(RplusRC)\nmodels[[9]] &lt;- model.summary(CplusRC)\nmodels[[10]] &lt;- model.summary(RplusCplusRC)\nmodels[[11]] &lt;- model.summary(RC2)\nmodels |&gt; bind_rows()\n\n# A tibble: 11 × 6\n   `Model Description`    df       L2    BIC   Delta         p\n   &lt;chr&gt;               &lt;int&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;\n 1 O                      12 1373.    1274.  23.9    8.44e-287\n 2 U                      11  244.     153.   8.54   4.99e- 46\n 3 R                       9  206.     132.   7.38   1.85e- 39\n 4 C                       8  155.      89.3  7.47   1.48e- 29\n 5 RplusC                  6   91.6     42.1  4.63   1.40e- 17\n 6 RC                      6  125.      75.5  6.44   1.41e- 24\n 7 UplusRC                 5   17.6    -23.7  1.52   3.49e-  3\n 8 RplusRC                 4    6.94   -26.1  0.832  1.39e-  1\n 9 CplusRC                 3   11.4    -13.4  1.01   9.72e-  3\n10 RplusCplusRC            2    0.278  -16.2  0.0538 8.70e-  1\n11 RC2                     2    0.600  -15.9  0.0935 7.41e-  1"
  },
  {
    "objectID": "3-Chapter_2.html#表2.6b",
    "href": "3-Chapter_2.html#表2.6b",
    "title": "2  第2章",
    "section": "2.21 表2.6B",
    "text": "2.21 表2.6B\n\n# Table 2.4 Panel B\nbind_rows(model_comparison(1,6),\n          model_comparison(6,11),\n          model_comparison(11),\n          model_comparison(1))\n\n# A tibble: 4 × 3\n  `Model Used`    df       L2\n  &lt;chr&gt;        &lt;int&gt;    &lt;dbl&gt;\n1 1-6              6 1248.   \n2 6-11             4  124.   \n3 11               2    0.600\n4 1               12 1373."
  },
  {
    "objectID": "3-Chapter_2.html#表2.6c",
    "href": "3-Chapter_2.html#表2.6c",
    "title": "2  第2章",
    "section": "2.22 表2.6C",
    "text": "2.22 表2.6C\n\n# Table 2.4 Panel C\nbind_rows(model_comparison(1,2),\n          model_comparison(2,6),\n          model_comparison(6,10),\n          model_comparison(10),\n          model_comparison(1))\n\n# A tibble: 5 × 3\n  `Model Used`    df       L2\n  &lt;chr&gt;        &lt;int&gt;    &lt;dbl&gt;\n1 1-2              1 1129.   \n2 2-6              5  119.   \n3 6-10             4  125.   \n4 10               2    0.278\n5 1               12 1373."
  },
  {
    "objectID": "3-Chapter_2.html#表2.7a",
    "href": "3-Chapter_2.html#表2.7a",
    "title": "2  第2章",
    "section": "2.23 表2.7A",
    "text": "2.23 表2.7A\n\nset.seed(1234)\nUplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Rscore:Cscore + \n        Mult(1, Educ, Occ),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n..............\nDone\n\nsummary(UplusRC)\n\n\nCall:\ngnm(formula = Freq ~ Educ + Occ + Rscore:Cscore + Mult(1, Educ, \n    Occ), family = poisson, data = freq_tab_2.3B, tolerance = 1e-12)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.0893  -0.5631   0.1321   0.7372   1.9761  \n\nCoefficients:\n                       Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)             5.49123         NA      NA       NA    \nEduc2                  -2.07045         NA      NA       NA    \nEduc3                  -1.00877         NA      NA       NA    \nEduc4                  -3.55473         NA      NA       NA    \nOcc2                   -1.06909         NA      NA       NA    \nOcc3                   -5.17113         NA      NA       NA    \nOcc4                   -4.53939         NA      NA       NA    \nOcc5                  -10.91018         NA      NA       NA    \nRscore:Cscore           0.55212    0.03429    16.1   &lt;2e-16 ***\nMult(., Educ, Occ).     0.05379         NA      NA       NA    \nMult(1, ., Occ).Educ1  57.38879         NA      NA       NA    \nMult(1, ., Occ).Educ2  28.47707         NA      NA       NA    \nMult(1, ., Occ).Educ3 -10.70009         NA      NA       NA    \nMult(1, ., Occ).Educ4   9.22301         NA      NA       NA    \nMult(1, Educ, .).Occ1   0.06067         NA      NA       NA    \nMult(1, Educ, .).Occ2  -0.31188         NA      NA       NA    \nMult(1, Educ, .).Occ3   0.01526         NA      NA       NA    \nMult(1, Educ, .).Occ4   0.19408         NA      NA       NA    \nMult(1, Educ, .).Occ5   1.34889         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 17.602 on 5 degrees of freedom\nAIC: 163.98\n\nNumber of iterations: 71\n\n# 変数と係数と係数の順番を表示\npickCoef(UplusRC, \"[.]Educ\")\n\nMult(1, ., Occ).Educ1 Mult(1, ., Occ).Educ2 Mult(1, ., Occ).Educ3 \n                   11                    12                    13 \nMult(1, ., Occ).Educ4 \n                   14 \n\npickCoef(UplusRC, \"[.]Occ\")\n\nMult(1, Educ, .).Occ1 Mult(1, Educ, .).Occ2 Mult(1, Educ, .).Occ3 \n                   15                    16                    17 \nMult(1, Educ, .).Occ4 Mult(1, Educ, .).Occ5 \n                   18                    19 \n\ndata.frame(var = names(UplusRC$coefficients),\n           estimate = UplusRC$coefficients) |&gt; \n  mutate(estimate = estimate,\n         number = row_number())\n\n                                        var     estimate number\n(Intercept)                     (Intercept)   5.49123206      1\nEduc2                                 Educ2  -2.07045034      2\nEduc3                                 Educ3  -1.00877122      3\nEduc4                                 Educ4  -3.55472593      4\nOcc2                                   Occ2  -1.06909237      5\nOcc3                                   Occ3  -5.17112951      6\nOcc4                                   Occ4  -4.53939355      7\nOcc5                                   Occ5 -10.91018443      8\nRscore:Cscore                 Rscore:Cscore   0.55211791      9\nMult(., Educ, Occ).     Mult(., Educ, Occ).   0.05378691     10\nMult(1, ., Occ).Educ1 Mult(1, ., Occ).Educ1  57.38878762     11\nMult(1, ., Occ).Educ2 Mult(1, ., Occ).Educ2  28.47707090     12\nMult(1, ., Occ).Educ3 Mult(1, ., Occ).Educ3 -10.70009235     13\nMult(1, ., Occ).Educ4 Mult(1, ., Occ).Educ4   9.22300628     14\nMult(1, Educ, .).Occ1 Mult(1, Educ, .).Occ1   0.06066883     15\nMult(1, Educ, .).Occ2 Mult(1, Educ, .).Occ2  -0.31187524     16\nMult(1, Educ, .).Occ3 Mult(1, Educ, .).Occ3   0.01525644     17\nMult(1, Educ, .).Occ4 Mult(1, Educ, .).Occ4   0.19407628     18\nMult(1, Educ, .).Occ5 Mult(1, Educ, .).Occ5   1.34889132     19\n\nmu &lt;- getContrasts(UplusRC, \n                   pickCoef(UplusRC, \"[.]Educ\"), \n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\nnu &lt;- getContrasts(UplusRC, \n                   pickCoef(UplusRC, \"[.]Occ\"), \n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\n\n# 中心化制約と尺度化制約の確認\nsum(mu$qvframe[,1]) |&gt; round()\n\n[1] 0\n\nsum(mu$qvframe[,1]^2)\n\n[1] 1\n\nsum(nu$qvframe[,1]) |&gt; round()\n\n[1] 0\n\nsum(nu$qvframe[,1]^2)\n\n[1] 1\n\n# 行スコアと列スコアの両端の値を固定する\ncon &lt;- c(mu$qvframe[,1][c(1,4)],nu$qvframe[,1][c(1,5)])\n\nset.seed(1234567)\nUplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Rscore:Cscore + \n        Mult(1, Educ, Occ),\n      constrain = c(11,14,15,19),\n      constrainTo = con,\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n.........\nDone\n\nsummary(UplusRC)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\"Rscore|Cscore|Mult\",\n                      Variable))\n\n                Variable    Estimate Std..Error   z.value     Pr...z..\n1          Rscore:Cscore  0.55211791 0.03429436 16.099379 2.576758e-58\n2    Mult(., Educ, Occ).  3.43558976 0.61932837  5.547283 2.901428e-08\n3  Mult(1, ., Occ).Educ1  0.72242916         NA        NA           NA\n4  Mult(1, ., Occ).Educ2  0.14690561 0.13431003  1.093780 2.740515e-01\n5  Mult(1, ., Occ).Educ3 -0.63296437 0.13149187 -4.813715 1.481501e-06\n6  Mult(1, ., Occ).Educ4 -0.23637040         NA        NA           NA\n7  Mult(1, Educ, .).Occ1 -0.15787324         NA        NA           NA\n8  Mult(1, Educ, .).Occ2 -0.45087063 0.05888770 -7.656448 1.911463e-14\n9  Mult(1, Educ, .).Occ3 -0.19358905 0.08174718 -2.368143 1.787760e-02\n10 Mult(1, Educ, .).Occ4 -0.05295134 0.05110102 -1.036209 3.001047e-01\n11 Mult(1, Educ, .).Occ5  0.85528425         NA        NA           NA"
  },
  {
    "objectID": "3-Chapter_2.html#表2.7b",
    "href": "3-Chapter_2.html#表2.7b",
    "title": "2  第2章",
    "section": "2.24 表2.7B",
    "text": "2.24 表2.7B\n\nRplusRC.un &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Cscore:Educ + \n        Mult(1, Educ, Occ),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.............................\nDone\n\nsummary(RplusRC.un)\n\n\nCall:\ngnm(formula = Freq ~ Educ + Occ + Cscore:Educ + Mult(1, Educ, \n    Occ), family = poisson, data = freq_tab_2.3B, tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-0.96462  -0.24301  -0.05231   0.31330   1.21311  \n\nCoefficients:\n                      Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)             7.8043         NA      NA       NA\nEduc2                  -2.5496         NA      NA       NA\nEduc3                  -1.0924         NA      NA       NA\nEduc4                  -3.6305         NA      NA       NA\nOcc2                    1.0437         NA      NA       NA\nOcc3                   -0.7855         NA      NA       NA\nOcc4                    2.0809         NA      NA       NA\nOcc5                   -1.8534         NA      NA       NA\nEduc1:Cscore           -1.7432         NA      NA       NA\nEduc2:Cscore           -0.9182         NA      NA       NA\nEduc3:Cscore           -0.5398         NA      NA       NA\nEduc4:Cscore            0.0000         NA      NA       NA\nMult(., Educ, Occ).    -0.4213         NA      NA       NA\nMult(1, ., Occ).Educ1  -2.0586         NA      NA       NA\nMult(1, ., Occ).Educ2  -0.7258         NA      NA       NA\nMult(1, ., Occ).Educ3   0.5605         NA      NA       NA\nMult(1, ., Occ).Educ4  -0.2104         NA      NA       NA\nMult(1, Educ, .).Occ1   0.2200         NA      NA       NA\nMult(1, Educ, .).Occ2  -0.9616         NA      NA       NA\nMult(1, Educ, .).Occ3   0.1953         NA      NA       NA\nMult(1, Educ, .).Occ4   0.7768         NA      NA       NA\nMult(1, Educ, .).Occ5   4.8551         NA      NA       NA\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 6.9359 on 4 degrees of freedom\nAIC: 155.31\n\nNumber of iterations: 29\n\npickCoef(RplusRC.un, \"[:]Cscore\")\n\nEduc1:Cscore Educ2:Cscore Educ3:Cscore Educ4:Cscore \n           9           10           11           12 \n\nRplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Cscore:Educ + \n        Mult(1, Educ, Occ),\n      constrain = c(9,12),\n      constrainTo = c(0,0),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations........................................\nDone\n\nsummary(RplusRC)\n\n\nCall:\ngnm(formula = Freq ~ Educ + Occ + Cscore:Educ + Mult(1, Educ, \n    Occ), constrain = c(9, 12), constrainTo = c(0, 0), family = poisson, \n    data = freq_tab_2.3B, tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-0.96462  -0.24301  -0.05231   0.31330   1.21311  \n\nCoefficients:\n                      Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)             5.0338         NA      NA       NA    \nEduc2                  -0.4417         NA      NA       NA    \nEduc3                   3.0501         NA      NA       NA    \nEduc4                  -0.7074         NA      NA       NA    \nOcc2                    0.6767         NA      NA       NA    \nOcc3                   -1.1329         NA      NA       NA    \nOcc4                    1.6580         NA      NA       NA    \nOcc5                   -1.7737         NA      NA       NA    \nEduc1:Cscore            0.0000         NA      NA       NA    \nEduc2:Cscore           -0.4321     0.2210  -1.955   0.0506 .  \nEduc3:Cscore           -1.2670     0.1931  -6.562 5.31e-11 ***\nEduc4:Cscore            0.0000         NA      NA       NA    \nMult(., Educ, Occ).    -1.5191         NA      NA       NA    \nMult(1, ., Occ).Educ1   4.6510         NA      NA       NA    \nMult(1, ., Occ).Educ2   0.9307         NA      NA       NA    \nMult(1, ., Occ).Educ3  -2.6602         NA      NA       NA    \nMult(1, ., Occ).Educ4  -0.5081         NA      NA       NA    \nMult(1, Educ, .).Occ1  -0.1724         NA      NA       NA    \nMult(1, Educ, .).Occ2   0.1674         NA      NA       NA    \nMult(1, Educ, .).Occ3   0.2749         NA      NA       NA    \nMult(1, Educ, .).Occ4   0.4395         NA      NA       NA    \nMult(1, Educ, .).Occ5   0.2568         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 6.9359 on 4 degrees of freedom\nAIC: 155.31\n\nNumber of iterations: 40\n\n# 変数と係数と係数の順番を表示\npickCoef(RplusRC.un, \"[.]Educ\")\n\nMult(1, ., Occ).Educ1 Mult(1, ., Occ).Educ2 Mult(1, ., Occ).Educ3 \n                   14                    15                    16 \nMult(1, ., Occ).Educ4 \n                   17 \n\npickCoef(RplusRC.un, \"[.]Occ\")\n\nMult(1, Educ, .).Occ1 Mult(1, Educ, .).Occ2 Mult(1, Educ, .).Occ3 \n                   18                    19                    20 \nMult(1, Educ, .).Occ4 Mult(1, Educ, .).Occ5 \n                   21                    22 \n\ndata.frame(var = names(RplusRC$coefficients),\n           estimate = RplusRC$coefficients) |&gt; \n  mutate(estimate = estimate,\n         number = row_number())\n\n                                        var   estimate number\n(Intercept)                     (Intercept)  5.0338134      1\nEduc2                                 Educ2 -0.4416984      2\nEduc3                                 Educ3  3.0500999      3\nEduc4                                 Educ4 -0.7074330      4\nOcc2                                   Occ2  0.6766646      5\nOcc3                                   Occ3 -1.1329222      6\nOcc4                                   Occ4  1.6579720      7\nOcc5                                   Occ5 -1.7736652      8\nEduc1:Cscore                   Educ1:Cscore         NA      9\nEduc2:Cscore                   Educ2:Cscore -0.4320760     10\nEduc3:Cscore                   Educ3:Cscore -1.2669500     11\nEduc4:Cscore                   Educ4:Cscore         NA     12\nMult(., Educ, Occ).     Mult(., Educ, Occ). -1.5191478     13\nMult(1, ., Occ).Educ1 Mult(1, ., Occ).Educ1  4.6509709     14\nMult(1, ., Occ).Educ2 Mult(1, ., Occ).Educ2  0.9307366     15\nMult(1, ., Occ).Educ3 Mult(1, ., Occ).Educ3 -2.6601848     16\nMult(1, ., Occ).Educ4 Mult(1, ., Occ).Educ4 -0.5080538     17\nMult(1, Educ, .).Occ1 Mult(1, Educ, .).Occ1 -0.1724067     18\nMult(1, Educ, .).Occ2 Mult(1, Educ, .).Occ2  0.1674123     19\nMult(1, Educ, .).Occ3 Mult(1, Educ, .).Occ3  0.2748827     20\nMult(1, Educ, .).Occ4 Mult(1, Educ, .).Occ4  0.4395333     21\nMult(1, Educ, .).Occ5 Mult(1, Educ, .).Occ5  0.2567545     22\n\nmu &lt;- getContrasts(RplusRC, \n                   pickCoef(RplusRC, \"[.]Educ\"), \n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\nnu &lt;- getContrasts(RplusRC, \n                   pickCoef(RplusRC, \"[.]Occ\"), \n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\ncon &lt;- c(0,0,\n         mu$qvframe[,1][c(1,4)],\n         nu$qvframe[,1][c(1,5)])\n\nRplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Cscore:Educ + \n        Mult(1, Educ, Occ),\n      constrain = c(9,12,14,17,18,22),\n      constrainTo = con,\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.....................................\nDone\n\nsummary(RplusRC)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\"Rscore|Cscore|Mult\", Variable))\n\n                Variable    Estimate Std..Error    z.value     Pr...z..\n1           Educ1:Cscore  0.00000000         NA         NA           NA\n2           Educ2:Cscore -0.43207600  0.2209849 -1.9552282 5.055614e-02\n3           Educ3:Cscore -1.26695003  0.1930731 -6.5620238 5.308234e-11\n4           Educ4:Cscore  0.00000000         NA         NA           NA\n5    Mult(., Educ, Occ). -3.67046405  0.5474332 -6.7048620 2.015968e-11\n6  Mult(1, ., Occ).Educ1  0.75983648         NA         NA           NA\n7  Mult(1, ., Occ).Educ2  0.06145542  0.1367987  0.4492399 6.532586e-01\n8  Mult(1, ., Occ).Educ3 -0.61265036  0.1325427 -4.6222852 3.795357e-06\n9  Mult(1, ., Occ).Educ4 -0.20864153         NA         NA           NA\n10 Mult(1, Educ, .).Occ1 -0.80614447         NA         NA           NA\n11 Mult(1, Educ, .).Occ2 -0.05693272  0.1225191 -0.4646846 6.421573e-01\n12 Mult(1, Educ, .).Occ3  0.18001127  0.1630841  1.1037941 2.696825e-01\n13 Mult(1, Educ, .).Occ4  0.54302264  0.2004941  2.7084221 6.760398e-03\n14 Mult(1, Educ, .).Occ5  0.14004328         NA         NA           NA"
  },
  {
    "objectID": "3-Chapter_2.html#表2.7c",
    "href": "3-Chapter_2.html#表2.7c",
    "title": "2  第2章",
    "section": "2.25 表2.7C",
    "text": "2.25 表2.7C\nAlgorithm failed - no model could be estimatedとなったら再度推定すること．\n\nset.seed(1234)\nCplusRC.un &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Rscore:Occ + \n        Mult(1, Educ, Occ),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...................................................\nDone\n\nsummary(CplusRC.un)\n\n\nCall:\ngnm(formula = Freq ~ Educ + Occ + Rscore:Occ + Mult(1, Educ, \n    Occ), family = poisson, data = freq_tab_2.3B, tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.98938  -0.14103  -0.01486   0.18280   2.20453  \n\nCoefficients:\n                      Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)            7.10137         NA      NA       NA\nEduc2                 -0.60908         NA      NA       NA\nEduc3                  1.91190         NA      NA       NA\nEduc4                  0.89240         NA      NA       NA\nOcc2                  -1.92075         NA      NA       NA\nOcc3                  -5.71514         NA      NA       NA\nOcc4                  -4.14240         NA      NA       NA\nOcc5                  -6.62799         NA      NA       NA\nOcc1:Rscore           -0.95586         NA      NA       NA\nOcc2:Rscore           -0.14909         NA      NA       NA\nOcc3:Rscore            0.31615         NA      NA       NA\nOcc4:Rscore            0.57050         NA      NA       NA\nOcc5:Rscore            0.00000         NA      NA       NA\nMult(., Educ, Occ).    0.66123         NA      NA       NA\nMult(1, ., Occ).Educ1  2.38686         NA      NA       NA\nMult(1, ., Occ).Educ2  0.76217         NA      NA       NA\nMult(1, ., Occ).Educ3 -1.41566         NA      NA       NA\nMult(1, ., Occ).Educ4  2.21619         NA      NA       NA\nMult(1, Educ, .).Occ1  0.05371         NA      NA       NA\nMult(1, Educ, .).Occ2 -0.28583         NA      NA       NA\nMult(1, Educ, .).Occ3  0.04603         NA      NA       NA\nMult(1, Educ, .).Occ4  0.13605         NA      NA       NA\nMult(1, Educ, .).Occ5  0.76573         NA      NA       NA\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 11.405 on 3 degrees of freedom\nAIC: 161.78\n\nNumber of iterations: 51\n\npickCoef(CplusRC.un, \"[:]Rscore\")\n\nOcc1:Rscore Occ2:Rscore Occ3:Rscore Occ4:Rscore Occ5:Rscore \n          9          10          11          12          13 \n\nCplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Rscore:Occ + \n        Mult(1, Educ, Occ),\n      constrain = c(9,13),\n      constrainTo = c(0,0),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations..............................................\nDone\n\nsummary(CplusRC)\n\n\nCall:\ngnm(formula = Freq ~ Educ + Occ + Rscore:Occ + Mult(1, Educ, \n    Occ), constrain = c(9, 13), constrainTo = c(0, 0), family = poisson, \n    data = freq_tab_2.3B, tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.98938  -0.14103  -0.01486   0.18280   2.20453  \n\nCoefficients:\n                      Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)            6.20363         NA      NA       NA    \nEduc2                 -1.63502         NA      NA       NA    \nEduc3                 -0.14273         NA      NA       NA    \nEduc4                 -2.16197         NA      NA       NA    \nOcc2                  -2.71651         NA      NA       NA    \nOcc3                  -5.73314         NA      NA       NA    \nOcc4                  -3.94944         NA      NA       NA    \nOcc5                  -4.95928         NA      NA       NA    \nOcc1:Rscore            0.00000         NA      NA       NA    \nOcc2:Rscore            1.26259    0.16970   7.440 1.00e-13 ***\nOcc3:Rscore            1.28232    0.20937   6.125 9.08e-10 ***\nOcc4:Rscore            1.41583    0.09054  15.638  &lt; 2e-16 ***\nOcc5:Rscore            0.00000         NA      NA       NA    \nMult(., Educ, Occ).    0.19485         NA      NA       NA    \nMult(1, ., Occ).Educ1  2.16357         NA      NA       NA    \nMult(1, ., Occ).Educ2  3.16895         NA      NA       NA    \nMult(1, ., Occ).Educ3  2.80310         NA      NA       NA    \nMult(1, ., Occ).Educ4 16.83940         NA      NA       NA    \nMult(1, Educ, .).Occ1  0.06320         NA      NA       NA    \nMult(1, Educ, .).Occ2 -0.40161         NA      NA       NA    \nMult(1, Educ, .).Occ3  0.05268         NA      NA       NA    \nMult(1, Educ, .).Occ4  0.17592         NA      NA       NA    \nMult(1, Educ, .).Occ5  1.03792         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 11.405 on 3 degrees of freedom\nAIC: 161.78\n\nNumber of iterations: 46\n\nsummary(CplusRC)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\"Rscore|Cscore|Mult\", Variable))\n\n                Variable    Estimate Std..Error   z.value     Pr...z..\n1            Occ1:Rscore  0.00000000         NA        NA           NA\n2            Occ2:Rscore  1.26259006  0.1696974  7.440245 1.004990e-13\n3            Occ3:Rscore  1.28231939  0.2093667  6.124752 9.082487e-10\n4            Occ4:Rscore  1.41582828  0.0905404 15.637531 4.040916e-55\n5            Occ5:Rscore  0.00000000         NA        NA           NA\n6    Mult(., Educ, Occ).  0.19484605         NA        NA           NA\n7  Mult(1, ., Occ).Educ1  2.16357386         NA        NA           NA\n8  Mult(1, ., Occ).Educ2  3.16895075         NA        NA           NA\n9  Mult(1, ., Occ).Educ3  2.80310016         NA        NA           NA\n10 Mult(1, ., Occ).Educ4 16.83939688         NA        NA           NA\n11 Mult(1, Educ, .).Occ1  0.06320167         NA        NA           NA\n12 Mult(1, Educ, .).Occ2 -0.40161169         NA        NA           NA\n13 Mult(1, Educ, .).Occ3  0.05268391         NA        NA           NA\n14 Mult(1, Educ, .).Occ4  0.17591506         NA        NA           NA\n15 Mult(1, Educ, .).Occ5  1.03791723         NA        NA           NA\n\n# 変数と係数と係数の順番を表示\ndata.frame(var = names(CplusRC$coefficients),\n           estimate = CplusRC$coefficients) |&gt; \n  mutate(estimate = estimate,\n         number = row_number())\n\n                                        var    estimate number\n(Intercept)                     (Intercept)  6.20363194      1\nEduc2                                 Educ2 -1.63501732      2\nEduc3                                 Educ3 -0.14273304      3\nEduc4                                 Educ4 -2.16196522      4\nOcc2                                   Occ2 -2.71650934      5\nOcc3                                   Occ3 -5.73314338      6\nOcc4                                   Occ4 -3.94943954      7\nOcc5                                   Occ5 -4.95928306      8\nOcc1:Rscore                     Occ1:Rscore          NA      9\nOcc2:Rscore                     Occ2:Rscore  1.26259006     10\nOcc3:Rscore                     Occ3:Rscore  1.28231939     11\nOcc4:Rscore                     Occ4:Rscore  1.41582828     12\nOcc5:Rscore                     Occ5:Rscore          NA     13\nMult(., Educ, Occ).     Mult(., Educ, Occ).  0.19484605     14\nMult(1, ., Occ).Educ1 Mult(1, ., Occ).Educ1  2.16357386     15\nMult(1, ., Occ).Educ2 Mult(1, ., Occ).Educ2  3.16895075     16\nMult(1, ., Occ).Educ3 Mult(1, ., Occ).Educ3  2.80310016     17\nMult(1, ., Occ).Educ4 Mult(1, ., Occ).Educ4 16.83939688     18\nMult(1, Educ, .).Occ1 Mult(1, Educ, .).Occ1  0.06320167     19\nMult(1, Educ, .).Occ2 Mult(1, Educ, .).Occ2 -0.40161169     20\nMult(1, Educ, .).Occ3 Mult(1, Educ, .).Occ3  0.05268391     21\nMult(1, Educ, .).Occ4 Mult(1, Educ, .).Occ4  0.17591506     22\nMult(1, Educ, .).Occ5 Mult(1, Educ, .).Occ5  1.03791723     23\n\nmu &lt;- getContrasts(CplusRC, \n                   pickCoef(CplusRC, \"[.]Educ\"),\n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\nnu &lt;- getContrasts(CplusRC, \n                   pickCoef(CplusRC, \"[.]Occ\"),\n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\ncon &lt;- c(0,0,\n         mu$qvframe[,1][c(1,4)],\n         nu$qvframe[,1][c(1,5)])\n\nCplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Rscore:Occ + \n        Mult(1, Educ, Occ),\n      constrain = c(9,13,15,18,19,23),\n      constrainTo = con,\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...............................................\nDone\n\nsummary(CplusRC)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\"Rscore|Cscore|Mult\", Variable))\n\n                Variable     Estimate Std..Error   z.value     Pr...z..\n1            Occ1:Rscore  0.000000000         NA        NA           NA\n2            Occ2:Rscore  1.262590058 0.16969738  7.440245 1.004990e-13\n3            Occ3:Rscore  1.282319390 0.20936674  6.124752 9.082487e-10\n4            Occ4:Rscore  1.415828283 0.09054040 15.637531 4.040916e-55\n5            Occ5:Rscore  0.000000000         NA        NA           NA\n6    Mult(., Educ, Occ).  2.509132039 0.47337666  5.300498 1.154873e-07\n7  Mult(1, ., Occ).Educ1 -0.332914652         NA        NA           NA\n8  Mult(1, ., Occ).Educ2 -0.250882838 0.17043562 -1.472009 1.410183e-01\n9  Mult(1, ., Occ).Educ3 -0.280733721 0.25875316 -1.084948 2.779447e-01\n10 Mult(1, ., Occ).Educ4  0.864531211         NA        NA           NA\n11 Mult(1, Educ, .).Occ1 -0.116510615         NA        NA           NA\n12 Mult(1, Educ, .).Occ2 -0.558888360 0.15090381 -3.703607 2.125557e-04\n13 Mult(1, Educ, .).Occ3 -0.126520705 0.12280113 -1.030289 3.028742e-01\n14 Mult(1, Educ, .).Occ4 -0.009237675 0.06533009 -0.141400 8.875539e-01\n15 Mult(1, Educ, .).Occ5  0.811157355         NA        NA           NA"
  },
  {
    "objectID": "3-Chapter_2.html#表2.7d",
    "href": "3-Chapter_2.html#表2.7d",
    "title": "2  第2章",
    "section": "2.26 表2.7D",
    "text": "2.26 表2.7D\nまずは行効果と列効果のパラメータに対して0という制約を課し，その上で推定した行スコアと列スコアを正規化し，再度推定する．\n\nRplusCplusRC.un &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Cscore:Educ + \n        Rscore:Occ + \n        Mult(1, Educ, Occ),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations..............\nDone\n\nsummary(RplusCplusRC.un)\n\n\nCall:\ngnm(formula = Freq ~ Educ + Occ + Cscore:Educ + Rscore:Occ + \n    Mult(1, Educ, Occ), family = poisson, data = freq_tab_2.3B, \n    tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-0.46856  -0.01129  -0.00160   0.02313   0.20690  \n\nCoefficients:\n                       Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)             7.70566         NA      NA       NA\nEduc2                   2.93231         NA      NA       NA\nEduc3                   9.84106         NA      NA       NA\nEduc4                  11.98330         NA      NA       NA\nOcc2                   -5.32506         NA      NA       NA\nOcc3                  -11.88093         NA      NA       NA\nOcc4                  -13.38551         NA      NA       NA\nOcc5                  -18.15374         NA      NA       NA\nEduc1:Cscore            2.30655         NA      NA       NA\nEduc2:Cscore            1.65824         NA      NA       NA\nEduc3:Cscore            0.57607         NA      NA       NA\nEduc4:Cscore            0.00000         NA      NA       NA\nOcc1:Rscore            -3.93278         NA      NA       NA\nOcc2:Rscore            -2.23708         NA      NA       NA\nOcc3:Rscore            -1.05781         NA      NA       NA\nOcc4:Rscore             0.00000         NA      NA       NA\nOcc5:Rscore             0.00000         NA      NA       NA\nMult(., Educ, Occ).     0.30868         NA      NA       NA\nMult(1, ., Occ).Educ1   0.24164         NA      NA       NA\nMult(1, ., Occ).Educ2  -0.05431         NA      NA       NA\nMult(1, ., Occ).Educ3  -0.29807         NA      NA       NA\nMult(1, ., Occ).Educ4   0.43140         NA      NA       NA\nMult(1, Educ, .).Occ1   2.28861         NA      NA       NA\nMult(1, Educ, .).Occ2  -2.69886         NA      NA       NA\nMult(1, Educ, .).Occ3   0.26160         NA      NA       NA\nMult(1, Educ, .).Occ4   0.21052         NA      NA       NA\nMult(1, Educ, .).Occ5   7.13039         NA      NA       NA\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 0.27843 on 2 degrees of freedom\nAIC: 152.66\n\nNumber of iterations: 14\n\npickCoef(RplusCplusRC.un, \"[:]Cscore\")\n\nEduc1:Cscore Educ2:Cscore Educ3:Cscore Educ4:Cscore \n           9           10           11           12 \n\npickCoef(RplusCplusRC.un, \"[:]Rscore\")\n\nOcc1:Rscore Occ2:Rscore Occ3:Rscore Occ4:Rscore Occ5:Rscore \n         13          14          15          16          17 \n\nRplusCplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Cscore:Educ + \n        Rscore:Occ + \n        Mult(1, Educ, Occ),\n      constrain = c(9,12,13,14,17), \n      constrainTo = c(0,0,0,0,0),\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations............................\nDone\n\n# 変数と係数と係数の順番を表示\ndata.frame(var = names(CplusRC$coefficients),\n           estimate = CplusRC$coefficients) |&gt; \n  mutate(estimate = estimate,\n         number = row_number())\n\n                                        var     estimate number\n(Intercept)                     (Intercept)  6.132951036      1\nEduc2                                 Educ2 -1.598655285      2\nEduc3                                 Educ3 -0.119602932      3\nEduc4                                 Educ4 -1.631176445      4\nOcc2                                   Occ2 -3.281987830      5\nOcc3                                   Occ3 -5.745938986      6\nOcc4                                   Occ4 -3.812315688      7\nOcc5                                   Occ5 -3.773472310      8\nOcc1:Rscore                     Occ1:Rscore           NA      9\nOcc2:Rscore                     Occ2:Rscore  1.262590058     10\nOcc3:Rscore                     Occ3:Rscore  1.282319390     11\nOcc4:Rscore                     Occ4:Rscore  1.415828283     12\nOcc5:Rscore                     Occ5:Rscore           NA     13\nMult(., Educ, Occ).     Mult(., Educ, Occ).  2.509132039     14\nMult(1, ., Occ).Educ1 Mult(1, ., Occ).Educ1           NA     15\nMult(1, ., Occ).Educ2 Mult(1, ., Occ).Educ2 -0.250882838     16\nMult(1, ., Occ).Educ3 Mult(1, ., Occ).Educ3 -0.280733721     17\nMult(1, ., Occ).Educ4 Mult(1, ., Occ).Educ4           NA     18\nMult(1, Educ, .).Occ1 Mult(1, Educ, .).Occ1           NA     19\nMult(1, Educ, .).Occ2 Mult(1, Educ, .).Occ2 -0.558888360     20\nMult(1, Educ, .).Occ3 Mult(1, Educ, .).Occ3 -0.126520705     21\nMult(1, Educ, .).Occ4 Mult(1, Educ, .).Occ4 -0.009237675     22\nMult(1, Educ, .).Occ5 Mult(1, Educ, .).Occ5           NA     23\n\nmu &lt;- getContrasts(RplusCplusRC, \n                   pickCoef(RplusCplusRC, \"[.]Educ\"), \n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\nnu &lt;- getContrasts(RplusCplusRC,\n                   pickCoef(RplusCplusRC, \"[.]Occ\"), \n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\ncon &lt;- c(0,0,0,0,0,\n         mu$qvframe[,1][c(1,4)],\n         nu$qvframe[,1][c(1,5)])\n\nRplusCplusRC &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        Cscore:Educ + \n        Rscore:Occ + \n        Mult(1, Educ, Occ),\n      constrain = c(9,12,13,14,17,19,22,23,27), \n      constrainTo = con,\n      family = poisson, \n      data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations......................\nDone\n\nmu\n\n                         Estimate Std. Error\nMult(1, ., Occ).Educ1 -0.76639941 0.03714637\nMult(1, ., Occ).Educ2 -0.05505913 0.08952794\nMult(1, ., Occ).Educ3  0.60073372 0.04744381\nMult(1, ., Occ).Educ4  0.22072481 0.06764890\n\nnu\n\n                         Estimate Std. Error\nMult(1, Educ, .).Occ1  0.83832072 0.02535129\nMult(1, Educ, .).Occ2 -0.04397713 0.08855421\nMult(1, Educ, .).Occ3 -0.11946443 0.09158773\nMult(1, Educ, .).Occ4 -0.50065982 0.06550415\nMult(1, Educ, .).Occ5 -0.17421935 0.12622465\n\nsummary(RplusCplusRC)$coefficients |&gt;\n  data.frame() |&gt;\n  rownames_to_column(\"Variable\") |&gt;\n  dplyr::filter(grepl(\"Rscore|Cscore|Mult\", Variable))\n\n                Variable    Estimate Std..Error    z.value     Pr...z..\n1           Educ1:Cscore  0.00000000         NA         NA           NA\n2           Educ2:Cscore -0.29016794  0.1835938 -1.5804884 1.139951e-01\n3           Educ3:Cscore -0.95452353  0.2168230 -4.4023158 1.071015e-05\n4           Educ4:Cscore  0.00000000         NA         NA           NA\n5            Occ1:Rscore  0.00000000         NA         NA           NA\n6            Occ2:Rscore  0.00000000         NA         NA           NA\n7            Occ3:Rscore  0.39725281  0.1673266  2.3741161 1.759102e-02\n8            Occ4:Rscore  0.32684292  0.1614939  2.0238715 4.298337e-02\n9            Occ5:Rscore  0.00000000         NA         NA           NA\n10   Mult(., Educ, Occ). -2.85715993  0.5343817 -5.3466654 8.958940e-08\n11 Mult(1, ., Occ).Educ1 -0.76639941         NA         NA           NA\n12 Mult(1, ., Occ).Educ2 -0.05505913  0.1291228 -0.4264091 6.698098e-01\n13 Mult(1, ., Occ).Educ3  0.60073372  0.1297703  4.6292078 3.670672e-06\n14 Mult(1, ., Occ).Educ4  0.22072481         NA         NA           NA\n15 Mult(1, Educ, .).Occ1  0.83832072         NA         NA           NA\n16 Mult(1, Educ, .).Occ2 -0.04397713  0.1677272 -0.2621944 7.931715e-01\n17 Mult(1, Educ, .).Occ3 -0.11946443  0.1842187 -0.6484923 5.166666e-01\n18 Mult(1, Educ, .).Occ4 -0.50065982  0.2149854 -2.3288081 1.986923e-02\n19 Mult(1, Educ, .).Occ5 -0.17421935         NA         NA           NA"
  },
  {
    "objectID": "3-Chapter_2.html#表2.7e",
    "href": "3-Chapter_2.html#表2.7e",
    "title": "2  第2章",
    "section": "2.27 表2.7E",
    "text": "2.27 表2.7E\nWongのサポートページにあるように，gnmを用いてRC(2)の係数を推定することは難しい．ここではKateri, Maria. 2014. {}. New York: Birkhäuser. のsupportページにあるプログラムを使用して係数を求める．\n\\(M &gt; 1\\)のRC(M)を推定するためにはgnmのinstancesを用いる． 今はinstances = 2としており，RC(2)を用いている． なお，式(2.35)のように\\(\\phi\\)は推定されない． これらスコアは求まるものの，直交という次元間制約が課されてない． そこで，特異値分解（SVD: singular value decomposition）によって行スコアと列スコアのそれぞれが次元間で直行するような変換を行う．\nまず次元間制約が課されてない行スコアの行列（\\(I\\times m\\)）と列スコアの行列（\\(J\\times m\\)）の積を求め，モデル化での2元交互作用パラメータを求める．\n\nRC2 &lt;- freq_tab_2.3B |&gt;\n  gnm(Freq ~ Educ + Occ + \n        instances(Mult(Educ, Occ), instances = 2),\n      family = poisson, data = _, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.......................\nDone\n\nsummary(RC2)\n\n\nCall:\ngnm(formula = Freq ~ Educ + Occ + instances(Mult(Educ, Occ), \n    instances = 2), family = poisson, data = freq_tab_2.3B, tolerance = 1e-12)\n\nDeviance Residuals: \n      Min         1Q     Median         3Q        Max  \n-0.631356  -0.030234  -0.004363   0.050323   0.320666  \n\nCoefficients:\n                             Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)                   4.98690         NA      NA       NA\nEduc2                        -0.82270         NA      NA       NA\nEduc3                         1.48754         NA      NA       NA\nEduc4                        -0.08253         NA      NA       NA\nOcc2                          0.02911         NA      NA       NA\nOcc3                         -2.10701         NA      NA       NA\nOcc4                          0.26228         NA      NA       NA\nOcc5                         -3.17251         NA      NA       NA\nMult(., Occ, inst = 1).Educ1 -6.48058         NA      NA       NA\nMult(., Occ, inst = 1).Educ2 -1.57685         NA      NA       NA\nMult(., Occ, inst = 1).Educ3  0.59452         NA      NA       NA\nMult(., Occ, inst = 1).Educ4  3.79509         NA      NA       NA\nMult(Educ, ., inst = 1).Occ1 -0.22164         NA      NA       NA\nMult(Educ, ., inst = 1).Occ2  0.11057         NA      NA       NA\nMult(Educ, ., inst = 1).Occ3  0.15266         NA      NA       NA\nMult(Educ, ., inst = 1).Occ4  0.21204         NA      NA       NA\nMult(Educ, ., inst = 1).Occ5 -0.15669         NA      NA       NA\nMult(., Occ, inst = 2).Educ1 -0.39694         NA      NA       NA\nMult(., Occ, inst = 2).Educ2 -0.26127         NA      NA       NA\nMult(., Occ, inst = 2).Educ3 -0.52436         NA      NA       NA\nMult(., Occ, inst = 2).Educ4  0.45321         NA      NA       NA\nMult(Educ, ., inst = 2).Occ1  0.43735         NA      NA       NA\nMult(Educ, ., inst = 2).Occ2 -0.65193         NA      NA       NA\nMult(Educ, ., inst = 2).Occ3  0.49859         NA      NA       NA\nMult(Educ, ., inst = 2).Occ4  0.79497         NA      NA       NA\nMult(Educ, ., inst = 2).Occ5  2.99034         NA      NA       NA\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 0.6001 on 2 degrees of freedom\nAIC: 152.98\n\nNumber of iterations: 23\n\nRCmodel_coef &lt;- function(RCmodel, row, col, m, data){\n  NI &lt;- RCmodel$xlevels[[1]] |&gt; length()\n  NJ &lt;- RCmodel$xlevels[[2]] |&gt; length()\n  iflag &lt;- 0\n  y &lt;- length(RCmodel$y)\n  X &lt;- gl(NI,NJ,length = y)\n  Y &lt;- gl(NJ,1,length = y)\n  IX &lt;- pickCoef(RCmodel, \n                 paste0(\"[.]\",deparse(substitute(row))))\n  IY &lt;- pickCoef(RCmodel,\n                 paste0(\"[.]\",deparse(substitute(col))))\n  X &lt;- RCmodel$coefficients[IX]\n  Y &lt;- RCmodel$coefficients[IY]\n  mu0 &lt;- matrix(X,nrow = NI,ncol = m)\n  nu0 &lt;- matrix(Y,nrow = NJ,ncol = m)\n  mu &lt;- mu0\n  nu &lt;- nu0\n  A &lt;- mu %*% t(nu) # [NI, M] [M. NJ]\n  R1 &lt;- diag(1,NI)\n  C1 &lt;- diag(1,NJ)\n  Rone &lt;- matrix(rep(1,NI^2),nrow = NI)\n  Cone &lt;- matrix(rep(1,NJ^2),nrow = NJ)\n  rowP &lt;- c(rep(1,NI))\n  colP &lt;- c(rep(1,NJ));\n  data &lt;- RC2$model\n  list(y,X,Y,IX,IY,data)\n  if (iflag == 1) {\n    rowP &lt;- with(data, tapply(freq,row,sum)/sum(freq))\n    colP &lt;- with(data, tapply(freq,col,sum)/sum(freq))}\n  DR &lt;- diag(rowP^(-1/2),NI)\n  DC &lt;- diag(colP^(-1/2),NJ)\n  RWsqr &lt;- diag(rowP^(1/2),NI)\n  CWsqr &lt;- diag(colP^(1/2),NJ)\n  RW &lt;- RWsqr^2\n  CW &lt;- CWsqr^2\n  L &lt;- (R1 - (Rone %*% RW)/sum(RW)) %*% A %*% t(C1 - (Cone %*% CW)/sum(CW))\n  phiv &lt;- svd(RWsqr %*% L %*% CWsqr)$d[1:m]\n  mu &lt;- svd(RWsqr %*% L %*% CWsqr)$u[,1:m]\n  nu &lt;- svd(RWsqr %*% L %*% CWsqr)$v[,1:m]\n  mu &lt;- DR %*% mu\n  nu &lt;- DC %*% nu\n  phi &lt;- diag(phiv, m)\n  L2 &lt;- RCmodel$deviance\n  df &lt;- RCmodel$df.residual\n  p.value &lt;- 1 - pchisq(L2,df)\n  fit.freq &lt;- predict(RCmodel, \n                      type = \"response\", \n                      se.fit = TRUE)\n  \n  print(list(model = RCmodel, \n     L2 = L2, \n     df = df,\n     p.value = p.value,\n     obs_freq = summary(RC2)$y, \n     fit.freq = fit.freq,\n     phi = phi, \n     mu = mu, \n     nu = nu,\n     cor(mu) |&gt; round(3),\n     cor(nu) |&gt; round(3)))\n  }\n\nRCmodel_coef(RC2, row = Educ, col = Occ, m =  2)\n\n$model\n\nCall:\ngnm(formula = Freq ~ Educ + Occ + instances(Mult(Educ, Occ), \n    instances = 2), family = poisson, data = freq_tab_2.3B, tolerance = 1e-12)\n\nCoefficients:\n                 (Intercept)                         Educ2  \n                     4.98690                      -0.82270  \n                       Educ3                         Educ4  \n                     1.48754                      -0.08253  \n                        Occ2                          Occ3  \n                     0.02911                      -2.10701  \n                        Occ4                          Occ5  \n                     0.26228                      -3.17251  \nMult(., Occ, inst = 1).Educ1  Mult(., Occ, inst = 1).Educ2  \n                    -6.48058                      -1.57685  \nMult(., Occ, inst = 1).Educ3  Mult(., Occ, inst = 1).Educ4  \n                     0.59452                       3.79509  \nMult(Educ, ., inst = 1).Occ1  Mult(Educ, ., inst = 1).Occ2  \n                    -0.22164                       0.11057  \nMult(Educ, ., inst = 1).Occ3  Mult(Educ, ., inst = 1).Occ4  \n                     0.15266                       0.21204  \nMult(Educ, ., inst = 1).Occ5  Mult(., Occ, inst = 2).Educ1  \n                    -0.15669                      -0.39694  \nMult(., Occ, inst = 2).Educ2  Mult(., Occ, inst = 2).Educ3  \n                    -0.26127                      -0.52436  \nMult(., Occ, inst = 2).Educ4  Mult(Educ, ., inst = 2).Occ1  \n                     0.45321                       0.43735  \nMult(Educ, ., inst = 2).Occ2  Mult(Educ, ., inst = 2).Occ3  \n                    -0.65193                       0.49859  \nMult(Educ, ., inst = 2).Occ4  Mult(Educ, ., inst = 2).Occ5  \n                     0.79497                       2.99034  \n\nDeviance:            0.6001022 \nPearson chi-squared: 0.5746549 \nResidual df:         2 \n\n$L2\n[1] 0.6001022\n\n$df\n[1] 2\n\n$p.value\n[1] 0.7407804\n\n$obs_freq\nNULL\n\n$fit.freq\n$fit.freq$fit\n          1           2           3           4           5           6 \n 517.836063   95.414391    5.433736   35.145848    5.169961   81.405000 \n          7           8           9          10          11          12 \n  65.976261    5.398934   48.639687    1.580117  451.846566 1003.387842 \n         13          14          15          16          17          18 \n  66.470016  630.136504    5.159072   70.912370  157.221505   36.697314 \n         19          20 \n 562.077961   12.090850 \n\n$fit.freq$se.fit\n        1         2         3         4         5         6         7         8 \n22.748933  9.732333  2.174395  5.860792  2.230227  8.912865  7.856714  1.044826 \n        9        10        11        12        13        14        15        16 \n 6.616317  0.619348 21.250045 31.666672  8.114913 25.088611  2.233235  8.415482 \n       17        18        19        20 \n12.530867  6.041164 23.703381  3.469126 \n\n$fit.freq$residual.scale\n[1] 1\n\n\n$phi\n         [,1]     [,2]\n[1,] 2.600861 0.000000\n[2,] 0.000000 1.521971\n\n$mu\n            [,1]        [,2]\n[1,]  0.74345129  0.27619989\n[2,]  0.08846472 -0.06103682\n[3,] -0.19984223 -0.77722344\n[4,] -0.63207378  0.56206037\n\n$nu\n            [,1]         [,2]\n[1,]  0.76509960 -0.137064850\n[2,]  0.01966104 -0.548959995\n[3,] -0.32245067 -0.119769392\n[4,] -0.55005650 -0.009934123\n[5,]  0.08774653  0.815728360\n\n[[10]]\n     [,1] [,2]\n[1,]    1    0\n[2,]    0    1\n\n[[11]]\n     [,1] [,2]\n[1,]    1    0\n[2,]    0    1\n\n\nlogmultパッケージのrcによってRC(2)を推定する．まずはanoasで連関分析を行う．表2.6Aと同じ結果になっていることを確認する．正規化だけではなく，次元間制約が課されており，表2.7の結果と一致する．\n\nanoas(tab_2.3B)\n\nFitting independence model...\nFitting model with 1 dimension...\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n........\nDone\nFitting model with 2 dimensions...\nInitialising\nRunning start-up iterations..\nRunning main iterations.........\nDone\nFitting model with 3 dimensions...\nInitialising\nRunning start-up iterations..\nRunning main iterations...\nDone\n\n\n       Res. Df            Res. Dev     Dev./Indep. (%)   Dissim. (%)\nIndep.      12 1373.17576565224545 100.000000000000000 23.8615752953\nRC(1)        6  125.05974855014664   9.107337289101110  6.4360390988\nRC(2)        2    0.60010223526822   0.043701778772885  0.0935165803\nRC(3)        0    0.00000000000009   0.000000000000006  0.0000000007\n                       BIC                 AIC    Dev. Df\nIndep. 1274.08091533065726 1349.17576565224545      NA NA\nRC(1)    75.51232338935259  113.05974855014664 -1248.1 -6\nRC(2)   -15.91570615166313   -3.39989776473178  -124.5 -4\nRC(3)     0.00000000000009    0.00000000000009    -0.6 -2\n\n\n\nRC2 &lt;- rc(tab_2.3B, \n          nd = 2, \n          weighting = \"none\", \n          se = \"bootstrap\",\n          nreplicates = 1000, \n          ncpus = getOption(\"boot.ncpus\"))\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.......\nDone\nComputing bootstrap standard errors...\n.\n\n\nWarning in jackboot(se, ncpus, nreplicates, tab, model, assoc1 =\ngetS3method(\"assoc\", : One model replicate failed and its results will be\nskipped. Standard errors will not be completely accurate. Consider raising the\nvalue of iterMax.\n\nsummary(RC2)\n\nCall:\nrc(tab = tab_2.3B, nd = 2, weighting = \"none\", se = \"bootstrap\", \n    nreplicates = 1000, ncpus = getOption(\"boot.ncpus\"))\n\nDeviance Residuals:\n    Columns\nRows         A         B         C         D         E\n   A   0.00720  -0.04245   0.23888  -0.02462  -0.07516\n   B  -0.04493   0.12571  -0.63136   0.05160   0.32067\n   C   0.00722  -0.01224   0.06492  -0.00544  -0.07040\n   D   0.01040  -0.01767   0.04990  -0.00329  -0.02616\n\nAssociation coefficients:\n               Normalized    Adjusted  Std. error   Pr(&gt;|z|)     \nDim1            2.6008615          NA      0.1873  &lt; 2.2e-16  ***\nDim2            1.5219709          NA      0.5272   0.003890  ** \nDim1:RowsA      0.7434513   1.1989778      0.0188  &lt; 2.2e-16  ***\nDim1:RowsB      0.0884647   0.1426687      0.0410   0.031124  *  \nDim1:RowsC     -0.1998422  -0.3222893      0.0226  &lt; 2.2e-16  ***\nDim1:RowsD     -0.6320738  -1.0193572      0.0185  &lt; 2.2e-16  ***\nDim2:RowsA      0.2761999   0.3407428      0.0903   0.002220  ** \nDim2:RowsB     -0.0610368  -0.0753000      0.1571   0.697718     \nDim2:RowsC     -0.7772234  -0.9588465      0.0637  &lt; 2.2e-16  ***\nDim2:RowsD      0.5620604   0.6934037      0.0696  6.804e-16  ***\nDim1:ColumnsA   0.7650996   1.2338904      0.0399  &lt; 2.2e-16  ***\nDim1:ColumnsB   0.0196610   0.0317077      0.0404   0.626275     \nDim1:ColumnsC  -0.3224507  -0.5200222      0.0991   0.001142  ** \nDim1:ColumnsD  -0.5500565  -0.8870864      0.0688  1.277e-15  ***\nDim1:ColumnsE   0.0877465   0.1415105      0.0992   0.376475     \nDim2:ColumnsA  -0.1370648  -0.1690944      0.0473   0.003746  ** \nDim2:ColumnsB  -0.5489600  -0.6772420      0.0805  9.003e-12  ***\nDim2:ColumnsC  -0.1197694  -0.1477573      0.0935   0.200113     \nDim2:ColumnsD  -0.0099341  -0.0122555      0.0708   0.888363     \nDim2:ColumnsE   0.8157284   1.0063493      0.0557  &lt; 2.2e-16  ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nNormalization weights: none\nDeviance:              0.6001022\nPearson chi-squared:   0.5746549\nDissimilarity index:   0.09351658%\nResidual df:           2\nBIC:                   -15.91571\nAIC:                   -3.399898\n\nRC2 |&gt; \n  summary() |&gt;\n  pluck(coefficients) |&gt;\n  data.frame() |&gt;\n  rownames_to_column(var = \"Parameter\") |&gt;\n  arrange(Parameter)\n\n       Parameter   Normalized    Adjusted Std..error      Pr...z..\n1           Dim1  2.600861491          NA 0.18733724  7.996127e-44\n2  Dim1:ColumnsA  0.765099599  1.23389040 0.03987968  4.920472e-82\n3  Dim1:ColumnsB  0.019661041  0.03170773 0.04037365  6.262746e-01\n4  Dim1:ColumnsC -0.322450671 -0.52002222 0.09912245  1.141718e-03\n5  Dim1:ColumnsD -0.550056503 -0.88708639 0.06878444  1.276783e-15\n6  Dim1:ColumnsE  0.087746534  0.14151047 0.09921477  3.764749e-01\n7     Dim1:RowsA  0.743451285  1.19897776 0.01883771  0.000000e+00\n8     Dim1:RowsB  0.088464723  0.14266871 0.04104172  3.112406e-02\n9     Dim1:RowsC -0.199842229 -0.32228929 0.02258981  9.025530e-19\n10    Dim1:RowsD -0.632073780 -1.01935718 0.01851006 1.452479e-255\n11          Dim2  1.521970932          NA 0.52719756  3.890478e-03\n12 Dim2:ColumnsA -0.137064849 -0.16909442 0.04728359  3.746148e-03\n13 Dim2:ColumnsB -0.548959996 -0.67724199 0.08047383  9.003428e-12\n14 Dim2:ColumnsC -0.119769391 -0.14775733 0.09347999  2.001128e-01\n15 Dim2:ColumnsD -0.009934123 -0.01225555 0.07076807  8.883631e-01\n16 Dim2:ColumnsE  0.815728359  1.00634928 0.05570139  1.457086e-48\n17    Dim2:RowsA  0.276199888  0.34074279 0.09028681  2.219741e-03\n18    Dim2:RowsB -0.061036818 -0.07530002 0.15714808  6.977177e-01\n19    Dim2:RowsC -0.777223438 -0.95884646 0.06373209  3.298285e-34\n20    Dim2:RowsD  0.562060367  0.69340368 0.06961379  6.804270e-16\n\n# getS3method(\"assoc\",\"rc\")"
  },
  {
    "objectID": "2-Chapter_1.html#クラメールのv",
    "href": "2-Chapter_1.html#クラメールのv",
    "title": "1  第1章",
    "section": "1.1 クラメールのV",
    "text": "1.1 クラメールのV\nクラメールの\\(V\\)も連関の強さをみる指標であり，次のように定義される．\n\\[\\begin{equation}\nV = \\sqrt{\\frac{\\chi^2/n}{{\\rm min}(I-1,J-1)}}\n\\end{equation}\\]\n\\({\\rm min}(I-1,J-1)\\)は括弧内の最小の値であり，\\({\\rm min}(I,J)-1\\)と考えても良い． 値の取りうる範囲は\\[0 \\leq V \\leq 1\\]となり，値が大きいほど2つの変数の連関は強いといえる．\nではクラメールのVを自分で求めてみよう．chisq.test(tab)$statisticでカイ2乗値を取り出すことができるが， 名前がついているのでunname関数で取り除く．as.numericとしても取り除くことができる．\n\ntab\n\n   MHS\nSES well mild modelrate impared\n  A   64   94        58      46\n  B   57   94        54      40\n  C   57  105        65      60\n  D   72  141        77      94\n  E   36   97        54      78\n  F   21   71        54      71\n\nX2 &lt;- chisq.test(tab)$statistic |&gt; unname()   # あるいはas.numeric()\nV &lt;- sqrt(X2/sum(tab)/(min(dim(tab)) - 1))\nV\n\n[1] 0.09609364\n\n\ntabの2行目を10倍，1列目を10倍したデータを考える．これをtab10とする．\n\ntab10 &lt;- tab\ntab10[,1] &lt;- tab10[,1]*10\ntab10[2,] &lt;- tab10[2,]*10\ntab\n\n   MHS\nSES well mild modelrate impared\n  A   64   94        58      46\n  B   57   94        54      40\n  C   57  105        65      60\n  D   72  141        77      94\n  E   36   97        54      78\n  F   21   71        54      71\n\ntab10\n\n   MHS\nSES well mild modelrate impared\n  A  640   94        58      46\n  B 5700  940       540     400\n  C  570  105        65      60\n  D  720  141        77      94\n  E  360   97        54      78\n  F  210   71        54      71\n\n\nこの2つの表について先程の連関係数の値を確認すると，すべての係数について表によって値が異なる．\n\nDescTools::CramerV(tab)\n\n[1] 0.09609364\n\nDescTools::CramerV(tab10)\n\n[1] 0.08200758\n\nDescTools::GoodmanKruskalTau(tab)\n\n[1] 0.004913157\n\nDescTools::GoodmanKruskalTau(tab10)\n\n[1] 0.00498861\n\nDescTools::KendallTauB(tab)\n\n[1] 0.1202322\n\nDescTools::KendallTauB(tab10)\n\n[1] 0.0933437\n\nDescTools::StuartTauC(tab)\n\n[1] 0.124738\n\nDescTools::StuartTauC(tab10)\n\n[1] 0.05978172\n\nDescTools::GoodmanKruskalGamma(tab)\n\n[1] 0.1542894\n\nDescTools::GoodmanKruskalGamma(tab10)\n\n[1] 0.1840237\n\nDescTools::SomersDelta(tab)\n\n[1] 0.1278381\n\nDescTools::SomersDelta(tab10)\n\n[1] 0.1015444\n\nDescTools::UncertCoef(tab)\n\n[1] 0.009135369\n\nDescTools::UncertCoef(tab10)\n\n[1] 0.008655116\n\n\nオッズ比に基づく尺度では表によって値は異ならない． Bouchet-Valat (2022) や Zhou (2015) を参照．\n\n# 2つの表をマージしたデータも作成\ntab_merge &lt;- dplyr::bind_rows(data.frame(as.table(tab)),\n                       data.frame(as.table(tab10)),\n         .id = \"Tab\") |&gt; \n  xtabs(Freq ~ SES + MHS + Tab, data = _)\ntab_merge\n\n, , Tab = 1\n\n   MHS\nSES well mild modelrate impared\n  A   64   94        58      46\n  B   57   94        54      40\n  C   57  105        65      60\n  D   72  141        77      94\n  E   36   97        54      78\n  F   21   71        54      71\n\n, , Tab = 2\n\n   MHS\nSES well mild modelrate impared\n  A  640   94        58      46\n  B 5700  940       540     400\n  C  570  105        65      60\n  D  720  141        77      94\n  E  360   97        54      78\n  F  210   71        54      71\n\n# intrinsic association coefficient\nlogmult::iac(tab, weighting = \"none\")\n\n[1] 1.022284\n\nlogmult::iac(tab10, weighting = \"none\")\n\n[1] 1.022284\n\nlogmult::iac(tab_merge, weighting = \"none\")\n\n       1        2 \n1.022284 1.022284 \n\n# Altham index\nlogmult::iac(tab, weighting = \"none\") * sqrt(nrow(tab) * ncol(tab)) * 2\n\n[1] 10.01629\n\nlogmult::iac(tab10, weighting = \"none\") * sqrt(nrow(tab) * ncol(tab)) * 2\n\n[1] 10.01629\n\nlogmult::iac(tab_merge, weighting = \"none\") * sqrt(nrow(tab) * ncol(tab)) * 2\n\n       1        2 \n10.01629 10.01629 \n\n# Shrinkage Estimation\nlogmult::iac(tab_merge, weighting=\"none\", shrink=TRUE) * sqrt(nrow(tab_merge) * ncol(tab_merge)) * 2 * 2\n\n       1        2 \n20.03259 20.03259 \n\n# Mean absolute odds ratio\nlogmult::maor(tab, weighting = \"uniform\")\n\n[1] 1.695377\n\nlogmult::maor(tab10, weighting = \"uniform\")\n\n[1] 1.695377\n\nlogmult::maor(tab_merge, weighting = \"uniform\")\n\n       1        2 \n1.695377 1.695377"
  },
  {
    "objectID": "2-Chapter_1.html#参考文献",
    "href": "2-Chapter_1.html#参考文献",
    "title": "1  第1章",
    "section": "参考文献",
    "text": "参考文献\n\n\n\n\n\n\nBouchet-Valat, Milan. 2022. “General Marginal-free Association Indices for Contingency Tables: From the Altham Index to the Intrinsic Association Coefficient.” Sociological Methods & Research 51 (1): 203–36. https://doi.org/10.1177/0049124119852389.\n\n\nZhou, Xiang. 2015. “Shrinkage Estimation of Log-odds Ratios for Comparing Mobility Tables.” Sociological Methodology 45 (1): 320–56. https://doi.org/10.1177/0081175015570097."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "『カテゴリカルデータのための連関モデル』",
    "section": "",
    "text": "はじめに"
  },
  {
    "objectID": "index.html#目的",
    "href": "index.html#目的",
    "title": "『カテゴリカルデータのための連関モデル』",
    "section": "目的",
    "text": "目的\nこのページは\n共立出版の「計量分析One Point」シリーズのひとつとして出版された\nRaymond Wong著・藤原翔訳．2023．『カテゴリカルデータの連関モデル』共立出版． のためのサポートページです．\n2023年11月29日販売\n\n\nhonto\n紀伊国屋書店ウェブストア\nTSUTAYAオンラインショッピング\n楽天ブックス\nAmazon\n\n本書の付録や補遺とすることも検討しましたが，Association Modelsは他のQuantitative Applications in the Social Sciences (QASS)に比べて分量が多いため（156ページ！），そしてRのバージョンアップやパッケージの更新などに備えるため，正誤表もあわせて公開するためにオンラインで公開することにしました．本書と関連した連関モデルの適用例の情報についても，このサポートページで補うことができればと思います．\nこのサポートページでは，特にRの基本的な操作方法と，Rを用いた連関分析の方法を紹介します．各章ごとにRの実行方法をまとめています．モデルの意味や結果の解釈などについては本書を参考にしてください．\nなおこのサポートページの内容は英語版のサポートページ が元になっています．そちらもぜひ参考にしてください．"
  },
  {
    "objectID": "index.html#rのスクリプト",
    "href": "index.html#rのスクリプト",
    "title": "『カテゴリカルデータのための連関モデル』",
    "section": "Rのスクリプト",
    "text": "Rのスクリプト\n本サポートページのスクリプトはそのままコピー・アンド・ペーストすることが可能です． スクリプトを選択してコピーしても良いですし，各スクリプトの右上の図をクリックしてもコピーされます．\n\nなおRのスクリプトについては 訳者のGitHubページ の scripts というフォルダに保存されているので，そちらを参照してください．Googleドライブにもスクリプトを保存しておきます．"
  },
  {
    "objectID": "index.html#正誤表",
    "href": "index.html#正誤表",
    "title": "『カテゴリカルデータのための連関モデル』",
    "section": "正誤表",
    "text": "正誤表\n\n原著 p. 133，Table 5.5，訳書 p. XX 表5.5のモデル1の\\(\\Delta\\)の値は3.85ではなく33.85です．（2023年11月7日）"
  },
  {
    "objectID": "index.html#サポートページバージョン情報",
    "href": "index.html#サポートページバージョン情報",
    "title": "『カテゴリカルデータのための連関モデル』",
    "section": "サポートページバージョン情報",
    "text": "サポートページバージョン情報\n\n2023年5月1日: version 0.1.\n2023年11月7日: version 0.2."
  },
  {
    "objectID": "4-Chapter_3.html#表3.1a",
    "href": "4-Chapter_3.html#表3.1a",
    "title": "3  第3章",
    "section": "3.1 表3.1A",
    "text": "3.1 表3.1A\n表3.1Aをまずベクトルとして入力する．\n\nlibrary(gnm)\n\n# 表3.1\nFreq &lt;- c(  9, 5, 5, 1,    1, 6, 5, 1,    2, 2, 2, 1,\n           17,13, 7, 4,   13,22, 9, 1,    7,13, 6, 2,\n            8,14, 6, 0,   10,29,10, 0,    5,14, 6, 2,\n           20,38,24, 8,   23,72,34,10,   17,67,36,12,\n            4,21,12, 4,    7,30, 9, 1,    9,19,14, 2,\n            2, 9, 8, 3,    1,16,19, 2,   11,28,28,11,\n            0, 1, 5, 0,    2, 3, 3, 2,    2, 7, 6, 6)\n\n次に行変数，列変数，層変数を入力する．gl(n = 水準数, k = 繰り返しの数, length = 長さ)を注意しながら設定する．\n\npolviews &lt;- gl(n = 7, k = 4*3, length = length(Freq))\nfefam &lt;- gl(n = 4, k = 1, length = length(Freq))\nnatfare &lt;- gl(n = 3, k = 4, length = length(Freq))\n\n対応しているのかを確認したければ，matrix形式で示すとよい．\n\nmatrix(polviews, nrow = 7, ncol = 12, byrow = TRUE)\n\n     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]\n[1,] \"1\"  \"1\"  \"1\"  \"1\"  \"1\"  \"1\"  \"1\"  \"1\"  \"1\"  \"1\"   \"1\"   \"1\"  \n[2,] \"2\"  \"2\"  \"2\"  \"2\"  \"2\"  \"2\"  \"2\"  \"2\"  \"2\"  \"2\"   \"2\"   \"2\"  \n[3,] \"3\"  \"3\"  \"3\"  \"3\"  \"3\"  \"3\"  \"3\"  \"3\"  \"3\"  \"3\"   \"3\"   \"3\"  \n[4,] \"4\"  \"4\"  \"4\"  \"4\"  \"4\"  \"4\"  \"4\"  \"4\"  \"4\"  \"4\"   \"4\"   \"4\"  \n[5,] \"5\"  \"5\"  \"5\"  \"5\"  \"5\"  \"5\"  \"5\"  \"5\"  \"5\"  \"5\"   \"5\"   \"5\"  \n[6,] \"6\"  \"6\"  \"6\"  \"6\"  \"6\"  \"6\"  \"6\"  \"6\"  \"6\"  \"6\"   \"6\"   \"6\"  \n[7,] \"7\"  \"7\"  \"7\"  \"7\"  \"7\"  \"7\"  \"7\"  \"7\"  \"7\"  \"7\"   \"7\"   \"7\"  \n\nmatrix(fefam, nrow = 7, ncol = 12, byrow = TRUE)\n\n     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]\n[1,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"   \"3\"   \"4\"  \n[2,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"   \"3\"   \"4\"  \n[3,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"   \"3\"   \"4\"  \n[4,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"   \"3\"   \"4\"  \n[5,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"   \"3\"   \"4\"  \n[6,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"   \"3\"   \"4\"  \n[7,] \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"  \"3\"  \"4\"  \"1\"  \"2\"   \"3\"   \"4\"  \n\nmatrix(natfare, nrow = 7, ncol = 12, byrow = TRUE)\n\n     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]\n[1,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\"  \"3\"  \"3\"   \"3\"   \"3\"  \n[2,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\"  \"3\"  \"3\"   \"3\"   \"3\"  \n[3,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\"  \"3\"  \"3\"   \"3\"   \"3\"  \n[4,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\"  \"3\"  \"3\"   \"3\"   \"3\"  \n[5,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\"  \"3\"  \"3\"   \"3\"   \"3\"  \n[6,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\"  \"3\"  \"3\"   \"3\"   \"3\"  \n[7,] \"1\"  \"1\"  \"1\"  \"1\"  \"2\"  \"2\"  \"2\"  \"2\"  \"3\"  \"3\"   \"3\"   \"3\"  \n\n\ntableのデータ（tab_3.1）とセルを単位としたデータ（freq_tab_3.1）を作成する．\n\ntab_3.1 &lt;- xtabs(Freq ~ polviews + fefam + natfare)\nfreq_tab_3.1 &lt;- tibble(Freq, polviews, fefam, natfare)\n\n表3.2のモデルで推定を行う．モデル6から8まではスコアパラメータの正則化が必要であるが，適合度については問題なく求めることができる．\n\n# Model 1 - 独立モデル\nM1 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ polviews + fefam + natfare,\n    family = poisson,\n    data = _,\n    trace = F,\n    tolerance = 1e-12\n  )\n\n# Model 2 - 完全2元交互作用モデル\nM2 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ polviews * fefam + fefam * natfare + polviews * natfare,\n    family = poisson,\n    data = _,\n    trace = F,\n    tolerance = 1e-12\n  )\n\n# Model 3 - 条件付き独立 (polviews)\nM3 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ polviews * fefam + polviews * natfare,\n    family = poisson,\n    data = _,\n    trace = F,\n    tolerance = 1e-12\n  )\n\n# Model 4 - 条件付き独立 (fefam)\nM4 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ polviews * fefam + fefam * natfare,\n    family = poisson,\n    data = _,\n    trace = F,\n    tolerance = 1e-12\n  )\n\n# Model 5 - 条件付き独立 (natfare)\nM5 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ fefam * natfare + polviews * natfare,\n    family = poisson,\n    data = _,\n    trace = F,\n    tolerance = 1e-12\n  )\n\n# Model 6 - RC(1)+RL(1) 部分連関\n# 値の正則化が必要\nM6 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ polviews + fefam + natfare + \n      Mult(1, polviews, fefam) + \n      Mult(1, polviews, natfare),\n    data = _,\n    family = poisson,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n.............\nDone\n\n# Model 7 - RC(1)+RL(1) 部分連関 (一貫した行スコア - polviews)\n# 値の正則化が必要\nM7 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ polviews + fefam + natfare + \n      Mult(1, polviews, fefam + natfare),\n    data = _,\n    family = poisson,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations................................................\nDone\n\n# Model 8 - RC(1)+RL(1) 部分連関 (一貫した行スコア - polviews)\n# 行スコアへの等値制約\n# 値の正則化が必要\n\n# 等値制約をかけたいセルの水準を同じにする\nfreq_tab_3.1 &lt;- freq_tab_3.1 |&gt; \n  mutate(polviews.c = case_when(polviews == 1 ~ 1,  # mu1 = mu2\n                                polviews == 2 ~ 1,  # mu1 = mu2\n                                polviews == 3 ~ 2,\n                                polviews == 4 ~ 3,  # mu4 = mu5\n                                polviews == 5 ~ 3,  # mu4 = mu5\n                                polviews == 6 ~ 4,\n                                polviews == 7 ~ 5) |&gt;\n           factor())\n\nM8 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ polviews + fefam + natfare + \n      Mult(1, polviews.c, fefam + natfare),\n    data = _,\n    family = poisson,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations......................................................\nDone\n\n\nモデル間の比較は次のように行う．\n\n# Model 3 と Model 2の比較\npchisq(q = M3$deviance - M2$deviance,\n       df = M3$df.residual - M2$df.residual,\n       lower.tail = FALSE)\n\n[1] 0.06425806\n\n# Model 6 と Model 3の比較\npchisq(q = M6$deviance - M3$deviance,\n       df = M6$df.residual - M3$df.residual,\n       lower.tail = FALSE)\n\n[1] 0.1266967\n\n# Model 13 と Model 8の比較\n## Model 13が推定できないため表の値を用いる\npchisq(q = 9.22,\n       df = 6,\n       lower.tail = FALSE)\n\n[1] 0.1615782"
  },
  {
    "objectID": "4-Chapter_3.html#表3.2",
    "href": "4-Chapter_3.html#表3.2",
    "title": "3  第3章",
    "section": "3.2 表3.2",
    "text": "3.2 表3.2\n表3.2を再現する．\n\n## 表3.2\n\n# リストを作成\nM &lt;- list()\n# モデルの適合度をリストに順に格納\nM[[1]] &lt;- model.summary(M1, \"1. Complete independence\") \nM[[2]] &lt;- model.summary(M2, \"2. Full two-way interaction\") \nM[[3]] &lt;- model.summary(M3, \"3. Conditional independence on POLVIEWS\") \nM[[4]] &lt;- model.summary(M4, \"4. Conditional independence on FEFAM\")\nM[[5]] &lt;- model.summary(M5, \"5. Conditional independence on NATFARE\")\nM[[6]] &lt;- model.summary(M6, \"6. RC(1) + RL(1) partial association\")\nM[[7]] &lt;- model.summary(M7, \"7. Model 6 plus consisitent row (POLVIEWS) score restrictions\")\nM[[8]] &lt;- model.summary(M8, \"8. Model 6 plus consisitent and equality restrictions on row (POLVIEWS) scores (mu_1 = mu_2, mu_4 = mu_5)\")\n# リストを行方向に合併する\nM |&gt; bind_rows()\n\n# A tibble: 8 × 6\n  `Model Description`                               df    L2   BIC Delta       p\n  &lt;chr&gt;                                          &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;\n1 1. Complete independence                          72 168.  -324. 14.1  1.37e-9\n2 2. Full two-way interaction                       36  35.4 -211.  5.72 4.99e-1\n3 3. Conditional independence on POLVIEWS           42  47.3 -240.  7.30 2.67e-1\n4 4. Conditional independence on FEFAM              48  87.3 -241. 10.3  4.50e-4\n5 5. Conditional independence on NATFARE            54  91.0 -278. 10.1  1.21e-3\n6 6. RC(1) + RL(1) partial association              57  68.6 -321.  8.83 1.40e-1\n7 7. Model 6 plus consisitent row (POLVIEWS) sc…    62  72.8 -351.  9.07 1.65e-1\n8 8. Model 6 plus consisitent and equality rest…    64  73.6 -364.  9.21 1.93e-1"
  },
  {
    "objectID": "4-Chapter_3.html#表3.3",
    "href": "4-Chapter_3.html#表3.3",
    "title": "3  第3章",
    "section": "3.3 表3.3",
    "text": "3.3 表3.3\n表3.3を再現するために，モデル6から8までのスコアパラメータの正則化を行う．\nまずはモデル6である．\n\n# Estimating standard error\n# Model 6\n\n# 変数と係数と係数の順番を表示\npickCoef(M6, \"[.]polviews\")\n\n  Mult(1, ., fefam).polviews1   Mult(1, ., fefam).polviews2 \n                           14                            15 \n  Mult(1, ., fefam).polviews3   Mult(1, ., fefam).polviews4 \n                           16                            17 \n  Mult(1, ., fefam).polviews5   Mult(1, ., fefam).polviews6 \n                           18                            19 \n  Mult(1, ., fefam).polviews7 Mult(1, ., natfare).polviews1 \n                           20                            26 \nMult(1, ., natfare).polviews2 Mult(1, ., natfare).polviews3 \n                           27                            28 \nMult(1, ., natfare).polviews4 Mult(1, ., natfare).polviews5 \n                           29                            30 \nMult(1, ., natfare).polviews6 Mult(1, ., natfare).polviews7 \n                           31                            32 \n\npickCoef(M6, \"[.]fefam\")\n\nMult(1, polviews, .).fefam1 Mult(1, polviews, .).fefam2 \n                         21                          22 \nMult(1, polviews, .).fefam3 Mult(1, polviews, .).fefam4 \n                         23                          24 \n\npickCoef(M6, \"[.]natfare\")\n\nMult(1, polviews, .).natfare1 Mult(1, polviews, .).natfare2 \n                           33                            34 \nMult(1, polviews, .).natfare3 \n                           35 \n\ndata.frame(var = names(M6$coefficients),\n           estimate = M6$coefficients) |&gt; \n  mutate(estimate = estimate,\n         number = row_number())\n\n                                                        var     estimate number\n(Intercept)                                     (Intercept)  0.447243697      1\npolviews2                                         polviews2  1.105422015      2\npolviews3                                         polviews3  1.061088971      3\npolviews4                                         polviews4  2.369565498      4\npolviews5                                         polviews5  1.357353275      5\npolviews6                                         polviews6  1.279706455      6\npolviews7                                         polviews7 -0.109150372      7\nfefam2                                               fefam2  0.989442619      8\nfefam3                                               fefam3  0.451330821      9\nfefam4                                               fefam4 -0.848799805     10\nnatfare2                                           natfare2  0.357509680     11\nnatfare3                                           natfare3  0.312209797     12\nMult(., polviews, fefam).         Mult(., polviews, fefam).  3.552415454     13\nMult(1, ., fefam).polviews1     Mult(1, ., fefam).polviews1 -0.140054449     14\nMult(1, ., fefam).polviews2     Mult(1, ., fefam).polviews2 -0.366427329     15\nMult(1, ., fefam).polviews3     Mult(1, ., fefam).polviews3 -0.289286748     16\nMult(1, ., fefam).polviews4     Mult(1, ., fefam).polviews4  0.009035523     17\nMult(1, ., fefam).polviews5     Mult(1, ., fefam).polviews5 -0.033070180     18\nMult(1, ., fefam).polviews6     Mult(1, ., fefam).polviews6  0.376743256     19\nMult(1, ., fefam).polviews7     Mult(1, ., fefam).polviews7  0.582941204     20\nMult(1, polviews, .).fefam1     Mult(1, polviews, .).fefam1 -0.413720496     21\nMult(1, polviews, .).fefam2     Mult(1, polviews, .).fefam2 -0.087890845     22\nMult(1, polviews, .).fefam3     Mult(1, polviews, .).fefam3  0.247204721     23\nMult(1, polviews, .).fefam4     Mult(1, polviews, .).fefam4  0.451483233     24\nMult(., polviews, natfare).     Mult(., polviews, natfare). -0.523745590     25\nMult(1, ., natfare).polviews1 Mult(1, ., natfare).polviews1 -5.018736321     26\nMult(1, ., natfare).polviews2 Mult(1, ., natfare).polviews2 -2.456036666     27\nMult(1, ., natfare).polviews3 Mult(1, ., natfare).polviews3 -1.549409876     28\nMult(1, ., natfare).polviews4 Mult(1, ., natfare).polviews4  0.177488070     29\nMult(1, ., natfare).polviews5 Mult(1, ., natfare).polviews5 -0.714664416     30\nMult(1, ., natfare).polviews6 Mult(1, ., natfare).polviews6  3.641396839     31\nMult(1, ., natfare).polviews7 Mult(1, ., natfare).polviews7  3.657508539     32\nMult(1, polviews, .).natfare1 Mult(1, polviews, .).natfare1  0.257674369     33\nMult(1, polviews, .).natfare2 Mult(1, polviews, .).natfare2  0.088436169     34\nMult(1, polviews, .).natfare3 Mult(1, polviews, .).natfare3 -0.276418550     35\n\n\n各スコアの両端のカテゴリ，つまり上記推定値のリストの 14,20,21,24,26,32,33,35番目の8つの値についてスコアを求め，固定する．\n\n# R POLVIEWS mu1[i], i = 1 to 7\nmu1 &lt;- getContrasts(M6, pickCoef(M6, \"fefam)[.]polviews\"),\n                    ref = \"mean\",\n                    scaleRef = \"mean\", \n                    scaleWeights = \"unit\")\n# C FEFAM nu[j], j = 1 to 4\nnu &lt;- getContrasts(M6, pickCoef(M6, \"[.]fefam\"), \n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\n# R POLVIEWS mu2[i], i = 1 to 7\nmu2 &lt;- getContrasts(M6, pickCoef(M6, \"natfare)[.]polviews\"), \n                    ref = \"mean\",\n                    scaleRef = \"mean\", \n                    scaleWeights = \"unit\")\n# L NATFARE eta[k], k = 1 to 3\neta &lt;- getContrasts(M6, pickCoef(M6, \"[.]natfare\"), \n                    ref = \"mean\",\n                    scaleRef = \"mean\", \n                    scaleWeights = \"unit\")\n\n# 確認 \nlist(mu1 = mu1, nu = nu, mu2 = mu2, eta = eta)\n\n$mu1\n                               Estimate Std. Error\nMult(1, ., fefam).polviews1 -0.18890704 0.17539812\nMult(1, ., fefam).polviews2 -0.45611586 0.11238050\nMult(1, ., fefam).polviews3 -0.36505971 0.11498236\nMult(1, ., fefam).polviews4 -0.01292237 0.08199631\nMult(1, ., fefam).polviews5 -0.06262362 0.11058185\nMult(1, ., fefam).polviews6  0.42111705 0.12367540\nMult(1, ., fefam).polviews7  0.66451154 0.10976226\n\n$nu\n                              Estimate Std. Error\nMult(1, polviews, .).fefam1 -0.7026886 0.06444123\nMult(1, polviews, .).fefam2 -0.2081705 0.09371704\nMult(1, polviews, .).fefam3  0.3004108 0.10956493\nMult(1, polviews, .).fefam4  0.6104483 0.09158453\n\n$mu2\n                                 Estimate Std. Error\nMult(1, ., natfare).polviews1 -0.60584367 0.12394769\nMult(1, ., natfare).polviews2 -0.27518966 0.11469790\nMult(1, ., natfare).polviews3 -0.15821154 0.11316687\nMult(1, ., natfare).polviews4  0.06460260 0.07187236\nMult(1, ., natfare).polviews5 -0.05050796 0.10030828\nMult(1, ., natfare).polviews6  0.51153570 0.10405220\nMult(1, ., natfare).polviews7  0.51361453 0.12512860\n\n$eta\n                                Estimate Std. Error\nMult(1, polviews, .).natfare1  0.6073482 0.07616839\nMult(1, polviews, .).natfare2  0.1689209 0.11149916\nMult(1, polviews, .).natfare3 -0.7762692 0.03533078\n\n\n正則化したスコアを求めることができたので， 各スコアの両端のカテゴリを取り出し，conとする．\n\ncon &lt;- c(mu1$qvframe[,1][c(1,7)], \n         nu$qvframe[,1][c(1,4)],\n         mu2$qvframe[,1][c(1,7)], \n         eta$qvframe[,1][c(1,3)])\n\nconを用いて制約を課す．制約のあるパラメータはconstrainで指定する．\n\nM6_SE &lt;- freq_tab_3.1 |&gt;\n  gnm(Freq ~ polviews + fefam + natfare + \n        Mult(1, polviews, fefam) + Mult(1, polviews, natfare),\n      constrain = c(14,20,21,24,26,32,33,35), \n      constrainTo = con,\n      data = _, \n      family = poisson, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n..........................\nDone\n\nM6_SE_coef &lt;- summary(M6_SE) |&gt;\n  coefficients() |&gt;\n  data.frame() |&gt;\n  rownames_to_column(var = \"Variable\")\nM6_SE_coef\n\n                        Variable    Estimate Std..Error     z.value\n1                    (Intercept)  0.49061305  0.2714613  1.80730399\n2                      polviews2  1.03462096  0.2286800  4.52431800\n3                      polviews3  0.99275852  0.2260565  4.39163963\n4                      polviews4  2.33243766  0.2118135 11.01174909\n5                      polviews5  1.32371069  0.2178840  6.07530027\n6                      polviews6  1.26479125  0.2817072  4.48973712\n7                      polviews7 -0.08817192  0.3550448 -0.24834026\n8                         fefam2  1.01257263  0.1875433  5.39913927\n9                         fefam3  0.49824862  0.3404100  1.46367194\n10                        fefam4 -0.78738067  0.4491457 -1.75306289\n11                      natfare2  0.32886127  0.1265360  2.59895340\n12                      natfare3  0.22179929  0.3142052  0.70590598\n13     Mult(., polviews, fefam).  1.98292236  0.7444158  2.66372963\n14   Mult(1, ., fefam).polviews1 -0.18890704         NA          NA\n15   Mult(1, ., fefam).polviews2 -0.45611586  0.3084481 -1.47874449\n16   Mult(1, ., fefam).polviews3 -0.36505971  0.2850040 -1.28089339\n17   Mult(1, ., fefam).polviews4 -0.01292237  0.1836908 -0.07034845\n18   Mult(1, ., fefam).polviews5 -0.06262362  0.2116102 -0.29593861\n19   Mult(1, ., fefam).polviews6  0.42111705  0.2048749  2.05548422\n20   Mult(1, ., fefam).polviews7  0.66451154         NA          NA\n21   Mult(1, polviews, .).fefam1 -0.70268861         NA          NA\n22   Mult(1, polviews, .).fefam2 -0.20817046  0.1521823 -1.36790202\n23   Mult(1, polviews, .).fefam3  0.30041075  0.1850933  1.62302311\n24   Mult(1, polviews, .).fefam4  0.61044832         NA          NA\n25   Mult(., polviews, natfare). -1.56691378  0.4052719 -3.86632725\n26 Mult(1, ., natfare).polviews1 -0.60584367         NA          NA\n27 Mult(1, ., natfare).polviews2 -0.27518966  0.1998376 -1.37706660\n28 Mult(1, ., natfare).polviews3 -0.15821154  0.1910651 -0.82805039\n29 Mult(1, ., natfare).polviews4  0.06460260  0.1559375  0.41428510\n30 Mult(1, ., natfare).polviews5 -0.05050796  0.1767772 -0.28571539\n31 Mult(1, ., natfare).polviews6  0.51153570  0.2109300  2.42514436\n32 Mult(1, ., natfare).polviews7  0.51361453         NA          NA\n33 Mult(1, polviews, .).natfare1  0.60734824         NA          NA\n34 Mult(1, polviews, .).natfare2  0.16892093  0.1747273  0.96676884\n35 Mult(1, polviews, .).natfare3 -0.77626917         NA          NA\n       Pr...z..\n1  7.071489e-02\n2  6.059057e-06\n3  1.124990e-05\n4  3.354276e-28\n5  1.237559e-09\n6  7.131113e-06\n7  8.038712e-01\n8  6.696138e-08\n9  1.432836e-01\n10 7.959121e-02\n11 9.350847e-03\n12 4.802466e-01\n13 7.727965e-03\n14           NA\n15 1.392086e-01\n16 2.002311e-01\n17 9.439163e-01\n18 7.672770e-01\n19 3.983226e-02\n20           NA\n21           NA\n22 1.713427e-01\n23 1.045845e-01\n24           NA\n25 1.104867e-04\n26           NA\n27 1.684917e-01\n28 4.076420e-01\n29 6.786653e-01\n30 7.750961e-01\n31 1.530230e-02\n32           NA\n33           NA\n34 3.336596e-01\n35           NA\n\n\nモデル7はすこし難しい．モデル7は一貫した制約を課している．このモデルからまず一貫したpolviewsについて正則化した場合の値を求める．これが求まったら，次は一貫した制約を課していないモデルに，先ほどの正則化したスコアをRCとRLのそれぞれの部分に適用する．\n\n# Model 7\n\n# 変数と係数と係数の順番を表示\npickCoef(M7, \"[.]polviews\")\n\nMult(1, ., fefam + natfare).polviews1 Mult(1, ., fefam + natfare).polviews2 \n                                   14                                    15 \nMult(1, ., fefam + natfare).polviews3 Mult(1, ., fefam + natfare).polviews4 \n                                   16                                    17 \nMult(1, ., fefam + natfare).polviews5 Mult(1, ., fefam + natfare).polviews6 \n                                   18                                    19 \nMult(1, ., fefam + natfare).polviews7 \n                                   20 \n\npickCoef(M7, \"[.]fefam\")\n\nMult(1, polviews, . + natfare).fefam1 Mult(1, polviews, . + natfare).fefam2 \n                                   21                                    22 \nMult(1, polviews, . + natfare).fefam3 Mult(1, polviews, . + natfare).fefam4 \n                                   23                                    24 \n\npickCoef(M7, \"[.]natfare\")\n\nMult(1, polviews, fefam + .).natfare2 Mult(1, polviews, fefam + .).natfare3 \n                                   25                                    26 \n\ndata.frame(var = names(M7$coefficients),\n           estimate = M7$coefficients) |&gt; \n  mutate(estimate = estimate,\n         number = row_number())\n\n                                                                        var\n(Intercept)                                                     (Intercept)\npolviews2                                                         polviews2\npolviews3                                                         polviews3\npolviews4                                                         polviews4\npolviews5                                                         polviews5\npolviews6                                                         polviews6\npolviews7                                                         polviews7\nfefam2                                                               fefam2\nfefam3                                                               fefam3\nfefam4                                                               fefam4\nnatfare2                                                           natfare2\nnatfare3                                                           natfare3\nMult(., polviews, fefam + natfare).     Mult(., polviews, fefam + natfare).\nMult(1, ., fefam + natfare).polviews1 Mult(1, ., fefam + natfare).polviews1\nMult(1, ., fefam + natfare).polviews2 Mult(1, ., fefam + natfare).polviews2\nMult(1, ., fefam + natfare).polviews3 Mult(1, ., fefam + natfare).polviews3\nMult(1, ., fefam + natfare).polviews4 Mult(1, ., fefam + natfare).polviews4\nMult(1, ., fefam + natfare).polviews5 Mult(1, ., fefam + natfare).polviews5\nMult(1, ., fefam + natfare).polviews6 Mult(1, ., fefam + natfare).polviews6\nMult(1, ., fefam + natfare).polviews7 Mult(1, ., fefam + natfare).polviews7\nMult(1, polviews, . + natfare).fefam1 Mult(1, polviews, . + natfare).fefam1\nMult(1, polviews, . + natfare).fefam2 Mult(1, polviews, . + natfare).fefam2\nMult(1, polviews, . + natfare).fefam3 Mult(1, polviews, . + natfare).fefam3\nMult(1, polviews, . + natfare).fefam4 Mult(1, polviews, . + natfare).fefam4\nMult(1, polviews, fefam + .).natfare2 Mult(1, polviews, fefam + .).natfare2\nMult(1, polviews, fefam + .).natfare3 Mult(1, polviews, fefam + .).natfare3\n                                         estimate number\n(Intercept)                            0.56785754      1\npolviews2                              1.05466852      2\npolviews3                              0.98494895      3\npolviews4                              2.21226434      4\npolviews5                              1.22187297      5\npolviews6                              1.00174155      6\npolviews7                             -0.40879836      7\nfefam2                                 1.01206305      8\nfefam3                                 0.48820517      9\nfefam4                                -0.79591290     10\nnatfare2                               0.35880883     11\nnatfare3                               0.34159399     12\nMult(., polviews, fefam + natfare).   -1.22929491     13\nMult(1, ., fefam + natfare).polviews1 -1.37811654     14\nMult(1, ., fefam + natfare).polviews2 -1.29314237     15\nMult(1, ., fefam + natfare).polviews3 -0.92663722     16\nMult(1, ., fefam + natfare).polviews4  0.00342994     17\nMult(1, ., fefam + natfare).polviews5 -0.25707670     18\nMult(1, ., fefam + natfare).polviews6  1.46863683     19\nMult(1, ., fefam + natfare).polviews7  1.80309805     20\nMult(1, polviews, . + natfare).fefam1  0.50600590     21\nMult(1, polviews, . + natfare).fefam2  0.22507861     22\nMult(1, polviews, . + natfare).fefam3 -0.01436004     23\nMult(1, polviews, . + natfare).fefam4 -0.16039623     24\nMult(1, polviews, fefam + .).natfare2 -0.13888490     25\nMult(1, polviews, fefam + .).natfare3 -0.50956617     26\n\n# mu[i], i = 1 to 7\nmu &lt;- getContrasts(M7, pickCoef(M7, \"[.]polviews\")[1:7], \n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\n\ncon &lt;- c(mu$qvframe[,1][c(1:7)], \n         mu$qvframe[,1][c(1:7)])\n\nここでは一貫した制約を課さないモデルを用い，制約で一貫したスコアを割り当てる．そして，制約のない列スコアと層スコアを正則化する．\n\nM7_SE &lt;- freq_tab_3.1 |&gt;\n  gnm(Freq ~ polviews + fefam + natfare + \n        Mult(1, polviews, fefam) + \n        Mult(1, polviews, natfare),\n      constrain = c(14:20, 26:32), \n      constrainTo = con,\n      data = _, \n      family = poisson, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...\nDone\n\n# nu[j], j = 1 to 4\nnu &lt;- getContrasts(M7_SE, \n                   pickCoef(M7_SE, \"[.]fefam\"), \n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\n# eta[k], k = 1 to 3\neta &lt;- getContrasts(M7_SE, \n                    pickCoef(M7_SE, \"[.]natfare\"), \n                    ref = \"mean\",\n                    scaleRef = \"mean\", \n                    scaleWeights = \"unit\")\n\ncon &lt;- c(mu$qvframe[,1][c(1:7)], \n         nu$qvframe[,1][c(1,4)],\n         mu$qvframe[,1][c(1:7)], \n         eta$qvframe[,1][c(1,3)])\n\n最後に一貫したスコア（行）と正則化したスコア（列と層）を用いて再度推定を行う．\n\nM7_SE &lt;- freq_tab_3.1 |&gt;\n  gnm(Freq ~ polviews + fefam + natfare + \n        Mult(1, polviews, fefam) + \n        Mult(1, polviews, natfare),\n      constrain = c(14:20,21,24,26:32,33,35), \n      constrainTo = con,\n      data = _, \n      family = poisson, \n      trace = T, \n      tolerance = 1e-12)\n\nInitialising\nInitial Deviance = 180.513172\nRunning start-up iterations\nStart-up iteration 1. Deviance = 76.905089\nStart-up iteration 2. Deviance = 73.153885\nRunning main iterations\nIteration 1. Deviance = 72.775726\nIteration 2. Deviance = 72.773834\nIteration 3. Deviance = 72.773834\nIteration 4. Deviance = 72.773834\nIteration 5. Deviance = 72.773834\nIteration 6. Deviance = 72.773834\nIteration 7. Deviance = 72.773834\nIteration 8. Deviance = 72.773834\nIteration 9. Deviance = 72.773834\nIteration 10. Deviance = 72.773834\nIteration 11. Deviance = 72.773834\nIteration 12. Deviance = 72.773834\nIteration 13. Deviance = 72.773834\nIteration 14. Deviance = 72.773834\nDone\n\nM7_SE_coef &lt;- summary(M7_SE) |&gt;\n  coefficients() |&gt;\n  data.frame() |&gt;\n  rownames_to_column(var = \"Variable\")\nM7_SE_coef\n\n                        Variable    Estimate Std..Error    z.value     Pr...z..\n1                    (Intercept)  0.49666511 0.19953839  2.4890704 1.280776e-02\n2                      polviews2  1.06271894 0.18389893  5.7788206 7.522608e-09\n3                      polviews3  1.02772195 0.18956295  5.4215339 5.908980e-08\n4                      polviews4  2.34315159 0.19992980 11.7198714 1.008250e-31\n5                      polviews5  1.32807991 0.20159537  6.5878491 4.462438e-11\n6                      polviews6  1.27144201 0.28745747  4.4230613 9.731214e-06\n7                      polviews7 -0.10741116 0.33836457 -0.3174421 7.509082e-01\n8                         fefam2  0.98345843 0.09473194 10.3814869 3.010493e-25\n9                         fefam3  0.43522039 0.10374979  4.1949037 2.729875e-05\n10                        fefam4 -0.86376740 0.14958265 -5.7745158 7.717469e-09\n11                      natfare2  0.34466727 0.08525038  4.0429996 5.277172e-05\n12                      natfare3  0.28970887 0.08687606  3.3347378 8.537987e-04\n13     Mult(., polviews, fefam). -1.94985651 0.37444868 -5.2072730 1.916361e-07\n14   Mult(1, ., fefam).polviews1 -0.41258265         NA         NA           NA\n15   Mult(1, ., fefam).polviews2 -0.38551616         NA         NA           NA\n16   Mult(1, ., fefam).polviews3 -0.26877471         NA         NA           NA\n17   Mult(1, ., fefam).polviews4  0.02747595         NA         NA           NA\n18   Mult(1, ., fefam).polviews5 -0.05550221         NA         NA           NA\n19   Mult(1, ., fefam).polviews6  0.49418258         NA         NA           NA\n20   Mult(1, ., fefam).polviews7  0.60071720         NA         NA           NA\n21   Mult(1, polviews, .).fefam1  0.72624699         NA         NA           NA\n22   Mult(1, polviews, .).fefam2  0.17021171 0.14950096  1.1385325 2.548982e-01\n23   Mult(1, polviews, .).fefam3 -0.30370570 0.18912635 -1.6058350 1.083102e-01\n24   Mult(1, polviews, .).fefam4 -0.59275300         NA         NA           NA\n25   Mult(., polviews, natfare).  1.43774015 0.22609189  6.3590965 2.029439e-10\n26 Mult(1, ., natfare).polviews1 -0.41258265         NA         NA           NA\n27 Mult(1, ., natfare).polviews2 -0.38551616         NA         NA           NA\n28 Mult(1, ., natfare).polviews3 -0.26877471         NA         NA           NA\n29 Mult(1, ., natfare).polviews4  0.02747595         NA         NA           NA\n30 Mult(1, ., natfare).polviews5 -0.05550221         NA         NA           NA\n31 Mult(1, ., natfare).polviews6  0.49418258         NA         NA           NA\n32 Mult(1, ., natfare).polviews7  0.60071720         NA         NA           NA\n33 Mult(1, polviews, .).natfare1 -0.58021189         NA         NA           NA\n34 Mult(1, polviews, .).natfare2 -0.20740348 0.18571219 -1.1168006 2.640796e-01\n35 Mult(1, polviews, .).natfare3  0.78761536         NA         NA           NA\n\n\nモデル8は1,1,2,3,3,4,5という制約があり，結局は1,2,3,4,5の5つのパラメータを推定することになる．しかし，あくまで1,1,2,3,3,4,5という7つのパラメータにウェイトをかける必要がある．そこでc(2,1,2,1,1)/7とすることで，等値制約をかけている部分は平均を2倍にし，c(2,1,2,1,1)とすることでウェイトも2倍にしている．\n\n# Model 8\n# mu[i], i = 1 to 7\nmu &lt;- getContrasts(M8, \n                   pickCoef(M8, \"[.]polviews.c\"),\n                   ref = c(2, 1, 2, 1, 1) / 7,\n                   scaleRef = c(2, 1, 2, 1, 1) / 7,\n                   scaleWeights = c(2, 1, 2, 1, 1))\n\nmu &lt;- getContrasts(M8,\n                   pickCoef(M8, \"[.]polviews.c\"),\n                   ref = c(2, 1, 2, 1, 1) / 7,\n                   scaleRef = c(2, 1, 2, 1, 1) / 7,\n                   scaleWeights = c(2, 1, 2, 1, 1))\nmu;mu\n\n                                            Estimate Std. Error\nMult(1, ., fefam + natfare).polviews.c1  0.402725149 0.04298356\nMult(1, ., fefam + natfare).polviews.c2  0.278981096 0.08172199\nMult(1, ., fefam + natfare).polviews.c3  0.001961895 0.04688021\nMult(1, ., fefam + natfare).polviews.c4 -0.491602614 0.08428340\nMult(1, ., fefam + natfare).polviews.c5 -0.596752569 0.08715205\n\n\n                                            Estimate Std. Error\nMult(1, ., fefam + natfare).polviews.c1  0.402725149 0.04298356\nMult(1, ., fefam + natfare).polviews.c2  0.278981096 0.08172199\nMult(1, ., fefam + natfare).polviews.c3  0.001961895 0.04688021\nMult(1, ., fefam + natfare).polviews.c4 -0.491602614 0.08428340\nMult(1, ., fefam + natfare).polviews.c5 -0.596752569 0.08715205\n\ncon &lt;- c(mu$qvframe[, 1][c(1, 1, 2, 3, 3, 4, 5)], \n         mu$qvframe[, 1][c(1, 1, 2, 3, 3, 4, 5)])\n\n一貫した行スコア（等値制約あり）を指定して再推定．\n\nM8 &lt;- freq_tab_3.1 |&gt; \n  gnm(Freq ~ polviews + fefam + natfare + \n        Mult(1, polviews, fefam) + \n        Mult(1, polviews, natfare),\n      constrain = c(14:20,26:32),\n      constrainTo = con,\n      data = _, \n      family = poisson, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations...\nDone\n\nsummary(M8)\n\n\nCall:\ngnm(formula = Freq ~ polviews + fefam + natfare + Mult(1, polviews, \n    fefam) + Mult(1, polviews, natfare), constrain = c(14:20, \n    26:32), constrainTo = con, family = poisson, data = freq_tab_3.1, \n    tolerance = 1e-12)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-2.09613  -0.69364  -0.06107   0.52149   2.13382  \n\nCoefficients:\n                               Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)                    0.486965         NA      NA       NA    \npolviews2                      1.047319   0.183771   5.699 1.20e-08 ***\npolviews3                      1.017343         NA      NA       NA    \npolviews4                      2.334810         NA      NA       NA    \npolviews5                      1.328734         NA      NA       NA    \npolviews6                      1.270198         NA      NA       NA    \npolviews7                     -0.105922         NA      NA       NA    \nfefam2                         0.993418   0.095568  10.395  &lt; 2e-16 ***\nfefam3                         0.451237   0.104313   4.326 1.52e-05 ***\nfefam4                        -0.839900   0.148980  -5.638 1.72e-08 ***\nnatfare2                       0.345798   0.085610   4.039 5.36e-05 ***\nnatfare3                       0.302261   0.086847   3.480 0.000501 ***\nMult(., polviews, fefam).      2.283340         NA      NA       NA    \nMult(1, ., fefam).polviews1    0.402725         NA      NA       NA    \nMult(1, ., fefam).polviews2    0.402725         NA      NA       NA    \nMult(1, ., fefam).polviews3    0.278981         NA      NA       NA    \nMult(1, ., fefam).polviews4    0.001962         NA      NA       NA    \nMult(1, ., fefam).polviews5    0.001962         NA      NA       NA    \nMult(1, ., fefam).polviews6   -0.491603         NA      NA       NA    \nMult(1, ., fefam).polviews7   -0.596753         NA      NA       NA    \nMult(1, polviews, .).fefam1    0.567564         NA      NA       NA    \nMult(1, polviews, .).fefam2    0.082697         NA      NA       NA    \nMult(1, polviews, .).fefam3   -0.321585         NA      NA       NA    \nMult(1, polviews, .).fefam4   -0.550635         NA      NA       NA    \nMult(., polviews, natfare).    4.903464         NA      NA       NA    \nMult(1, ., natfare).polviews1  0.402725         NA      NA       NA    \nMult(1, ., natfare).polviews2  0.402725         NA      NA       NA    \nMult(1, ., natfare).polviews3  0.278981         NA      NA       NA    \nMult(1, ., natfare).polviews4  0.001962         NA      NA       NA    \nMult(1, ., natfare).polviews5  0.001962         NA      NA       NA    \nMult(1, ., natfare).polviews6 -0.491603         NA      NA       NA    \nMult(1, ., natfare).polviews7 -0.596753         NA      NA       NA    \nMult(1, polviews, .).natfare1  0.193332         NA      NA       NA    \nMult(1, polviews, .).natfare2  0.093270         NA      NA       NA    \nMult(1, polviews, .).natfare3 -0.198556         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 73.594 on 67 degrees of freedom\nAIC: 411.62\n\nNumber of iterations: 3\n\n\n次は列スコアと層スコアの正則化をおこなう．\n\n# nu[j], j = 1 to 4\nnu &lt;- getContrasts(M8, \n                   pickCoef(M8, \"[.]fefam\"), \n                   ref = \"mean\",\n                   scaleRef = \"mean\", \n                   scaleWeights = \"unit\")\n\n# eta[k], k = 1 to 3\neta &lt;- getContrasts(M8, \n                    pickCoef(M8, \"[.]natfare\"), \n                    ref = \"mean\",\n                    scaleRef = \"mean\", \n                    scaleWeights = \"unit\")\n\ncon &lt;- c(mu$qvframe[,1][c(1,1,2,3,3,4,5)], \n         nu$qvframe[,1][c(1,4)],\n         mu$qvframe[,1][c(1,1,2,3,3,4,5)], \n         eta$qvframe[,1][c(1,3)])\n\n一貫した行スコア（等値制約あり）のすべて，列スコア（最初と最後），層スコア（最初と最後）を指定して再推定．\n\nM8_SE &lt;- freq_tab_3.1 |&gt; \n  gnm(Freq ~ polviews + fefam + natfare + \n        Mult(1, polviews, fefam) + \n        Mult(1, polviews, natfare),\n      constrain = c(14:20,21,24,26:32,33,35), \n      constrainTo = con,\n      data = _, \n      family = poisson, \n      tolerance = 1e-12)\n\nInitialising\nRunning start-up iterations..\nRunning main iterations....\nDone\n\nM8_SE_coef &lt;- summary(M8_SE) |&gt;\n  coefficients() |&gt;\n  data.frame() |&gt;\n  rownames_to_column(var = \"Variable\")\nM8_SE_coef\n\n                        Variable     Estimate Std..Error    z.value\n1                    (Intercept)  0.493895139 0.19859016  2.4870071\n2                      polviews2  1.047318994 0.18377141  5.6990313\n3                      polviews3  1.015213949 0.18866665  5.3809931\n4                      polviews4  2.327913419 0.19476832 11.9522182\n5                      polviews5  1.321837383 0.20673745  6.3937976\n6                      polviews6  1.254808219 0.28561174  4.3934056\n7                      polviews7 -0.123120652 0.33655821 -0.3658228\n8                         fefam2  0.993417594 0.09556828 10.3948467\n9                         fefam3  0.451236835 0.10431337  4.3257815\n10                        fefam4 -0.839899708 0.14897993 -5.6376702\n11                      natfare2  0.345798040 0.08561002  4.0392239\n12                      natfare3  0.302261247 0.08684722  3.4803790\n13     Mult(., polviews, fefam).  1.941869008 0.37449253  5.1853344\n14   Mult(1, ., fefam).polviews1  0.402725149         NA         NA\n15   Mult(1, ., fefam).polviews2  0.402725149         NA         NA\n16   Mult(1, ., fefam).polviews3  0.278981096         NA         NA\n17   Mult(1, ., fefam).polviews4  0.001961895         NA         NA\n18   Mult(1, ., fefam).polviews5  0.001961895         NA         NA\n19   Mult(1, ., fefam).polviews6 -0.491602614         NA         NA\n20   Mult(1, ., fefam).polviews7 -0.596752569         NA         NA\n21   Mult(1, polviews, .).fefam1  0.732615689         NA         NA\n22   Mult(1, polviews, .).fefam2  0.162486357 0.14986223  1.0842382\n23   Mult(1, polviews, .).fefam3 -0.312887371 0.19082765 -1.6396333\n24   Mult(1, polviews, .).fefam4 -0.582214676         NA         NA\n25   Mult(., polviews, natfare).  1.411968172 0.22580482  6.2530472\n26 Mult(1, ., natfare).polviews1  0.402725149         NA         NA\n27 Mult(1, ., natfare).polviews2  0.402725149         NA         NA\n28 Mult(1, ., natfare).polviews3  0.278981096         NA         NA\n29 Mult(1, ., natfare).polviews4  0.001961895         NA         NA\n30 Mult(1, ., natfare).polviews5  0.001961895         NA         NA\n31 Mult(1, ., natfare).polviews6 -0.491602614         NA         NA\n32 Mult(1, ., natfare).polviews7 -0.596752569         NA         NA\n33 Mult(1, polviews, .).natfare1  0.569479796         NA         NA\n34 Mult(1, polviews, .).natfare2  0.221984457 0.18989352  1.1689943\n35 Mult(1, polviews, .).natfare3 -0.791464253         NA         NA\n       Pr...z..\n1  1.288228e-02\n2  1.204901e-08\n3  7.407603e-08\n4  6.321508e-33\n5  1.618156e-10\n6  1.115886e-05\n7  7.144973e-01\n8  2.617075e-25\n9  1.519920e-05\n10 1.723662e-08\n11 5.362835e-05\n12 5.007049e-04\n13 2.156276e-07\n14           NA\n15           NA\n16           NA\n17           NA\n18           NA\n19           NA\n20           NA\n21           NA\n22 2.782592e-01\n23 1.010814e-01\n24           NA\n25 4.025205e-10\n26           NA\n27           NA\n28           NA\n29           NA\n30           NA\n31           NA\n32           NA\n33           NA\n34 2.424059e-01\n35           NA\n\n\nすべてのスコアを列方向に合併し，表3.3を再現．\n\nbind_cols(\nM6_SE_coef |&gt; dplyr::select(Variable, Model6 = Estimate),\nM7_SE_coef |&gt; dplyr::select(Model7 = Estimate),\nM8_SE_coef |&gt; dplyr::select(Model8 = Estimate)) |&gt;\n  dplyr::filter(grepl(\"Mult\",Variable))\n\n                        Variable      Model6      Model7       Model8\n1      Mult(., polviews, fefam).  1.98292236 -1.94985651  1.941869008\n2    Mult(1, ., fefam).polviews1 -0.18890704 -0.41258265  0.402725149\n3    Mult(1, ., fefam).polviews2 -0.45611586 -0.38551616  0.402725149\n4    Mult(1, ., fefam).polviews3 -0.36505971 -0.26877471  0.278981096\n5    Mult(1, ., fefam).polviews4 -0.01292237  0.02747595  0.001961895\n6    Mult(1, ., fefam).polviews5 -0.06262362 -0.05550221  0.001961895\n7    Mult(1, ., fefam).polviews6  0.42111705  0.49418258 -0.491602614\n8    Mult(1, ., fefam).polviews7  0.66451154  0.60071720 -0.596752569\n9    Mult(1, polviews, .).fefam1 -0.70268861  0.72624699  0.732615689\n10   Mult(1, polviews, .).fefam2 -0.20817046  0.17021171  0.162486357\n11   Mult(1, polviews, .).fefam3  0.30041075 -0.30370570 -0.312887371\n12   Mult(1, polviews, .).fefam4  0.61044832 -0.59275300 -0.582214676\n13   Mult(., polviews, natfare). -1.56691378  1.43774015  1.411968172\n14 Mult(1, ., natfare).polviews1 -0.60584367 -0.41258265  0.402725149\n15 Mult(1, ., natfare).polviews2 -0.27518966 -0.38551616  0.402725149\n16 Mult(1, ., natfare).polviews3 -0.15821154 -0.26877471  0.278981096\n17 Mult(1, ., natfare).polviews4  0.06460260  0.02747595  0.001961895\n18 Mult(1, ., natfare).polviews5 -0.05050796 -0.05550221  0.001961895\n19 Mult(1, ., natfare).polviews6  0.51153570  0.49418258 -0.491602614\n20 Mult(1, ., natfare).polviews7  0.51361453  0.60071720 -0.596752569\n21 Mult(1, polviews, .).natfare1  0.60734824 -0.58021189  0.569479796\n22 Mult(1, polviews, .).natfare2  0.16892093 -0.20740348  0.221984457\n23 Mult(1, polviews, .).natfare3 -0.77626917  0.78761536 -0.791464253"
  },
  {
    "objectID": "4-Chapter_3.html#表3.4",
    "href": "4-Chapter_3.html#表3.4",
    "title": "3  第3章",
    "section": "3.4 表3.4",
    "text": "3.4 表3.4\n表3.4のデータを入力する．\n\n# 表3.1\nFreq &lt;- c(76, 14, 15,  4,\n        32, 17,  7,  3,\n        64, 23, 28, 15,\n        41, 11, 27, 16,\n        15,  2,  7,  4,\n        27, 20,  9,  5,\n        57, 31, 24, 15,\n        27,  9, 22, 16,\n        13,  6, 13,  5,\n        12, 13, 10,  6,\n        46, 32, 75, 20,\n        54, 26, 58, 55,\n        7,  6,  7,  6,\n        7,  2,  3,  6,\n        12, 11, 31, 15,\n        52, 36, 80,101)\n\n行，列，層のカテゴリを入力し，matrixで確認する．\n\nL &lt;- gl(4, 16, 64)\nR &lt;- gl(4, 4, 64)\nC &lt;- gl(4, 1, 64)\n\n# 確認する\nL |&gt; matrix(nrow = 16, ncol = 4, byrow = TRUE)\n\n      [,1] [,2] [,3] [,4]\n [1,] \"1\"  \"1\"  \"1\"  \"1\" \n [2,] \"1\"  \"1\"  \"1\"  \"1\" \n [3,] \"1\"  \"1\"  \"1\"  \"1\" \n [4,] \"1\"  \"1\"  \"1\"  \"1\" \n [5,] \"2\"  \"2\"  \"2\"  \"2\" \n [6,] \"2\"  \"2\"  \"2\"  \"2\" \n [7,] \"2\"  \"2\"  \"2\"  \"2\" \n [8,] \"2\"  \"2\"  \"2\"  \"2\" \n [9,] \"3\"  \"3\"  \"3\"  \"3\" \n[10,] \"3\"  \"3\"  \"3\"  \"3\" \n[11,] \"3\"  \"3\"  \"3\"  \"3\" \n[12,] \"3\"  \"3\"  \"3\"  \"3\" \n[13,] \"4\"  \"4\"  \"4\"  \"4\" \n[14,] \"4\"  \"4\"  \"4\"  \"4\" \n[15,] \"4\"  \"4\"  \"4\"  \"4\" \n[16,] \"4\"  \"4\"  \"4\"  \"4\" \n\nR |&gt; matrix(nrow = 16, ncol = 4, byrow = TRUE)\n\n      [,1] [,2] [,3] [,4]\n [1,] \"1\"  \"1\"  \"1\"  \"1\" \n [2,] \"2\"  \"2\"  \"2\"  \"2\" \n [3,] \"3\"  \"3\"  \"3\"  \"3\" \n [4,] \"4\"  \"4\"  \"4\"  \"4\" \n [5,] \"1\"  \"1\"  \"1\"  \"1\" \n [6,] \"2\"  \"2\"  \"2\"  \"2\" \n [7,] \"3\"  \"3\"  \"3\"  \"3\" \n [8,] \"4\"  \"4\"  \"4\"  \"4\" \n [9,] \"1\"  \"1\"  \"1\"  \"1\" \n[10,] \"2\"  \"2\"  \"2\"  \"2\" \n[11,] \"3\"  \"3\"  \"3\"  \"3\" \n[12,] \"4\"  \"4\"  \"4\"  \"4\" \n[13,] \"1\"  \"1\"  \"1\"  \"1\" \n[14,] \"2\"  \"2\"  \"2\"  \"2\" \n[15,] \"3\"  \"3\"  \"3\"  \"3\" \n[16,] \"4\"  \"4\"  \"4\"  \"4\" \n\nC |&gt; matrix(nrow = 16, ncol = 4, byrow = TRUE)\n\n      [,1] [,2] [,3] [,4]\n [1,] \"1\"  \"2\"  \"3\"  \"4\" \n [2,] \"1\"  \"2\"  \"3\"  \"4\" \n [3,] \"1\"  \"2\"  \"3\"  \"4\" \n [4,] \"1\"  \"2\"  \"3\"  \"4\" \n [5,] \"1\"  \"2\"  \"3\"  \"4\" \n [6,] \"1\"  \"2\"  \"3\"  \"4\" \n [7,] \"1\"  \"2\"  \"3\"  \"4\" \n [8,] \"1\"  \"2\"  \"3\"  \"4\" \n [9,] \"1\"  \"2\"  \"3\"  \"4\" \n[10,] \"1\"  \"2\"  \"3\"  \"4\" \n[11,] \"1\"  \"2\"  \"3\"  \"4\" \n[12,] \"1\"  \"2\"  \"3\"  \"4\" \n[13,] \"1\"  \"2\"  \"3\"  \"4\" \n[14,] \"1\"  \"2\"  \"3\"  \"4\" \n[15,] \"1\"  \"2\"  \"3\"  \"4\" \n[16,] \"1\"  \"2\"  \"3\"  \"4\" \n\n\n以上をtibbleでまとめ，データを作成する．\n\nfreq_tab_3.1 &lt;- tibble(Freq, L, R, C) |&gt; arrange(L, R, C)\nfreq_tab_3.1\n\n# A tibble: 64 × 4\n    Freq L     R     C    \n   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;\n 1    76 1     1     1    \n 2    14 1     1     2    \n 3    15 1     1     3    \n 4     4 1     1     4    \n 5    32 1     2     1    \n 6    17 1     2     2    \n 7     7 1     2     3    \n 8     3 1     2     4    \n 9    64 1     3     1    \n10    23 1     3     2    \n# ℹ 54 more rows\n\n\n行，列，層について整数スコアを作成する．\n\nfreq_tab_3.1 &lt;- freq_tab_3.1 |&gt; \n  mutate(Rscore = as.numeric(R),\n         Cscore = as.numeric(C),\n         Lscore = as.numeric(L))\nfreq_tab_3.1\n\n# A tibble: 64 × 7\n    Freq L     R     C     Rscore Cscore Lscore\n   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;\n 1    76 1     1     1          1      1      1\n 2    14 1     1     2          1      2      1\n 3    15 1     1     3          1      3      1\n 4     4 1     1     4          1      4      1\n 5    32 1     2     1          2      1      1\n 6    17 1     2     2          2      2      1\n 7     7 1     2     3          2      3      1\n 8     3 1     2     4          2      4      1\n 9    64 1     3     1          3      1      1\n10    23 1     3     2          3      2      1\n# ℹ 54 more rows\n\n\nそれではモデル1から15までを用いた推定を行う．ただしgnmではモデル3と5の推定はできない． また\n\n# Model 1 - Complete Independence\nmodel1 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ R + C + L,\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\n# Model 2 - Unrestricted RC(1)+RL(1)+CL(1)\nmodel2 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ R + C + L + Mult(1, R, C) + Mult(1, R, L) + Mult(1, C, L),\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n............................................................\nDone\n\n# Model 3 - Restricted RC(1)+RL(1)+CL(1) with consistent score\n# It may not be fitted with gnm package!\n\n# Model 4 - Model 2 with consistent cells fitted exactly\nfreq_tab_3.1 &lt;- freq_tab_3.1 |&gt;\n  mutate(consistent.cells = factor(ifelse((R == C) & (C == L), R, 0)))\nmodel4 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ R + C + L + consistent.cells +\n      Mult(1, R, C) + Mult(1, R, L) + Mult(1, C, L),\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations....................................\nDone\n\n# Model 5 - Model 3 with consistent cells fitted exactly\n# It may not be fitted with gnm package!\n\n# Model 6 - Full Two-way interaction\nmodel6 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ R * C + R * L + C * L,\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\nsummary(model6)\n\n\nCall:\ngnm(formula = Freq ~ R * C + R * L + C * L, family = poisson, \n    data = freq_tab_3.1, tolerance = 1e-12, trace = F)\n\nDeviance Residuals: \n      Min         1Q     Median         3Q        Max  \n-1.685582  -0.504109  -0.008581   0.460359   1.299438  \n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  4.26029    0.11066  38.499  &lt; 2e-16 ***\nR2          -0.79606    0.18519  -4.299 1.72e-05 ***\nR3          -0.09579    0.14996  -0.639  0.52299    \nR4          -0.43476    0.16083  -2.703  0.00687 ** \nC2          -1.63953    0.22829  -7.182 6.89e-13 ***\nC3          -1.39351    0.20261  -6.878 6.08e-12 ***\nC4          -2.33707    0.28019  -8.341  &lt; 2e-16 ***\nR2:C2        0.90120    0.28232   3.192  0.00141 ** \nR3:C2        0.63274    0.25192   2.512  0.01202 *  \nR4:C2        0.33707    0.26138   1.290  0.19719    \nR2:C3       -0.06534    0.29098  -0.225  0.82232    \nR3:C3        0.66917    0.22004   3.041  0.00236 ** \nR4:C3        0.60286    0.22215   2.714  0.00665 ** \nR2:C4        0.34284    0.36220   0.947  0.34388    \nR3:C4        0.56412    0.29673   1.901  0.05729 .  \nR4:C4        1.27643    0.28261   4.517 6.29e-06 ***\nL2          -1.48502    0.22186  -6.694 2.18e-11 ***\nL3          -1.52970    0.20833  -7.343 2.10e-13 ***\nL4          -2.08728    0.24553  -8.501  &lt; 2e-16 ***\nR2:L2        1.34634    0.28170   4.779 1.76e-06 ***\nR3:L2        1.28703    0.24739   5.203 1.97e-07 ***\nR4:L2        1.03853    0.26517   3.916 8.99e-05 ***\nR2:L3        0.67005    0.28444   2.356  0.01849 *  \nR3:L3        1.21742    0.22757   5.350 8.81e-08 ***\nR4:L3        1.59671    0.23321   6.847 7.56e-12 ***\nR2:L4        0.17240    0.35528   0.485  0.62750    \nR3:L4        0.61348    0.27149   2.260  0.02384 *  \nR4:L4        2.16906    0.25643   8.459  &lt; 2e-16 ***\nC2:L2        0.35033    0.21463   1.632  0.10263    \nC3:L2        0.22827    0.20862   1.094  0.27389    \nC4:L2        0.49174    0.25839   1.903  0.05703 .  \nC2:L3        0.65539    0.20819   3.148  0.00164 ** \nC3:L3        1.09826    0.18400   5.969 2.39e-09 ***\nC4:L3        1.11150    0.23123   4.807 1.53e-06 ***\nC2:L4        0.87747    0.23892   3.673  0.00024 ***\nC3:L4        1.29956    0.20753   6.262 3.80e-10 ***\nC4:L4        1.79692    0.23862   7.530 5.06e-14 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nResidual deviance: 28.998 on 27 degrees of freedom\nAIC: 397.32\n\nNumber of iterations: 5\n\n# Model 7 - Model 6 with consistent cells fitted exactly\nmodel7 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ R * C + R * L + C * L + consistent.cells,\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\nsummary(model7)\n\n\nCall:\ngnm(formula = Freq ~ R * C + R * L + C * L + consistent.cells, \n    family = poisson, data = freq_tab_3.1, tolerance = 1e-12,     trace = F)\n\nDeviance Residuals: \n       Min          1Q      Median          3Q         Max  \n-1.505e+00  -4.123e-01  -1.490e-08   3.008e-01   1.562e+00  \n\nCoefficients:\n                  Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)        3.70806    0.31642  11.719  &lt; 2e-16 ***\nR2                -0.26471    0.33752  -0.784 0.432870    \nR3                 0.43595    0.31473   1.385 0.166007    \nR4                 0.04506    0.31538   0.143 0.886401    \nC2                -1.23787    0.31573  -3.921 8.83e-05 ***\nC3                -0.95472    0.29544  -3.232 0.001231 ** \nC4                -2.00687    0.35086  -5.720 1.07e-08 ***\nR2:C2              0.49806    0.36012   1.383 0.166653    \nR3:C2              0.33263    0.30439   1.093 0.274482    \nR4:C2              0.02956    0.30915   0.096 0.923826    \nR2:C3             -0.37252    0.33538  -1.111 0.266684    \nR3:C3              0.21202    0.29412   0.721 0.470997    \nR4:C3              0.33724    0.27290   1.236 0.216553    \nR2:C4              0.06257    0.39636   0.158 0.874574    \nR3:C4              0.29993    0.33550   0.894 0.371334    \nR4:C4              1.06332    0.33951   3.132 0.001737 ** \nL2                -1.05809    0.31923  -3.314 0.000918 ***\nL3                -1.09080    0.29894  -3.649 0.000263 ***\nL4                -1.74115    0.32163  -5.413 6.18e-08 ***\nR2:L2              0.91597    0.36361   2.519 0.011766 *  \nR3:L2              0.93125    0.31450   2.961 0.003066 ** \nR4:L2              0.67771    0.32813   2.065 0.038888 *  \nR2:L3              0.33649    0.33467   1.005 0.314694    \nR3:L3              0.75119    0.30376   2.473 0.013399 *  \nR4:L3              1.28290    0.29072   4.413 1.02e-05 ***\nR2:L4             -0.12414    0.39162  -0.317 0.751243    \nR3:L4              0.33826    0.31651   1.069 0.285199    \nR4:L4              1.91005    0.31369   6.089 1.14e-09 ***\nC2:L2              0.17440    0.24791   0.704 0.481744    \nC3:L2              0.12343    0.21731   0.568 0.570049    \nC4:L2              0.38519    0.26377   1.460 0.144196    \nC2:L3              0.54622    0.21620   2.526 0.011522 *  \nC3:L3              0.78217    0.22762   3.436 0.000590 ***\nC4:L3              0.98203    0.23833   4.120 3.78e-05 ***\nC2:L4              0.75925    0.24670   3.078 0.002087 ** \nC3:L4              1.14125    0.21839   5.226 1.73e-07 ***\nC4:L4              1.79914    0.31902   5.640 1.70e-08 ***\nconsistent.cells1  0.62268    0.33657   1.850 0.064303 .  \nconsistent.cells2  0.25993    0.39723   0.654 0.512891    \nconsistent.cells3  0.47364    0.26552   1.784 0.074458 .  \nconsistent.cells4 -0.16248    0.31471  -0.516 0.605666    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nResidual deviance: 21.934 on 23 degrees of freedom\nAIC: 398.25\n\nNumber of iterations: 5\n\n# Model 8 - Unrestricted uniform and log-multiplicative association in all partial\n# association\nmodel8 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ R + C + L +\n      Rscore:Cscore +\n      Mult(1, R, C) +\n      Rscore:Lscore +\n      Mult(1, R, L) +\n      Cscore:Lscore +\n      Mult(1, C, L),\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n.................\nDone\n\nsummary(model8)\n\n\nCall:\ngnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + \n    Rscore:Lscore + Mult(1, R, L) + Cscore:Lscore + Mult(1, C, \n    L), family = poisson, data = freq_tab_3.1, tolerance = 1e-12,     trace = F)\n\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.64348  -0.68031  -0.02712   0.48954   2.01814  \n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       3.56947         NA      NA       NA    \nR2               -0.95581         NA      NA       NA    \nR3               -0.73198         NA      NA       NA    \nR4               -1.57358         NA      NA       NA    \nC2               -1.58190         NA      NA       NA    \nC3               -2.03620         NA      NA       NA    \nC4               -3.44447         NA      NA       NA    \nL2               -1.44333         NA      NA       NA    \nL3               -2.28015         NA      NA       NA    \nL4               -3.81499         NA      NA       NA    \nRscore:Cscore     0.12964    0.02728   4.752 2.01e-06 ***\nMult(., R, C).    0.48082         NA      NA       NA    \nMult(1, ., C).R1  1.29304         NA      NA       NA    \nMult(1, ., C).R2 -2.57199         NA      NA       NA    \nMult(1, ., C).R3 -1.09414         NA      NA       NA    \nMult(1, ., C).R4  1.61279         NA      NA       NA    \nMult(1, R, .).C1  0.06022         NA      NA       NA    \nMult(1, R, .).C2 -0.31136         NA      NA       NA    \nMult(1, R, .).C3 -0.01483         NA      NA       NA    \nMult(1, R, .).C4  0.25587         NA      NA       NA    \nRscore:Lscore     0.25450    0.02803   9.080  &lt; 2e-16 ***\nMult(., R, L).   -1.68398         NA      NA       NA    \nMult(1, ., L).R1  0.65550         NA      NA       NA    \nMult(1, ., L).R2 -0.65902         NA      NA       NA    \nMult(1, ., L).R3 -0.51718         NA      NA       NA    \nMult(1, ., L).R4  0.39543         NA      NA       NA    \nMult(1, R, .).L1 -0.04375         NA      NA       NA    \nMult(1, R, .).L2  0.37905         NA      NA       NA    \nMult(1, R, .).L3  0.06614         NA      NA       NA    \nMult(1, R, .).L4 -0.45727         NA      NA       NA    \nCscore:Lscore     0.20172    0.02585   7.802  &lt; 2e-16 ***\nMult(., C, L).   -0.26598         NA      NA       NA    \nMult(1, ., L).C1 -0.35181         NA      NA       NA    \nMult(1, ., L).C2  0.55513         NA      NA       NA    \nMult(1, ., L).C3  3.03110         NA      NA       NA    \nMult(1, ., L).C4 -0.54901         NA      NA       NA    \nMult(1, C, .).L1  0.07238         NA      NA       NA    \nMult(1, C, .).L2  0.24744         NA      NA       NA    \nMult(1, C, .).L3 -0.27232         NA      NA       NA    \nMult(1, C, .).L4  0.04368         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 45.854 on 36 degrees of freedom\nAIC: 396.17\n\nNumber of iterations: 74\n\npickCoef(model8, \"[.]R\")\n\nMult(1, ., C).R1 Mult(1, ., C).R2 Mult(1, ., C).R3 Mult(1, ., C).R4 \n              13               14               15               16 \nMult(1, ., L).R1 Mult(1, ., L).R2 Mult(1, ., L).R3 Mult(1, ., L).R4 \n              23               24               25               26 \n\npickCoef(model8, \"[.]C\")\n\nMult(1, R, .).C1 Mult(1, R, .).C2 Mult(1, R, .).C3 Mult(1, R, .).C4 \n              17               18               19               20 \nMult(1, ., L).C1 Mult(1, ., L).C2 Mult(1, ., L).C3 Mult(1, ., L).C4 \n              33               34               35               36 \n\npickCoef(model8, \"[.]L\")\n\nMult(1, R, .).L1 Mult(1, R, .).L2 Mult(1, R, .).L3 Mult(1, R, .).L4 \n              27               28               29               30 \nMult(1, C, .).L1 Mult(1, C, .).L2 Mult(1, C, .).L3 Mult(1, C, .).L4 \n              37               38               39               40 \n\ndata.frame(var = names(model8$coefficients),\n           estimate = model8$coefficients) |&gt; \n  mutate(estimate = estimate,\n         number = row_number())\n\n                              var    estimate number\n(Intercept)           (Intercept)  3.56947423      1\nR2                             R2 -0.95580768      2\nR3                             R3 -0.73197773      3\nR4                             R4 -1.57358020      4\nC2                             C2 -1.58189637      5\nC3                             C3 -2.03620006      6\nC4                             C4 -3.44447046      7\nL2                             L2 -1.44333262      8\nL3                             L3 -2.28015375      9\nL4                             L4 -3.81499149     10\nRscore:Cscore       Rscore:Cscore  0.12964400     11\nMult(., R, C).     Mult(., R, C).  0.48082123     12\nMult(1, ., C).R1 Mult(1, ., C).R1  1.29303936     13\nMult(1, ., C).R2 Mult(1, ., C).R2 -2.57198629     14\nMult(1, ., C).R3 Mult(1, ., C).R3 -1.09414070     15\nMult(1, ., C).R4 Mult(1, ., C).R4  1.61278769     16\nMult(1, R, .).C1 Mult(1, R, .).C1  0.06021584     17\nMult(1, R, .).C2 Mult(1, R, .).C2 -0.31135865     18\nMult(1, R, .).C3 Mult(1, R, .).C3 -0.01483124     19\nMult(1, R, .).C4 Mult(1, R, .).C4  0.25586809     20\nRscore:Lscore       Rscore:Lscore  0.25449639     21\nMult(., R, L).     Mult(., R, L). -1.68398482     22\nMult(1, ., L).R1 Mult(1, ., L).R1  0.65550361     23\nMult(1, ., L).R2 Mult(1, ., L).R2 -0.65901912     24\nMult(1, ., L).R3 Mult(1, ., L).R3 -0.51718173     25\nMult(1, ., L).R4 Mult(1, ., L).R4  0.39542928     26\nMult(1, R, .).L1 Mult(1, R, .).L1 -0.04375006     27\nMult(1, R, .).L2 Mult(1, R, .).L2  0.37905108     28\nMult(1, R, .).L3 Mult(1, R, .).L3  0.06614048     29\nMult(1, R, .).L4 Mult(1, R, .).L4 -0.45726723     30\nCscore:Lscore       Cscore:Lscore  0.20172487     31\nMult(., C, L).     Mult(., C, L). -0.26597634     32\nMult(1, ., L).C1 Mult(1, ., L).C1 -0.35181103     33\nMult(1, ., L).C2 Mult(1, ., L).C2  0.55513109     34\nMult(1, ., L).C3 Mult(1, ., L).C3  3.03109800     35\nMult(1, ., L).C4 Mult(1, ., L).C4 -0.54900731     36\nMult(1, C, .).L1 Mult(1, C, .).L1  0.07237679     37\nMult(1, C, .).L2 Mult(1, C, .).L2  0.24743771     38\nMult(1, C, .).L3 Mult(1, C, .).L3 -0.27232306     39\nMult(1, C, .).L4 Mult(1, C, .).L4  0.04368449     40\n\n# mu1: 13-16\nmu1 &lt;- getContrasts(\n  model8,\n  pickCoef(model8, \"[.]R\")[1:4],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\nmu1\n\n                   Estimate Std. Error\nMult(1, ., C).R1  0.4291986 0.18120993\nMult(1, ., C).R2 -0.6893016 0.09977232\nMult(1, ., C).R3 -0.2616277 0.15931019\nMult(1, ., C).R4  0.5217306 0.15976113\n\n# nu1: 17-20\nnu1 &lt;- getContrasts(\n  model8,\n  pickCoef(model8, \"[.]C\")[1:4],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\nnu1\n\n                    Estimate Std. Error\nMult(1, R, .).C1  0.15388700 0.15383900\nMult(1, R, .).C2 -0.75746716 0.08227847\nMult(1, R, .).C3 -0.03017965 0.15480459\nMult(1, R, .).C4  0.63375980 0.11651692\n\n# mu2: 23-26\nmu2 &lt;- getContrasts(\n  model8,\n  pickCoef(model8, \"[.]R\")[5:8],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\nmu2\n\n                   Estimate Std. Error\nMult(1, ., L).R1  0.6061444 0.08512883\nMult(1, ., L).R2 -0.5539702 0.08877502\nMult(1, ., L).R3 -0.4287935 0.09713147\nMult(1, ., L).R4  0.3766193 0.10554742\n\n# eta1: 27-30\neta1 &lt;- getContrasts(\n  model8,\n  pickCoef(model8, \"[.]L\")[1:4],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\neta1\n\n                    Estimate Std. Error\nMult(1, R, .).L1 -0.04977493 0.08992116\nMult(1, R, .).L2  0.65658058 0.06234704\nMult(1, R, .).L3  0.13381443 0.08765352\nMult(1, R, .).L4 -0.74062008 0.04970264\n\n# nu2: 33-36\nnu2 &lt;- getContrasts(\n  model8,\n  pickCoef(model8, \"[.]C\")[5:8],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\nnu2\n\n                    Estimate Std. Error\nMult(1, ., L).C1 -0.35910324  0.2995712\nMult(1, ., L).C2 -0.04079069  0.3606231\nMult(1, ., L).C3  0.82820782  0.1075525\nMult(1, ., L).C4 -0.42831389  0.3177968\n\n# eta2: 37-40\neta2 &lt;- getContrasts(\n  model8,\n  pickCoef(model8, \"[.]L\")[5:8],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\neta2\n\n                    Estimate Std. Error\nMult(1, C, .).L1  0.13230141  0.3592002\nMult(1, C, .).L2  0.59941504  0.2494518\nMult(1, C, .).L3 -0.78745843  0.1409196\nMult(1, C, .).L4  0.05574198  0.3241035\n\ncon &lt;- c(mu1$qvframe[, 1][c(1,4)],\n         nu1$qvframe[, 1][c(1,4)],\n         mu2$qvframe[, 1][c(1,4)],\n         eta1$qvframe[, 1][c(1,4)],\n         nu2$qvframe[, 1][c(1,4)],\n         eta2$qvframe[, 1][c(1,4)])\n\n\nmodel8_se &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ R + C + L +\n      Rscore:Cscore +\n      Mult(1, R, C) +\n      Rscore:Lscore +\n      Mult(1, R, L) +\n      Cscore:Lscore +\n      Mult(1, C, L),\n#    constrain = c(13,16,17,20,23,26,27,30,33,36,37,40),\n#    constrainTo = con,\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-15\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n................................................................................\n................................................................................\n................................................................................\n................................................................................\n................................................................................\n...........................................\nDone\n\n\nWarning in gnmFit(modelTools = modelTools, y = y, constrain = constrain, : Fitting algorithm has either not converged or converged\nto a non-solution of the likelihood equations.\nUse exitInfo() for numerical details of last iteration.\n\nsummary(model8_se)\n\n\nCall:\ngnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + \n    Rscore:Lscore + Mult(1, R, L) + Cscore:Lscore + Mult(1, C, \n    L), family = poisson, data = freq_tab_3.1, tolerance = 1e-15,     trace = F)\n\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.64348  -0.68031  -0.02712   0.48954   2.01814  \n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       3.58749         NA      NA       NA    \nR2               -0.97393         NA      NA       NA    \nR3               -0.75294         NA      NA       NA    \nR4               -1.58207         NA      NA       NA    \nC2               -1.59731         NA      NA       NA    \nC3               -2.02606         NA      NA       NA    \nC4               -3.43520         NA      NA       NA    \nL2               -1.42034         NA      NA       NA    \nL3               -2.29570         NA      NA       NA    \nL4               -3.82962         NA      NA       NA    \nRscore:Cscore     0.12964    0.02728   4.752 2.01e-06 ***\nMult(., R, C).   -1.03386         NA      NA       NA    \nMult(1, ., C).R1  0.18172         NA      NA       NA    \nMult(1, ., C).R2 -0.41060         NA      NA       NA    \nMult(1, ., C).R3 -0.18412         NA      NA       NA    \nMult(1, ., C).R4  0.23072         NA      NA       NA    \nMult(1, R, .).C1 -0.21126         NA      NA       NA    \nMult(1, R, .).C2  0.91636         NA      NA       NA    \nMult(1, R, .).C3  0.01649         NA      NA       NA    \nMult(1, R, .).C4 -0.80500         NA      NA       NA    \nRscore:Lscore     0.25450    0.02803   9.080  &lt; 2e-16 ***\nMult(., R, L).   -4.02469         NA      NA       NA    \nMult(1, ., L).R1 -0.34482         NA      NA       NA    \nMult(1, ., L).R2  0.32746         NA      NA       NA    \nMult(1, ., L).R3  0.25492         NA      NA       NA    \nMult(1, ., L).R4 -0.21181         NA      NA       NA    \nMult(1, R, .).L1  0.02264         NA      NA       NA    \nMult(1, R, .).L2 -0.32327         NA      NA       NA    \nMult(1, R, .).L3 -0.06727         NA      NA       NA    \nMult(1, R, .).L4  0.36095         NA      NA       NA    \nCscore:Lscore     0.20172    0.02585   7.802  &lt; 2e-16 ***\nMult(., C, L).   -0.76012         NA      NA       NA    \nMult(1, ., L).C1  0.03536         NA      NA       NA    \nMult(1, ., L).C2 -0.18673         NA      NA       NA    \nMult(1, ., L).C3 -0.79306         NA      NA       NA    \nMult(1, ., L).C4  0.08365         NA      NA       NA    \nMult(1, C, .).L1 -0.12566         NA      NA       NA    \nMult(1, C, .).L2 -0.37581         NA      NA       NA    \nMult(1, C, .).L3  0.36687         NA      NA       NA    \nMult(1, C, .).L4 -0.08467         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 45.854 on 36 degrees of freedom\nAIC: 396.17\n\nNumber of iterations: 500\n\noptions(contrasts = c(factor=\"contr.treatment\",\n                      ordered=\"contr.treatment\"))\n# Model 9 - Model 8 with consistent row scores\nmodel9 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ R + C + L +\n      Rscore:Cscore +\n      Mult(1, R, C + L) +\n      Rscore:Lscore +\n      Cscore:Lscore +\n      Mult(1, C, L),\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n..............\nDone\n\nsummary(model9)\n\n\nCall:\ngnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C + \n    L) + Rscore:Lscore + Cscore:Lscore + Mult(1, C, L), family = poisson, \n    data = freq_tab_3.1, tolerance = 1e-12, trace = F)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.56526  -0.67024  -0.02438   0.54037   1.98333  \n\nCoefficients:\n                     Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)           3.60660         NA      NA       NA    \nR2                   -1.03567         NA      NA       NA    \nR3                   -0.79166         NA      NA       NA    \nR4                   -1.56512         NA      NA       NA    \nC2                   -1.62760         NA      NA       NA    \nC3                   -2.09659         NA      NA       NA    \nC4                   -3.46103         NA      NA       NA    \nL2                   -1.46344         NA      NA       NA    \nL3                   -2.20133         NA      NA       NA    \nL4                   -3.77063         NA      NA       NA    \nRscore:Cscore         0.13353    0.02535   5.266 1.39e-07 ***\nMult(., R, C + L).   -2.52474         NA      NA       NA    \nMult(1, ., C + L).R1  0.17688         NA      NA       NA    \nMult(1, ., C + L).R2 -0.22447         NA      NA       NA    \nMult(1, ., C + L).R3 -0.15437         NA      NA       NA    \nMult(1, ., C + L).R4  0.12900         NA      NA       NA    \nMult(1, R, . + L).C1 -0.12690         NA      NA       NA    \nMult(1, R, . + L).C2  0.54818         NA      NA       NA    \nMult(1, R, . + L).C3  0.05093         NA      NA       NA    \nMult(1, R, . + L).C4 -0.49867         NA      NA       NA    \nMult(1, R, C + .).L2  0.92231         NA      NA       NA    \nMult(1, R, C + .).L3  0.22916         NA      NA       NA    \nMult(1, R, C + .).L4 -0.88965         NA      NA       NA    \nRscore:Lscore         0.24848    0.02722   9.127  &lt; 2e-16 ***\nCscore:Lscore         0.20270    0.02562   7.913  &lt; 2e-16 ***\nMult(., C, L).        0.18289         NA      NA       NA    \nMult(1, ., L).C1     -1.06884         NA      NA       NA    \nMult(1, ., L).C2     -0.18453         NA      NA       NA    \nMult(1, ., L).C3      3.14325         NA      NA       NA    \nMult(1, ., L).C4     -1.34802         NA      NA       NA    \nMult(1, C, .).L1     -0.02989         NA      NA       NA    \nMult(1, C, .).L2     -0.26006         NA      NA       NA    \nMult(1, C, .).L3      0.34522         NA      NA       NA    \nMult(1, C, .).L4     -0.01903         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 47.134 on 38 degrees of freedom\nAIC: 393.45\n\nNumber of iterations: 71\n\nmu &lt;- getContrasts(\n  model9,\n  pickCoef(model9, \"[.]R\"),\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\nnu2 &lt;- getContrasts(\n  model9,\n  pickCoef(model9, \"[.]C\")[5:8],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\neta2 &lt;- getContrasts(\n  model9,\n  pickCoef(model9, \"[.]L\")[4:7],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\nmodel9.extended &lt;-\n  freq_tab_3.1 |&gt; gnm(\n    Freq ~ R + C + L +\n      Rscore:Cscore +\n      Mult(1, R, C) +\n      Rscore:Lscore +\n      Mult(1, R, L) +\n      Cscore:Lscore +\n      Mult(1, C, L),\n    constrain = c(13:16, 23:26),\n    constrainTo = c(mu$qvframe[, 1], mu$qvframe[, 1]),\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n........\nDone\n\nsummary(model9.extended)\n\n\nCall:\ngnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + \n    Rscore:Lscore + Mult(1, R, L) + Cscore:Lscore + Mult(1, C, \n    L), constrain = c(13:16, 23:26), constrainTo = c(mu$qvframe[, \n    1], mu$qvframe[, 1]), family = poisson, data = freq_tab_3.1, \n    tolerance = 1e-12, trace = F)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.56526  -0.67024  -0.02438   0.54037   1.98333  \n\nCoefficients:\n                  Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       3.601646         NA      NA       NA    \nR2               -1.012649         NA      NA       NA    \nR3               -0.772656         NA      NA       NA    \nR4               -1.562372         NA      NA       NA    \nC2               -1.582422         NA      NA       NA    \nC3               -2.021304         NA      NA       NA    \nC4               -3.482599         NA      NA       NA    \nL2               -1.363693         NA      NA       NA    \nL3               -2.284109         NA      NA       NA    \nL4               -3.814306         NA      NA       NA    \nRscore:Cscore     0.133527   0.025195   5.300 1.16e-07 ***\nMult(., R, C).   -0.068128         NA      NA       NA    \nMult(1, ., C).R1  0.561358         NA      NA       NA    \nMult(1, ., C).R2 -0.593325         NA      NA       NA    \nMult(1, ., C).R3 -0.391651         NA      NA       NA    \nMult(1, ., C).R4  0.423618         NA      NA       NA    \nMult(1, R, .).C1 -1.296576         NA      NA       NA    \nMult(1, R, .).C2  7.399298         NA      NA       NA    \nMult(1, R, .).C3  0.994157         NA      NA       NA    \nMult(1, R, .).C4 -6.085329         NA      NA       NA    \nRscore:Lscore     0.248478   0.025211   9.856  &lt; 2e-16 ***\nMult(., R, L).   -2.522838         NA      NA       NA    \nMult(1, ., L).R1  0.561358         NA      NA       NA    \nMult(1, ., L).R2 -0.593325         NA      NA       NA    \nMult(1, ., L).R3 -0.391651         NA      NA       NA    \nMult(1, ., L).R4  0.423618         NA      NA       NA    \nMult(1, R, .).L1 -0.017035         NA      NA       NA    \nMult(1, R, .).L2  0.303791         NA      NA       NA    \nMult(1, R, .).L3  0.062679         NA      NA       NA    \nMult(1, R, .).L4 -0.326500         NA      NA       NA    \nCscore:Lscore     0.202702   0.025596   7.919  &lt; 2e-16 ***\nMult(., C, L).   -1.891686         NA      NA       NA    \nMult(1, ., L).C1  0.028247         NA      NA       NA    \nMult(1, ., L).C2  0.113895         NA      NA       NA    \nMult(1, ., L).C3  0.436202         NA      NA       NA    \nMult(1, ., L).C4  0.001208         NA      NA       NA    \nMult(1, C, .).L1  0.116788         NA      NA       NA    \nMult(1, C, .).L2  0.346543         NA      NA       NA    \nMult(1, C, .).L3 -0.257664         NA      NA       NA    \nMult(1, C, .).L4  0.105938         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 47.134 on 40 degrees of freedom\nAIC: 389.45\n\nNumber of iterations: 65\n\nnu1 &lt;- getContrasts(\n  model9.extended,\n  pickCoef(model9.extended, \"[.]C\")[1:4],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\neta1 &lt;- getContrasts(\n    model9.extended,\n    pickCoef(model9.extended, \"[.]L\")[1:4],\n    ref = \"mean\",\n    scaleRef = \"mean\",\n    scaleWeights = \"unit\"\n  )\n\nmodel9.phis &lt;-\n  freq_tab_3.1 |&gt;  gnm(\n    Freq ~ R + C + L + \n      Rscore:Cscore + \n      Mult(1, R, C) +\n      Rscore:Lscore + \n      Mult(1, R, L) + \n      Cscore:Lscore + \n      Mult(1, C, L),\n    constrain = c(13:20, 23:30, 33:40),\n    constrainTo = c(\n      mu$qvframe[, 1],\n      nu1$qvframe[, 1],\n      mu$qvframe[, 1],\n      eta1$qvframe[, 1],\n      nu2$qvframe[, 1],\n      eta2$qvframe[, 1]\n    ),\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning main iterations...........................\nDone\n\nsummary(model9.phis)\n\n\nCall:\ngnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + \n    Rscore:Lscore + Mult(1, R, L) + Cscore:Lscore + Mult(1, C, \n    L), constrain = c(13:20, 23:30, 33:40), constrainTo = c(mu$qvframe[, \n    1], nu1$qvframe[, 1], mu$qvframe[, 1], eta1$qvframe[, 1], \n    nu2$qvframe[, 1], eta2$qvframe[, 1]), family = poisson, data = freq_tab_3.1, \n    tolerance = 1e-12, trace = F)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.56526  -0.67024  -0.02438   0.54037   1.98333  \n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       3.56903    0.08137  43.862  &lt; 2e-16 ***\nR2               -0.97605    0.11881  -8.215  &lt; 2e-16 ***\nR3               -0.74245    0.14810  -5.013 5.36e-07 ***\nR4               -1.55801    0.22175  -7.026 2.13e-12 ***\nC2               -1.59504    0.10577 -15.081  &lt; 2e-16 ***\nC3               -2.08142    0.17240 -12.073  &lt; 2e-16 ***\nC4               -3.47861    0.26841 -12.960  &lt; 2e-16 ***\nL2               -1.42666    0.10739 -13.285  &lt; 2e-16 ***\nL3               -2.18148    0.17791 -12.262  &lt; 2e-16 ***\nL4               -3.81133    0.27937 -13.643  &lt; 2e-16 ***\nRscore:Cscore     0.13353    0.02486   5.371 7.83e-08 ***\nMult(., R, C).   -0.66121    0.14008  -4.720 2.36e-06 ***\nMult(1, ., C).R1  0.56136         NA      NA       NA    \nMult(1, ., C).R2 -0.59333         NA      NA       NA    \nMult(1, ., C).R3 -0.39165         NA      NA       NA    \nMult(1, ., C).R4  0.42362         NA      NA       NA    \nMult(1, R, .).C1 -0.15965         NA      NA       NA    \nMult(1, R, .).C2  0.73633         NA      NA       NA    \nMult(1, R, .).C3  0.07638         NA      NA       NA    \nMult(1, R, .).C4 -0.65306         NA      NA       NA    \nRscore:Lscore     0.24848    0.02515   9.879  &lt; 2e-16 ***\nMult(., R, L).   -1.13662    0.13964  -8.140  &lt; 2e-16 ***\nMult(1, ., L).R1  0.56136         NA      NA       NA    \nMult(1, ., L).R2 -0.59333         NA      NA       NA    \nMult(1, ., L).R3 -0.39165         NA      NA       NA    \nMult(1, ., L).R4  0.42362         NA      NA       NA    \nMult(1, R, .).L1 -0.05054         NA      NA       NA    \nMult(1, R, .).L2  0.66157         NA      NA       NA    \nMult(1, R, .).L3  0.12640         NA      NA       NA    \nMult(1, R, .).L4 -0.73743         NA      NA       NA    \nCscore:Lscore     0.20270    0.02315   8.756  &lt; 2e-16 ***\nMult(., C, L).    0.28351    0.10068   2.816  0.00486 ** \nMult(1, ., L).C1 -0.33661         NA      NA       NA    \nMult(1, ., L).C2 -0.08944         NA      NA       NA    \nMult(1, ., L).C3  0.84069         NA      NA       NA    \nMult(1, ., L).C4 -0.41464         NA      NA       NA    \nMult(1, C, .).L1 -0.08991         NA      NA       NA    \nMult(1, C, .).L2 -0.62111         NA      NA       NA    \nMult(1, C, .).L3  0.77584         NA      NA       NA    \nMult(1, C, .).L4 -0.06482         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 47.134 on 48 degrees of freedom\nAIC: 373.45\n\nNumber of iterations: 27\n\nmu\n\n                       Estimate Std. Error\nMult(1, ., C + L).R1  0.5613577 0.07946201\nMult(1, ., C + L).R2 -0.5933253 0.06976100\nMult(1, ., C + L).R3 -0.3916506 0.08375491\nMult(1, ., C + L).R4  0.4236182 0.08896023\n\nnu1\n\n                    Estimate Std. Error\nMult(1, R, .).C1 -0.15964986 0.14637516\nMult(1, R, .).C2  0.73633460 0.08871449\nMult(1, R, .).C3  0.07637713 0.15684115\nMult(1, R, .).C4 -0.65306187 0.10868144\n\neta1\n\n                    Estimate Std. Error\nMult(1, R, .).L1 -0.05053742 0.08981862\nMult(1, R, .).L2  0.66156822 0.06038098\nMult(1, R, .).L3  0.12639555 0.08679365\nMult(1, R, .).L4 -0.73742635 0.04940126\n\nnu2\n\n                    Estimate Std. Error\nMult(1, ., L).C1 -0.33661004 0.30087703\nMult(1, ., L).C2 -0.08944163 0.36058729\nMult(1, ., L).C3  0.84069369 0.08936905\nMult(1, ., L).C4 -0.41464201 0.32252708\n\neta2\n\n                    Estimate Std. Error\nMult(1, C, .).L1 -0.08990831  0.3610226\nMult(1, C, .).L2 -0.62111332  0.2399524\nMult(1, C, .).L3  0.77584334  0.1519881\nMult(1, C, .).L4 -0.06482171  0.3227342\n\nmodel.summary(model9)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 model9                 38  47.1 -231.  6.25 0.147\n\n# Model 10 - Model 8 with consistent col scores\nmodel10 &lt;-\n  freq_tab_3.1 |&gt; gnm(\n    Freq ~ R + C + L + \n      Rscore:Cscore + \n      Mult(1, C, R + L) +\n      Rscore:Lscore + \n      Mult(1, R, L) + \n      Cscore:Lscore,\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n.........................................................................\nDone\n\nmodel.summary(model10)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta      p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;\n1 model10                38  50.9 -227.  6.31 0.0788\n\n# Model 11 - Model 8 with consistent layer scores\nmodel11 &lt;-\n  freq_tab_3.1 |&gt; gnm(\n    Freq ~ R + C + L + \n      Rscore:Cscore + \n      Mult(1, L, R + C) +\n      Rscore:Lscore +\n      Mult(1, R, C) +\n      Cscore:Lscore,\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n..........................\nDone\n\nmodel.summary(model11)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta      p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;\n1 model11                38  53.6 -225.  6.58 0.0477\n\n# Model 12 - Modek 9 + U(RL)=U(CL)\n# To impose equality constraint on U(RL) & U(CL),\n# a covariate is created in following manner:\n\nfreq_tab_3.1 &lt;- freq_tab_3.1|&gt; \n  mutate(cov_rcl = Rscore * Lscore + Cscore * Lscore)\nmodel12 &lt;-\n  freq_tab_3.1 |&gt; gnm(\n    Freq ~ R + C + L + \n      Rscore:Cscore + \n      Mult(1, R, C + L) +\n      cov_rcl + \n      Mult(1, C, L),\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n...................................\nDone\n\n#summary(model12)\nmodel.summary(model12)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 model12                39  48.6 -237.  6.57 0.140\n\nmu &lt;- getContrasts(\n  model12,\n  pickCoef(model12, \"[.]R\"),\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\nnu2 &lt;-\n  getContrasts(\n    model12,\n    pickCoef(model12, \"[.]C\")[5:8],\n    ref = \"mean\",\n    scaleRef = \"mean\",\n    scaleWeights = \"unit\"\n  )\n\neta2 &lt;-\n  getContrasts(\n    model12,\n    pickCoef(model12, \"[.]L\")[4:7],\n    ref = \"mean\",\n    scaleRef = \"mean\",\n    scaleWeights = \"unit\"\n  )\n\nmodel12.extended &lt;-\n  freq_tab_3.1 |&gt;\n  gnm(Freq ~ R + C + L + \n        Rscore:Cscore + \n        Mult(1, R, C) +\n        cov_rcl + \n        Mult(1, R, L) + \n        Mult(1, C, L),\n      constrain = c(13:16, 23:26),\n      constrainTo = c(mu$qvframe[, 1], mu$qvframe[, 1]),\n      data = _,\n      family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.........................................................\n......................................................\nDone\n\nsummary(model12.extended)\n\n\nCall:\ngnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + \n    cov_rcl + Mult(1, R, L) + Mult(1, C, L), constrain = c(13:16, \n    23:26), constrainTo = c(mu$qvframe[, 1], mu$qvframe[, 1]), \n    family = poisson, data = freq_tab_3.1, tolerance = 1e-12,     trace = F)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.58844  -0.76809   0.02278   0.56330   1.92999  \n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       3.59679         NA      NA       NA    \nR2               -1.02088         NA      NA       NA    \nR3               -0.71717         NA      NA       NA    \nR4               -1.40043         NA      NA       NA    \nC2               -1.63811         NA      NA       NA    \nC3               -2.18632         NA      NA       NA    \nC4               -3.65268         NA      NA       NA    \nL2               -1.33235         NA      NA       NA    \nL3               -2.20335         NA      NA       NA    \nL4               -3.73551         NA      NA       NA    \nRscore:Cscore     0.13336    0.02542   5.246 1.55e-07 ***\nMult(., R, C).    0.79591         NA      NA       NA    \nMult(1, ., C).R1  0.53827         NA      NA       NA    \nMult(1, ., C).R2 -0.59766         NA      NA       NA    \nMult(1, ., C).R3 -0.38941         NA      NA       NA    \nMult(1, ., C).R4  0.44880         NA      NA       NA    \nMult(1, R, .).C1  0.10268         NA      NA       NA    \nMult(1, R, .).C2 -0.63922         NA      NA       NA    \nMult(1, R, .).C3 -0.10782         NA      NA       NA    \nMult(1, R, .).C4  0.47258         NA      NA       NA    \ncov_rcl           0.22423    0.01709  13.123  &lt; 2e-16 ***\nMult(., R, L).   -0.37598         NA      NA       NA    \nMult(1, ., L).R1  0.53827         NA      NA       NA    \nMult(1, ., L).R2 -0.59766         NA      NA       NA    \nMult(1, ., L).R3 -0.38941         NA      NA       NA    \nMult(1, ., L).R4  0.44880         NA      NA       NA    \nMult(1, R, .).L1 -0.01378         NA      NA       NA    \nMult(1, R, .).L2  2.13030         NA      NA       NA    \nMult(1, R, .).L3  0.49421         NA      NA       NA    \nMult(1, R, .).L4 -2.11472         NA      NA       NA    \nMult(., C, L).    0.29075         NA      NA       NA    \nMult(1, ., L).C1 -0.17304         NA      NA       NA    \nMult(1, ., L).C2 -0.49643         NA      NA       NA    \nMult(1, ., L).C3 -2.80786         NA      NA       NA    \nMult(1, ., L).C4  0.18415         NA      NA       NA    \nMult(1, C, .).L1 -0.01430         NA      NA       NA    \nMult(1, C, .).L2  0.25729         NA      NA       NA    \nMult(1, C, .).L3 -0.31108         NA      NA       NA    \nMult(1, C, .).L4  0.03916         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 48.569 on 41 degrees of freedom\nAIC: 388.89\n\nNumber of iterations: 111\n\nnu1 &lt;- getContrasts(\n  model12.extended,\n  pickCoef(model12.extended, \"[.]C\")[1:4],\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\neta1 &lt;-\n  getContrasts(\n    model12.extended,\n    pickCoef(model12.extended, \"[.]L\")[1:4],\n    ref = \"mean\",\n    scaleRef = \"mean\",\n    scaleWeights = \"unit\"\n  )\n\nmodel12.phis &lt;-\n  freq_tab_3.1 |&gt; gnm(\n    Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) +\n      cov_rcl + Mult(1, R, L) + Mult(1, C, L),\n    constrain = c(13:20, 23:30, 32:39),\n    constrainTo = c(mu$qvframe[, 1], nu1$qvframe[, 1],\n                    mu$qvframe[, 1], eta1$qvframe[, 1], \n                    nu2$qvframe[, 1], eta2$qvframe[, 1]),\n    data = _,\n    family = poisson, \n    trace = F, \n    tolerance = 1e-12)\n\nInitialising\nRunning main iterations.\nDone\n\nsummary(model12.phis)\n\n\nCall:\ngnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + \n    cov_rcl + Mult(1, R, L) + Mult(1, C, L), constrain = c(13:20, \n    23:30, 32:39), constrainTo = c(mu$qvframe[, 1], nu1$qvframe[, \n    1], mu$qvframe[, 1], eta1$qvframe[, 1], nu2$qvframe[, 1], \n    eta2$qvframe[, 1]), family = poisson, data = freq_tab_3.1, \n    tolerance = 1e-12, trace = F)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.58844  -0.76809   0.02278   0.56330   1.92999  \n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       3.55535    0.08106  43.859  &lt; 2e-16 ***\nR2               -0.92909    0.11339  -8.194  &lt; 2e-16 ***\nR3               -0.64221    0.12609  -5.093 3.52e-07 ***\nR4               -1.39320    0.17746  -7.851  &lt; 2e-16 ***\nC2               -1.63743    0.10043 -16.304  &lt; 2e-16 ***\nC3               -2.18079    0.15608 -13.973  &lt; 2e-16 ***\nC4               -3.65343    0.23846 -15.321  &lt; 2e-16 ***\nL2               -1.39736    0.10537 -13.261  &lt; 2e-16 ***\nL3               -2.13230    0.17235 -12.372  &lt; 2e-16 ***\nL4               -3.74831    0.27154 -13.804  &lt; 2e-16 ***\nRscore:Cscore     0.13336    0.02490   5.357 8.48e-08 ***\nMult(., R, C).    0.64007    0.13725   4.663 3.11e-06 ***\nMult(1, ., C).R1  0.53827         NA      NA       NA    \nMult(1, ., C).R2 -0.59766         NA      NA       NA    \nMult(1, ., C).R3 -0.38941         NA      NA       NA    \nMult(1, ., C).R4  0.44880         NA      NA       NA    \nMult(1, R, .).C1  0.18108         NA      NA       NA    \nMult(1, R, .).C2 -0.74146         NA      NA       NA    \nMult(1, R, .).C3 -0.08067         NA      NA       NA    \nMult(1, R, .).C4  0.64105         NA      NA       NA    \ncov_rcl           0.22423    0.01636  13.707  &lt; 2e-16 ***\nMult(., R, L).   -1.13998    0.13669  -8.340  &lt; 2e-16 ***\nMult(1, ., L).R1  0.53827         NA      NA       NA    \nMult(1, ., L).R2 -0.59766         NA      NA       NA    \nMult(1, ., L).R3 -0.38941         NA      NA       NA    \nMult(1, ., L).R4  0.44880         NA      NA       NA    \nMult(1, R, .).L1 -0.04544         NA      NA       NA    \nMult(1, R, .).L2  0.66170         NA      NA       NA    \nMult(1, R, .).L3  0.12210         NA      NA       NA    \nMult(1, R, .).L4 -0.73836         NA      NA       NA    \nMult(., C, L).   -0.27613    0.10158  -2.718  0.00656 ** \nMult(1, ., L).C1 -0.27770         NA      NA       NA    \nMult(1, ., L).C2 -0.13959         NA      NA       NA    \nMult(1, ., L).C3  0.84752         NA      NA       NA    \nMult(1, ., L).C4 -0.43024         NA      NA       NA    \nMult(1, C, .).L1 -0.01743         NA      NA       NA    \nMult(1, C, .).L2  0.65220         NA      NA       NA    \nMult(1, C, .).L3 -0.74916         NA      NA       NA    \nMult(1, C, .).L4  0.11439         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 48.569 on 49 degrees of freedom\nAIC: 372.89\n\nNumber of iterations: 1\n\nmu\n\n                       Estimate Std. Error\nMult(1, ., C + L).R1  0.5382715 0.07940991\nMult(1, ., C + L).R2 -0.5976649 0.06869502\nMult(1, ., C + L).R3 -0.3894076 0.08390695\nMult(1, ., C + L).R4  0.4488010 0.08495489\n\nnu1\n\n                    Estimate Std. Error\nMult(1, R, .).C1  0.18108336  0.1505749\nMult(1, R, .).C2 -0.74145909  0.0888159\nMult(1, R, .).C3 -0.08066998  0.1598862\nMult(1, R, .).C4  0.64104571  0.1141041\n\neta1\n\n                   Estimate Std. Error\nMult(1, R, .).L1 -0.0454423 0.08895571\nMult(1, R, .).L2  0.6617033 0.05943373\nMult(1, R, .).L3  0.1220991 0.08507409\nMult(1, R, .).L4 -0.7383601 0.04862532\n\nnu2\n\n                   Estimate Std. Error\nMult(1, ., L).C1 -0.2776974 0.30818568\nMult(1, ., L).C2 -0.1395889 0.36977790\nMult(1, ., L).C3  0.8475231 0.08001496\nMult(1, ., L).C4 -0.4302368 0.32326672\n\neta2\n\n                    Estimate Std. Error\nMult(1, C, .).L1 -0.01742597  0.3681779\nMult(1, C, .).L2  0.65219849  0.2296758\nMult(1, C, .).L3 -0.74916478  0.1797929\nMult(1, C, .).L4  0.11439226  0.3321123\n\nmodel.summary(model12)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 model12                39  48.6 -237.  6.57 0.140\n\n# Model 15\n\n\nfreq_tab_3.1 &lt;-\n  freq_tab_3.1 |&gt; mutate(cov_rcl = Rscore * Lscore + Cscore * Lscore)\nmodel15 &lt;- freq_tab_3.1 |&gt;\n  gnm(\n    Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C + L) + cov_rcl,\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations.................................................\nDone\n\nsummary(model15)\n\n\nCall:\ngnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C + \n    L) + cov_rcl, family = poisson, data = freq_tab_3.1, tolerance = 1e-12, \n    trace = F)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.98677  -0.75501   0.01756   0.52206   2.97799  \n\nCoefficients:\n                     Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)           3.60594         NA      NA       NA    \nR2                   -1.03410         NA      NA       NA    \nR3                   -0.73802         NA      NA       NA    \nR4                   -1.42900         NA      NA       NA    \nC2                   -1.68749         NA      NA       NA    \nC3                   -2.18127         NA      NA       NA    \nC4                   -3.67502         NA      NA       NA    \nL2                   -1.46986         NA      NA       NA    \nL3                   -2.17261         NA      NA       NA    \nL4                   -3.76609         NA      NA       NA    \nRscore:Cscore         0.13307    0.02552   5.215 1.84e-07 ***\nMult(., R, C + L).   -0.79291         NA      NA       NA    \nMult(1, ., C + L).R1 -0.65613         NA      NA       NA    \nMult(1, ., C + L).R2  0.91810         NA      NA       NA    \nMult(1, ., C + L).R3  0.62909         NA      NA       NA    \nMult(1, ., C + L).R4 -0.51688         NA      NA       NA    \nMult(1, R, . + L).C1  0.07367         NA      NA       NA    \nMult(1, R, . + L).C2 -0.46424         NA      NA       NA    \nMult(1, R, . + L).C3 -0.06703         NA      NA       NA    \nMult(1, R, . + L).C4  0.34928         NA      NA       NA    \nMult(1, R, C + .).L2 -0.73512         NA      NA       NA    \nMult(1, R, C + .).L3 -0.18550         NA      NA       NA    \nMult(1, R, C + .).L4  0.72047         NA      NA       NA    \ncov_rcl               0.22862    0.01709  13.377  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 55.984 on 44 degrees of freedom\nAIC: 390.3\n\nNumber of iterations: 49\n\nmodel.summary(model15)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 model15                44  56.0 -266.  6.83 0.106\n\nmu &lt;- getContrasts(\n  model15,\n  pickCoef(model15, \"[.]R\"),\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\nnu &lt;- getContrasts(\n  model15,\n  pickCoef(model15, \"[.]C\"),\n  ref = \"mean\",\n  scaleRef = \"mean\",\n  scaleWeights = \"unit\"\n)\n\nmodel15.extended &lt;-\n  freq_tab_3.1 |&gt; gnm(\n    Freq ~ R + C + L + \n      Rscore:Cscore + \n      Mult(1, R, C) +\n      cov_rcl + \n      Mult(1, R, L),\n    constrain = c(13:16, 23:26),\n    constrainTo = c(mu$qvframe[, 1], mu$qvframe[, 1]),\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning start-up iterations..\nRunning main iterations....\nDone\n\nsummary(model15.extended)\n\n\nCall:\ngnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + \n    cov_rcl + Mult(1, R, L), constrain = c(13:16, 23:26), constrainTo = c(mu$qvframe[, \n    1], mu$qvframe[, 1]), family = poisson, data = freq_tab_3.1, \n    tolerance = 1e-12, trace = F)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.98677  -0.75501   0.01756   0.52206   2.97799  \n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       3.58773         NA      NA       NA    \nR2               -1.00732         NA      NA       NA    \nR3               -0.71615         NA      NA       NA    \nR4               -1.42663         NA      NA       NA    \nC2               -1.64759    0.10152  -16.23  &lt; 2e-16 ***\nC3               -2.17084    0.15843  -13.70  &lt; 2e-16 ***\nC4               -3.69546    0.24129  -15.32  &lt; 2e-16 ***\nL2               -1.41533    0.10612  -13.34  &lt; 2e-16 ***\nL3               -2.15885    0.17266  -12.50  &lt; 2e-16 ***\nL4               -3.81953    0.27268  -14.01  &lt; 2e-16 ***\nRscore:Cscore     0.13307    0.02539    5.24  1.6e-07 ***\nMult(., R, C).   -0.84168         NA      NA       NA    \nMult(1, ., C).R1 -0.54368         NA      NA       NA    \nMult(1, ., C).R2  0.59799         NA      NA       NA    \nMult(1, ., C).R3  0.38839         NA      NA       NA    \nMult(1, ., C).R4 -0.44270         NA      NA       NA    \nMult(1, R, .).C1  0.08721         NA      NA       NA    \nMult(1, R, .).C2 -0.61151         NA      NA       NA    \nMult(1, R, .).C3 -0.09555         NA      NA       NA    \nMult(1, R, .).C4  0.44523         NA      NA       NA    \ncov_rcl           0.22862    0.01643   13.91  &lt; 2e-16 ***\nMult(., R, L).   -1.84393         NA      NA       NA    \nMult(1, ., L).R1 -0.54368         NA      NA       NA    \nMult(1, ., L).R2  0.59799         NA      NA       NA    \nMult(1, ., L).R3  0.38839         NA      NA       NA    \nMult(1, ., L).R4 -0.44270         NA      NA       NA    \nMult(1, R, .).L1  0.01659         NA      NA       NA    \nMult(1, R, .).L2 -0.41929         NA      NA       NA    \nMult(1, R, .).L3 -0.09340         NA      NA       NA    \nMult(1, R, .).L4  0.44378         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 55.984 on 46 degrees of freedom\nAIC: 386.3\n\nNumber of iterations: 4\n\neta &lt;-\n  getContrasts(\n    model15.extended,\n    pickCoef(model15.extended, \"[.]L\"),\n    ref = \"mean\",\n    scaleRef = \"mean\",\n    scaleWeights = \"unit\"\n  )\n\nmodel15.phis &lt;-\n  freq_tab_3.1 |&gt; gnm(\n    Freq ~ R + C + L + \n      Rscore:Cscore + \n      Mult(1, R, C) + \n      cov_rcl + \n      Mult(1, R, L),\n    constrain = c(13:20, 23:30),\n    constrainTo = c(mu$qvframe[, 1], \n                    nu$qvframe[, 1], \n                    mu$qvframe[, 1], \n                    eta$qvframe[, 1]),\n    data = _,\n    family = poisson,\n    trace = F,\n    tolerance = 1e-12\n  )\n\nInitialising\nRunning main iterations.\nDone\n\nsummary(model15.phis)\n\n\nCall:\ngnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + \n    cov_rcl + Mult(1, R, L), constrain = c(13:20, 23:30), constrainTo = c(mu$qvframe[, \n    1], nu$qvframe[, 1], mu$qvframe[, 1], eta$qvframe[, 1]), \n    family = poisson, data = freq_tab_3.1, tolerance = 1e-12,     trace = F)\n\nDeviance Residuals: \n     Min        1Q    Median        3Q       Max  \n-1.98677  -0.75501   0.01756   0.52206   2.97799  \n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       3.55464    0.08091  43.935  &lt; 2e-16 ***\nR2               -0.93784    0.11339  -8.271  &lt; 2e-16 ***\nR3               -0.65943    0.12613  -5.228 1.71e-07 ***\nR4               -1.42048    0.17754  -8.001  &lt; 2e-16 ***\nC2               -1.64759    0.10044 -16.404  &lt; 2e-16 ***\nC3               -2.17084    0.15588 -13.927  &lt; 2e-16 ***\nC4               -3.69546    0.23861 -15.488  &lt; 2e-16 ***\nL2               -1.41533    0.10551 -13.414  &lt; 2e-16 ***\nL3               -2.15885    0.17245 -12.519  &lt; 2e-16 ***\nL4               -3.81953    0.27221 -14.032  &lt; 2e-16 ***\nRscore:Cscore     0.13307    0.02492   5.341 9.24e-08 ***\nMult(., R, C).   -0.64172    0.13829  -4.641 3.48e-06 ***\nMult(1, ., C).R1 -0.54368         NA      NA       NA    \nMult(1, ., C).R2  0.59799         NA      NA       NA    \nMult(1, ., C).R3  0.38839         NA      NA       NA    \nMult(1, ., C).R4 -0.44270         NA      NA       NA    \nMult(1, R, .).C1  0.17165         NA      NA       NA    \nMult(1, R, .).C2 -0.74481         NA      NA       NA    \nMult(1, R, .).C3 -0.06806         NA      NA       NA    \nMult(1, R, .).C4  0.64122         NA      NA       NA    \ncov_rcl           0.22862    0.01640  13.939  &lt; 2e-16 ***\nMult(., R, L).   -1.13826    0.13726  -8.293  &lt; 2e-16 ***\nMult(1, ., L).R1 -0.54368         NA      NA       NA    \nMult(1, ., L).R2  0.59799         NA      NA       NA    \nMult(1, ., L).R3  0.38839         NA      NA       NA    \nMult(1, ., L).R4 -0.44270         NA      NA       NA    \nMult(1, R, .).L1  0.04806         NA      NA       NA    \nMult(1, R, .).L2 -0.65804         NA      NA       NA    \nMult(1, R, .).L3 -0.13012         NA      NA       NA    \nMult(1, R, .).L4  0.74010         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\nStd. Error is NA where coefficient has been constrained or is unidentified\n\nResidual deviance: 55.984 on 50 degrees of freedom\nAIC: 378.3\n\nNumber of iterations: 1\n\nmu\n\n                       Estimate Std. Error\nMult(1, ., C + L).R1 -0.5436794 0.07818382\nMult(1, ., C + L).R2  0.5979869 0.06871974\nMult(1, ., C + L).R3  0.3883879 0.08391754\nMult(1, ., C + L).R4 -0.4426954 0.08454001\n\nnu\n\n                        Estimate Std. Error\nMult(1, R, . + L).C1  0.17164747 0.14998137\nMult(1, R, . + L).C2 -0.74480785 0.08583798\nMult(1, R, . + L).C3 -0.06806188 0.15421719\nMult(1, R, . + L).C4  0.64122226 0.11322236\n\neta\n\n                    Estimate Std. Error\nMult(1, R, .).L1  0.04806244 0.08932196\nMult(1, R, .).L2 -0.65804171 0.05969167\nMult(1, R, .).L3 -0.13011596 0.08427834\nMult(1, R, .).L4  0.74009523 0.04837401\n\nmodel.summary(model15)\n\n# A tibble: 1 × 6\n  `Model Description`    df    L2   BIC Delta     p\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 model15                44  56.0 -266.  6.83 0.106\n\n\n\nbind_rows(model.summary(model1),\nmodel.summary(model2),\nmodel.summary(model4),\nmodel.summary(model6),\nmodel.summary(model7),\nmodel.summary(model8),\nmodel.summary(model9),\nmodel.summary(model10),\nmodel.summary(model11),\nmodel.summary(model12),\nmodel.summary(model15))\n\n# A tibble: 11 × 6\n   `Model Description`    df    L2   BIC Delta        p\n   &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n 1 model1                 54 544.   149. 23.7  3.44e-82\n 2 model2                 39 109.  -176.  9.81 1.42e- 8\n 3 model4                 35  37.7 -218.  4.63 3.47e- 1\n 4 model6                 27  29.0 -169.  4.86 3.61e- 1\n 5 model7                 23  21.9 -146.  3.70 5.24e- 1\n 6 model8                 36  45.9 -218.  6.25 1.26e- 1\n 7 model9                 38  47.1 -231.  6.25 1.47e- 1\n 8 model10                38  50.9 -227.  6.31 7.88e- 2\n 9 model11                38  53.6 -225.  6.58 4.77e- 2\n10 model12                39  48.6 -237.  6.57 1.40e- 1\n11 model15                44  56.0 -266.  6.83 1.06e- 1"
  }
]